// https://github.com/arose/ngl/ LICENSE
(function(a){a.console=a.console||{};a=a.console;for(var b,c={},d=function(){},e=["memory"],f="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");b=e.pop();)a[b]||(a[b]=c);for(;b=f.pop();)a[b]||(a[b]=d)})("undefined"===typeof window?this:window);
"function"===typeof importScripts||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,b,c){c=window.atob(this.toDataURL(b,c).split(",")[1]);for(var d=c.length,e=d>>2,f=new Uint8Array(d),g=new Uint32Array(f.buffer,0,e),h=0,k=0;h<e;h++)g[h]=c.charCodeAt(k++)|c.charCodeAt(k++)<<8|c.charCodeAt(k++)<<16|c.charCodeAt(k++)<<24;for(d&=3;d--;)f[k]=c.charCodeAt(k++);a(new Blob([f],{type:b||"image/png"}))}});
Number.isInteger||(Number.isInteger=function(a){return"number"===typeof a&&isFinite(a)&&-9007199254740992<a&&9007199254740992>a&&Math.floor(a)===a});Number.isNaN||(Number.isNaN=function(a){return a!==a});
Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(a,b){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var c=Object(a),d=!1,e,f=1;f<arguments.length;f++){var g=arguments[f];if(void 0!==g&&null!==g){for(var h=Object.keys(Object(g)),k=0,l=h.length;k<l;k++){var m=h[k];try{var p=Object.getOwnPropertyDescriptor(g,m);void 0!==p&&p.enumerable&&(c[m]=g[m])}catch(r){d||(d=!0,e=r)}}if(d)throw e;}}return c}});
String.prototype.startsWith||function(){var a=function(){try{var a={},b=Object.defineProperty,c=b(a,a,a)&&b}catch(g){}return c}(),b={}.toString,c=function(a){if(null==this)throw TypeError();var c=String(this);if(a&&"[object RegExp]"==b.call(a))throw TypeError();var f=c.length,g=String(a),h=g.length,k=1<arguments.length?arguments[1]:void 0,k=k?Number(k):0;k!=k&&(k=0);k=Math.min(Math.max(k,0),f);if(h+k>f)return!1;for(f=-1;++f<h;)if(c.charCodeAt(k+f)!=g.charCodeAt(f))return!1;return!0};a?a(String.prototype,
"startsWith",{value:c,configurable:!0,writable:!0}):String.prototype.startsWith=c}();
"function"!==typeof importScripts&&function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var f=(new Date).getTime(),g=Math.max(0,16-(f-a)),h=window.setTimeout(function(){b(f+g)},g);a=f+g;return h});window.cancelAnimationFrame||
(window.cancelAnimationFrame=function(a){clearTimeout(a)})}();void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});"function"!==typeof importScripts&&(HTMLElement.prototype.getBoundingClientRect=function(){var a=HTMLElement.prototype.getBoundingClientRect;return function(){try{return a.apply(this,arguments)}catch(b){return{top:0,left:0,width:this.width,height:this.height}}}}());
"function"!==typeof importScripts&&WebGLRenderingContext&&(WebGLRenderingContext.prototype.getShaderParameter=function(){var a=WebGLRenderingContext.prototype.getShaderParameter;return function(){return NGL.debug?a.apply(this,arguments):!0}}(),WebGLRenderingContext.prototype.getShaderInfoLog=function(){var a=WebGLRenderingContext.prototype.getShaderInfoLog;return function(){return NGL.debug?a.apply(this,arguments):""}}(),WebGLRenderingContext.prototype.getProgramParameter=function(){var a=WebGLRenderingContext.prototype.getProgramParameter;
return function(b,c){return NGL.debug||c!==WebGLRenderingContext.prototype.LINK_STATUS?a.apply(this,arguments):!0}}(),WebGLRenderingContext.prototype.getProgramInfoLog=function(){var a=WebGLRenderingContext.prototype.getProgramInfoLog;return function(){return NGL.debug?a.apply(this,arguments):""}}());
var NGL={REVISION:"0.6dev",EPS:1E-7,disableImpostor:!1,useWorker:!0,indexUint16:!1,debug:!1,develop:-1!==self.location.pathname.indexOf("core.js")||-1!==self.location.pathname.indexOf("dev.html"),mainScriptFilePath:"../js/build/ngl.full.min.js",cssDirectory:"../css/",assetsDirectory:"../"};NGL.log=Function.prototype.bind.call(console.log,console);NGL.info=Function.prototype.bind.call(console.info,console);NGL.warn=Function.prototype.bind.call(console.warn,console);
NGL.error=Function.prototype.bind.call(console.error,console);NGL.time=Function.prototype.bind.call(console.time,console);NGL.timeEnd=Function.prototype.bind.call(console.timeEnd,console);NGL.LeftMouseButton=1;NGL.MiddleMouseButton=2;NGL.RightMouseButton=3;
"function"===typeof importScripts&&NGL.develop&&importScripts("../three/three.js","../three/Detector.js","../three/TypedArrayUtils.js","../three/controls/TrackballControls.js","../three/loaders/OBJLoader.js","../three/loaders/PLYLoader.js","../lib/async.js","../lib/promise.min.js","../lib/sprintf.min.js","../lib/jszip.min.js","../lib/pako.min.js","../lib/lzma.min.js","../lib/bzip2.min.js","../lib/chroma.min.js","../lib/svd.js","../lib/signals.min.js","../ngl/shims.js","../ngl/worker.js","../ngl/utils.js",
"../ngl/symmetry.js","../ngl/alignment.js","../ngl/geometry.js","../ngl/selection.js","../ngl/superposition.js","../ngl/structure.js","../ngl/trajectory.js","../ngl/surface.js","../ngl/script.js","../ngl/streamer.js","../ngl/parser.js","../ngl/writer.js","../ngl/loader.js","../ngl/viewer.js","../ngl/buffer.js","../ngl/representation.js","../ngl/stage.js");
NGL.PluginRegistry={dict:{},add:function(a,b){this.dict[a]=b},get:function(a){if(a in this.dict)return this.dict[a];throw"NGL.PluginRegistry '"+a+"' not defined";},get names(){return Object.keys(this.dict)},get count(){return this.names.length},load:function(a,b){var c=this.get(a);b.loadFile(c,{name:a+" plugin"})}};
NGL.ExampleRegistry={dict:{},add:function(a,b){this.dict[a]=b},addDict:function(a){Object.keys(a).forEach(function(b){this.add(b,a[b])}.bind(this))},get:function(a){return this.dict[a]},get names(){return Object.keys(this.dict)},get count(){return this.names.length},load:function(a,b){var c=this.get(a);"function"===typeof c?c(b):NGL.warn("NGL.ExampleRegistry.load not available:",a)}};NGL.WorkerRegistry={activeWorkerCount:0,funcDict:{},add:function(a,b){NGL.WorkerRegistry.funcDict[a]=b}};
NGL.Worker=function(a){var b=0,c=0,d={},e={},f=new Worker(NGL.mainScriptFilePath);NGL.WorkerRegistry.activeWorkerCount+=1;f.onmessage=function(c){--b;var h=c.data.__postId;NGL.timeEnd("NGL.Worker.postMessage "+a+" #"+h);d[h]&&d[h].call(f,c);delete d[h];delete e[h]};f.onerror=function(c){--b;var h=c.data.__postId;e[h]?e[h].call(f,c):NGL.error("NGL.Worker.onerror",h,a,c);delete d[h];delete e[h]};this.name=a;this.post=function(g,h,k,l){d[c]=k;e[c]=l;g=g||{};g.__name=a;g.__postId=c;NGL.time("NGL.Worker.postMessage "+
a+" #"+c);try{f.postMessage.call(f,g,h)}catch(m){NGL.error("NGL.worker.post:",m),f.postMessage.call(f,g)}b+=1;c+=1;return this};this.terminate=function(){f?(f.terminate(),--NGL.WorkerRegistry.activeWorkerCount):console.log("no worker to terminate")};Object.defineProperties(this,{postCount:{get:function(){return c}},pending:{get:function(){return b}}})};NGL.Worker.prototype.constructor=NGL.Worker;
NGL.WorkerPool=function(a,b){b=Math.min(8,b||2);var c=[],d=0;this.name=a;this.maxCount=b;this.post=function(a,b,c,d){this.getNextWorker().post(a,b,c,d);return this};this.terminate=function(){c.forEach(function(a){a.terminate()})};this.getNextWorker=function(){for(var e,f=Infinity,g=0;g<b;++g){if(g>=d){e=new NGL.Worker(a);c.push(e);d+=1;break}var h=c[g];if(0===h.pending){e=h;break}else h.pending<f&&(f=h.pending,e=h)}return e};Object.defineProperties(this,{count:{get:function(){return d}}})};
NGL.WorkerPool.prototype.constructor=NGL.WorkerPool;"function"===typeof importScripts&&(self.onmessage=function(a){var b=a.data.__name,c=a.data.__postId;if(void 0===b)NGL.error("message __name undefined");else if(void 0===NGL.WorkerRegistry.funcDict[b])NGL.error("funcDict[ __name ] undefined",b);else NGL.WorkerRegistry.funcDict[b](a,function(a,b){a=a||{};void 0!==c&&(a.__postId=c);try{self.postMessage(a,b)}catch(f){NGL.error("self.postMessage:",f),self.postMessage(a)}})});
NGL.browser=function(){var a=navigator.userAgent;return/Arora/i.test(a)?"Arora":/Opera|OPR/.test(a)?"Opera":/Chrome/i.test(a)?"Chrome":/Epiphany/i.test(a)?"Epiphany":/Firefox/i.test(a)?"Firefox":/Mobile(\/.*)? Safari/i.test(a)?"Mobile Safari":/MSIE/i.test(a)?"Internet Explorer":/Midori/i.test(a)?"Midori":/Safari/i.test(a)?"Safari":!1}();NGL.GET=function(a){if(a=(new RegExp(a+"=([^&#=]*)")).exec(window.location.search))return decodeURIComponent(a[1])};
NGL.getAbsolutePath=function(a){var b=window.location,c=b.pathname,c=c.substring(0,c.lastIndexOf("/")+1);return b.origin+c+a};NGL.createObject=function(a,b){var c=Object.create(a),d;for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c};NGL.deepCopy=function(a){if("object"!==typeof a)return a;var b=Array.isArray(a)?[]:{},c;for(c in a)b[c]=NGL.deepCopy(a[c]);return b};
NGL.download=function(a,b){if(a){b=b||"download";var c=document.createElement("a");c.style.display="hidden";document.body.appendChild(c);c.href=a instanceof Blob?URL.createObjectURL(a):a;c.download=b;c.target="_blank";c.click();document.body.removeChild(c);a instanceof Blob&&URL.revokeObjectURL(a)}else NGL.warn("NGL.download: no data given.")};
NGL.submit=function(a,b,c,d){if(b instanceof FormData){var e=new XMLHttpRequest;e.open("POST",a);e.addEventListener("load",function(a){200===e.status||304===e.status?c(e.response):"function"===typeof d&&d(e.status)},!1);e.send(b)}else NGL.warn("NGL.submit: type not supported.",b)};
NGL.open=function(a,b){b=b||["*"];var c=document.createElement("input");c.type="file";c.multiple=!0;c.style.display="hidden";document.body.appendChild(c);c.accept="."+b.join(",.");c.addEventListener("change",function(b){a(b.target.files)},!1);c.click()};NGL.unicodeHelper=function(){var a={"{alpha}":"\u03b1","{beta}":"\u03b2","{gamma}":"\u03b3","{dot}":"\u00b7","{bullet}":"\u2022"},b=Object.keys(a).join("|"),c=new RegExp("("+b+")","gi");return function(b){return b.replace(c,function(b,c,d,h,k){return a[String(b)]})}}();
NGL.getFileInfo=function(a){var b,c,d;b=a instanceof File?a.name:a;var e=b.replace(/^.*[\\\/]/,""),f=e.substring(0,e.lastIndexOf(".")),g=b.split("."),g=1<g.length?g.pop().toLowerCase():"";if(c=b.match(/^(.+):\/\/(.+)$/))d=c[1].toLowerCase(),b=c[2];var h=b.substring(0,b.lastIndexOf("/")+1);-1!==["gz","zip","lzma","bz2"].indexOf(g)?(c=g,g=b.substr(0,b.length-g.length-1).split(".").pop().toLowerCase(),f=f.substr(0,f.length-g.length-1)):c=!1;return{path:b,name:e,ext:g,base:f,dir:h,compressed:c,protocol:d,
src:a}};NGL.fromJSON=function(a){return(new NGL[a.metadata.type]).fromJSON(a)};NGL.processArray=function(a,b,c,d){var e=a.length;if("function"===typeof importScripts)b(0,e,a),c();else{var f=0,g=void 0!==d?d:1E4,h=Math.min(g,e);async.until(function(){return f>=e},function(c){requestAnimationFrame(function(){b(f,h,a)?f=e:(f+=g,h=Math.min(h+g,e));c()})},c)}};
NGL.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var k=function(){h=!1===c.leading?0:Date.now();g=null;f=a.apply(d,e);g||(d=e=null)};return function(){var l=Date.now();h||!1!==c.leading||(h=l);var m=b-(l-h);d=this;e=arguments;0>=m||m>b?(g&&(clearTimeout(g),g=null),h=l,f=a.apply(d,e),g||(d=e=null)):g||!1===c.trailing||(g=setTimeout(k,m));return f}};
NGL.binarySearchIndexOf=function(){function a(a,c){return a<c?-1:a>c?1:0}return function(b,c,d){var e=0,f=b.length-1;for(d||(d=a);e<=f;){var g=e+f>>1,h=d(c,b[g]);if(0<h)e=g+1;else if(0>h)f=g-1;else return g}return-e-1}}();NGL.Uint8ToString=function(a){for(var b=[],c=0;c<a.length;c+=4096)b.push(String.fromCharCode.apply(null,a.subarray(c,c+4096)));return b.join("")};
NGL.Uint8ToLines=function(a,b,c){NGL.time("NGL.Uint8ToLines");b=void 0!==b?b:10485760;c=void 0!==c?c:"\n";for(var d="",e=[],f=0;f<a.length;f+=b){var g=NGL.Uint8ToString(a.subarray(f,f+b)),h=g.lastIndexOf(c);-1===h?d+=g:(d+=g.substr(0,h),e=e.concat(d.split(c)),d=h===g.length-c.length?"":g.substr(h+c.length))}""!==d&&e.push(d);NGL.timeEnd("NGL.Uint8ToLines");return e};
NGL.decompress=function(a,b,c,d){var e,f;b=NGL.getFileInfo(b).compressed;NGL.time("NGL.decompress "+b);a instanceof ArrayBuffer&&(a=new Uint8Array(a));"gz"===b?e=pako.ungzip(a):"zip"===b?(a=new JSZip(a),e=Object.keys(a.files)[0],e=a.files[e].asUint8Array()):"lzma"===b?(e={data:[],offset:0,writeByte:function(a){this.data[this.offset++]=a}},LZMA.decompressFile({data:a,offset:0,readByte:function(){return this.data[this.offset++]}},e),e=new Uint8Array(e.data)):"bz2"===b?(f=bzip2.array(a),f=bzip2.simple(f)):
(NGL.warn("no decompression method available for '"+b+"'"),f=a);c||void 0!==f||(f=NGL.Uint8ToString(e));NGL.timeEnd("NGL.decompress "+b);c=c?e:f;"function"===typeof d&&d(c);return c};NGL.WorkerRegistry.add("decompress",function(a,b){var c=a.data,d=NGL.decompress(c.data,c.file,c.asBinary),e=[];c.asBinary&&e.push(d.buffer);b(d,e)});
NGL.decompressWorker=function(a,b,c,d){if(NGL.useWorker&&"undefined"!==typeof Worker&&"function"!==typeof importScripts)var e=(new NGL.Worker("decompress")).post({data:a,file:b,asBinary:c},[a.buffer?a.buffer:a],function(a){e.terminate();d(a.data)},function(f){console.warn("NGL.decompressWorker error - trying without worker",f);e.terminate();NGL.decompress(a,b,c,d)});else NGL.decompress(a,b,c,d)};NGL.Counter=function(){var a=signals;this.count=0;this.signals={countChanged:new a.Signal}};
NGL.Counter.prototype={clear:function(){this.change(-this.count)},change:function(a){this.count+=a;this.signals.countChanged.dispatch(a,this.count);0>this.count&&NGL.warn("NGL.Counter.count below zero",this.count)},increment:function(){this.change(1)},decrement:function(){this.change(-1)},listen:function(a){this.change(a.count);a.signals.countChanged.add(function(a,c){this.change(a)}.bind(this))},onZeroOnce:function(a,b){if(0===this.count)a.call(b,0,0);else{var c=function(){0===this.count&&(this.signals.countChanged.remove(c,
this),a.apply(b,arguments))};this.signals.countChanged.add(c,this)}},dispose:function(){this.clear()}};
NGL.Unitcell=function(a,b,c,d,e,f,g,h){this.a=a||1;this.b=b||1;this.c=c||1;this.alpha=d||90;this.beta=e||90;this.gamma=f||90;this.spacegroup=g||"P 1";d=THREE.Math.degToRad(this.alpha);f=THREE.Math.degToRad(this.beta);e=THREE.Math.degToRad(this.gamma);c=Math.cos(d);a=Math.cos(f);b=Math.cos(e);Math.sin(d);d=Math.sin(f);e=Math.sin(e);this.volume=this.a*this.b*this.c*Math.sqrt(1-c*c-a*a-b*b+2*c*a*b);this.cartToFrac=h;void 0===this.cartToFrac&&(h=this.a*this.b*e/this.volume,c=(a*b-c)/(d*e),this.cartToFrac=
(new THREE.Matrix4).set(this.a,0,0,0,this.b*b,this.b*e,0,0,this.c*a,-this.c*d*c,1/h,0,0,0,0,1));this.fracToCart=(new THREE.Matrix4).getInverse(this.cartToFrac)};
NGL.Unitcell.prototype={toJSON:function(){return{metadata:{version:.1,type:"Unitcell",generator:"UnitcellExporter"},a:this.a,b:this.b,c:this.c,alpha:this.alpha,beta:this.beta,gamma:this.gamma,spacegroup:this.spacegroup,volume:this.volume,cartToFrac:this.cartToFrac.toArray(),fracToCart:this.fracToCart.toArray()}},fromJSON:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.alpha=a.alpha;this.beta=a.beta;this.gamma=a.gamma;this.spacegroup=a.spacegroup;this.volume=a.volume;this.cartToFrac.fromArray(a.cartToFrac);
this.fracToCart.fromArray(a.fracToCart);return this}};
NGL.getSymmetryOperations=function(a){var b=NGL.SymOp[a],c={};if(void 0===b)return console.warn("NGL.getSymmetryOperations: spacegroup '"+a+"' not found in symop library"),c;var d=/^[1-9]$/;b.forEach(function(a){var b=a.split(","),g=0,h=(new THREE.Matrix4).set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),k=h.elements;c[a]=h;b.forEach(function(a){for(var b=!1,c=!1,e=0,f=a.length;e<f;++e){var h=a[e];"-"===h?b=!0:"+"===h?b=!1:"/"===h?c=!0:"X"===h?k[0+g]=b?-1:1:"Y"===h?k[4+g]=b?-1:1:"Z"===h?k[8+g]=b?-1:1:d.test(h)?
(h=parseInt(h),k[12+g]=c?k[12+g]/h:h):NGL.warn("NGL.getSymmetryOperations: unknown token '"+h+"'")}g+=1})});return c};
NGL.SymOp={"P 1":["X,Y,Z"],"P -1":["X,Y,Z","-X,-Y,-Z"],"P 1 2 1":["X,Y,Z","-X,Y,-Z"],"P 1 21 1":["X,Y,Z","-X,Y+1/2,-Z"],"C 1 2 1":["X,Y,Z","-X,Y,-Z","1/2+X,1/2+Y,Z","1/2-X,1/2+Y,-Z"],"P 1 m 1":["X,Y,Z","X,-Y,Z"],"P 1 c 1":["X,Y,Z","X,-Y,1/2+Z"],"C 1 m 1":["X,Y,Z","X,-Y,Z","1/2+X,1/2+Y,Z","1/2+X,1/2-Y,Z"],"C 1 c 1":["X,Y,Z","X,-Y,1/2+Z","1/2+X,1/2+Y,Z","1/2+X,1/2-Y,1/2+Z"],"P 1 2/m 1":["X,Y,Z","X,-Y,Z","-X,Y,-Z","-X,-Y,-Z"],"P 1 21/m 1":["X,Y,Z","-X,1/2+Y,-Z","-X,-Y,-Z","X,1/2-Y,Z"],"C 1 2/m 1":"X,Y,Z X,-Y,Z -X,Y,-Z -X,-Y,-Z 1/2+X,1/2+Y,Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2-X,1/2-Y,-Z".split(" "),
"P 1 2/c 1":["X,Y,Z","-X,Y,1/2-Z","-X,-Y,-Z","X,-Y,1/2+Z"],"P 1 21/c 1":["X,Y,Z","-X,-Y,-Z","-X,1/2+Y,1/2-Z","X,1/2-Y,1/2+Z"],"C 1 2/c 1":"X,Y,Z -X,Y,1/2-Z -X,-Y,-Z X,-Y,1/2+Z 1/2+X,1/2+Y,Z 1/2-X,1/2+Y,1/2-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2-Y,1/2+Z".split(" "),"P 2 2 2":["X,Y,Z","-X,-Y,Z","-X,Y,-Z","X,-Y,-Z"],"P 2 2 21":["X,Y,Z","-X,-Y,1/2+Z","-X,Y,1/2-Z","X,-Y,-Z"],"P 21 21 2":["X,Y,Z","-X,-Y,Z","1/2-X,1/2+Y,-Z","1/2+X,1/2-Y,-Z"],"P 21 21 21":["X,Y,Z","1/2-X,-Y,1/2+Z","-X,1/2+Y,1/2-Z","1/2+X,1/2-Y,-Z"],
"C 2 2 21":"X,Y,Z -X,-Y,1/2+Z -X,Y,1/2-Z X,-Y,-Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z".split(" "),"C 2 2 2":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z".split(" "),"F 2 2 2":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z".split(" "),"I 2 2 2":"X,Y,Z -X,-Y,Z X,-Y,-Z -X,Y,-Z X+1/2,Y+1/2,Z+1/2 -X+1/2,-Y+1/2,Z+1/2 X+1/2,-Y+1/2,-Z+1/2 -X+1/2,Y+1/2,-Z+1/2".split(" "),
"I 21 21 21":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,Y,-Z X,-Y,1/2-Z".split(" "),"P m m 2":["X,Y,Z","-X,-Y,Z","X,-Y,Z","-X,Y,Z"],"P m c 21":["X,Y,Z","-X,-Y,1/2+Z","X,-Y,1/2+Z","-X,Y,Z"],"P c c 2":["X,Y,Z","-X,-Y,Z","X,-Y,1/2+Z","-X,Y,1/2+Z"],"P m a 2":["X,Y,Z","-X,-Y,Z","1/2+X,-Y,Z","1/2-X,Y,Z"],"P c a 21":["X,Y,Z","-X,-Y,1/2+Z","1/2+X,-Y,Z","1/2-X,Y,1/2+Z"],"P n c 2":["X,Y,Z","-X,-Y,Z","X,1/2-Y,1/2+Z","-X,1/2+Y,1/2+Z"],"P m n 21":["X,Y,Z","1/2-X,-Y,1/2+Z",
"1/2+X,-Y,1/2+Z","-X,Y,Z"],"P b a 2":["X,Y,Z","-X,-Y,Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,Z"],"P n a 21":["X,Y,Z","-X,-Y,1/2+Z","1/2+X,1/2-Y,Z","1/2-X,1/2+Y,1/2+Z"],"P n n 2":["X,Y,Z","-X,-Y,Z","1/2+X,1/2-Y,1/2+Z","1/2-X,1/2+Y,1/2+Z"],"C m m 2":"X,Y,Z -X,-Y,Z X,-Y,Z -X,Y,Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z".split(" "),"C m c 21":"X,Y,Z -X,-Y,1/2+Z X,-Y,1/2+Z -X,Y,Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,1/2+Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z".split(" "),"C c c 2":"X,Y,Z -X,-Y,Z X,-Y,1/2+Z -X,Y,1/2+Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),
"A m m 2":"X,Y,Z -X,-Y,Z X,-Y,Z -X,Y,Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z".split(" "),"A b m 2":"X,Y,Z -X,-Y,Z X,1/2-Y,Z -X,1/2+Y,Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z X,-Y,1/2+Z -X,Y,1/2+Z".split(" "),"A m a 2":"X,Y,Z -X,-Y,Z 1/2+X,-Y,Z 1/2-X,Y,Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),"A b a 2":"X,Y,Z -X,-Y,Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z 1/2+X,-Y,1/2+Z 1/2-X,Y,1/2+Z".split(" "),"F m m 2":"X,Y,Z -X,-Y,Z X,-Y,Z -X,Y,Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2+X,-Y,1/2+Z 1/2-X,Y,1/2+Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z".split(" "),
"F d d 2":"X,Y,Z -X,-Y,Z 1/4+X,1/4-Y,1/4+Z 1/4-X,1/4+Y,1/4+Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z 1/4+X,3/4-Y,3/4+Z 1/4-X,3/4+Y,3/4+Z 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 3/4+X,1/4-Y,3/4+Z 3/4-X,1/4+Y,3/4+Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 3/4+X,3/4-Y,1/4+Z 3/4-X,3/4+Y,1/4+Z".split(" "),"I m m 2":"X,Y,Z -X,-Y,Z X,-Y,Z -X,Y,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),"I b a 2":"X,Y,Z -X,-Y,Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z X,-Y,1/2+Z -X,Y,1/2+Z".split(" "),
"I m a 2":"X,Y,Z -X,-Y,Z 1/2+X,-Y,Z 1/2-X,Y,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z".split(" "),"P 2/m 2/m 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z".split(" "),"P 2/n 2/n 2/n":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),"P 2/c 2/c 2/m":"X,Y,Z -X,-Y,Z -X,Y,1/2-Z X,-Y,1/2-Z -X,-Y,-Z X,Y,-Z X,-Y,1/2+Z -X,Y,1/2+Z".split(" "),"P 2/b 2/a 2/n":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z".split(" "),
"P 21/m 2/m 2/a":"X,Y,Z 1/2-X,-Y,Z -X,Y,-Z 1/2+X,-Y,-Z -X,-Y,-Z 1/2+X,Y,-Z X,-Y,Z 1/2-X,Y,Z".split(" "),"P 2/n 21/n 2/a":"X,Y,Z 1/2-X,-Y,Z 1/2-X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z -X,-Y,-Z 1/2+X,Y,-Z 1/2+X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z".split(" "),"P 2/m 2/n 21/a":"X,Y,Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z X,-Y,-Z -X,-Y,-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z -X,Y,Z".split(" "),"P 21/c 2/c 2/a":"X,Y,Z 1/2-X,-Y,Z -X,Y,1/2-Z 1/2+X,-Y,1/2-Z -X,-Y,-Z 1/2+X,Y,-Z X,-Y,1/2+Z 1/2-X,Y,1/2+Z".split(" "),"P 21/b 21/a 2/m":"X,Y,Z -X,-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z -X,-Y,-Z X,Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z".split(" "),
"P 21/c 21/c 2/n":"X,Y,Z 1/2-X,1/2-Y,Z -X,1/2+Y,1/2-Z 1/2+X,-Y,1/2-Z -X,-Y,-Z 1/2+X,1/2+Y,-Z X,1/2-Y,1/2+Z 1/2-X,Y,1/2+Z".split(" "),"P 2/b 21/c 21/m":"X,Y,Z -X,-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,-Z -X,-Y,-Z X,Y,1/2-Z X,1/2-Y,1/2+Z -X,1/2+Y,Z".split(" "),"P 21/n 21/n 2/m":"X,Y,Z -X,-Y,Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z -X,-Y,-Z X,Y,-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),"P 21/m 21/m 2/n":"X,Y,Z -X,-Y,Z 1/2-X,Y+1/2,-Z X+1/2,1/2-Y,-Z 1/2-X,1/2-Y,-Z X+1/2,Y+1/2,-Z X,-Y,Z -X,Y,Z".split(" "),
"P 21/b 2/c 21/n":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -X,Y,1/2-Z 1/2+X,1/2-Y,-Z -X,-Y,-Z 1/2+X,1/2+Y,1/2-Z X,-Y,1/2+Z 1/2-X,1/2+Y,Z".split(" "),"P 21/b 21/c 21/a":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z -X,-Y,-Z 1/2+X,Y,1/2-Z X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z".split(" "),"P 21/n 21/m 21/a":"X,Y,Z -X+1/2,-Y,Z+1/2 -X,Y+1/2,-Z X+1/2,-Y+1/2,-Z+1/2 -X,-Y,-Z X+1/2,Y,-Z+1/2 X,-Y+1/2,Z -X+1/2,Y+1/2,Z+1/2".split(" "),"C 2/m 2/c 21/m":"X,Y,Z -X,-Y,1/2+Z -X,Y,1/2-Z X,-Y,-Z -X,-Y,-Z X,Y,1/2-Z X,-Y,1/2+Z -X,Y,Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z".split(" "),
"C 2/m 2/c 21/a":"X,Y,Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,-Y,-Z -X,-Y,-Z X,1/2+Y,1/2-Z X,1/2-Y,1/2+Z -X,Y,Z 1/2+X,1/2+Y,Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,1/2-Y,-Z 1/2-X,1/2-Y,-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z 1/2-X,1/2+Y,Z".split(" "),"C 2/m 2/m 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z".split(" "),"C 2/c 2/c 2/m":"X,Y,Z -X,-Y,Z -X,Y,1/2-Z X,-Y,1/2-Z -X,-Y,-Z X,Y,-Z X,-Y,1/2+Z -X,Y,1/2+Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),
"C 2/m 2/m 2/a":"X,Y,Z -X,1/2-Y,Z -X,1/2+Y,-Z X,-Y,-Z -X,-Y,-Z X,1/2+Y,-Z X,1/2-Y,Z -X,Y,Z 1/2+X,1/2+Y,Z 1/2-X,-Y,Z 1/2-X,Y,-Z 1/2+X,1/2-Y,-Z 1/2-X,1/2-Y,-Z 1/2+X,Y,-Z 1/2+X,-Y,Z 1/2-X,1/2+Y,Z".split(" "),"C 2/c 2/c 2/a":"X,Y,Z 1/2-X,1/2-Y,Z -X,Y,-Z 1/2+X,1/2-Y,-Z -X,1/2-Y,1/2-Z 1/2+X,Y,1/2-Z X,1/2-Y,1/2+Z 1/2-X,Y,1/2+Z 1/2+X,1/2+Y,Z -X,-Y,Z 1/2-X,1/2+Y,-Z X,-Y,-Z 1/2-X,-Y,1/2-Z X,1/2+Y,1/2-Z 1/2+X,-Y,1/2+Z -X,1/2+Y,1/2+Z".split(" "),"F 2/m 2/m 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z -X,1/2-Y,1/2-Z X,1/2+Y,1/2-Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2-X,-Y,1/2-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z 1/2-X,Y,1/2+Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z".split(" "),
"F 2/d 2/d 2/d":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z 1/4-X,1/4-Y,1/4-Z 1/4+X,1/4+Y,1/4-Z 1/4+X,1/4-Y,1/4+Z 1/4-X,1/4+Y,1/4+Z X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z 1/4-X,3/4-Y,3/4-Z 1/4+X,3/4+Y,3/4-Z 1/4+X,3/4-Y,3/4+Z 1/4-X,3/4+Y,3/4+Z 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 3/4-X,1/4-Y,3/4-Z 3/4+X,1/4+Y,3/4-Z 3/4+X,1/4-Y,3/4+Z 3/4-X,1/4+Y,3/4+Z 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 3/4-X,3/4-Y,1/4-Z 3/4+X,3/4+Y,1/4-Z 3/4+X,3/4-Y,1/4+Z 3/4-X,3/4+Y,1/4+Z".split(" "),
"I 2/m 2/m 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),"I 2/b 2/a 2/m":"X,Y,Z -X,-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z -X,-Y,-Z X,Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z -X,Y,1/2-Z X,-Y,1/2-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z X,-Y,1/2+Z -X,Y,1/2+Z".split(" "),"I 21/b 21/c 21/a":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z -X,-Y,-Z 1/2+X,Y,1/2-Z X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,Y,-Z X,-Y,1/2-Z 1/2-X,1/2-Y,1/2-Z X,1/2+Y,-Z 1/2+X,-Y,Z -X,Y,1/2+Z".split(" "),
"I 21/m 21/m 21/a":"X,Y,Z -X,1/2-Y,Z -X,1/2+Y,-Z X,-Y,-Z -X,-Y,-Z X,1/2+Y,-Z X,1/2-Y,Z -X,Y,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z".split(" "),"P 4":["X,Y,Z","-X,-Y,Z","-Y,X,Z","Y,-X,Z"],"P 41":["X,Y,Z","-X,-Y,1/2+Z","-Y,X,1/4+Z","Y,-X,3/4+Z"],"P 42":["X,Y,Z","-X,-Y,Z","-Y,X,1/2+Z","Y,-X,1/2+Z"],"P 43":["X,Y,Z","-X,-Y,1/2+Z","-Y,X,3/4+Z","Y,-X,1/4+Z"],"I 4":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z".split(" "),
"I 41":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z".split(" "),"P -4":["X,Y,Z","-X,-Y,Z","Y,-X,-Z","-Y,X,-Z"],"I -4":"X,Y,Z -X,-Y,Z Y,-X,-Z -Y,X,-Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z".split(" "),"P 4/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z".split(" "),"P 42/m":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z -X,-Y,-Z X,Y,-Z Y,-X,1/2-Z -Y,X,1/2-Z".split(" "),"P 4/n":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,Z 1/2+Y,1/2-X,Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z Y,-X,-Z -Y,X,-Z".split(" "),
"P 42/n":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z Y,-X,-Z -Y,X,-Z".split(" "),"I 4/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z".split(" "),"I 41/a":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z -X,1/2-Y,1/4-Z 1/2+X,Y,3/4-Z Y,-X,-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z 1/2-X,-Y,3/4-Z X,1/2+Y,1/4-Z 1/2+Y,1/2-X,1/2-Z -Y,X,-Z".split(" "),
"P 4 2 2":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,-Z X,-Y,-Z Y,X,-Z -Y,-X,-Z".split(" "),"P 4 21 2":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,Z 1/2+Y,1/2-X,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z Y,X,-Z -Y,-X,-Z".split(" "),"P 41 2 2":"X,Y,Z -X,-Y,1/2+Z -Y,X,1/4+Z Y,-X,3/4+Z -X,Y,-Z X,-Y,1/2-Z Y,X,3/4-Z -Y,-X,1/4-Z".split(" "),"P 41 21 2":"X,Y,Z -X,-Y,1/2+Z 1/2-Y,1/2+X,1/4+Z 1/2+Y,1/2-X,3/4+Z 1/2-X,1/2+Y,1/4-Z 1/2+X,1/2-Y,3/4-Z Y,X,-Z -Y,-X,1/2-Z".split(" "),"P 42 2 2":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z -X,Y,-Z X,-Y,-Z Y,X,1/2-Z -Y,-X,1/2-Z".split(" "),
"P 42 21 2":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z Y,X,-Z -Y,-X,-Z".split(" "),"P 43 2 2":"X,Y,Z -X,-Y,1/2+Z -Y,X,3/4+Z Y,-X,1/4+Z -X,Y,-Z X,-Y,1/2-Z Y,X,1/4-Z -Y,-X,3/4-Z".split(" "),"P 43 21 2":"X,Y,Z -X,-Y,1/2+Z 1/2-Y,1/2+X,3/4+Z 1/2+Y,1/2-X,1/4+Z 1/2-X,1/2+Y,3/4-Z 1/2+X,1/2-Y,1/4-Z Y,X,-Z -Y,-X,1/2-Z".split(" "),"I 4 2 2":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,-Z X,-Y,-Z Y,X,-Z -Y,-X,-Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z".split(" "),
"I 41 2 2":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z 1/2-X,Y,3/4-Z X,1/2-Y,1/4-Z 1/2+Y,1/2+X,1/2-Z -Y,-X,-Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z -X,1/2+Y,1/4-Z 1/2+X,-Y,3/4-Z Y,X,-Z 1/2-Y,1/2-X,1/2-Z".split(" "),"P 4 m m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z X,-Y,Z -X,Y,Z -Y,-X,Z Y,X,Z".split(" "),"P 4 b m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),"P 42 c m":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z X,-Y,1/2+Z -X,Y,1/2+Z -Y,-X,Z Y,X,Z".split(" "),
"P 42 n m":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z -Y,-X,Z Y,X,Z".split(" "),"P 4 c c":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z X,-Y,1/2+Z -X,Y,1/2+Z -Y,-X,1/2+Z Y,X,1/2+Z".split(" "),"P 4 n c":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"P 42 m c":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z X,-Y,Z -X,Y,Z -Y,-X,1/2+Z Y,X,1/2+Z".split(" "),"P 42 b c":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),
"I 4 m m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z X,-Y,Z -X,Y,Z -Y,-X,Z Y,X,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"I 4 c m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z X,-Y,1/2+Z -X,Y,1/2+Z -Y,-X,1/2+Z Y,X,1/2+Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),"I 41 m d":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z X,-Y,Z 1/2-X,1/2+Y,1/2+Z -Y,1/2-X,1/4+Z 1/2+Y,X,3/4+Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z 1/2+X,1/2-Y,1/2+Z -X,Y,Z 1/2-Y,-X,3/4+Z Y,1/2+X,1/4+Z".split(" "),
"I 41 c d":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z X,-Y,1/2+Z 1/2-X,1/2+Y,Z -Y,1/2-X,3/4+Z 1/2+Y,X,1/4+Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z 1/2+X,1/2-Y,Z -X,Y,1/2+Z 1/2-Y,-X,1/4+Z Y,1/2+X,3/4+Z".split(" "),"P -4 2 m":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z -X,Y,-Z X,-Y,-Z -Y,-X,Z Y,X,Z".split(" "),"P -4 2 c":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z -X,Y,1/2-Z X,-Y,1/2-Z -Y,-X,1/2+Z Y,X,1/2+Z".split(" "),"P -4 21 m":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),
"P -4 21 c":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"P -4 m 2":"X,Y,Z -X,-Y,Z Y,-X,-Z -Y,X,-Z X,-Y,Z -X,Y,Z Y,X,-Z -Y,-X,-Z".split(" "),"P -4 c 2":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z X,-Y,1/2+Z -X,Y,1/2+Z Y,X,1/2-Z -Y,-X,1/2-Z".split(" "),"P -4 b 2":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z".split(" "),"P -4 n 2":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z".split(" "),
"I -4 m 2":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z X,-Y,Z -X,Y,Z Y,X,-Z -Y,-X,-Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z".split(" "),"I -4 c 2":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z X,-Y,1/2+Z -X,Y,1/2+Z Y,X,1/2-Z -Y,-X,1/2-Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z".split(" "),"I -4 2 m":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z -X,Y,-Z X,-Y,-Z -Y,-X,Z Y,X,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),
"I -4 2 d":"X,Y,Z -X,-Y,Z -Y,X,-Z Y,-X,-Z 1/2-X,Y,3/4-Z 1/2+X,-Y,3/4-Z 1/2-Y,-X,3/4+Z 1/2+Y,X,3/4+Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z -X,1/2+Y,1/4-Z X,1/2-Y,1/4-Z -Y,1/2-X,1/4+Z Y,1/2+X,1/4+Z".split(" "),"P 4/m 2/m 2/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,-Z X,-Y,-Z Y,X,-Z -Y,-X,-Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z X,-Y,Z -X,Y,Z -Y,-X,Z Y,X,Z".split(" "),"P 4/m 2/c 2/c":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,1/2-Z X,-Y,1/2-Z Y,X,1/2-Z -Y,-X,1/2-Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z X,-Y,1/2+Z -X,Y,1/2+Z -Y,-X,1/2+Z Y,X,1/2+Z".split(" "),
"P 4/n 2/b 2/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,-Z X,-Y,-Z Y,X,-Z -Y,-X,-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+Y,1/2-X,-Z 1/2-Y,1/2+X,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),"P 4/n 2/n 2/c":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,-Z X,-Y,-Z Y,X,-Z -Y,-X,-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"P 4/m 21/b 2/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),
"P 4/m 21/n 2/c":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"P 4/n 21/m 2/m":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,Z 1/2+Y,1/2-X,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z Y,X,-Z -Y,-X,-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z Y,-X,-Z -Y,X,-Z X,-Y,Z -X,Y,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),"P 4/n 2/c 2/c":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,Z 1/2+Y,1/2-X,Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z Y,X,1/2-Z -Y,-X,1/2-Z 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z Y,-X,-Z -Y,X,-Z X,-Y,1/2+Z -X,Y,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),
"P 42/m 2/m 2/c":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z -X,Y,-Z X,-Y,-Z Y,X,1/2-Z -Y,-X,1/2-Z -X,-Y,-Z X,Y,-Z Y,-X,1/2-Z -Y,X,1/2-Z X,-Y,Z -X,Y,Z -Y,-X,1/2+Z Y,X,1/2+Z".split(" "),"P 42/m 2/c 2/m":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z -X,Y,1/2-Z X,-Y,1/2-Z Y,X,-Z -Y,-X,-Z -X,-Y,-Z X,Y,-Z Y,-X,1/2-Z -Y,X,1/2-Z X,-Y,1/2+Z -X,Y,1/2+Z -Y,-X,Z Y,X,Z".split(" "),"P 42/n 2/b 2/c":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z -X,Y,1/2-Z X,-Y,1/2-Z 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z Y,-X,-Z -Y,X,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z -Y,-X,1/2+Z Y,X,1/2+Z".split(" "),
"P 42/n 2/n 2/m":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z -X,Y,-Z X,-Y,-Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z Y,-X,-Z -Y,X,-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z -Y,-X,Z Y,X,Z".split(" "),"P 42/m 21/b 2/c":"X,Y,Z -X,-Y,Z -Y,X,1/2+Z Y,-X,1/2+Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z -X,-Y,-Z X,Y,-Z Y,-X,1/2-Z -Y,X,1/2-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"P 42/m 21/n 2/m":"X,Y,Z -X,-Y,Z 1/2-Y,X+1/2,Z+1/2 Y+1/2,1/2-X,Z+1/2 1/2-X,Y+1/2,1/2-Z X+1/2,1/2-Y,1/2-Z Y,X,-Z -Y,-X,-Z -X,-Y,-Z X,Y,-Z Y+1/2,1/2-X,1/2-Z 1/2-Y,X+1/2,1/2-Z X+1/2,1/2-Y,Z+1/2 1/2-X,Y+1/2,Z+1/2 -Y,-X,Z Y,X,Z".split(" "),
"P 42/n 21/m 2/c":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z Y,X,-Z -Y,-X,-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z Y,-X,-Z -Y,X,-Z X,-Y,Z -X,Y,Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),"P 42/n 21/c 2/m":"X,Y,Z -X,-Y,Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z Y,X,1/2-Z -Y,-X,1/2-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z Y,-X,-Z -Y,X,-Z X,-Y,1/2+Z -X,Y,1/2+Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),"I 4/m 2/m 2/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,-Z X,-Y,-Z Y,X,-Z -Y,-X,-Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z X,-Y,Z -X,Y,Z -Y,-X,Z Y,X,Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z".split(" "),
"I 4/m 2/c 2/m":"X,Y,Z -X,-Y,Z -Y,X,Z Y,-X,Z -X,Y,1/2-Z X,-Y,1/2-Z Y,X,1/2-Z -Y,-X,1/2-Z -X,-Y,-Z X,Y,-Z Y,-X,-Z -Y,X,-Z X,-Y,1/2+Z -X,Y,1/2+Z -Y,-X,1/2+Z Y,X,1/2+Z 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+Y,1/2-X,1/2+Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z".split(" "),"I 41/a 2/m 2/d":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z 1/2-X,Y,3/4-Z X,1/2-Y,1/4-Z 1/2+Y,1/2+X,1/2-Z -Y,-X,-Z -X,1/2-Y,1/4-Z 1/2+X,Y,3/4-Z Y,-X,-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2-Y,1/2+Z -X,Y,Z 1/2-Y,-X,3/4+Z Y,1/2+X,1/4+Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z -X,1/2+Y,1/4-Z 1/2+X,-Y,3/4-Z Y,X,-Z 1/2-Y,1/2-X,1/2-Z 1/2-X,-Y,3/4-Z X,1/2+Y,1/4-Z 1/2+Y,1/2-X,1/2-Z -Y,X,-Z X,-Y,Z 1/2-X,1/2+Y,1/2+Z -Y,1/2-X,1/4+Z 1/2+Y,X,3/4+Z".split(" "),
"I 41/a 2/c 2/d":"X,Y,Z 1/2-X,1/2-Y,1/2+Z -Y,1/2+X,1/4+Z 1/2+Y,-X,3/4+Z 1/2-X,Y,1/4-Z X,1/2-Y,3/4-Z 1/2+Y,1/2+X,-Z -Y,-X,1/2-Z -X,1/2-Y,1/4-Z 1/2+X,Y,3/4-Z Y,-X,-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2-Y,Z -X,Y,1/2+Z 1/2-Y,-X,1/4+Z Y,1/2+X,3/4+Z 1/2+X,1/2+Y,1/2+Z -X,-Y,Z 1/2-Y,X,3/4+Z Y,1/2-X,1/4+Z -X,1/2+Y,3/4-Z 1/2+X,-Y,1/4-Z Y,X,1/2-Z 1/2-Y,1/2-X,-Z 1/2-X,-Y,3/4-Z X,1/2+Y,1/4-Z 1/2+Y,1/2-X,1/2-Z -Y,X,-Z X,-Y,1/2+Z 1/2-X,1/2+Y,Z -Y,1/2-X,3/4+Z 1/2+Y,X,1/4+Z".split(" "),"P 3":["X,Y,Z","-Y,X-Y,Z","Y-X,-X,Z"],
"P 31":["X,Y,Z","-Y,X-Y,Z+1/3","Y-X,-X,Z+2/3"],"P 32":["X,Y,Z","-Y,X-Y,Z+2/3","Y-X,-X,Z+1/3"],"H 3":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z X+2/3,Y+1/3,Z+1/3 -Y+2/3,X-Y+1/3,Z+1/3 Y-X+2/3,-X+1/3,Z+1/3 X+1/3,Y+2/3,Z+2/3 -Y+1/3,X-Y+2/3,Z+2/3 Y-X+1/3,-X+2/3,Z+2/3".split(" "),"R 3":["X,Y,Z","Z,X,Y","Y,Z,X"],"P -3":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z".split(" "),"H -3":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z 2/3+X,1/3+Y,1/3+Z 2/3-Y,1/3+X-Y,1/3+Z 2/3+Y-X,1/3-X,1/3+Z 2/3-X,1/3-Y,1/3-Z 2/3+Y,1/3+Y-X,1/3-Z 2/3+X-Y,1/3+X,1/3-Z 1/3+X,2/3+Y,2/3+Z 1/3-Y,2/3+X-Y,2/3+Z 1/3+Y-X,2/3-X,2/3+Z 1/3-X,2/3-Y,2/3-Z 1/3+Y,2/3+Y-X,2/3-Z 1/3+X-Y,2/3+X,2/3-Z".split(" "),
"R -3":"X,Y,Z Z,X,Y Y,Z,X -X,-Y,-Z -Z,-X,-Y -Y,-Z,-X".split(" "),"P 3 1 2":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z".split(" "),"P 3 2 1":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z".split(" "),"P 31 1 2":"X,Y,Z -Y,X-Y,1/3+Z Y-X,-X,2/3+Z -Y,-X,2/3-Z Y-X,Y,1/3-Z X,X-Y,-Z".split(" "),"P 31 2 1":"X,Y,Z -Y,X-Y,Z+1/3 Y-X,-X,Z+2/3 Y,X,-Z X-Y,-Y,2/3-Z -X,Y-X,1/3-Z".split(" "),"P 32 1 2":"X,Y,Z -Y,X-Y,2/3+Z Y-X,-X,1/3+Z -Y,-X,1/3-Z Y-X,Y,2/3-Z X,X-Y,-Z".split(" "),"P 32 2 1":"X,Y,Z -Y,X-Y,Z+2/3 Y-X,-X,Z+1/3 Y,X,-Z X-Y,-Y,1/3-Z -X,Y-X,2/3-Z".split(" "),
"H 3 2":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z 2/3+X,1/3+Y,1/3+Z 2/3-Y,1/3+X-Y,1/3+Z 2/3+Y-X,1/3-X,1/3+Z 2/3+Y,1/3+X,1/3-Z 2/3+X-Y,1/3-Y,1/3-Z 2/3-X,1/3+Y-X,1/3-Z 1/3+X,2/3+Y,2/3+Z 1/3-Y,2/3+X-Y,2/3+Z 1/3+Y-X,2/3-X,2/3+Z 1/3+Y,2/3+X,2/3-Z 1/3+X-Y,2/3-Y,2/3-Z 1/3-X,2/3+Y-X,2/3-Z".split(" "),"R 3 2":"X,Y,Z Z,X,Y Y,Z,X -Y,-X,-Z -X,-Z,-Y -Z,-Y,-X".split(" "),"P 3 m 1":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z".split(" "),"P 3 1 m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),
"P 3 c 1":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z".split(" "),"P 3 1 c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),"H 3 m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z 2/3+X,1/3+Y,1/3+Z 2/3-Y,1/3+X-Y,1/3+Z 2/3+Y-X,1/3-X,1/3+Z 2/3-Y,1/3-X,1/3+Z 2/3+Y-X,1/3+Y,1/3+Z 2/3+X,1/3+X-Y,1/3+Z 1/3+X,2/3+Y,2/3+Z 1/3-Y,2/3+X-Y,2/3+Z 1/3+Y-X,2/3-X,2/3+Z 1/3-Y,2/3-X,2/3+Z 1/3+Y-X,2/3+Y,2/3+Z 1/3+X,2/3+X-Y,2/3+Z".split(" "),"R 3 m":"X,Y,Z Z,X,Y Y,Z,X Y,X,Z X,Z,Y Z,Y,X".split(" "),
"H 3 c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z 2/3+X,1/3+Y,1/3+Z 2/3-Y,1/3+X-Y,1/3+Z 2/3+Y-X,1/3-X,1/3+Z 2/3-Y,1/3-X,5/6+Z 2/3+Y-X,1/3+Y,5/6+Z 2/3+X,1/3+X-Y,5/6+Z 1/3+X,2/3+Y,2/3+Z 1/3-Y,2/3+X-Y,2/3+Z 1/3+Y-X,2/3-X,2/3+Z 1/3-Y,2/3-X,1/6+Z 1/3+Y-X,2/3+Y,1/6+Z 1/3+X,2/3+X-Y,1/6+Z".split(" "),"R 3 c":"X,Y,Z Z,X,Y Y,Z,X Y+1/2,X+1/2,Z+1/2 X+1/2,Z+1/2,Y+1/2 Z+1/2,Y+1/2,X+1/2".split(" "),"P -3 1 2/m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),
"P -3 1 2/c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -Y,-X,1/2-Z Y-X,Y,1/2-Z X,X-Y,1/2-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),"P -3 2/m 1":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z".split(" "),"P -3 2/c 1":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,1/2-Z X-Y,-Y,1/2-Z -X,Y-X,1/2-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z".split(" "),"H -3 2/m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z 2/3+X,1/3+Y,1/3+Z 2/3-Y,1/3+X-Y,1/3+Z 2/3+Y-X,1/3-X,1/3+Z 2/3+Y,1/3+X,1/3-Z 2/3+X-Y,1/3-Y,1/3-Z 2/3-X,1/3+Y-X,1/3-Z 2/3-X,1/3-Y,1/3-Z 2/3+Y,1/3+Y-X,1/3-Z 2/3+X-Y,1/3+X,1/3-Z 2/3-Y,1/3-X,1/3+Z 2/3+Y-X,1/3+Y,1/3+Z 2/3+X,1/3+X-Y,1/3+Z 1/3+X,2/3+Y,2/3+Z 1/3-Y,2/3+X-Y,2/3+Z 1/3+Y-X,2/3-X,2/3+Z 1/3+Y,2/3+X,2/3-Z 1/3+X-Y,2/3-Y,2/3-Z 1/3-X,2/3+Y-X,2/3-Z 1/3-X,2/3-Y,2/3-Z 1/3+Y,2/3+Y-X,2/3-Z 1/3+X-Y,2/3+X,2/3-Z 1/3-Y,2/3-X,2/3+Z 1/3+Y-X,2/3+Y,2/3+Z 1/3+X,2/3+X-Y,2/3+Z".split(" "),
"R -3 2/m":"X,Y,Z Z,X,Y Y,Z,X -Y,-X,-Z -X,-Z,-Y -Z,-Y,-X -X,-Y,-Z -Z,-X,-Y -Y,-Z,-X Y,X,Z X,Z,Y Z,Y,X".split(" "),"H -3 2/c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z Y,X,1/2-Z X-Y,-Y,1/2-Z -X,Y-X,1/2-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z 2/3+X,1/3+Y,1/3+Z 2/3-Y,1/3+X-Y,1/3+Z 2/3+Y-X,1/3-X,1/3+Z 2/3+Y,1/3+X,5/6-Z 2/3+X-Y,1/3-Y,5/6-Z 2/3-X,1/3+Y-X,5/6-Z 2/3-X,1/3-Y,1/3-Z 2/3+Y,1/3+Y-X,1/3-Z 2/3+X-Y,1/3+X,1/3-Z 2/3-Y,1/3-X,5/6+Z 2/3+Y-X,1/3+Y,5/6+Z 2/3+X,1/3+X-Y,5/6+Z 1/3+X,2/3+Y,2/3+Z 1/3-Y,2/3+X-Y,2/3+Z 1/3+Y-X,2/3-X,2/3+Z 1/3+Y,2/3+X,1/6-Z 1/3+X-Y,2/3-Y,1/6-Z 1/3-X,2/3+Y-X,1/6-Z 1/3-X,2/3-Y,2/3-Z 1/3+Y,2/3+Y-X,2/3-Z 1/3+X-Y,2/3+X,2/3-Z 1/3-Y,2/3-X,1/6+Z 1/3+Y-X,2/3+Y,1/6+Z 1/3+X,2/3+X-Y,1/6+Z".split(" "),
"R -3 2/c":"X,Y,Z Z,X,Y Y,Z,X -Y+1/2,-X+1/2,-Z+1/2 -X+1/2,-Z+1/2,-Y+1/2 -Z+1/2,-Y+1/2,-X+1/2 -X,-Y,-Z -Z,-X,-Y -Y,-Z,-X Y+1/2,X+1/2,Z+1/2 X+1/2,Z+1/2,Y+1/2 Z+1/2,Y+1/2,X+1/2".split(" "),"P 6":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z".split(" "),"P 61":"X,Y,Z -Y,X-Y,Z+1/3 Y-X,-X,Z+2/3 -X,-Y,Z+1/2 Y,Y-X,Z+5/6 X-Y,X,Z+1/6".split(" "),"P 65":"X,Y,Z -Y,X-Y,Z+2/3 Y-X,-X,Z+1/3 -X,-Y,Z+1/2 Y,Y-X,Z+1/6 X-Y,X,Z+5/6".split(" "),"P 62":"X,Y,Z -Y,X-Y,2/3+Z Y-X,-X,1/3+Z -X,-Y,Z Y,Y-X,2/3+Z X-Y,X,1/3+Z".split(" "),
"P 64":"X,Y,Z -Y,X-Y,1/3+Z Y-X,-X,2/3+Z -X,-Y,Z Y,Y-X,1/3+Z X-Y,X,2/3+Z".split(" "),"P 63":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z".split(" "),"P -6":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z X,Y,-Z -Y,X-Y,-Z Y-X,-X,-Z".split(" "),"P 6/m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z X,Y,-Z -Y,X-Y,-Z Y-X,-X,-Z".split(" "),"P 63/m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z X,Y,1/2-Z -Y,X-Y,1/2-Z Y-X,-X,1/2-Z".split(" "),
"P 6 2 2":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z".split(" "),"P 61 2 2":"X,Y,Z -Y,X-Y,1/3+Z Y-X,-X,2/3+Z -X,-Y,1/2+Z Y,Y-X,5/6+Z X-Y,X,1/6+Z Y,X,1/3-Z X-Y,-Y,-Z -X,Y-X,2/3-Z -Y,-X,5/6-Z Y-X,Y,1/2-Z X,X-Y,1/6-Z".split(" "),"P 65 2 2":"X,Y,Z -Y,X-Y,2/3+Z Y-X,-X,1/3+Z -X,-Y,1/2+Z Y,Y-X,1/6+Z X-Y,X,5/6+Z Y,X,2/3-Z X-Y,-Y,-Z -X,Y-X,1/3-Z -Y,-X,1/6-Z Y-X,Y,1/2-Z X,X-Y,5/6-Z".split(" "),"P 62 2 2":"X,Y,Z -Y,X-Y,2/3+Z Y-X,-X,1/3+Z -X,-Y,Z Y,Y-X,2/3+Z X-Y,X,1/3+Z Y,X,2/3-Z X-Y,-Y,-Z -X,Y-X,1/3-Z -Y,-X,2/3-Z Y-X,Y,-Z X,X-Y,1/3-Z".split(" "),
"P 64 2 2":"X,Y,Z -Y,X-Y,1/3+Z Y-X,-X,2/3+Z -X,-Y,Z Y,Y-X,1/3+Z X-Y,X,2/3+Z Y,X,1/3-Z X-Y,-Y,-Z -X,Y-X,2/3-Z -Y,-X,1/3-Z Y-X,Y,-Z X,X-Y,2/3-Z".split(" "),"P 63 2 2":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z -Y,-X,1/2-Z Y-X,Y,1/2-Z X,X-Y,1/2-Z".split(" "),"P 6 m m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),"P 6 c c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),
"P 63 c m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),"P 63 m c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),"P -6 m 2":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z X,Y,-Z -Y,X-Y,-Z Y-X,-X,-Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z".split(" "),"P -6 c 2":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z X,Y,1/2-Z -Y,X-Y,1/2-Z Y-X,-X,1/2-Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z".split(" "),
"P -6 2 m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z X,Y,-Z -Y,X-Y,-Z Y-X,-X,-Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),"P -6 2 c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z X,Y,1/2-Z -Y,X-Y,1/2-Z Y-X,-X,1/2-Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),"P 6/m 2/m 2/m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z X,Y,-Z Y-X,-X,-Z -Y,X-Y,-Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),
"P 6/m 2/c 2/c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,Z Y,Y-X,Z X-Y,X,Z Y,X,1/2-Z X-Y,-Y,1/2-Z -X,Y-X,1/2-Z -Y,-X,1/2-Z Y-X,Y,1/2-Z X,X-Y,1/2-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z X,Y,-Z Y-X,-X,-Z -Y,X-Y,-Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),"P 63/m 2/c 2/m":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z Y,X,1/2-Z X-Y,-Y,1/2-Z -X,Y-X,1/2-Z -Y,-X,-Z Y-X,Y,-Z X,X-Y,-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z X,Y,1/2-Z Y-X,-X,1/2-Z -Y,X-Y,1/2-Z -Y,-X,1/2+Z Y-X,Y,1/2+Z X,X-Y,1/2+Z Y,X,Z X-Y,-Y,Z -X,Y-X,Z".split(" "),
"P 63/m 2/m 2/c":"X,Y,Z -Y,X-Y,Z Y-X,-X,Z -X,-Y,1/2+Z Y,Y-X,1/2+Z X-Y,X,1/2+Z Y,X,-Z X-Y,-Y,-Z -X,Y-X,-Z -Y,-X,1/2-Z Y-X,Y,1/2-Z X,X-Y,1/2-Z -X,-Y,-Z Y,Y-X,-Z X-Y,X,-Z X,Y,1/2-Z Y-X,-X,1/2-Z -Y,X-Y,1/2-Z -Y,-X,Z Y-X,Y,Z X,X-Y,Z Y,X,1/2+Z X-Y,-Y,1/2+Z -X,Y-X,1/2+Z".split(" "),"P 2 3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X".split(" "),"F 2 3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X".split(" "),
"I 2 3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y 1/2+Z,1/2-X,1/2-Y 1/2-Z,1/2-X,1/2+Y 1/2-Z,1/2+X,1/2-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,1/2-X 1/2-Y,1/2-Z,1/2+X".split(" "),"P 21 3":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X".split(" "),
"I 21 3":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,Y,-Z X,-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y Z,-X,1/2-Y -Z,1/2-X,Y 1/2-Z,X,-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,Z,-X Y,-Z,1/2-X -Y,1/2-Z,X".split(" "),"P 2/m -3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X".split(" "),
"P 2/n -3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Z,1/2-X,1/2-Y 1/2-Z,1/2+X,1/2+Y 1/2+Z,1/2+X,1/2-Y 1/2+Z,1/2-X,1/2+Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,1/2+X 1/2+Y,1/2+Z,1/2-X".split(" "),"F 2/m -3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X -X,1/2-Y,1/2-Z X,1/2+Y,1/2-Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z -Z,1/2-X,1/2-Y -Z,1/2+X,1/2+Y Z,1/2+X,1/2-Y Z,1/2-X,1/2+Y -Y,1/2-Z,1/2-X Y,1/2-Z,1/2+X -Y,1/2+Z,1/2+X Y,1/2+Z,1/2-X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X 1/2-X,-Y,1/2-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z 1/2-X,Y,1/2+Z 1/2-Z,-X,1/2-Y 1/2-Z,X,1/2+Y 1/2+Z,X,1/2-Y 1/2+Z,-X,1/2+Y 1/2-Y,-Z,1/2-X 1/2+Y,-Z,1/2+X 1/2-Y,Z,1/2+X 1/2+Y,Z,1/2-X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Z,1/2-X,-Y 1/2-Z,1/2+X,Y 1/2+Z,1/2+X,-Y 1/2+Z,1/2-X,Y 1/2-Y,1/2-Z,-X 1/2+Y,1/2-Z,X 1/2-Y,1/2+Z,X 1/2+Y,1/2+Z,-X".split(" "),
"F 2/d -3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/4-X,1/4-Y,1/4-Z 1/4+X,1/4+Y,1/4-Z 1/4+X,1/4-Y,1/4+Z 1/4-X,1/4+Y,1/4+Z 1/4-Z,1/4-X,1/4-Y 1/4-Z,1/4+X,1/4+Y 1/4+Z,1/4+X,1/4-Y 1/4+Z,1/4-X,1/4+Y 1/4-Y,1/4-Z,1/4-X 1/4+Y,1/4-Z,1/4+X 1/4-Y,1/4+Z,1/4+X 1/4+Y,1/4+Z,1/4-X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X 1/4-X,3/4-Y,3/4-Z 1/4+X,3/4+Y,3/4-Z 1/4+X,3/4-Y,3/4+Z 1/4-X,3/4+Y,3/4+Z 1/4-Z,3/4-X,3/4-Y 1/4-Z,3/4+X,3/4+Y 1/4+Z,3/4+X,3/4-Y 1/4+Z,3/4-X,3/4+Y 1/4-Y,3/4-Z,3/4-X 1/4+Y,3/4-Z,3/4+X 1/4-Y,3/4+Z,3/4+X 1/4+Y,3/4+Z,3/4-X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X 3/4-X,1/4-Y,3/4-Z 3/4+X,1/4+Y,3/4-Z 3/4+X,1/4-Y,3/4+Z 3/4-X,1/4+Y,3/4+Z 3/4-Z,1/4-X,3/4-Y 3/4-Z,1/4+X,3/4+Y 3/4+Z,1/4+X,3/4-Y 3/4+Z,1/4-X,3/4+Y 3/4-Y,1/4-Z,3/4-X 3/4+Y,1/4-Z,3/4+X 3/4-Y,1/4+Z,3/4+X 3/4+Y,1/4+Z,3/4-X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X 3/4-X,3/4-Y,1/4-Z 3/4+X,3/4+Y,1/4-Z 3/4+X,3/4-Y,Z+1/4 3/4-X,3/4+Y,Z+1/4 3/4-Z,3/4-X,1/4-Y 3/4-Z,3/4+X,1/4+Y 3/4+Z,3/4+X,1/4-Y 3/4+Z,3/4-X,1/4+Y 3/4-Y,3/4-Z,1/4-X 3/4+Y,3/4-Z,1/4+X 3/4-Y,3/4+Z,1/4+X 3/4+Y,3/4+Z,1/4-X".split(" "),
"I 2/m -3":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y 1/2+Z,1/2-X,1/2-Y 1/2-Z,1/2-X,1/2+Y 1/2-Z,1/2+X,1/2-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,1/2-X 1/2-Y,1/2-Z,1/2+X 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Z,1/2-X,1/2-Y 1/2-Z,1/2+X,1/2+Y 1/2+Z,1/2+X,1/2-Y 1/2+Z,1/2-X,1/2+Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,1/2+X 1/2+Y,1/2+Z,1/2-X".split(" "),
"P 21/a -3":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X -X,-Y,-Z 1/2+X,Y,1/2-Z X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z -Z,-X,-Y 1/2-Z,1/2+X,Y 1/2+Z,X,1/2-Y Z,1/2-X,1/2+Y -Y,-Z,-X Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,X 1/2+Y,Z,1/2-X".split(" "),"I 21/a -3":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X -X,-Y,-Z 1/2+X,Y,1/2-Z X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z -Z,-X,-Y 1/2-Z,1/2+X,Y 1/2+Z,X,1/2-Y Z,1/2-X,1/2+Y -Y,-Z,-X Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,X 1/2+Y,Z,1/2-X 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,+Y,-Z X,-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y Z,-X,1/2-Y -Z,1/2-X,Y 1/2-Z,X,-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,Z,-X Y,-Z,1/2-X -Y,1/2-Z,X 1/2-X,1/2-Y,1/2-Z X,1/2+Y,-Z 1/2+X,-Y,Z -X,Y,1/2+Z 1/2-Z,1/2-X,1/2-Y -Z,X,1/2+Y Z,1/2+X,-Y 1/2+Z,-X,Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,-Z,X -Y,Z,1/2+X Y,1/2+Z,-X".split(" "),
"P 4 3 2":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X".split(" "),"P 42 3 2":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2+Y,1/2-X,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+X,1/2+Z,1/2-Y 1/2-X,1/2+Z,1/2+Y 1/2-X,1/2-Z,1/2-Y 1/2+X,1/2-Z,1/2+Y 1/2+Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2+X 1/2-Z,1/2-Y,1/2-X".split(" "),
"F 4 3 2":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X Y,1/2+X,1/2-Z -Y,1/2-X,1/2-Z Y,1/2-X,1/2+Z -Y,1/2+X,1/2+Z X,1/2+Z,1/2-Y -X,1/2+Z,1/2+Y -X,1/2-Z,1/2-Y X,1/2-Z,1/2+Y Z,1/2+Y,1/2-X Z,1/2-Y,1/2+X -Z,1/2+Y,1/2+X -Z,1/2-Y,1/2-X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X 1/2+Y,X,1/2-Z 1/2-Y,-X,1/2-Z 1/2+Y,-X,1/2+Z 1/2-Y,X,1/2+Z 1/2+X,Z,1/2-Y 1/2-X,Z,1/2+Y 1/2-X,-Z,1/2-Y 1/2+X,-Z,1/2+Y 1/2+Z,Y,1/2-X 1/2+Z,-Y,1/2+X 1/2-Z,Y,1/2+X 1/2-Z,-Y,1/2-X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z 1/2+Y,1/2-X,Z 1/2-Y,1/2+X,Z 1/2+X,1/2+Z,-Y 1/2-X,1/2+Z,Y 1/2-X,1/2-Z,-Y 1/2+X,1/2-Z,Y 1/2+Z,1/2+Y,-X 1/2+Z,1/2-Y,X 1/2-Z,1/2+Y,X 1/2-Z,1/2-Y,-X".split(" "),
"F 41 3 2":"X,Y,Z -X,1/2-Y,1/2+Z 1/2-X,1/2+Y,-Z 1/2+X,-Y,1/2-Z Z,X,Y 1/2+Z,-X,1/2-Y -Z,1/2-X,1/2+Y 1/2-Z,1/2+X,-Y Y,Z,X 1/2-Y,1/2+Z,-X 1/2+Y,-Z,1/2-X -Y,1/2-Z,1/2+X 3/4+Y,1/4+X,3/4-Z 1/4-Y,1/4-X,1/4-Z 1/4+Y,3/4-X,3/4+Z 3/4-Y,3/4+X,1/4+Z 3/4+X,1/4+Z,3/4-Y 3/4-X,3/4+Z,1/4+Y 1/4-X,1/4-Z,1/4-Y 1/4+X,3/4-Z,3/4+Y 3/4+Z,1/4+Y,3/4-X 1/4+Z,3/4-Y,3/4+X 3/4-Z,3/4+Y,1/4+X 1/4-Z,1/4-Y,1/4-X X,1/2+Y,1/2+Z -X,-Y,Z 1/2-X,Y,1/2-Z 1/2+X,1/2-Y,-Z Z,1/2+X,1/2+Y 1/2+Z,1/2-X,-Y -Z,-X,Y 1/2-Z,X,1/2-Y Y,1/2+Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,1/2-Z,-X -Y,-Z,X 3/4+Y,3/4+X,1/4-Z 1/4-Y,3/4-X,3/4-Z 1/4+Y,1/4-X,1/4+Z 3/4-Y,1/4+X,3/4+Z 3/4+X,3/4+Z,1/4-Y 3/4-X,1/4+Z,3/4+Y 1/4-X,3/4-Z,3/4-Y 1/4+X,1/4-Z,1/4+Y 3/4+Z,3/4+Y,1/4-X 1/4+Z,1/4-Y,1/4+X 3/4-Z,1/4+Y,3/4+X 1/4-Z,3/4-Y,3/4-X 1/2+X,Y,1/2+Z 1/2-X,1/2-Y,Z -X,1/2+Y,1/2-Z X,-Y,-Z 1/2+Z,X,1/2+Y Z,-X,-Y 1/2-Z,1/2-X,Y -Z,1/2+X,1/2-Y 1/2+Y,Z,1/2+X -Y,1/2+Z,1/2-X Y,-Z,-X 1/2-Y,1/2-Z,X 1/4+Y,1/4+X,1/4-Z 3/4-Y,1/4-X,3/4-Z 3/4+Y,3/4-X,1/4+Z 1/4-Y,3/4+X,3/4+Z 1/4+X,1/4+Z,1/4-Y 1/4-X,3/4+Z,3/4+Y 3/4-X,1/4-Z,3/4-Y 3/4+X,3/4-Z,1/4+Y 1/4+Z,1/4+Y,1/4-X 3/4+Z,3/4-Y,1/4+X 1/4-Z,3/4+Y,3/4+X 3/4-Z,1/4-Y,3/4-X 1/2+X,1/2+Y,Z 1/2-X,-Y,1/2+Z -X,Y,-Z X,1/2-Y,1/2-Z 1/2+Z,1/2+X,Y Z,1/2-X,1/2-Y 1/2-Z,-X,1/2+Y -Z,X,-Y 1/2+Y,1/2+Z,X -Y,Z,-X Y,1/2-Z,1/2-X 1/2-Y,-Z,1/2+X 1/4+Y,3/4+X,3/4-Z 3/4-Y,3/4-X,1/4-Z 3/4+Y,1/4-X,3/4+Z 1/4-Y,1/4+X,1/4+Z 1/4+X,3/4+Z,3/4-Y 1/4-X,1/4+Z,1/4+Y 3/4-X,3/4-Z,1/4-Y 3/4+X,1/4-Z,3/4+Y 1/4+Z,3/4+Y,3/4-X 3/4+Z,1/4-Y,3/4+X 1/4-Z,1/4+Y,1/4+X 3/4-Z,3/4-Y,1/4-X".split(" "),
"I 4 3 2":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y 1/2+Z,1/2-X,1/2-Y 1/2-Z,1/2-X,1/2+Y 1/2-Z,1/2+X,1/2-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,1/2-X 1/2-Y,1/2-Z,1/2+X 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2+Y,1/2-X,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+X,1/2+Z,1/2-Y 1/2-X,1/2+Z,1/2+Y 1/2-X,1/2-Z,1/2-Y 1/2+X,1/2-Z,1/2+Y 1/2+Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2+X 1/2-Z,1/2-Y,1/2-X".split(" "),
"P 43 3 2":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X 1/4+Y,3/4+X,3/4-Z 1/4-Y,1/4-X,1/4-Z 3/4+Y,3/4-X,1/4+Z 3/4-Y,1/4+X,3/4+Z 1/4+X,3/4+Z,3/4-Y 3/4-X,1/4+Z,3/4+Y 1/4-X,1/4-Z,1/4-Y 3/4+X,3/4-Z,1/4+Y 1/4+Z,3/4+Y,3/4-X 3/4+Z,3/4-Y,1/4+X 3/4-Z,1/4+Y,3/4+X 1/4-Z,1/4-Y,1/4-X".split(" "),"P 41 3 2":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X 3/4+Y,1/4+X,1/4-Z 3/4-Y,3/4-X,3/4-Z 1/4+Y,1/4-X,3/4+Z 1/4-Y,3/4+X,1/4+Z 3/4+X,1/4+Z,1/4-Y 1/4-X,3/4+Z,1/4+Y 3/4-X,3/4-Z,3/4-Y 1/4+X,1/4-Z,3/4+Y 3/4+Z,1/4+Y,1/4-X 1/4+Z,1/4-Y,3/4+X 1/4-Z,3/4+Y,1/4+X 3/4-Z,3/4-Y,3/4-X".split(" "),
"I 41 3 2":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X 3/4+Y,1/4+X,1/4-Z 3/4-Y,3/4-X,3/4-Z 1/4+Y,1/4-X,3/4+Z 1/4-Y,3/4+X,1/4+Z 3/4+X,1/4+Z,1/4-Y 1/4-X,3/4+Z,1/4+Y 3/4-X,3/4-Z,3/4-Y 1/4+X,1/4-Z,3/4+Y 3/4+Z,1/4+Y,1/4-X 1/4+Z,1/4-Y,3/4+X 1/4-Z,3/4+Y,1/4+X 3/4-Z,3/4-Y,3/4-X 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,Y,-Z X,-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y Z,-X,1/2-Y -Z,1/2-X,Y 1/2-Z,X,-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,Z,-X Y,-Z,1/2-X -Y,1/2-Z,X 1/4+Y,3/4+X,3/4-Z 1/4-Y,1/4-X,1/4-Z 3/4+Y,3/4-X,1/4+Z 3/4-Y,1/4+X,3/4+Z 1/4+X,3/4+Z,3/4-Y 3/4-X,1/4+Z,3/4+Y 1/4-X,1/4-Z,1/4-Y 3/4+X,3/4-Z,1/4+Y 1/4+Z,3/4+Y,3/4-X 3/4+Z,3/4-Y,1/4+X 3/4-Z,1/4+Y,3/4+X 1/4-Z,1/4-Y,1/4-X".split(" "),
"P -4 3 m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,Z -Y,-X,Z Y,-X,-Z -Y,X,-Z X,Z,Y -X,Z,-Y -X,-Z,Y X,-Z,-Y Z,Y,X Z,-Y,-X -Z,Y,-X -Z,-Y,X".split(" "),"F -4 3 m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,Z -Y,-X,Z Y,-X,-Z -Y,X,-Z X,Z,Y -X,Z,-Y -X,-Z,Y X,-Z,-Y Z,Y,X Z,-Y,-X -Z,Y,-X -Z,-Y,X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X Y,1/2+X,1/2+Z -Y,1/2-X,1/2+Z Y,1/2-X,1/2-Z -Y,1/2+X,1/2-Z X,1/2+Z,1/2+Y -X,1/2+Z,1/2-Y -X,1/2-Z,1/2+Y X,1/2-Z,1/2-Y Z,1/2+Y,1/2+X Z,1/2-Y,1/2-X -Z,1/2+Y,1/2-X -Z,1/2-Y,1/2+X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X 1/2+Y,X,1/2+Z 1/2-Y,-X,1/2+Z 1/2+Y,-X,1/2-Z 1/2-Y,X,1/2-Z 1/2+X,Z,1/2+Y 1/2-X,Z,1/2-Y 1/2-X,-Z,1/2+Y 1/2+X,-Z,1/2-Y 1/2+Z,Y,1/2+X 1/2+Z,-Y,1/2-X 1/2-Z,Y,1/2-X 1/2-Z,-Y,1/2+X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X 1/2+Y,1/2+X,Z 1/2-Y,1/2-X,Z 1/2+Y,1/2-X,-Z 1/2-Y,1/2+X,-Z 1/2+X,1/2+Z,Y 1/2-X,1/2+Z,-Y 1/2-X,1/2-Z,Y 1/2+X,1/2-Z,-Y 1/2+Z,1/2+Y,X 1/2+Z,1/2-Y,-X 1/2-Z,1/2+Y,-X 1/2-Z,1/2-Y,X".split(" "),
"I -4 3 m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,Z -Y,-X,Z Y,-X,-Z -Y,X,-Z X,Z,Y -X,Z,-Y -X,-Z,Y X,-Z,-Y Z,Y,X Z,-Y,-X -Z,Y,-X -Z,-Y,X 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y 1/2+Z,1/2-X,1/2-Y 1/2-Z,1/2-X,1/2+Y 1/2-Z,1/2+X,1/2-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,1/2-X 1/2-Y,1/2-Z,1/2+X 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+Z,1/2+Y,1/2+X 1/2+Z,1/2-Y,1/2-X 1/2-Z,1/2+Y,1/2-X 1/2-Z,1/2-Y,1/2+X".split(" "),
"P -4 3 n":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+Z,1/2+Y,1/2+X 1/2+Z,1/2-Y,1/2-X 1/2-Z,1/2+Y,1/2-X 1/2-Z,1/2-Y,1/2+X".split(" "),"F -4 3 c":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2-X,1/2-Z 1/2-Y,1/2+X,1/2-Z 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+Z,1/2+Y,1/2+X 1/2+Z,1/2-Y,1/2-X 1/2-Z,1/2+Y,1/2-X 1/2-Z,1/2-Y,1/2+X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X 1/2+Y,X,Z 1/2-Y,-X,Z 1/2+Y,-X,-Z 1/2-Y,X,-Z 1/2+X,Z,Y 1/2-X,Z,-Y 1/2-X,-Z,Y 1/2+X,-Z,-Y 1/2+Z,Y,X 1/2+Z,-Y,-X 1/2-Z,Y,-X 1/2-Z,-Y,X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X Y,1/2+X,Z -Y,1/2-X,Z Y,1/2-X,-Z -Y,1/2+X,-Z X,1/2+Z,Y -X,1/2+Z,-Y -X,1/2-Z,Y X,1/2-Z,-Y Z,1/2+Y,X Z,1/2-Y,-X -Z,1/2+Y,-X -Z,1/2-Y,X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X Y,X,1/2+Z -Y,-X,1/2+Z Y,-X,1/2-Z -Y,X,1/2-Z X,Z,1/2+Y -X,Z,1/2-Y -X,-Z,1/2+Y X,-Z,1/2-Y Z,Y,1/2+X Z,-Y,1/2-X -Z,Y,1/2-X -Z,-Y,1/2+X".split(" "),
"I -4 3 d":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X 1/4+Y,1/4+X,1/4+Z 1/4-Y,3/4-X,3/4+Z 3/4+Y,1/4-X,3/4-Z 3/4-Y,3/4+X,1/4-Z 1/4+X,1/4+Z,1/4+Y 3/4-X,3/4+Z,1/4-Y 1/4-X,3/4-Z,3/4+Y 3/4+X,1/4-Z,3/4-Y 1/4+Z,1/4+Y,1/4+X 3/4+Z,1/4-Y,3/4-X 3/4-Z,3/4+Y,1/4-X 1/4-Z,3/4-Y,3/4+X 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,Y,-Z X,-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y Z,-X,1/2-Y -Z,1/2-X,Y 1/2-Z,X,-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,Z,-X Y,-Z,1/2-X -Y,1/2-Z,X 3/4+Y,3/4+X,3/4+Z 3/4-Y,1/4-X,1/4+Z 1/4+Y,3/4-X,1/4-Z 1/4-Y,1/4+X,3/4-Z 3/4+X,3/4+Z,3/4+Y 1/4-X,1/4+Z,3/4-Y 3/4-X,1/4-Z,1/4+Y 1/4+X,3/4-Z,1/4-Y 3/4+Z,3/4+Y,3/4+X 1/4+Z,3/4-Y,1/4-X 1/4-Z,1/4+Y,3/4-X 3/4-Z,1/4-Y,1/4+X".split(" "),
"P 4/m -3 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X -Y,-X,Z Y,X,Z -Y,X,-Z Y,-X,-Z -X,-Z,Y X,-Z,-Y X,Z,Y -X,Z,-Y -Z,-Y,X -Z,Y,-X Z,-Y,-X Z,Y,X".split(" "),"P 4/n -3 2/n":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Z,1/2-X,1/2-Y 1/2-Z,1/2+X,1/2+Y 1/2+Z,1/2+X,1/2-Y 1/2+Z,1/2-X,1/2+Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,1/2+X 1/2+Y,1/2+Z,1/2-X 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2-X 1/2+Z,1/2+Y,1/2+X".split(" "),
"P 42/m -3 2/n":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2+Y,1/2-X,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+X,1/2+Z,1/2-Y 1/2-X,1/2+Z,1/2+Y 1/2-X,1/2-Z,1/2-Y 1/2+X,1/2-Z,1/2+Y 1/2+Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2+X 1/2-Z,1/2-Y,1/2-X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2-X 1/2+Z,1/2+Y,1/2+X".split(" "),
"P 42/n -3 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2+Y,1/2-X,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+X,1/2+Z,1/2-Y 1/2-X,1/2+Z,1/2+Y 1/2-X,1/2-Z,1/2-Y 1/2+X,1/2-Z,1/2+Y 1/2+Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2+X 1/2-Z,1/2-Y,1/2-X 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Z,1/2-X,1/2-Y 1/2-Z,1/2+X,1/2+Y 1/2+Z,1/2+X,1/2-Y 1/2+Z,1/2-X,1/2+Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,1/2+X 1/2+Y,1/2+Z,1/2-X -Y,-X,Z Y,X,Z -Y,X,-Z Y,-X,-Z -X,-Z,Y X,-Z,-Y X,Z,Y -X,Z,-Y -Z,-Y,X -Z,Y,-X Z,-Y,-X Z,Y,X".split(" "),
"F 4/m -3 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X -Y,-X,Z Y,X,Z -Y,X,-Z Y,-X,-Z -X,-Z,Y X,-Z,-Y X,Z,Y -X,Z,-Y -Z,-Y,X -Z,Y,-X Z,-Y,-X Z,Y,X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X Y,1/2+X,1/2-Z -Y,1/2-X,1/2-Z Y,1/2-X,1/2+Z -Y,1/2+X,1/2+Z X,1/2+Z,1/2-Y -X,1/2+Z,1/2+Y -X,1/2-Z,1/2-Y X,1/2-Z,1/2+Y Z,1/2+Y,1/2-X Z,1/2-Y,1/2+X -Z,1/2+Y,1/2+X -Z,1/2-Y,1/2-X -X,1/2-Y,1/2-Z X,1/2+Y,1/2-Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z -Z,1/2-X,1/2-Y -Z,1/2+X,1/2+Y Z,1/2+X,1/2-Y Z,1/2-X,1/2+Y -Y,1/2-Z,1/2-X Y,1/2-Z,1/2+X -Y,1/2+Z,1/2+X Y,1/2+Z,1/2-X -Y,1/2-X,1/2+Z Y,1/2+X,1/2+Z -Y,1/2+X,1/2-Z Y,1/2-X,1/2-Z -X,1/2-Z,1/2+Y X,1/2-Z,1/2-Y X,1/2+Z,1/2+Y -X,1/2+Z,1/2-Y -Z,1/2-Y,1/2+X -Z,1/2+Y,1/2-X Z,1/2-Y,1/2-X Z,1/2+Y,1/2+X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X 1/2+Y,X,1/2-Z 1/2-Y,-X,1/2-Z 1/2+Y,-X,1/2+Z 1/2-Y,X,1/2+Z 1/2+X,Z,1/2-Y 1/2-X,Z,1/2+Y 1/2-X,-Z,1/2-Y 1/2+X,-Z,1/2+Y 1/2+Z,Y,1/2-X 1/2+Z,-Y,1/2+X 1/2-Z,Y,1/2+X 1/2-Z,-Y,1/2-X 1/2-X,-Y,1/2-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z 1/2-X,Y,1/2+Z 1/2-Z,-X,1/2-Y 1/2-Z,X,1/2+Y 1/2+Z,X,1/2-Y 1/2+Z,-X,1/2+Y 1/2-Y,-Z,1/2-X 1/2+Y,-Z,1/2+X 1/2-Y,Z,1/2+X 1/2+Y,Z,1/2-X 1/2-Y,-X,1/2+Z 1/2+Y,X,1/2+Z 1/2-Y,X,1/2-Z 1/2+Y,-X,1/2-Z 1/2-X,-Z,1/2+Y 1/2+X,-Z,1/2-Y 1/2+X,Z,1/2+Y 1/2-X,Z,1/2-Y 1/2-Z,-Y,1/2+X 1/2-Z,Y,1/2-X 1/2+Z,-Y,1/2-X 1/2+Z,Y,1/2+X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X 1/2+Y,1/2+X,-Z 1/2-Y,1/2-X,-Z 1/2+Y,1/2-X,Z 1/2-Y,1/2+X,Z 1/2+X,1/2+Z,-Y 1/2-X,1/2+Z,Y 1/2-X,1/2-Z,-Y 1/2+X,1/2-Z,Y 1/2+Z,1/2+Y,-X 1/2+Z,1/2-Y,X 1/2-Z,1/2+Y,X 1/2-Z,1/2-Y,-X 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Z,1/2-X,-Y 1/2-Z,1/2+X,Y 1/2+Z,1/2+X,-Y 1/2+Z,1/2-X,Y 1/2-Y,1/2-Z,-X 1/2+Y,1/2-Z,X 1/2-Y,1/2+Z,X 1/2+Y,1/2+Z,-X 1/2-Y,1/2-X,Z 1/2+Y,1/2+X,Z 1/2-Y,1/2+X,-Z 1/2+Y,1/2-X,-Z 1/2-X,1/2-Z,Y 1/2+X,1/2-Z,-Y 1/2+X,1/2+Z,Y 1/2-X,1/2+Z,-Y 1/2-Z,1/2-Y,X 1/2-Z,1/2+Y,-X 1/2+Z,1/2-Y,-X 1/2+Z,1/2+Y,X".split(" "),
"F 4/m -3 2/c":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2+Y,1/2-X,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+X,1/2+Z,1/2-Y 1/2-X,1/2+Z,1/2+Y 1/2-X,1/2-Z,1/2-Y 1/2+X,1/2-Z,1/2+Y 1/2+Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2+X 1/2-Z,1/2-Y,1/2-X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2-X 1/2+Z,1/2+Y,1/2+X X,1/2+Y,1/2+Z -X,1/2-Y,1/2+Z -X,1/2+Y,1/2-Z X,1/2-Y,1/2-Z Z,1/2+X,1/2+Y Z,1/2-X,1/2-Y -Z,1/2-X,1/2+Y -Z,1/2+X,1/2-Y Y,1/2+Z,1/2+X -Y,1/2+Z,1/2-X Y,1/2-Z,1/2-X -Y,1/2-Z,1/2+X 1/2+Y,X,-Z 1/2-Y,-X,-Z 1/2+Y,-X,Z 1/2-Y,X,Z 1/2+X,Z,-Y 1/2-X,Z,Y 1/2-X,-Z,-Y 1/2+X,-Z,Y 1/2+Z,Y,-X 1/2+Z,-Y,X 1/2-Z,Y,X 1/2-Z,-Y,-X -X,1/2-Y,1/2-Z X,1/2+Y,1/2-Z X,1/2-Y,1/2+Z -X,1/2+Y,1/2+Z -Z,1/2-X,1/2-Y -Z,1/2+X,1/2+Y Z,1/2+X,1/2-Y Z,1/2-X,1/2+Y -Y,1/2-Z,1/2-X Y,1/2-Z,1/2+X -Y,1/2+Z,1/2+X Y,1/2+Z,1/2-X 1/2-Y,-X,Z 1/2+Y,X,Z 1/2-Y,X,-Z 1/2+Y,-X,-Z 1/2-X,-Z,Y 1/2+X,-Z,-Y 1/2+X,Z,Y 1/2-X,Z,-Y 1/2-Z,-Y,X 1/2-Z,Y,-X 1/2+Z,-Y,-X 1/2+Z,Y,X 1/2+X,Y,1/2+Z 1/2-X,-Y,1/2+Z 1/2-X,Y,1/2-Z 1/2+X,-Y,1/2-Z 1/2+Z,X,1/2+Y 1/2+Z,-X,1/2-Y 1/2-Z,-X,1/2+Y 1/2-Z,X,1/2-Y 1/2+Y,Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,-Z,1/2-X 1/2-Y,-Z,1/2+X Y,1/2+X,-Z -Y,1/2-X,-Z Y,1/2-X,Z -Y,1/2+X,Z X,1/2+Z,-Y -X,1/2+Z,Y -X,1/2-Z,-Y X,1/2-Z,Y Z,1/2+Y,-X Z,1/2-Y,X -Z,1/2+Y,X -Z,1/2-Y,-X 1/2-X,-Y,1/2-Z 1/2+X,Y,1/2-Z 1/2+X,-Y,1/2+Z 1/2-X,Y,1/2+Z 1/2-Z,-X,1/2-Y 1/2-Z,X,1/2+Y 1/2+Z,X,1/2-Y 1/2+Z,-X,1/2+Y 1/2-Y,-Z,1/2-X 1/2+Y,-Z,1/2+X 1/2-Y,Z,1/2+X 1/2+Y,Z,1/2-X -Y,1/2-X,Z Y,1/2+X,Z -Y,1/2+X,-Z Y,1/2-X,-Z -X,1/2-Z,Y X,1/2-Z,-Y X,1/2+Z,Y -X,1/2+Z,-Y -Z,1/2-Y,X -Z,1/2+Y,-X Z,1/2-Y,-X Z,1/2+Y,X 1/2+X,1/2+Y,Z 1/2-X,1/2-Y,Z 1/2-X,1/2+Y,-Z 1/2+X,1/2-Y,-Z 1/2+Z,1/2+X,Y 1/2+Z,1/2-X,-Y 1/2-Z,1/2-X,Y 1/2-Z,1/2+X,-Y 1/2+Y,1/2+Z,X 1/2-Y,1/2+Z,-X 1/2+Y,1/2-Z,-X 1/2-Y,1/2-Z,X Y,X,1/2-Z -Y,-X,1/2-Z Y,-X,1/2+Z -Y,X,1/2+Z X,Z,1/2-Y -X,Z,1/2+Y -X,-Z,1/2-Y X,-Z,1/2+Y Z,Y,1/2-X Z,-Y,1/2+X -Z,Y,1/2+X -Z,-Y,1/2-X 1/2-X,1/2-Y,-Z 1/2+X,1/2+Y,-Z 1/2+X,1/2-Y,Z 1/2-X,1/2+Y,Z 1/2-Z,1/2-X,-Y 1/2-Z,1/2+X,Y 1/2+Z,1/2+X,-Y 1/2+Z,1/2-X,Y 1/2-Y,1/2-Z,-X 1/2+Y,1/2-Z,X 1/2-Y,1/2+Z,X 1/2+Y,1/2+Z,-X -Y,-X,1/2+Z Y,X,1/2+Z -Y,X,1/2-Z Y,-X,1/2-Z -X,-Z,1/2+Y X,-Z,1/2-Y X,Z,1/2+Y -X,Z,1/2-Y -Z,-Y,1/2+X -Z,Y,1/2-X Z,-Y,1/2-X Z,Y,1/2+X".split(" "),
"F 41/d -3 2/m":"X,Y,Z -X,1/2-Y,1/2+Z 1/2-X,1/2+Y,-Z 1/2+X,-Y,1/2-Z Z,X,Y 1/2+Z,-X,1/2-Y -Z,1/2-X,1/2+Y 1/2-Z,1/2+X,-Y Y,Z,X 1/2-Y,1/2+Z,-X 1/2+Y,-Z,1/2-X -Y,1/2-Z,1/2+X 3/4+Y,1/4+X,3/4-Z 1/4-Y,1/4-X,1/4-Z 1/4+Y,3/4-X,3/4+Z 3/4-Y,3/4+X,1/4+Z 3/4+X,1/4+Z,3/4-Y 3/4-X,3/4+Z,1/4+Y 1/4-X,1/4-Z,1/4-Y 1/4+X,3/4-Z,3/4+Y 3/4+Z,1/4+Y,3/4-X 1/4+Z,3/4-Y,3/4+X 3/4-Z,3/4+Y,1/4+X 1/4-Z,1/4-Y,1/4-X 1/4-X,1/4-Y,1/4-Z 1/4+X,3/4+Y,3/4-Z 3/4+X,3/4-Y,1/4+Z 3/4-X,1/4+Y,3/4+Z 1/4-Z,1/4-X,1/4-Y 3/4-Z,1/4+X,3/4+Y 1/4+Z,3/4+X,3/4-Y 3/4+Z,3/4-X,1/4+Y 1/4-Y,1/4-Z,1/4-X 3/4+Y,3/4-Z,1/4+X 3/4-Y,1/4+Z,3/4+X 1/4+Y,3/4+Z,3/4-X 1/2-Y,-X,1/2+Z Y,X,Z -Y,1/2+X,1/2-Z 1/2+Y,1/2-X,-Z 1/2-X,-Z,1/2+Y 1/2+X,1/2-Z,-Y X,Z,Y -X,1/2+Z,1/2-Y 1/2-Z,-Y,1/2+X -Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,-X Z,Y,X X,1/2+Y,1/2+Z -X,-Y,Z 1/2-X,Y,1/2-Z 1/2+X,1/2-Y,-Z Z,1/2+X,1/2+Y 1/2+Z,1/2-X,-Y -Z,-X,Y 1/2-Z,X,1/2-Y Y,1/2+Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,1/2-Z,-X -Y,-Z,X 3/4+Y,3/4+X,1/4-Z 1/4-Y,3/4-X,3/4-Z 1/4+Y,1/4-X,1/4+Z 3/4-Y,1/4+X,3/4+Z 3/4+X,3/4+Z,1/4-Y 3/4-X,1/4+Z,3/4+Y 1/4-X,3/4-Z,3/4-Y 1/4+X,1/4-Z,1/4+Y 3/4+Z,3/4+Y,1/4-X 1/4+Z,1/4-Y,1/4+X 3/4-Z,1/4+Y,3/4+X 1/4-Z,3/4-Y,3/4-X 1/4-X,3/4-Y,3/4-Z 1/4+X,1/4+Y,1/4-Z 3/4+X,1/4-Y,3/4+Z 3/4-X,3/4+Y,1/4+Z 1/4-Z,3/4-X,3/4-Y 3/4-Z,3/4+X,1/4+Y 1/4+Z,1/4+X,1/4-Y 3/4+Z,1/4-X,3/4+Y 1/4-Y,3/4-Z,3/4-X 3/4+Y,1/4-Z,3/4+X 3/4-Y,3/4+Z,1/4+X 1/4+Y,1/4+Z,1/4-X 1/2-Y,1/2-X,Z Y,1/2+X,1/2+Z -Y,X,-Z 1/2+Y,-X,1/2-Z 1/2-X,1/2-Z,Y 1/2+X,-Z,1/2-Y X,1/2+Z,1/2+Y -X,Z,-Y 1/2-Z,1/2-Y,X -Z,Y,-X 1/2+Z,-Y,1/2-X Z,1/2+Y,1/2+X 1/2+X,Y,1/2+Z 1/2-X,1/2-Y,Z -X,1/2+Y,1/2-Z X,-Y,-Z 1/2+Z,X,1/2+Y Z,-X,-Y 1/2-Z,1/2-X,Y -Z,1/2+X,1/2-Y 1/2+Y,Z,1/2+X -Y,1/2+Z,1/2-X Y,-Z,-X 1/2-Y,1/2-Z,X 1/4+Y,1/4+X,1/4-Z 3/4-Y,1/4-X,3/4-Z 3/4+Y,3/4-X,1/4+Z 1/4-Y,3/4+X,3/4+Z 1/4+X,1/4+Z,1/4-Y 1/4-X,3/4+Z,3/4+Y 3/4-X,1/4-Z,3/4-Y 3/4+X,3/4-Z,1/4+Y 1/4+Z,1/4+Y,1/4-X 3/4+Z,3/4-Y,1/4+X 1/4-Z,3/4+Y,3/4+X 3/4-Z,1/4-Y,3/4-X 3/4-X,1/4-Y,3/4-Z 3/4+X,3/4+Y,1/4-Z 1/4+X,3/4-Y,3/4+Z 1/4-X,1/4+Y,1/4+Z 3/4-Z,1/4-X,3/4-Y 1/4-Z,1/4+X,1/4+Y 3/4+Z,3/4+X,1/4-Y 1/4+Z,3/4-X,3/4+Y 3/4-Y,1/4-Z,3/4-X 1/4+Y,3/4-Z,3/4+X 1/4-Y,1/4+Z,1/4+X 3/4+Y,3/4+Z,1/4-X -Y,-X,Z 1/2+Y,X,1/2+Z 1/2-Y,1/2+X,-Z Y,1/2-X,1/2-Z -X,-Z,Y X,1/2-Z,1/2-Y 1/2+X,Z,1/2+Y 1/2-X,1/2+Z,-Y -Z,-Y,X 1/2-Z,1/2+Y,-X Z,1/2-Y,1/2-X 1/2+Z,Y,1/2+X 1/2+X,1/2+Y,Z 1/2-X,-Y,1/2+Z -X,Y,-Z X,1/2-Y,1/2-Z 1/2+Z,1/2+X,Y Z,1/2-X,1/2-Y 1/2-Z,-X,1/2+Y -Z,X,-Y 1/2+Y,1/2+Z,X -Y,Z,-X Y,1/2-Z,1/2-X 1/2-Y,-Z,1/2+X 1/4+Y,3/4+X,3/4-Z 3/4-Y,3/4-X,1/4-Z 3/4+Y,1/4-X,3/4+Z 1/4-Y,1/4+X,1/4+Z 1/4+X,3/4+Z,3/4-Y 1/4-X,1/4+Z,1/4+Y 3/4-X,3/4-Z,1/4-Y 3/4+X,1/4-Z,3/4+Y 1/4+Z,3/4+Y,3/4-X 3/4+Z,1/4-Y,3/4+X 1/4-Z,1/4+Y,1/4+X 3/4-Z,3/4-Y,1/4-X 3/4-X,3/4-Y,1/4-Z 3/4+X,1/4+Y,3/4-Z 1/4+X,1/4-Y,1/4+Z 1/4-X,3/4+Y,3/4+Z 3/4-Z,3/4-X,1/4-Y 1/4-Z,3/4+X,3/4+Y 3/4+Z,1/4+X,3/4-Y 1/4+Z,1/4-X,1/4+Y 3/4-Y,3/4-Z,1/4-X 1/4+Y,1/4-Z,1/4+X 1/4-Y,3/4+Z,3/4+X 3/4+Y,1/4+Z,3/4-X -Y,1/2-X,1/2+Z 1/2+Y,1/2+X,Z 1/2-Y,X,1/2-Z Y,-X,-Z -X,1/2-Z,1/2+Y X,-Z,-Y 1/2+X,1/2+Z,Y 1/2-X,Z,1/2-Y -Z,1/2-Y,1/2+X 1/2-Z,Y,1/2-X Z,-Y,-X 1/2+Z,1/2+Y,X".split(" "),
"F 41/d -3 2/c":"X,Y,Z -X,1/2-Y,1/2+Z 1/2-X,1/2+Y,-Z 1/2+X,-Y,1/2-Z Z,X,Y 1/2+Z,-X,1/2-Y -Z,1/2-X,1/2+Y 1/2-Z,1/2+X,-Y Y,Z,X 1/2-Y,1/2+Z,-X 1/2+Y,-Z,1/2-X -Y,1/2-Z,1/2+X 3/4+Y,1/4+X,3/4-Z 1/4-Y,1/4-X,1/4-Z 1/4+Y,3/4-X,3/4+Z 3/4-Y,3/4+X,1/4+Z 3/4+X,1/4+Z,3/4-Y 3/4-X,3/4+Z,1/4+Y 1/4-X,1/4-Z,1/4-Y 1/4+X,3/4-Z,3/4+Y 3/4+Z,1/4+Y,3/4-X 1/4+Z,3/4-Y,3/4+X 3/4-Z,3/4+Y,1/4+X 1/4-Z,1/4-Y,1/4-X 3/4-X,3/4-Y,3/4-Z 3/4+X,1/4+Y,1/4-Z 1/4+X,1/4-Y,3/4+Z 1/4-X,3/4+Y,1/4+Z 3/4-Z,3/4-X,3/4-Y 1/4-Z,3/4+X,1/4+Y 3/4+Z,1/4+X,1/4-Y 1/4+Z,1/4-X,3/4+Y 3/4-Y,3/4-Z,3/4-X 1/4+Y,1/4-Z,3/4+X 1/4-Y,3/4+Z,1/4+X 3/4+Y,1/4+Z,1/4-X -Y,1/2-X,Z 1/2+Y,1/2+X,1/2+Z 1/2-Y,X,-Z Y,-X,1/2-Z -X,1/2-Z,Y X,-Z,1/2-Y 1/2+X,1/2+Z,1/2+Y 1/2-X,Z,-Y -Z,1/2-Y,X 1/2-Z,Y,-X Z,-Y,1/2-X 1/2+Z,1/2+Y,1/2+X X,1/2+Y,1/2+Z -X,-Y,Z 1/2-X,Y,1/2-Z 1/2+X,1/2-Y,-Z Z,1/2+X,1/2+Y 1/2+Z,1/2-X,-Y -Z,-X,Y 1/2-Z,X,1/2-Y Y,1/2+Z,1/2+X 1/2-Y,Z,1/2-X 1/2+Y,1/2-Z,-X -Y,-Z,X 3/4+Y,3/4+X,1/4-Z 1/4-Y,3/4-X,3/4-Z 1/4+Y,1/4-X,1/4+Z 3/4-Y,1/4+X,3/4+Z 3/4+X,3/4+Z,1/4-Y 3/4-X,1/4+Z,3/4+Y 1/4-X,3/4-Z,3/4-Y 1/4+X,1/4-Z,1/4+Y 3/4+Z,3/4+Y,1/4-X 1/4+Z,1/4-Y,1/4+X 3/4-Z,1/4+Y,3/4+X 1/4-Z,3/4-Y,3/4-X 3/4-X,1/4-Y,1/4-Z 3/4+X,3/4+Y,3/4-Z 1/4+X,3/4-Y,1/4+Z 1/4-X,1/4+Y,3/4+Z 3/4-Z,1/4-X,1/4-Y 1/4-Z,1/4+X,3/4+Y 3/4+Z,3/4+X,3/4-Y 1/4+Z,3/4-X,1/4+Y 3/4-Y,1/4-Z,1/4-X 1/4+Y,3/4-Z,1/4+X 1/4-Y,1/4+Z,3/4+X 3/4+Y,3/4+Z,3/4-X -Y,-X,1/2+Z 1/2+Y,X,Z 1/2-Y,1/2+X,1/2-Z Y,1/2-X,-Z -X,-Z,1/2+Y X,1/2-Z,-Y 1/2+X,Z,Y 1/2-X,1/2+Z,1/2-Y -Z,-Y,1/2+X 1/2-Z,1/2+Y,1/2-X Z,1/2-Y,-X 1/2+Z,Y,X 1/2+X,Y,1/2+Z 1/2-X,1/2-Y,Z -X,1/2+Y,1/2-Z X,-Y,-Z 1/2+Z,X,1/2+Y Z,-X,-Y 1/2-Z,1/2-X,Y -Z,1/2+X,1/2-Y 1/2+Y,Z,1/2+X -Y,1/2+Z,1/2-X Y,-Z,-X 1/2-Y,1/2-Z,X 1/4+Y,1/4+X,1/4-Z 3/4-Y,1/4-X,3/4-Z 3/4+Y,3/4-X,1/4+Z 1/4-Y,3/4+X,3/4+Z 1/4+X,1/4+Z,1/4-Y 1/4-X,3/4+Z,3/4+Y 3/4-X,1/4-Z,3/4-Y 3/4+X,3/4-Z,1/4+Y 1/4+Z,1/4+Y,1/4-X 3/4+Z,3/4-Y,1/4+X 1/4-Z,3/4+Y,3/4+X 3/4-Z,1/4-Y,3/4-X 1/4-X,3/4-Y,1/4-Z 1/4+X,1/4+Y,3/4-Z 3/4+X,1/4-Y,1/4+Z 3/4-X,3/4+Y,3/4+Z 1/4-Z,3/4-X,1/4-Y 3/4-Z,3/4+X,3/4+Y 1/4+Z,1/4+X,3/4-Y 3/4+Z,1/4-X,1/4+Y 1/4-Y,3/4-Z,1/4-X 3/4+Y,1/4-Z,1/4+X 3/4-Y,3/4+Z,3/4+X 1/4+Y,1/4+Z,3/4-X 1/2-Y,1/2-X,1/2+Z Y,1/2+X,Z -Y,X,1/2-Z 1/2+Y,-X,-Z 1/2-X,1/2-Z,1/2+Y 1/2+X,-Z,-Y X,1/2+Z,Y -X,Z,1/2-Y 1/2-Z,1/2-Y,1/2+X -Z,Y,1/2-X 1/2+Z,-Y,-X Z,1/2+Y,X 1/2+X,1/2+Y,Z 1/2-X,-Y,1/2+Z -X,Y,-Z X,1/2-Y,1/2-Z 1/2+Z,1/2+X,Y Z,1/2-X,1/2-Y 1/2-Z,-X,1/2+Y -Z,X,-Y 1/2+Y,1/2+Z,X -Y,Z,-X Y,1/2-Z,1/2-X 1/2-Y,-Z,1/2+X 1/4+Y,3/4+X,3/4-Z 3/4-Y,3/4-X,1/4-Z 3/4+Y,1/4-X,3/4+Z 1/4-Y,1/4+X,1/4+Z 1/4+X,3/4+Z,3/4-Y 1/4-X,1/4+Z,1/4+Y 3/4-X,3/4-Z,1/4-Y 3/4+X,1/4-Z,3/4+Y 1/4+Z,3/4+Y,3/4-X 3/4+Z,1/4-Y,3/4+X 1/4-Z,1/4+Y,1/4+X 3/4-Z,3/4-Y,1/4-X 1/4-X,1/4-Y,3/4-Z 1/4+X,3/4+Y,1/4-Z 3/4+X,3/4-Y,3/4+Z 3/4-X,1/4+Y,1/4+Z 1/4-Z,1/4-X,3/4-Y 3/4-Z,1/4+X,1/4+Y 1/4+Z,3/4+X,1/4-Y 3/4+Z,3/4-X,3/4+Y 1/4-Y,1/4-Z,3/4-X 3/4+Y,3/4-Z,3/4+X 3/4-Y,1/4+Z,1/4+X 1/4+Y,3/4+Z,1/4-X 1/2-Y,-X,Z Y,X,1/2+Z -Y,1/2+X,-Z 1/2+Y,1/2-X,1/2-Z 1/2-X,-Z,Y 1/2+X,1/2-Z,1/2-Y X,Z,1/2+Y -X,1/2+Z,-Y 1/2-Z,-Y,X -Z,1/2+Y,-X 1/2+Z,1/2-Y,1/2-X Z,Y,1/2+X".split(" "),
"I 4/m -3 2/m":"X,Y,Z -X,-Y,Z -X,Y,-Z X,-Y,-Z Z,X,Y Z,-X,-Y -Z,-X,Y -Z,X,-Y Y,Z,X -Y,Z,-X Y,-Z,-X -Y,-Z,X Y,X,-Z -Y,-X,-Z Y,-X,Z -Y,X,Z X,Z,-Y -X,Z,Y -X,-Z,-Y X,-Z,Y Z,Y,-X Z,-Y,X -Z,Y,X -Z,-Y,-X -X,-Y,-Z X,Y,-Z X,-Y,Z -X,Y,Z -Z,-X,-Y -Z,X,Y Z,X,-Y Z,-X,Y -Y,-Z,-X Y,-Z,X -Y,Z,X Y,Z,-X -Y,-X,Z Y,X,Z -Y,X,-Z Y,-X,-Z -X,-Z,Y X,-Z,-Y X,Z,Y -X,Z,-Y -Z,-Y,X -Z,Y,-X Z,-Y,-X Z,Y,X 1/2+X,1/2+Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y 1/2+Z,1/2-X,1/2-Y 1/2-Z,1/2-X,1/2+Y 1/2-Z,1/2+X,1/2-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,1/2-X 1/2-Y,1/2-Z,1/2+X 1/2+Y,1/2+X,1/2-Z 1/2-Y,1/2-X,1/2-Z 1/2+Y,1/2-X,1/2+Z 1/2-Y,1/2+X,1/2+Z 1/2+X,1/2+Z,1/2-Y 1/2-X,1/2+Z,1/2+Y 1/2-X,1/2-Z,1/2-Y 1/2+X,1/2-Z,1/2+Y 1/2+Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2+X 1/2-Z,1/2-Y,1/2-X 1/2-X,1/2-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z 1/2+X,1/2-Y,1/2+Z 1/2-X,1/2+Y,1/2+Z 1/2-Z,1/2-X,1/2-Y 1/2-Z,1/2+X,1/2+Y 1/2+Z,1/2+X,1/2-Y 1/2+Z,1/2-X,1/2+Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,1/2+X 1/2+Y,1/2+Z,1/2-X 1/2-Y,1/2-X,1/2+Z 1/2+Y,1/2+X,1/2+Z 1/2-Y,1/2+X,1/2-Z 1/2+Y,1/2-X,1/2-Z 1/2-X,1/2-Z,1/2+Y 1/2+X,1/2-Z,1/2-Y 1/2+X,1/2+Z,1/2+Y 1/2-X,1/2+Z,1/2-Y 1/2-Z,1/2-Y,1/2+X 1/2-Z,1/2+Y,1/2-X 1/2+Z,1/2-Y,1/2-X 1/2+Z,1/2+Y,1/2+X".split(" "),
"I 41/a -3 2/d":"X,Y,Z 1/2-X,-Y,1/2+Z -X,1/2+Y,1/2-Z 1/2+X,1/2-Y,-Z Z,X,Y 1/2+Z,1/2-X,-Y 1/2-Z,-X,1/2+Y -Z,1/2+X,1/2-Y Y,Z,X -Y,1/2+Z,1/2-X 1/2+Y,1/2-Z,-X 1/2-Y,-Z,1/2+X 3/4+Y,1/4+X,1/4-Z 3/4-Y,3/4-X,3/4-Z 1/4+Y,1/4-X,3/4+Z 1/4-Y,3/4+X,1/4+Z 3/4+X,1/4+Z,1/4-Y 1/4-X,3/4+Z,1/4+Y 3/4-X,3/4-Z,3/4-Y 1/4+X,1/4-Z,3/4+Y 3/4+Z,1/4+Y,1/4-X 1/4+Z,1/4-Y,3/4+X 1/4-Z,3/4+Y,1/4+X 3/4-Z,3/4-Y,3/4-X -X,-Y,-Z 1/2+X,Y,1/2-Z X,1/2-Y,1/2+Z 1/2-X,1/2+Y,Z -Z,-X,-Y 1/2-Z,1/2+X,Y 1/2+Z,X,1/2-Y Z,1/2-X,1/2+Y -Y,-Z,-X Y,1/2-Z,1/2+X 1/2-Y,1/2+Z,X 1/2+Y,Z,1/2-X 1/4-Y,3/4-X,3/4+Z 1/4+Y,1/4+X,1/4+Z 3/4-Y,3/4+X,1/4-Z 3/4+Y,1/4-X,3/4-Z 1/4-X,3/4-Z,3/4+Y 3/4+X,1/4-Z,3/4-Y 1/4+X,1/4+Z,1/4+Y 3/4-X,3/4+Z,1/4-Y 1/4-Z,3/4-Y,3/4+X 3/4-Z,3/4+Y,1/4-X 3/4+Z,1/4-Y,3/4-X 1/4+Z,1/4+Y,1/4+X 1/2+X,1/2+Y,1/2+Z -X,1/2-Y,Z 1/2-X,Y,-Z X,-Y,1/2-Z 1/2+Z,1/2+X,1/2+Y Z,-X,1/2-Y -Z,1/2-X,Y 1/2-Z,X,-Y 1/2+Y,1/2+Z,1/2+X 1/2-Y,Z,-X Y,-Z,1/2-X -Y,1/2-Z,X 1/4+Y,3/4+X,3/4-Z 1/4-Y,1/4-X,1/4-Z 3/4+Y,3/4-X,1/4+Z 3/4-Y,1/4+X,3/4+Z 1/4+X,3/4+Z,3/4-Y 3/4-X,1/4+Z,3/4+Y 1/4-X,1/4-Z,1/4-Y 3/4+X,3/4-Z,1/4+Y 1/4+Z,3/4+Y,3/4-X 3/4+Z,3/4-Y,1/4+X 3/4-Z,1/4+Y,3/4+X 1/4-Z,1/4-Y,1/4-X 1/2-X,1/2-Y,1/2-Z X,1/2+Y,-Z 1/2+X,-Y,Z -X,Y,1/2+Z 1/2-Z,1/2-X,1/2-Y -Z,X,1/2+Y Z,1/2+X,-Y 1/2+Z,-X,Y 1/2-Y,1/2-Z,1/2-X 1/2+Y,-Z,X -Y,Z,1/2+X Y,1/2+Z,-X 3/4-Y,1/4-X,1/4+Z 3/4+Y,3/4+X,3/4+Z 1/4-Y,1/4+X,3/4-Z 1/4+Y,3/4-X,1/4-Z 3/4-X,1/4-Z,1/4+Y 1/4+X,3/4-Z,1/4-Y 3/4+X,3/4+Z,3/4+Y 1/4-X,1/4+Z,3/4-Y 3/4-Z,1/4-Y,1/4+X 1/4-Z,1/4+Y,3/4-X 1/4+Z,3/4-Y,1/4-X 3/4+Z,3/4+Y,3/4+X".split(" "),
"P 1 1 2":["X,Y,Z","-X,-Y,Z"],"P 1 1 21":["X,Y,Z","-X,-Y,1/2+Z"],"B 1 1 2":["X,Y,Z","-X,-Y,Z","1/2+X,+Y,1/2+Z","1/2-X,-Y,1/2+Z"],"A 1 2 1":["X,Y,Z","-X,Y,-Z","X,1/2+Y,1/2+Z","-X,1/2+Y,1/2-Z"],"C 1 21 1":["X,Y,Z","-X,1/2+Y,-Z","1/2+X,1/2+Y,Z","1/2-X,Y,-Z"],"I 1 2 1":["X,Y,Z","-X,Y,-Z","X+1/2,Y+1/2,Z+1/2","-X+1/2,Y+1/2,-Z+1/2"],"I 1 21 1":["X,Y,Z","-X,1/2+Y,-Z","X+1/2,Y+1/2,Z+1/2","-X+1/2,Y,1/2-Z"],"P 1 1 m":["X,Y,Z","X,Y,-Z"],"P 1 1 b":["X,Y,Z","X,1/2+Y,-Z"],"B 1 1 m":["X,Y,Z","X,Y,-Z","1/2+X,Y,1/2+Z",
"1/2+X,Y,1/2-Z"],"B 1 1 b":["X,Y,Z","X,1/2+Y,-Z","1/2+X,Y,1/2+Z","1/2+X,1/2+Y,1/2-Z"],"P 1 1 2/m":["X,Y,Z","X,Y,-Z","-X,-Y,Z","-X,-Y,-Z"],"P 1 1 21/m":["X,Y,Z","-X,-Y,1/2+Z","-X,-Y,-Z","X,Y,1/2-Z"],"B 1 1 2/m":"X,Y,Z X,Y,-Z -X,-Y,Z -X,-Y,-Z 1/2+X,Y,1/2+Z 1/2+X,Y,1/2-Z 1/2-X,-Y,1/2+Z 1/2-X,-Y,1/2-Z".split(" "),"P 1 1 2/b":["X,Y,Z","-X,1/2-Y,Z","-X,-Y,-Z","X,1/2+Y,-Z"],"P 1 1 21/b":["X,Y,Z","-X,-Y,-Z","-X,1/2-Y,1/2+Z","X,1/2+Y,1/2-Z"],"B 1 1 2/b":"X,Y,Z -X,1/2-Y,Z -X,-Y,-Z X,1/2+Y,-Z 1/2+X,Y,1/2+Z 1/2-X,1/2-Y,1/2+Z 1/2-X,-Y,1/2-Z 1/2+X,1/2+Y,1/2-Z".split(" "),
"P 21 2 2":["X,Y,Z","-X,Y,-Z","1/2+X,-Y,-Z","1/2-X,-Y,Z"],"P 2 21 2":["X,Y,Z","X,1/2-Y,-Z","-X,1/2+Y,-Z","-X,-Y,Z"],"P 21 21 2 (a)":["X,Y,Z","1/2-X,1/2-Y,Z","X+1/2,-Y,-Z","-X,Y+1/2,-Z"],"P 21 2 21":["X,Y,Z","-X,Y,-Z","1/2+X,-Y,1/2-Z","1/2-X,-Y,1/2+Z"],"P 2 21 21":["X,Y,Z","X,-Y,-Z","-X,1/2+Y,1/2-Z","-X,1/2-Y,1/2+Z"],"C 2 2 21a)":"X,Y,Z 1/2-X,-Y,1/2+Z 1/2+X,1/2-Y,-Z -X,1/2+Y,1/2-Z 1/2+X,1/2+Y,Z -X,1/2-Y,1/2+Z X,-Y,-Z 1/2-X,Y,1/2-Z".split(" "),"C 2 2 2a":"X,Y,Z;1/2-X,1/2-Y,Z;X+1/2,-Y,-Z;-X,Y+1/2,-Z;1/2+ X,1/2+Y,Z;-X,-Y,Z;X,1/2-Y,-Z;1/2-X,Y,-Z".split(";"),
"F 2 2 2a":"X,Y,Z 1/2-X,1/2-Y,Z X+1/2,-Y,-Z -X,Y+1/2,-Z X,Y+1/2,Z+1/2 1/2-X,-Y,Z+1/2 X+1/2,-Y+1/2,-Z+1/2 -X,Y,-Z+1/2 X+1/2,Y,Z+1/2 -X,1/2-Y,Z+1/2 X,-Y,-Z+1/2 -X+1/2,Y+1/2,-Z+1/2 X+1/2,Y+1/2,Z -X,-Y,Z X,-Y+1/2,-Z -X+1/2,Y,-Z".split(" "),"I 2 2 2a":"X,Y,Z 1/2-X,1/2-Y,Z X+1/2,-Y,-Z -X,Y+1/2,-Z 1/2+X,1/2+Y,1/2+Z -X,-Y,1/2+Z 1/2-X,Y,1/2-Z X,1/2-Y,1/2-Z".split(" "),"P 21/m 21/m 2/n a":"X,Y,Z 1/2-X,1/2-Y,Z -X,1/2+Y,-Z 1/2+X,-Y,-Z -X,-Y,-Z X+1/2,Y+1/2,-Z X,1/2-Y,Z 1/2-X,Y,Z".split(" "),"P 42 21 2a":"X,Y,Z 1/2-X,1/2-Y,Z -Y,X+1/2,1/2+Z Y+1/2,-X,1/2+Z -X,Y+1/2,-Z X+1/2,-Y,-Z Y,X,1/2-Z 1/2-Y,1/2-X,1/2-Z".split(" "),
"I 2 3a":"X,Y,Z 1/2-X,1/2-Y,Z X+1/2,-Y,-Z -X,Y+1/2,-Z Y,Z,X 1/2-Y,1/2-Z,X Y+1/2,-Z,-X -Y,Z+1/2,-X Z,X,Y 1/2-Z,1/2-X,Y Z+1/2,-X,-Y -Z,X+1/2,-Y 1/2+X,1/2+Y,1/2+Z -X,-Y,1/2+Z X,1/2-Y,1/2-Z 1/2-X,Y,1/2-Z 1/2+Y,1/2+Z,1/2+X -Y,-Z,1/2+X Y,1/2-Z,1/2-X 1/2-Y,Z,1/2-X 1/2+Z,1/2+X,1/2+Y -Z,-X,1/2+Y Z,1/2-X,1/2-Y 1/2-Z,X,1/2-Y".split(" ")};
NGL.SubstitutionMatrices=function(){function a(a,c){var d,e=0,f={};c.forEach(function(c){d=0;var h={};c.forEach(function(c){h[a[d++]]=c});f[a[e++]]=h});return f}return{blosum62:a("ARNDCQEGHILKMFPSTWYVBZ?",[[4,-1,-2,-2,0,-1,-1,0,-2,-1,-1,-1,-1,-2,-1,1,0,-3,-2,0,-2,-1,0],[-1,5,0,-2,-3,1,0,-2,0,-3,-2,2,-1,-3,-2,-1,-1,-3,-2,-3,-1,0,-1],[-2,0,6,1,-3,0,0,0,1,-3,-3,0,-2,-3,-2,1,0,-4,-2,-3,3,0,-1],[-2,-2,1,6,-3,0,2,-1,-1,-3,-4,-1,-3,-3,-1,0,-1,-4,-3,-3,4,1,-1],[0,-3,-3,-3,9,-3,-4,-3,-3,-1,-1,-3,-1,-2,-3,
-1,-1,-2,-2,-1,-3,-3,-2],[-1,1,0,0,-3,5,2,-2,0,-3,-2,1,0,-3,-1,0,-1,-2,-1,-2,0,3,-1],[-1,0,0,2,-4,2,5,-2,0,-3,-3,1,-2,-3,-1,0,-1,-3,-2,-2,1,4,-1],[0,-2,0,-1,-3,-2,-2,6,-2,-4,-4,-2,-3,-3,-2,0,-2,-2,-3,-3,-1,-2,-1],[-2,0,1,-1,-3,0,0,-2,8,-3,-3,-1,-2,-1,-2,-1,-2,-2,2,-3,0,0,-1],[-1,-3,-3,-3,-1,-3,-3,-4,-3,4,2,-3,1,0,-3,-2,-1,-3,-1,3,-3,-3,-1],[-1,-2,-3,-4,-1,-2,-3,-4,-3,2,4,-2,2,0,-3,-2,-1,-2,-1,1,-4,-3,-1],[-1,2,0,-1,-3,1,1,-2,-1,-3,-2,5,-1,-3,-1,0,-1,-3,-2,-2,0,1,-1],[-1,-1,-2,-3,-1,0,-2,-3,-2,1,2,
-1,5,0,-2,-1,-1,-1,-1,1,-3,-1,-1],[-2,-3,-3,-3,-2,-3,-3,-3,-1,0,0,-3,0,6,-4,-2,-2,1,3,-1,-3,-3,-1],[-1,-2,-2,-1,-3,-1,-1,-2,-2,-3,-3,-1,-2,-4,7,-1,-1,-4,-3,-2,-2,-1,-2],[1,-1,1,0,-1,0,0,0,-1,-2,-2,0,-1,-2,-1,4,1,-3,-2,-2,0,0,0],[0,-1,0,-1,-1,-1,-1,-2,-2,-1,-1,-1,-1,-2,-1,1,5,-2,-2,0,-1,-1,0],[-3,-3,-4,-4,-2,-2,-3,-2,-2,-3,-2,-3,-1,1,-4,-3,-2,11,2,-3,-4,-3,-2],[-2,-2,-2,-3,-2,-1,-2,-3,2,-1,-1,-2,-1,3,-3,-2,-2,2,7,-1,-3,-2,-1],[0,-3,-3,-3,-1,-2,-2,-3,-3,3,1,-2,1,-1,-2,-2,0,-3,-1,4,-3,-2,-1],[-2,-1,
3,4,-3,0,1,-1,0,-3,-4,0,-3,-3,-2,0,-1,-4,-3,-3,4,1,-1],[-1,0,0,1,-3,3,4,-2,0,-3,-3,1,-1,-3,-1,0,-1,-3,-2,-2,1,4,-1],[0,-1,-1,-1,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-2,0,0,-2,-1,-1,-1,-1,-1]]),blosum62x:a("ACDEFGHIKLMNPQRSTVWY",[[4,0,-2,-1,-2,0,-2,-1,-1,-1,-1,-2,-1,-1,-1,1,0,0,-3,-2],[0,9,-3,-4,-2,-3,-3,-1,-3,-1,-1,-3,-3,-3,-3,-1,-1,-1,-2,-2],[-2,-3,6,2,-3,-1,-1,-3,-1,-4,-3,1,-1,0,-2,0,-1,-3,-4,-3],[-1,-4,2,5,-3,-2,0,-3,1,-3,-2,0,-1,2,0,0,-1,-2,-3,-2],[-2,-2,-3,-3,6,-3,-1,0,-3,0,0,-3,-4,-3,-3,-2,-2,-1,1,
3],[0,-3,-1,-2,-3,6,-2,-4,-2,-4,-3,0,-2,-2,-2,0,-2,-3,-2,-3],[-2,-3,-1,0,-1,-2,8,-3,-1,-3,-2,1,-2,0,0,-1,-2,-3,-2,2],[-1,-1,-3,-3,0,-4,-3,4,-3,2,1,-3,-3,-3,-3,-2,-1,3,-3,-1],[-1,-3,-1,1,-3,-2,-1,-3,5,-2,-1,0,-1,1,2,0,-1,-2,-3,-2],[-1,-1,-4,-3,0,-4,-3,2,-2,4,2,-3,-3,-2,-2,-2,-1,1,-2,-1],[-1,-1,-3,-2,0,-3,-2,1,-1,2,5,-2,-2,0,-1,-1,-1,1,-1,-1],[-2,-3,1,0,-3,0,1,-3,0,-3,-2,6,-2,0,0,1,0,-3,-4,-2],[-1,-3,-1,-1,-4,-2,-2,-3,-1,-3,-2,-2,7,-1,-2,-1,-1,-2,-4,-3],[-1,-3,0,2,-3,-2,0,-3,1,-2,0,0,-1,5,1,0,-1,-2,
-2,-1],[-1,-3,-2,0,-3,-2,0,-3,2,-2,-1,0,-2,1,5,-1,-1,-3,-3,-2],[1,-1,0,0,-2,0,-1,-2,0,-2,-1,1,-1,0,-1,4,1,-2,-3,-2],[0,-1,-1,-1,-2,-2,-2,-1,-1,-1,-1,0,-1,-1,-1,1,5,0,-2,-2],[0,-1,-3,-2,-1,-3,-3,3,-2,1,1,-3,-2,-2,-3,-2,0,4,-3,-1],[-3,-2,-4,-3,1,-2,-2,-3,-3,-2,-1,-4,-4,-2,-3,-3,-2,-3,11,2],[-2,-2,-3,-2,3,-3,2,-1,-2,-1,-1,-2,-3,-1,-2,-2,-2,-1,2,7]])}}();
NGL.Alignment=function(a,b,c,d,e){this.seq1=a;this.seq2=b;this.gapPenalty=c||-10;this.gapExtensionPenalty=d||-1;this.substMatrix=e||"blosum62",this.substMatrix=NGL.SubstitutionMatrices[this.substMatrix]};
NGL.Alignment.prototype={constructor:NGL.Alignment,initMatrices:function(){this.n=this.seq1.length;this.m=this.seq2.length;this.score=void 0;this.ali="";this.S=[];this.V=[];this.H=[];for(var a=0;a<=this.n;++a){this.S[a]=[];this.V[a]=[];this.H[a]=[];for(var b=0;b<=this.m;++b)this.S[a][b]=0,this.V[a][b]=0,this.H[a][b]=0}for(a=0;a<=this.n;++a)this.S[a][0]=this.gap(0),this.H[a][0]=-Infinity;for(b=0;b<=this.m;++b)this.S[0][b]=this.gap(0),this.V[0][b]=-Infinity;this.S[0][0]=0},gap:function(a){return this.gapPenalty+
a*this.gapExtensionPenalty},makeScoreFn:function(){var a=this.seq1,b=this.seq2,c=this.substMatrix,d,e;if(c)return function(f,g){d=a[f];e=b[g];try{return c[d][e]}catch(h){return-4}};NGL.warn("NGL.Alignment: no subst matrix");return function(c,g){d=a[c];e=b[g];return d===e?5:-3}},calc:function(){NGL.time("NGL.Alignment.calc");this.initMatrices();var a=this.gap(0),b=this.makeScoreFn(),c=this.gapExtensionPenalty,d=this.V,e=this.H,f=this.S,g=this.n,h=this.m,k,l,m,p,r,n,q;for(n=1;n<=g;++n)for(l=f[n-1],
k=d[n-1],m=d[n],p=e[n],r=f[n],q=1;q<=h;++q)m[q]=Math.max(l[q]+a,k[q]+c),p[q]=Math.max(r[q-1]+a,p[q-1]+c),r[q]=Math.max(l[q-1]+b(n-1,q-1),m[q],p[q]);NGL.timeEnd("NGL.Alignment.calc")},trace:function(){this.ali2=this.ali1="";var a=this.makeScoreFn(),b=this.n,c=this.m,d="S";this.S[b][c]>=this.V[b][c]&&this.S[b][c]>=this.V[b][c]?(d="S",this.score=this.S[b][c]):this.V[b][c]>=this.H[b][c]?(d="V",this.score=this.V[b][c]):(d="H",this.score=this.H[b][c]);for(;0<b&&0<c;)"S"==d?this.S[b][c]==this.S[b-1][c-1]+
a(b-1,c-1)?(this.ali1=this.seq1[b-1]+this.ali1,this.ali2=this.seq2[c-1]+this.ali2,--b,--c,d="S"):this.S[b][c]==this.V[b][c]?d="V":this.S[b][c]==this.H[b][c]?d="H":(NGL.error("NGL.Alignment: S"),--b,--c):"V"==d?this.V[b][c]==this.V[b-1][c]+this.gapExtensionPenalty?(this.ali1=this.seq1[b-1]+this.ali1,this.ali2="-"+this.ali2,--b,d="V"):this.V[b][c]==this.S[b-1][c]+this.gap(0)?(this.ali1=this.seq1[b-1]+this.ali1,this.ali2="-"+this.ali2,--b,d="S"):(NGL.error("NGL.Alignment: V"),--b):"H"==d?this.H[b][c]==
this.H[b][c-1]+this.gapExtensionPenalty?(this.ali1="-"+this.ali1,this.ali2=this.seq2[c-1]+this.ali2,--c,d="H"):this.H[b][c]==this.S[b][c-1]+this.gap(0)?(this.ali1="-"+this.ali1,this.ali2=this.seq2[c-1]+this.ali2,--c,d="S"):(NGL.error("NGL.Alignment: H"),--c):NGL.error("NGL.Alignment: no matrix");for(;0<b;)this.ali1=this.seq1[b-1]+this.ali1,this.ali2="-"+this.ali2,--b;for(;0<c;)this.ali1="-"+this.ali1,this.ali2=this.seq2[c-1]+this.ali2,--c}};
NGL.Spline=function(a,b){this.arrows=b||!1;this.fiber=a;this.size=a.residueCount-2;this.type=this.fiber.getType();this.tension=this.type===NGL.NucleicType?.5:.9};
NGL.Spline.prototype={constructor:NGL.Spline,interpolate:function(a,b,c,d,e,f){a=(c-a)*f;d=(d-b)*f;f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b},getSubdividedColor:function(a,b){var c=this.size-1,d=new Float32Array(c*a*3+3),e=new Float32Array(c*a*3+3),f=b||{};f.structure=this.fiber.structure;var g=NGL.ColorMakerRegistry.getScheme(f),h=NGL.ColorMakerRegistry.getPickingScheme(f),k=0,l,m,p;this.fiber.eachAtomN(4,function(b,c,f,t){p=Math.ceil(a/2);for(l=0;l<p;++l)m=k+3*l,g.atomColorToArray(c,
d,m),h.atomColorToArray(c,e,m);for(l=p;l<a;++l)m=k+3*l,g.atomColorToArray(f,d,m),h.atomColorToArray(f,e,m);k+=3*a},"trace");d[c*a*3+0]=d[c*a*3-3];d[c*a*3+1]=d[c*a*3-2];d[c*a*3+2]=d[c*a*3-1];e[c*a*3+0]=e[c*a*3-3];e[c*a*3+1]=e[c*a*3-2];e[c*a*3+2]=e[c*a*3-1];return{color:d,pickingColor:e}},getSubdividedPosition:function(a,b){isNaN(b)&&(b=this.tension);return{position:this.getPosition(a,b)}},getSubdividedOrientation:function(a,b){isNaN(b)&&(b=this.tension);var c=this.getTangent(a,b),d=this.getNormals(a,
b,c);return{tangent:c,normal:d.normal,binormal:d.binormal}},getSubdividedSize:function(a,b,c){var d=this.arrows,e=new Float32Array((this.size-1)*a+1),f=new NGL.RadiusFactory(b,c),g=0,h,k,l,m;this.fiber.eachAtomN(4,function(b,c,n,q){k=f.atomRadius(c);l=f.atomRadius(n);if(d&&("s"===c.ss&&"s"!==n.ss||"h"===c.ss&&"h"!==n.ss||"g"===c.ss&&"g"!==n.ss||"i"===c.ss&&"i"!==n.ss)){k*=1.7;b=Math.ceil(a/2);for(h=0;h<b;++h)m=h/b,e[g+h]=(1-m)*k+m*l;for(h=b;h<a;++h)e[g+h]=l}else for(h=0;h<a;++h)m=h/a,e[g+h]=(1-m)*
k+m*l;g+=a},"trace");e[g]=e[g-1];return{size:e}},getPosition:function(a,b,c){isNaN(b)&&(b=this.tension);var d=this.interpolate,e=new Float32Array((this.size-1)*a*3+3),f=0,g=1/a,h,k,l,m;this.fiber.eachAtomN(4,function(c,r,n,q){m=n;for(h=0;h<a;++h)l=g*h,k=f+3*h,e[k+0]=d(c.x,r.x,n.x,q.x,l,b),e[k+1]=d(c.y,r.y,n.y,q.y,l,b),e[k+2]=d(c.z,r.z,n.z,q.z,l,b);f+=3*a},c||"trace");m.positionToArray(e,f);return e},getTangent:function(a,b,c){isNaN(b)&&(b=this.tension);var d=this.interpolate,e=new THREE.Vector3,f=
new THREE.Vector3,g=new Float32Array((this.size-1)*a*3+3),h=0,k=1/a,l,m,p,r,n;this.fiber.eachAtomN(4,function(c,t,u,s){for(l=0;l<a;++l)p=k*l,r=p-1E-4,n=p+1E-4,m=h+3*l,0>r&&(r=0),1<n&&(n=1),e.x=d(c.x,t.x,u.x,s.x,r,b),e.y=d(c.y,t.y,u.y,s.y,r,b),e.z=d(c.z,t.z,u.z,s.z,r,b),f.x=d(c.x,t.x,u.x,s.x,n,b),f.y=d(c.y,t.y,u.y,s.y,n,b),f.z=d(c.z,t.z,u.z,s.z,n,b),f.sub(e).normalize(),f.toArray(g,m);h+=3*a},c||"trace");f.toArray(g,h);return g},getNormals:function(a,b,c){var d=this.interpolate,e=this.type,f=this.fiber,
g=this.size-1,h=new Float32Array(g*a*3+3),g=new Float32Array(g*a*3+3),k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector3,p=new THREE.Vector3,r=new THREE.Vector3,n=new THREE.Vector3,q=new THREE.Vector3,t=new THREE.Vector3,u=(new THREE.Vector3).set(0,0,1),s=new THREE.Vector3;new THREE.Vector3;var v=new THREE.Vector3,y=new THREE.Vector3,x=new THREE.Vector3,B=new THREE.Vector3,G=new THREE.Vector3,F=new THREE.Vector3,w=new THREE.Vector3,z=new THREE.Vector3,C=0,L=1/a,O=!0,W=Math.ceil(a/2),K,P;
f.computedAtoms.direction1||f.computeAtom("direction1");f.computedAtoms.direction2||f.computeAtom("direction2");for(var da=f.computedAtoms.direction1,A=f.computedAtoms.direction2,X=da.length,D=4;D<=X;D++){e!==NGL.CgType&&(O?(O=!1,v.copy(da[D-4]),y.copy(da[D-3]),x.copy(da[D-2]),G.copy(A[D-4]),F.copy(A[D-3]),w.copy(A[D-2]),m.subVectors(G,v),p.subVectors(F,y),0>m.dot(p)&&(p.multiplyScalar(-1),F.addVectors(y,p)),r.subVectors(w,x),0>p.dot(r)&&(r.multiplyScalar(-1),w.addVectors(x,r))):(v.copy(y),y.copy(x),
x.copy(B),G.copy(F),F.copy(w),w.copy(z),r.copy(n)),B.copy(da[D-1]),z.copy(A[D-1]),n.subVectors(z,B),0>r.dot(n)&&(n.multiplyScalar(-1),z.addVectors(B,n)));for(f=0;f<a;++f)K=C+3*f,e===NGL.CgType?q.copy(u):(e===NGL.ProteinType&&(K+=3*W),P=L*f,k.x=d(v.x,y.x,x.x,B.x,P,b),k.y=d(v.y,y.y,x.y,B.y,P,b),k.z=d(v.z,y.z,x.z,B.z,P,b),l.x=d(G.x,F.x,w.x,z.x,P,b),l.y=d(G.y,F.y,w.y,z.y,P,b),l.z=d(G.z,F.z,w.z,z.z,P,b),q.subVectors(l,k).normalize()),t.fromArray(c,K),s.crossVectors(q,t).normalize(),s.toArray(g,K),u.crossVectors(t,
s).normalize(),u.toArray(h,K);C+=3*a}if(e===NGL.ProteinType)for(s.fromArray(g,3*W),u.fromArray(h,3*W),f=0;f<W;++f)s.toArray(g,3*f),u.toArray(h,3*f);else s.toArray(g,C),u.toArray(h,C);return{normal:h,binormal:g}}};NGL.Helixorient=function(a){this.fiber=a;this.size=a.residueCount};
NGL.Helixorient.prototype={constructor:NGL.Helixorient,getFiber:function(a,b){var c=this.getPosition().center,d,e,f,g,h,k=[],l=c.length/3,m=this.fiber;m.computedAtoms.trace||m.computeAtom("trace");var p=m.computedAtoms.trace;for(d=0;d<l;++d){h=p[d];e=h.residue;g=new NGL.Residue;f=new NGL.Atom(g,h.globalindex);g.atoms.push(f);g.atomCount+=1;g.resname=e.resname;g.index=e.index;g.chain=e.chain;e=3*d;f.positionFromArray(c,e);if(a){var r,n,q,t=Math.min(a,d,l-d-1);for(n=1;n<=t;++n)r=3*n,q=(t+1-n)/(t+1),
f.x+=q*c[e-r+0]+q*c[e+r+0],f.y+=q*c[e-r+1]+q*c[e+r+1],f.z+=q*c[e-r+2]+q*c[e+r+2];f.x/=t+1;f.y/=t+1;f.z/=t+1}f.atomname=h.atomname;f.index=h.index;f.resname=h.resname;f.chainname=h.chainname;f.bfactor=h.bfactor;f.ss=h.ss;k.push(g);!b||0!==d&&d!==l-1||k.push(g)}return new NGL.Fiber(k,m.structure)},getColor:function(a){var b=this.size,c=this.fiber,d=new Float32Array(3*b),e=new Float32Array(3*b),f=a||{};f.structure=c.structure;a=NGL.ColorMakerRegistry.getScheme(f);f=NGL.ColorMakerRegistry.getPickingScheme(f);
c.computedAtoms.trace||c.computeAtom("trace");for(var c=c.computedAtoms.trace,g=0;g<b;++g){var h=c[g],k=3*g;a.atomColorToArray(h,d,k);f.atomColorToArray(h,e,k)}return{color:d,pickingColor:e}},getSize:function(a,b){var c=this.size,d=this.fiber,e=new Float32Array(c),f=new NGL.RadiusFactory(a,b);d.computedAtoms.trace||d.computeAtom("trace");for(var d=d.computedAtoms.trace,g=0;g<c;++g)e[g]=f.atomRadius(d[g]);return{size:e}},getPosition:function(){var a=0,b=this.size,c=new Float32Array(3*b),d=new Float32Array(3*
b),e=new Float32Array(b),f=new Float32Array(b),g=new Float32Array(b),h=new Float32Array(b),k=new Float32Array(3*b),l,m,p,r,n=new THREE.Vector3,q=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector3,s=new THREE.Vector3,v=new THREE.Vector3,y=new THREE.Vector3,x=new THREE.Vector3,B=new THREE.Vector3,G=new THREE.Vector3;new THREE.Vector3;var F=new THREE.Vector3(0,0,0);this.fiber.eachAtomN(4,function(b,w,z,L){m=3*a;n.subVectors(w,b);q.subVectors(z,w);t.subVectors(L,z);u.subVectors(n,q);s.subVectors(q,
t);x.crossVectors(u,s).normalize();x.toArray(d,m);0<a&&(e[a]=x.angleTo(B));l=Math.cos(u.angleTo(s));h[a]=180/Math.PI*Math.acos(l);p=u.length();r=s.length();f[a]=Math.sqrt(r*p)/Math.max(2,2*(1-l));g[a]=Math.abs(q.dot(x));v.copy(u).multiplyScalar(f[a]/p);y.copy(s).multiplyScalar(f[a]/r);v.subVectors(w,v);y.subVectors(z,y);v.toArray(c,m+3);y.toArray(c,m+6);G.subVectors(b,F);G.toArray(k,m);a+=1;B.copy(x);F.copy(v)},"trace");var w=this.fiber.residues;v.fromArray(c,3);y.fromArray(c,6);x.subVectors(v,y).normalize();
F.copy(w[0].getTraceAtom());v=NGL.Utils.pointVectorIntersection(F,v,x);v.toArray(c,0);G.subVectors(F,v);G.toArray(k,0);v.fromArray(c,3*b-6);y.fromArray(c,3*b-9);x.subVectors(v,y).normalize();F.copy(w[b-1].getTraceAtom());v=NGL.Utils.pointVectorIntersection(F,v,x);v.toArray(c,3*b-3);for(a=b-3;a<b;++a)v.fromArray(c,3*a),F.copy(w[a].getTraceAtom()),G.subVectors(F,v),G.toArray(k,3*a);var w=new Float32Array(b),z=new Float32Array(b),C=new Float32Array(b),L=new Float32Array(b);w[1]=f[0];z[1]=h[0];C[1]=f[0];
for(a=2;a<b-2;a++)w[a]=.5*(f[a-2]+f[a-1]),z[a]=.5*(h[a-2]+h[a-1]),C[a]=.5*(g[a-2]+g[a-1]),v.fromArray(d,3*(a-2)),y.fromArray(d,3*(a-1)),L[a]=180/Math.PI*Math.acos(Math.cos(v.angleTo(y)));w[b-2]=f[b-4];z[b-2]=h[b-4];C[b-2]=g[b-4];var O=new Float32Array(3*b);NGL.Utils.copyArray(d,O,0,0,3);NGL.Utils.copyArray(d,O,0,3,3);for(a=2;a<b-2;a++)v.fromArray(d,3*(a-2)),y.fromArray(d,3*(a-1)),x.addVectors(y,v).multiplyScalar(.5).normalize(),x.toArray(O,3*a);NGL.Utils.copyArray(d,O,3*b-12,3*b-6,3);NGL.Utils.copyArray(d,
O,3*b-12,3*b-3,3);return{center:c,axis:O,bending:L,radius:w,rise:C,twist:z,resdir:k}}};NGL.Helix=function(){this.begin=new THREE.Vector3;this.end=new THREE.Vector3;this.axis=new THREE.Vector3;this.center=new THREE.Vector3;this.length=0;this.residues=[];this.size=0};
NGL.Helix.prototype={constructor:NGL.Helix,fromHelixbundleAxis:function(){var a=new THREE.Vector3;return function(b,c){this.begin.fromArray(b.begin,3*c);this.end.fromArray(b.end,3*c);this.axis.fromArray(b.axis,3*c);this.center.fromArray(b.center,3*c);this.length=a.subVectors(this.begin,this.end).length();this.residues=b.residue[c];this.size=this.residues.length;return this}}(),angleTo:function(){var a=new THREE.Vector3;return function(b){var c=a.crossVectors(this.axis,b.axis).length();b=this.axis.dot(b.axis);
c=Math.atan2(c,b);return 0>b?-c:c}}(),distanceTo:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d){this.crossingPoints(d,a,b);c.subVectors(b,a);return c.length()}}(),crossingPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g){f||(f=new THREE.Vector3);g||(g=new THREE.Vector3);a.crossVectors(this.axis,e.axis);b.subVectors(e.begin,this.begin);var h=a.dot(a),k=c.crossVectors(b,e.axis).dot(a),
l=d.crossVectors(b,this.axis).dot(a);f.copy(this.axis).multiplyScalar(k/h).add(this.begin);g.copy(e.axis).multiplyScalar(l/h).add(e.begin);return[f,g]}}(),crossing:function(a){var b={},c=this.angleTo(a)/(Math.PI/180),d=this.crossingPoints(a),e=NGL.Utils.isPointOnSegment(d[0],this.begin,this.end)&&NGL.Utils.isPointOnSegment(d[1],a.begin,a.end),f=NGL.Utils.pointVectorIntersection(this.begin,a.begin,a.axis),g=NGL.Utils.pointVectorIntersection(this.end,a.begin,a.axis),h=NGL.Utils.pointVectorIntersection(a.begin,
this.begin,this.axis),k=NGL.Utils.pointVectorIntersection(a.end,this.begin,this.axis),l=NGL.Utils.isPointOnSegment(f,a.begin,a.end),m=NGL.Utils.isPointOnSegment(g,a.begin,a.end),p=NGL.Utils.isPointOnSegment(h,this.begin,this.end),r=NGL.Utils.isPointOnSegment(k,this.begin,this.end),n=[0,0,0,0];l&&m&&(n[0]=f.distanceTo(g));p&&r&&(n[1]=h.distanceTo(k));l&&!m&&(g.distanceTo(a.begin)<g.distanceTo(a.end)?n[2]=f.distanceTo(a.begin):n[2]=f.distanceTo(a.end));!l&&m&&(f.distanceTo(a.begin)<f.distanceTo(a.end)?
n[2]=g.distanceTo(a.begin):n[2]=g.distanceTo(a.end));p&&!r&&(k.distanceTo(this.begin)<k.distanceTo(this.end)?n[3]=h.distanceTo(this.begin):n[3]=h.distanceTo(this.end));!p&&r&&(h.distanceTo(this.begin)<h.distanceTo(this.end)?n[3]=k.distanceTo(this.begin):n[3]=k.distanceTo(this.end));var q=Math.max.apply(null,n),t=[l,m,p,r];if(e)b={distance:this.distanceTo(a),contact:!0,p1:d[0],p2:d[1]};else{d=[];if(120<c||60>c)d.push({distance:this.begin.distanceTo(f),contact:l,p1:this.begin,p2:f}),d.push({distance:this.end.distanceTo(g),
contact:m,p1:this.end,p2:g}),d.push({distance:a.begin.distanceTo(h),contact:p,p1:a.begin,p2:h}),d.push({distance:a.end.distanceTo(k),contact:r,p1:a.end,p2:k});0<q&&(120<c||60>c)&&(d.push({distance:this.begin.distanceTo(a.begin),contact:!0,p1:this.begin,p2:a.begin}),d.push({distance:this.begin.distanceTo(a.end),contact:!0,p1:this.begin,p2:a.end}),d.push({distance:this.end.distanceTo(a.begin),contact:!0,p1:this.end,p2:a.begin}),d.push({distance:this.end.distanceTo(a.end),contact:!0,p1:this.end,p2:a.end}));
b.distance=Infinity;d.forEach(function(a){a.contact&&a.distance<b.distance&&(b=a)})}return Object.assign({distance:Infinity,contact:!1,angle:c,onSegment:t,overlap:n,maxOverlap:q,lineContact:e},b)}};NGL.Helixbundle=function(a){this.fiber=a;this.helixorient=new NGL.Helixorient(a);this.position=this.helixorient.getPosition();this.size=a.residueCount};
NGL.Helixbundle.prototype={constructor:NGL.Helixbundle,getFiber:function(a){},getColor:function(a){},getSize:function(a,b){},getAxis:function(a,b,c,d,e,f){a=a||30;b=b||2.5;c=void 0===c?!1:c;var g=this.position,h=d||{};h.structure=this.fiber.structure;d=NGL.ColorMakerRegistry.getScheme(h);h=NGL.ColorMakerRegistry.getPickingScheme(h);e=new NGL.RadiusFactory(e,f);var k,l,m=0,p=0,r=this.size,n=this.fiber.residues,q=[],t=[],u=[],s=[],v=[],y=[],x=[],B=[],G=[];l=[];var F,w=new THREE.Vector3,z=new THREE.Vector3,
C=new THREE.Vector3,L=new THREE.Vector3,G=!1;for(f=0;f<r;++f)k=n[f],C.fromArray(g.center,3*f),f===r-1?G=!0:(l=n[f+1],L.fromArray(g.center,3*f+3),c&&k.ss!==l.ss?G=!0:C.distanceTo(L)>b?G=!0:g.bending[f]>a&&(G=!0)),G&&(4>f-m||(k=k.getTraceAtom(),G=g.axis.subarray(3*m+3,3*f),l=g.center.subarray(3*m,3*f+3),G=NGL.Utils.calculateMeanVector3(G).normalize(),F=NGL.Utils.calculateMeanVector3(l),w.fromArray(l),w=NGL.Utils.pointVectorIntersection(w,F,G),z.fromArray(l,l.length-3),z=NGL.Utils.pointVectorIntersection(z,
F,G),G.subVectors(z,w),G.toArray(q,p),F.toArray(t,p),w.toArray(u,p),z.toArray(s,p),d.atomColorToArray(k,v,p),h.atomColorToArray(k,y,p),x.push(e.atomRadius(k)),B.push(n.slice(m,f+1)),p+=3),m=f,G=!1);return{axis:new Float32Array(q),center:new Float32Array(t),begin:new Float32Array(u),end:new Float32Array(s),color:new Float32Array(v),pickingColor:new Float32Array(y),size:new Float32Array(x),residue:B}},getPosition:function(){}};NGL.HelixCrossing=function(a){this.helices=a};
NGL.HelixCrossing.prototype={constructor:NGL.HelixCrossing,getCrossing:function(a){a=a||12;for(var b=this.helices,c=[],d=[],e=[],f=[],g=[],h=0,k=0;k<b.length;++k){var l=b[k];c.push("H"+(k+1));l.center.toArray(d,3*k);for(var m=k+1;m<b.length;++m){var p=l.crossing(b[m]);p.contact&&p.distance<a&&(g.push({helix1:k+1,helix2:m+1,angle:p.angle,distance:p.distance,overlap:p.maxOverlap}),p.p1.toArray(e,3*h),p.p2.toArray(f,3*h),h+=1)}}return{helixLabel:c,helixCenter:d,begin:e,end:f,info:g}}};
NGL.Kdtree=function(a,b){var c=b?function(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e}:function(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return Math.sqrt(c*c+d*d+e*e)};if(a instanceof NGL.AtomSet||a instanceof NGL.Structure||a instanceof NGL.StructureSubset)a=a.atoms;for(var d=a.length,e=new Float32Array(4*d),f=0;f<d;++f){var g=a[f],h=4*f;e[h+0]=g.x;e[h+1]=g.y;e[h+2]=g.z;e[h+3]=f}this.points=e;this.atoms=a;this.kdtree=new THREE.TypedArrayUtils.Kdtree(e,c,4,3)};
NGL.Kdtree.prototype={nearest:function(){var a=new Float32Array(3);return function(b,c,d){b instanceof THREE.Vector3?b.toArray(a):(b instanceof NGL.Atom||b instanceof NGL.ProxyAtom)&&b.positionToArray(a);b=this.kdtree.nearest(a,c,d);c=this.atoms;d=[];for(var e=0,f=b.length;e<f;++e){var g=b[e];d.push({atom:c[this.points[g[0].pos+3]],distance:g[1]})}return d}}()};NGL.Contact=function(a,b){this.atomSet1=a;this.atomSet2=b;this.kdtree1=new NGL.Kdtree(a);this.kdtree2=new NGL.Kdtree(b)};
NGL.Contact.prototype={within:function(a,b){NGL.time("NGL.Contact within");for(var c=new NGL.AtomSet,d=new NGL.BondSet,e=this.kdtree2,f=this.atomSet1.atoms,g=0,h=f.length;g<h;++g){for(var k=f[g],l=!1,m=e.nearest(k,Infinity,a),p=0,r=m.length;p<r;++p){var n=m[p],q=n.atom,n=n.distance;k.residue!==q.residue&&(!b||n>b)&&(l=!0,c.addAtom(q),d.addBond(k,q,!0))}l&&c.addAtom(k)}NGL.timeEnd("NGL.Contact within");return{atomSet:c,bondSet:d}}};
NGL.polarContacts=function(a,b,c){b=b||3.5;c=c||40;var d=new NGL.Selection("( ARG and ( .NE or .NH1 or .NH2 ) ) or ( ASP and .ND2 ) or ( GLN and .NE2 ) or ( HIS and ( .ND1 or .NE2 ) ) or ( LYS and .NZ ) or ( SER and .OG ) or ( THR and .OG1 ) or ( TRP and .NE1 ) or ( TYR and .OH ) or ( PROTEIN and .N )"),e=new NGL.Selection("( ASN and .OD1 ) or ( ASP and ( OD1 or .OD2 ) ) or ( GLN and .OE1 ) or ( GLU and ( .OE1 or .OE2 ) ) or ( HIS and ( .ND1 or .NE2 ) ) or ( SER and .OG ) or ( THR and .OG1 ) or ( TYR and .OH ) or ( PROTEIN and .O )"),
d=new NGL.AtomSet(a,d),e=new NGL.AtomSet(a,e);b=(new NGL.Contact(d,e)).within(b);b.atomSet.structure=a;b.bondSet.structure=a;var f=new NGL.BondSet,g=new THREE.Vector3,h=new THREE.Vector3;b.bondSet.eachBond(function(a){var b=a.atom1;a=a.atom2;if(!("O"===b.atomname&&"N"===a.atomname||"N"===b.atomname&&"O"===a.atomname))if("N"===b.atomname||"N"===a.atomname){var d,e;"N"===b.atomname?(d=b,e=a):(d=a,e=b);var r=d.residue.getAtomByName("CA");if(r){var n=d.residue.getPreviousConnectedResidue();n&&(n=n.getAtomByName("C"))&&
(g.subVectors(d,n),h.subVectors(d,r),g.add(h).multiplyScalar(.5),h.subVectors(e,d),THREE.Math.radToDeg(g.angleTo(h))<c&&f.addBond(b,a,!0))}}else"OH"===b.atomname&&"TYR"===b.resname||"OH"===a.atomname&&"TYR"===a.resname?("OH"===b.atomname?(d=b,e=a):(d=a,e=b),r=d.residue.getAtomByName("CZ"),g.subVectors(r,d),h.subVectors(r,e),THREE.Math.radToDeg(g.angleTo(h))<c&&f.addBond(b,a,!0)):f.addBond(b,a,!0)});f.structure=a;b.bondSet.dispose();d.dispose();e.dispose();return{atomSet:b.atomSet,bondSet:f}};
NGL.polarBackboneContacts=function(a,b,c){b=b||3.5;c=c||40;var d=new NGL.Selection("( PROTEIN and .N )"),e=new NGL.Selection("( PROTEIN and .O )"),d=new NGL.AtomSet(a,d),e=new NGL.AtomSet(a,e);b=(new NGL.Contact(d,e)).within(b);b.atomSet.structure=a;b.bondSet.structure=a;var f=new NGL.BondSet,g=new THREE.Vector3,h=new THREE.Vector3;b.bondSet.eachBond(function(a){var b=a.atom1;a=a.atom2;var d,e;"N"===b.atomname?(d=b,e=a):(d=a,e=b);var r=d.residue.getAtomByName("CA");if(r){var n=d.residue.getPreviousConnectedResidue();
n&&(n=n.getAtomByName("C"))&&(g.subVectors(d,n),h.subVectors(d,r),g.add(h).multiplyScalar(.5),h.subVectors(e,d),THREE.Math.radToDeg(g.angleTo(h))<c&&f.addBond(b,a,!0))}});f.structure=a;b.bondSet.dispose();d.dispose();e.dispose();return{atomSet:b.atomSet,bondSet:f}};NGL.Selection=function(a,b){this.signals={stringChanged:new signals.Signal};this.setString(a,b)};
NGL.Selection.prototype={constructor:NGL.Selection,setString:function(a,b,c){void 0===a&&(a=this.string||"");void 0===b&&(b=this.extraString||"");if(a!==this.string||b!==this.extraString){var d;d=a||b?a?b?"( "+a+" ) and ( "+b+" )":a:b:"";if(d!==this.combinedString){try{this.parse(d)}catch(e){this.selection={error:e.message}}this.string=a;this.extraString=b;this.combinedString=d;this.test=this.makeAtomTest();this.residueTest=this.makeResidueTest();this.chainTest=this.makeChainTest();this.modelTest=
this.makeModelTest();this.atomOnlyTest=this.makeAtomTest(!0);this.residueOnlyTest=this.makeResidueTest(!0);this.chainOnlyTest=this.makeChainTest(!0);this.modelOnlyTest=this.makeModelTest(!0);c||this.signals.stringChanged.dispatch(this.string)}}},parse:function(a){this.selection={operator:void 0,rules:[]};if(a){var b=this,c=this.selection,d=[],e,f;a=a.replace(/\(/g," ( ").replace(/\)/g," ) ").trim();"("===a.charAt(0)&&")"===a.substr(-1)&&(a=a.slice(1,-1).trim());a=a.split(/\s+/);var g=["*","","ALL"],
h,k,l,m,p=function(a){e={operator:a,rules:[]};void 0===c?(c=e,b.selection=e):(c.rules.push(e),d.push(c),c=e)},r=function(a){f=c;c=d.pop();void 0===c&&(p(a),n(f))},n=function(a){c.rules.push(a)};for(l=0;l<a.length;++l)if(h=a[l],"("===h)m=!1,p();else if(")"===h)r(),c.negate&&r();else{if(0<m)if("NOT"===h.toUpperCase())m=1;else if(1===m)m=2;else if(2===m)m=!1,r();else throw Error("something went wrong with 'not'");if("AND"===h.toUpperCase())"OR"===c.operator?(k=c.rules.pop(),p("AND"),n(k)):c.operator=
"AND";else if("OR"===h.toUpperCase())"AND"===c.operator?r("OR"):c.operator="OR";else if("NOT"===h.toUpperCase())m=1,p(),c.negate=!0;else if(k={},"HETERO"===h.toUpperCase())k.keyword="HETERO",n(k);else if("WATER"===h.toUpperCase())k.keyword="WATER",n(k);else if("PROTEIN"===h.toUpperCase())k.keyword="PROTEIN",n(k);else if("NUCLEIC"===h.toUpperCase())k.keyword="NUCLEIC",n(k);else if("RNA"===h.toUpperCase())k.keyword="RNA",n(k);else if("DNA"===h.toUpperCase())k.keyword="DNA",n(k);else if("POLYMER"===
h.toUpperCase())k.keyword="POLYMER",n(k);else if("HYDROGEN"===h.toUpperCase())k.element="H",n(k);else if("SMALL"===h.toUpperCase())k={operator:"OR",rules:[{resname:"GLY"},{resname:"ALA"}]},n(k);else if("NUCLEOPHILIC"===h.toUpperCase())k={operator:"OR",rules:[{resname:"SER"},{resname:"THR"},{resname:"CYS"}]},n(k);else if("HYDROPHOBIC"===h.toUpperCase())k={operator:"OR",rules:[{resname:"VAL"},{resname:"LEU"},{resname:"ILE"},{resname:"MET"},{resname:"PRO"}]},n(k);else if("AROMATIC"===h.toUpperCase())k=
{operator:"OR",rules:[{resname:"PHE"},{resname:"TYR"},{resname:"TRP"}]},n(k);else if("AMIDE"===h.toUpperCase())k={operator:"OR",rules:[{resname:"ASN"},{resname:"GLN"}]},n(k);else if("ACIDIC"===h.toUpperCase())k={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"}]},n(k);else if("BASIC"===h.toUpperCase())k={operator:"OR",rules:[{resname:"HIS"},{resname:"LYS"},{resname:"ARG"}]},n(k);else if("CHARGED"===h.toUpperCase())k={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"},{resname:"HIS"},{resname:"LYS"},
{resname:"ARG"}]},n(k);else if("POLAR"===h.toUpperCase())k={operator:"OR",rules:[{resname:"ASP"},{resname:"GLU"},{resname:"HIS"},{resname:"LYS"},{resname:"ARG"},{resname:"ASN"},{resname:"GLN"},{resname:"SER"},{resname:"THR"},{resname:"TYR"}]},n(k);else if("NONPOLAR"===h.toUpperCase())k={operator:"OR",rules:[{resname:"ALA"},{resname:"CYS"},{resname:"GLY"},{resname:"ILE"},{resname:"LEU"},{resname:"MET"},{resname:"PHE"},{resname:"PRO"},{resname:"VAL"},{resname:"TRP"}]},n(k);else if("HELIX"===h.toUpperCase())k.keyword=
"HELIX",n(k);else if("SHEET"===h.toUpperCase())k.keyword="SHEET",n(k);else if("TURN"===h.toUpperCase())k={operator:"OR",negate:!0,rules:[{keyword:"HELIX"},{keyword:"SHEET"}]},n(k);else if("BACKBONE"===h.toUpperCase())k.keyword="BACKBONE",n(k);else if("SIDECHAIN"===h.toUpperCase())k.keyword="SIDECHAIN",n(k);else if("SIDECHAINATTACHED"===h.toUpperCase())k={operator:"OR",rules:[{operator:"AND",negate:!1,rules:[{resname:"PRO"},{atomname:"N"}]},{keyword:"SIDECHAIN"},{atomname:"CA"},{atomname:"BB"}]},n(k);
else if(-1!==g.indexOf(h.toUpperCase()))k.keyword="ALL",n(k);else if("#"===h.charAt(0))k.element=h.substr(1).toUpperCase(),n(k);else if("~"===h.charAt(0))k.altloc=h.substr(1),n(k);else if(1<=h.length&&4>=h.length&&":"!==h[0]&&"."!==h[0]&&"/"!==h[0]&&isNaN(parseInt(h)))k.resname=h.toUpperCase(),n(k);else{k={operator:"AND",rules:[]};h=h.split("/");if(1<h.length&&h[1]){if(isNaN(parseInt(h[1])))throw Error("model must be an integer");k.rules.push({model:parseInt(h[1])})}h=h[0].split(".");if(1<h.length&&
h[1]){if(4<h[1].length)throw Error("atomname must be one to four characters");k.rules.push({atomname:h[1].substring(0,4).toUpperCase()})}h=h[0].split(":");1<h.length&&h[1]&&k.rules.push({chainname:h[1]});if(h[0])if(h=h[0].split("-"),1===h.length){h=parseInt(h[0]);if(isNaN(h))throw Error("resi must be an integer");k.rules.push({resno:h})}else if(2===h.length)k.rules.push({resno:[parseInt(h[0]),parseInt(h[1])]});else throw Error("resi range must contain one '-'");if(1===k.rules.length)n(k.rules[0]);
else if(1<k.rules.length)n(k);else throw Error("empty selection chunk");}}void 0===this.selection.operator&&1===this.selection.rules.length&&this.selection.rules[0].hasOwnProperty("operator")&&(this.selection=this.selection.rules[0])}},_makeTest:function(a,b){void 0===b&&(b=this.selection);if(null===b||b.error)return!1;var c=b.rules.length;if(0===c)return!1;for(var d=b.negate?!1:!0,e=b.negate?!0:!1,f,g,h,k,l=[],m=0;m<c;++m)f=b.rules[m],f.hasOwnProperty("operator")&&(l[m]=this._makeTest(a,f));return function(m){g=
"AND"===b.operator;k=!1;for(var r=0;r<c;++r){f=b.rules[r];if(f.hasOwnProperty("operator"))h=l[r]?l[r](m):-1;else{if(void 0!==f.keyword&&"ALL"===f.keyword)if(g)continue;else return d;h=a(m,f)}if(-1===h)k=!0;else if(!0===h){if(!g)return d}else if(g)return e}return k?-1:g?d:e}},_filter:function(a,b){void 0===b&&(b=this.selection);if(b.error)return b;var c=b.rules.length;if(0===c)return b;var d=[];b.hasOwnProperty("negate");for(var e=0;e<c;++e){var f=b.rules[e];f.hasOwnProperty("operator")?(f=this._filter(a,
f),null!==f&&d.push(f)):a(f)||d.push(f)}return 0<d.length?b:null},makeAtomTest:function(a){var b="CA C N O O1 O2 OC1 OC2 H H1 H2 H3 HA".split(" "),c="P O3' O5' C5' C4' C3' OP1 OP2 O3* O5* C5* C4* C3*".split(" "),d=["CA","BB"],e=["h","g","i"];a=a?this._filter(function(a){return void 0!==a.model||void 0!==a.chainname||void 0!==a.resname||void 0!==a.resno?!0:!1}):this.selection;return this._makeTest(function(a,g){if(void 0!==g.keyword)return"HETERO"===g.keyword&&1===a.hetero||"PROTEIN"===g.keyword&&
(a.residue.isProtein()||a.residue.isCg())||"NUCLEIC"===g.keyword&&a.residue.isNucleic()||"RNA"===g.keyword&&a.residue.isRna()||"DNA"===g.keyword&&a.residue.isDna()||"POLYMER"===g.keyword&&(a.residue.isProtein()||a.residue.isNucleic()||a.residue.isCg())||"WATER"===g.keyword&&a.residue.isWater()||"HELIX"===g.keyword&&-1!==e.indexOf(a.ss)||"SHEET"===g.keyword&&"s"===a.ss||"BACKBONE"===g.keyword&&(a.residue.isProtein()&&-1!==b.indexOf(a.atomname)||a.residue.isNucleic()&&-1!==c.indexOf(a.atomname)||a.residue.isCg()&&
-1!==d.indexOf(a.atomname))||"SIDECHAIN"===g.keyword&&(a.residue.isProtein()&&-1===b.indexOf(a.atomname)||a.residue.isNucleic()&&-1===c.indexOf(a.atomname)||a.residue.isCg()&&-1===d.indexOf(a.atomname))?!0:!1;if(void 0!==g.resname&&g.resname!==a.resname||void 0!==g.chainname&&g.chainname!==a.chainname||void 0!==g.atomname&&g.atomname!==a.atomname||void 0!==g.model&&g.model!==a.residue.chain.model.index)return!1;if(void 0!==g.resno)if(Array.isArray(g.resno)&&2===g.resno.length){if(g.resno[0]>a.resno||
g.resno[1]<a.resno)return!1}else if(g.resno!==a.resno)return!1;return void 0!==g.element&&g.element!==a.element||void 0!==g.altloc&&g.altloc!==a.altloc?!1:!0},a)},makeResidueTest:function(a){a=a?this._filter(function(a){return void 0!==a.model||void 0!==a.chainname||void 0!==a.atomname||void 0!==a.element||void 0!==a.altloc?!0:!1}):this.selection;return this._makeTest(function(a,c){if(void 0!==c.keyword&&("HETERO"===c.keyword&&a.isHetero()||"PROTEIN"===c.keyword&&(a.isProtein()||a.isCg())||"NUCLEIC"===
c.keyword&&a.isNucleic()||"RNA"===c.keyword&&a.isRna()||"DNA"===c.keyword&&a.isDna()||"POLYMER"===c.keyword&&(a.isProtein()||a.isNucleic()||a.isCg())||"WATER"===c.keyword&&a.isWater()))return!0;if(void 0===c.chainname&&void 0===c.model&&void 0===c.resname&&void 0===c.resno||void 0!==c.chainname&&void 0===a.chain.chainname||void 0!==c.chainname&&""===a.chain.chainname)return-1;if(void 0!==c.resname&&c.resname!==a.resname||void 0!==c.chainname&&c.chainname!==a.chain.chainname||void 0!==c.model&&c.model!==
a.chain.model.index)return!1;if(void 0!==c.resno)if(Array.isArray(c.resno)&&2===c.resno.length){if(c.resno[0]>a.resno||c.resno[1]<a.resno)return!1}else if(c.resno!==a.resno)return!1;return!0},a)},makeChainTest:function(a){a=a?this._filter(function(a){return void 0!==a.model||void 0!==a.resname||void 0!==a.resno||void 0!==a.atomname||void 0!==a.element||void 0!==a.altloc?!0:!1}):this.selection;return this._makeTest(function(a,c){return void 0!==c.chainname&&void 0===a.chainname||void 0===c.chainname&&
void 0===c.model||void 0!==c.chainname&&""===a.chainname?-1:void 0!==c.chainname&&c.chainname!==a.chainname||void 0!==c.model&&c.model!==a.model.index?!1:!0},a)},makeModelTest:function(a){a=a?this._filter(function(a){return void 0!==a.chainname||void 0!==a.resname||void 0!==a.resno||void 0!==a.atomname||void 0!==a.element||void 0!==a.altloc?!0:!1}):this.selection;return this._makeTest(function(a,c){return void 0===c.model?-1:c.model!==a.index?!1:!0},a)}};
NGL.Matrix=function(a,b){return new jsfeat.matrix_t(a,b,jsfeat.F32_t|jsfeat.C1_t)};
NGL.Superposition=function(a,b){var c;"function"===typeof a.eachAtom?c=a.atomCount:a instanceof Float32Array&&(c=a.length/3);var d=new NGL.Matrix(3,c),e=new NGL.Matrix(3,c);this.coords1t=new NGL.Matrix(c,3);this.coords2t=new NGL.Matrix(c,3);this.A=new NGL.Matrix(3,3);this.W=new NGL.Matrix(1,3);this.U=new NGL.Matrix(3,3);this.V=new NGL.Matrix(3,3);this.VH=new NGL.Matrix(3,3);this.R=new NGL.Matrix(3,3);this.tmp=new NGL.Matrix(3,3);this.c=new NGL.Matrix(3,3);this.c.data.set([1,0,0,0,1,0,0,0,-1]);this.prepCoords(a,
d);this.prepCoords(b,e);this._superpose(d,e)};
NGL.Superposition.prototype={constructor:NGL.Superposition,_superpose:function(a,b){this.mean1=jsfeat.matmath.mean_rows(a);this.mean2=jsfeat.matmath.mean_rows(b);jsfeat.matmath.sub_rows(a,this.mean1);jsfeat.matmath.sub_rows(b,this.mean2);jsfeat.matmath.transpose(this.coords1t,a);jsfeat.matmath.transpose(this.coords2t,b);jsfeat.matmath.multiply_ABt(this.A,this.coords2t,this.coords1t);jsfeat.linalg.svd_decompose(this.A,this.W,this.U,this.V);jsfeat.matmath.invert_3x3(this.V,this.VH);jsfeat.matmath.multiply_3x3(this.R,
this.U,this.VH);0>jsfeat.matmath.mat3x3_determinant(this.R)&&(NGL.log("R not a right handed system"),jsfeat.matmath.multiply_3x3(this.tmp,this.c,this.VH),jsfeat.matmath.multiply_3x3(this.R,this.U,this.tmp))},prepCoords:function(a,b){var c=0,d=b.data;"function"===typeof a.eachAtom?a.eachAtom(function(a){d[c+0]=a.x;d[c+1]=a.y;d[c+2]=a.z;c+=3}):a instanceof Float32Array?d.set(a):NGL.warn("prepCoords: input type unknown")},transform:function(a){var b;"function"===typeof a.eachAtom?b=a.atomCount:a instanceof
Float32Array&&(b=a.length/3);var c=new NGL.Matrix(3,b),d=new NGL.Matrix(b,3);this.prepCoords(a,c);jsfeat.matmath.sub_rows(c,this.mean1);jsfeat.matmath.multiply_ABt(d,this.R,c);jsfeat.matmath.transpose(c,d);jsfeat.matmath.add_rows(c,this.mean2);var e=0,f=c.data;"function"===typeof a.eachAtom?a.eachAtom(function(a){a.x=f[e+0];a.y=f[e+1];a.z=f[e+2];e+=3}):a instanceof Float32Array?a.set(f.subarray(0,3*b)):NGL.warn("transform: input type unknown")}};
NGL.superpose=function(a,b,c,d,e,f,g){d=d||"";e=e||"";f=f||"";g=g||"";var h,k;if(c){c=a;var l=b;d&&e&&(c=new NGL.StructureSubset(a,new NGL.Selection(d)),l=new NGL.StructureSubset(b,new NGL.Selection(e)));b=c.getSequence();d=l.getSequence();d=new NGL.Alignment(b.join(""),d.join(""));d.calc();d.trace();var m,p,r,n,q=0,t=0;b=d.ali1.length;var u=[],s=[];for(e=0;e<b;++e)r=d.ali1[e],n=d.ali2[e],p=m=0,"-"===r?s[t]=!1:(s[t]=!0,m=1),"-"===n?u[q]=!1:(u[q]=!0,p=1),q+=m,t+=p;h=new NGL.AtomSet;k=new NGL.AtomSet;
q=0;c.eachResidue(function(a){a.getResname1()&&a.getAtomByName("CA")&&(u[q]&&h.addAtom(a.getAtomByName("CA")),q+=1)});q=0;l.eachResidue(function(a){a.getResname1()&&a.getAtomByName("CA")&&(s[q]&&k.addAtom(a.getAtomByName("CA")),q+=1)})}else h=new NGL.AtomSet(a,new NGL.Selection(d+" and .CA")),k=new NGL.AtomSet(b,new NGL.Selection(e+" and .CA"));if(f&&g){c=new NGL.AtomSet;l=new NGL.AtomSet;f=new NGL.Selection(f);b=new NGL.Selection(g);g=f.test;f=b.test;b=h.atomCount;for(q=0;q<b;++q)d=h.atoms[q],e=
k.atoms[q],g(d)&&f(e)&&(c.addAtom(d),l.addAtom(e));h=c;k=l}g=new NGL.Superposition(h,k);f=new NGL.AtomSet(a,new NGL.Selection("*"));g.transform(f);a.center=a.atomCenter()};
NGL.ElementColors={H:16777215,HE:14286847,LI:13402367,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,NE:11789301,NA:11230450,MG:9109248,AL:12560038,SI:1578E4,P:16744448,S:16777008,CL:2093087,AR:8442339,K:9388244,CA:4062976,SC:15132390,TI:12567239,V:10921643,CR:9083335,MN:10255047,FE:14706227,CO:15765664,NI:5296208,CU:13140019,ZN:8224944,GA:12750735,GE:6721423,AS:12419299,SE:16752896,BR:10889513,KR:6076625,RB:7351984,SR:65280,Y:9764863,ZR:9756896,NB:7586505,MO:5551541,TC:3907230,RU:2396047,
RH:687500,PD:27013,AG:12632256,CD:16767375,IN:10909043,SN:6717568,SB:10380213,TE:13924864,I:9699476,XE:9699476,CS:5707663,BA:51456,LA:7394559,CE:16777159,PR:14286791,ND:13107143,PM:10747847,SM:9437127,EU:6422471,GD:4587463,TB:3211207,DY:2097095,HO:65436,ER:58997,TM:54354,YB:48952,LU:43812,HF:5096191,TA:5089023,W:2200790,RE:2522539,OS:2516630,IR:1528967,PT:13684960,AU:16765219,HG:12105936,TL:10900557,PB:5724513,BI:10375093,PO:11230208,AT:7688005,RN:4358806,FR:4325478,RA:32E3,AC:7384058,TH:47871,PA:41471,
U:36863,NP:33023,PU:27647,AM:5528818,CM:7888099,BK:9064419,CF:10565332,ES:11739092,FM:11739066,MD:11734438,NO:12389767,LR:13041766,RF:13369433,DB:13697103,SG:14221381,BH:14680120,HS:15073326,MT:15400998,DS:16777215,RG:16777215,CN:16777215,UUT:16777215,FL:16777215,UUP:16777215,LV:16777215,UUH:16777215,D:16777152,T:16777120,"":16777215};
NGL.ResidueColors={ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935,ASH:16711935,GLH:16711935,A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576,DA:10526975,DG:16740464,DI:8454143,DC:16747595,DT:10551200,DU:16744576,"":16711935};
NGL.StructureColors={alphaHelix:16711808,"3_10Helix":10485888,piHelix:6291584,betaStrand:16762880,betaTurn:6324479,coil:16777215,dna:11403518,rna:16580962,carbohydrate:10921722,"":8421504};NGL.HelixTypes={1:"h",2:"h",3:"i",4:"h",5:"g",6:"h",7:"h",8:"h",9:"h",10:"h","":"h"};
NGL.VdwRadii={H:1.1,HE:1.4,LI:1.81,BE:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,NE:1.54,NA:2.27,MG:1.73,AL:1.84,SI:2.1,P:1.8,S:1.8,CL:1.75,AR:1.88,K:2.75,CA:2.31,SC:2.3,TI:2.15,V:2.05,CR:2.05,MN:2.05,FE:2.05,CO:2,NI:2,CU:2,ZN:2.1,GA:1.87,GE:2.11,AS:1.85,SE:1.9,BR:1.83,KR:2.02,RB:3.03,SR:2.49,Y:2.4,ZR:2.3,NB:2.15,MO:2.1,TC:2.05,RU:2.05,RH:2,PD:2.05,AG:2.1,CD:2.2,IN:2.2,SN:1.93,SB:2.17,TE:2.06,I:1.98,XE:2.16,CS:3.43,BA:2.68,LA:2.5,CE:2.48,PR:2.47,ND:2.45,PM:2.43,SM:2.42,EU:2.4,GD:2.38,TB:2.37,DY:2.35,
HO:2.33,ER:2.32,TM:2.3,YB:2.28,LU:2.27,HF:2.25,TA:2.2,W:2.1,RE:2.05,OS:2,IR:2,PT:2.05,AU:2.1,HG:2.05,TL:1.96,PB:2.02,BI:2.07,PO:1.97,AT:2.02,RN:2.2,FR:3.48,RA:2.83,AC:2,TH:2.4,PA:2,U:2.3,NP:2,PU:2,AM:2,CM:2,BK:2,CF:2,ES:2,FM:2,MD:2,NO:2,LR:2,RF:2,DB:2,SG:2,BH:2,HS:2,MT:2,DS:2,RG:2,CN:2,UUT:2,FL:2,UUP:2,LV:2,UUH:2,"":2};
NGL.CovalentRadii={H:.31,HE:.28,LI:1.28,BE:.96,B:.84,C:.76,N:.71,O:.66,F:.57,NE:.58,NA:1.66,MG:1.41,AL:1.21,SI:1.11,P:1.07,S:1.05,CL:1.02,AR:1.06,K:2.03,CA:1.76,SC:1.7,TI:1.6,V:1.53,CR:1.39,MN:1.39,FE:1.32,CO:1.26,NI:1.24,CU:1.32,ZN:1.22,GA:1.22,GE:1.2,AS:1.19,SE:1.2,BR:1.2,KR:1.16,RB:2.2,SR:1.95,Y:1.9,ZR:1.75,NB:1.64,MO:1.54,TC:1.47,RU:1.46,RH:1.42,PD:1.39,AG:1.45,CD:1.44,IN:1.42,SN:1.39,SB:1.39,TE:1.38,I:1.39,XE:1.4,CS:2.44,BA:2.15,LA:2.07,CE:2.04,PR:2.03,ND:2.01,PM:1.99,SM:1.98,EU:1.98,GD:1.96,
TB:1.94,DY:1.92,HO:1.92,ER:1.89,TM:1.9,YB:1.87,LU:1.87,HF:1.75,TA:1.7,W:1.62,RE:1.51,OS:1.44,IR:1.41,PT:1.36,AU:1.36,HG:1.32,TL:1.45,PB:1.46,BI:1.48,PO:1.4,AT:1.5,RN:1.5,FR:2.6,RA:2.21,AC:2.15,TH:2.06,PA:2,U:1.96,NP:1.9,PU:1.87,AM:1.8,CM:1.69,BK:1.6,CF:1.6,ES:1.6,FM:1.6,MD:1.6,NO:1.6,LR:1.6,RF:1.6,DB:1.6,SG:1.6,BH:1.6,HS:1.6,MT:1.6,DS:1.6,RG:1.6,CN:1.6,UUT:1.6,FL:1.6,UUP:1.6,LV:1.6,UUH:1.6,"":1.6};
NGL.ResidueRadii={"2QY":6.58,CY0:11.98,"2QZ":2.52,CY1:6.59,HHK:5.11,CXM:4.69,HHI:4.58,CY4:4.57,S12:18.57,CY3:2.79,C5C:5.35,PFX:11.84,"2R3":6.94,"2R1":3.78,ILX:4.99,"32S":5.68,BTK:8.59,"32T":5.72,FAK:9.8,B27:2.78,ILM:3.84,C4R:5.63,"32L":6.75,SYS:3.01,"1MH":5.04,ILE:3.65,YNM:6.39,"2RX":4.91,B3A:2.48,GEE:4.76,"7MN":7.34,B3E:5.4,ARG:6.33,200:6.89,HIP:5.47,HIA:4.64,B3K:5.89,HIC:5.76,B3L:4.96,B3M:5.07,ARM:6.86,ARO:7.35,AR4:8.42,PG1:10.67,YOF:6.44,IML:3.74,SXE:6.65,HIQ:7.98,PFF:6.31,HIS:4.52,"0TD":3.62,
C3Y:5.24,"1OP":11.55,"02Y":4.77,"02V":4.83,ASB:5.59,"30V":8.53,S2P:4.81,ASP:3.55,ASN:3.54,"2OR":6.91,QMM:6.13,"2P0":8.52,ASL:5.36,HFA:5.14,"5PG":5.69,B3X:4.38,AS9:4.1,ARV:7.59,B3U:6.06,S2C:7.54,B3T:3.34,175:5.64,GFT:8.18,HG7:6.8,B3Q:4.48,ASA:3.64,"02K":2.94,B3Y:7.45,PHD:5.35,C6C:6.42,BUC:5.8,HGL:8.07,PHE:5.06,"03Y":2.6,PHA:5.11,OCY:5,"4PH":6.79,"5OH":4.7,"31Q":10.46,BTR:7.98,"3PX":4.7,"1PA":8.07,ASX:3.54,IOR:7.23,"03E":3.38,PHL:5.17,KWS:5.09,PHI:7.12,NAL:7.22,S1H:19.21,"2ML":3.86,"2MR":7.35,GHG:4.83,
TYY:6.54,"2MT":3.67,"56A":13.01,SVA:5.46,TYX:8.31,TYS:8.59,TYR:6.38,TYQ:6.43,HLU:3.99,MYK:19.47,TYO:7.71,HLX:4.98,TYN:9.87,TYJ:6.25,TYI:6.49,LYH:5.13,LYF:12.19,SUN:6.73,LYR:18.28,TYB:6.46,"11W":14.39,LYS:5.54,LYN:4.8,"11Q":4.85,LYO:4.71,LYZ:1.76,TXY:6.44,MYN:4.71,TY5:10.6,HMR:5.09,"01W":8.55,LYX:13.36,TY8:7.22,TY2:6.49,KYN:6.18,KYQ:9.75,CZZ:5.14,IIL:3.81,HNC:10.41,OIC:4.62,LVN:2.89,QIL:3.84,JJL:8.3,VAH:3.88,JJJ:7.5,JJK:7.43,VAD:2.56,CYW:4.65,"0QL":5.72,143:8.22,SVX:7.04,CYJ:11.64,SVY:7.1,SVZ:6.6,
CYG:8.03,CYF:13.54,SVV:5.09,GL3:2.72,"8SP":14.26,CYS:2.78,"004":4.33,CYR:10.33,PLJ:3.71,EXY:7.37,HL2:3.75,A5N:5.21,CYQ:5.67,CZ2:5.16,LWY:4.12,PM3:8.78,OHS:6.98,OHI:5.35,"3TY":8.42,CYD:8.55,DYS:7.87,DAH:6.47,"4IK":11.81,"3EG":3.66,AYA:3.65,"4IN":6.31,DAB:3.48,"4HT":6.03,RGL:7.03,DAM:2.49,NFA:5.04,WFP:6.07,"2JC":2.97,HAR:7.55,"2JG":5.67,MH6:1.72,"2JF":9.13,"3FG":4.96,MGN:4.84,AZH:5.36,AZK:6.03,ZBZ:7.79,TBG:2.58,VAL:2.51,MGG:7.34,AZS:5.61,FHL:9.75,"2JH":4.56,IEL:7.07,FHO:6.75,DA2:7.79,FH7:6.99,ME0:4.52,
"3GL":4.84,MDO:5.03,AZY:7.37,A8E:3.76,ZCL:6.71,MDH:2.58,LA2:14.07,"4FW":6.1,YCM:5.32,MDF:4.95,YCP:3.01,TEF:8.63,FGP:4.34,UF0:19.72,XCN:4.57,FGL:2.56,MF3:6.37,MEQ:5.13,LAA:3.23,IGL:5.52,MET:4.49,NIY:6.81,QCS:5.18,TCQ:8.56,MEN:4.33,"4HL":8.79,MEA:4.95,EFC:5.28,LAL:2.41,"2HF":5.52,KBE:5.64,OCS:3.94,CAF:5.46,NC1:11.4,NBQ:9.82,CAB:4.19,MBQ:9.55,193:7.38,192:2.44,"0WZ":7.61,CAS:5.35,NB8:11.98,OBS:11.71,"1AC":2.42,PCA:3.48,MCL:9.73,LBY:7.75,GAU:4.67,PBF:9.75,MCG:6.46,DDE:6.86,"19W":3.94,MD5:9.33,MD6:6.44,
MD3:8.41,MCS:7.56,OBF:3.64,UAL:4.68,PAT:6.05,IAM:8.88,PAQ:8.77,FDL:9.49,NCB:3.45,LCK:9.81,DDZ:2.52,"2FM":5.54,IAR:6.77,OAS:4.8,HBN:8.8,TA4:5.55,"1C3":7.43,ECX:5.51,PF5:6.28,RE3:5.29,FCL:6.25,ECC:4.79,LDH:7.06,NCY:2.91,CCS:4.58,PEC:6.54,"2CO":4.45,LE1:2.72,HCM:5.53,"07O":8.05,HCL:4.96,NEP:6.94,PE1:8.01,LEF:4.37,FC0:5.18,LED:4.34,HCS:4.09,DBU:2.49,RE0:5.53,LEN:3.82,"1E3":8.71,BB9:2.56,BB8:5.14,PCS:5.05,BB7:4.56,BB6:2.62,LEU:3.83,DBZ:7.08,LET:11.29,DBY:6.46,ICY:7.76,MAA:2.4,CGA:7.91,"5CS":8.34,UGY:3.7,
LGY:11.71,N10:8.96,AAR:6.39,FT6:7.5,MOD:12.62,"5CW":7.21,PVH:4.58,BBC:6.42,YYA:7.3,O12:14.08,NOT:7.15,KGC:9.88,MP4:5.86,"0CS":4.07,MP8:3.75,VLL:2.54,VLM:2.51,BCS:8.03,MNL:4.9,AA4:4.47,SAC:3.49,BCX:2.99,"3CF":6.47,SAH:11.7,NNH:6.86,CGU:4.71,SIB:12.41,TLY:8.78,SIC:4.81,VMS:8.82,TMD:6.76,MMO:6.53,PXU:2.46,"4AW":6.22,OTH:3.6,DLS:6.84,MME:4.99,DM0:6.99,"0FL":2.76,SBL:8.96,CDV:3.72,OTY:6.51,PYA:7.75,"2AS":3.57,DMH:4.92,ELY:7.42,GVL:9.6,FVA:2.9,SAR:2.48,"4BF":6.92,EME:4.69,CDE:2.51,"3AR":7.86,"3AH":9.11,
AC5:2.44,FTR:6.08,MLL:3.76,NPH:11.66,NPI:6.9,DMT:6.67,PYX:11.3,MLE:3.87,PYL:9.67,ZZU:6.94,H5M:3.61,SCH:4.46,DMK:3.52,FTY:9.07,"2AG":3.7,ABA:2.55,ZZJ:2.44,MLZ:6.8,MLY:6.88,KCX:7.28,ZZD:8.16,"3A5":5.37,LHC:7.75,"9AT":2.47,OZT:3.4,THO:2.62,THR:2.5,DFI:3.93,MKD:6.42,"4CY":4.6,SDP:6.07,DFO:3.94,"0A0":3.45,"4DB":9.73,ML3:6.26,BG1:8.02,SD4:4.57,THC:3.8,SCS:5.48,TH5:4.65,BFD:5.33,AEI:6.34,TH6:2.85,SCY:4.53,TIS:4.81,SEE:4.53,BHD:3.48,SEB:8.18,SEC:2.96,SEP:4.8,CLH:7.13,TIH:5.02,CLG:13.62,SEN:6.43,XXA:7.34,
SEL:2.46,SE7:4.19,"4CF":7.72,G8M:3.57,BH2:3.51,UN2:3.22,VR0:10.51,MK8:4.76,DHA:2.32,LMQ:4.69,SFE:5.01,AHB:3.47,OXX:7.05,BIF:9.63,IZO:4.47,NMM:8.25,"0BN":7,HZP:3.12,NMC:4.23,DHL:2.69,"9DS":9.29,SER:2.41,CHG:4.2,MIR:6.54,AGQ:7.79,SET:2.46,MIS:6.32,"4FB":3.08,"0AR":8.46,LME:3.99,FZN:24.42,AGT:9.04,IYR:6.46,"9DN":9.31,CHP:5.75,UNK:1.64,XX1:9.92,AGM:6.57,"0AH":5.78,LLP:10.22,"0AF":6.72,"4DP":9.28,HYP:2.25,DIR:5.8,LLY:8.71,"0AK":6.11,NLE:4.67,OYL:6.42,WVL:4.69,"0A8":8.1,NLY:6.37,MHO:4.89,VOL:2.55,"0A1":7.1,
MHL:3.92,NLP:4.81,NLQ:4.65,MHW:2.74,BIL:4.7,NLO:4.8,MHU:7.51,XW1:9.36,LLO:10.13,SGB:6.88,MHV:3.6,MHS:4.51,"0A9":5.17,"0LF":9.96,HT7:6.82,X2W:6.6,YPZ:9.38,I58:6.73,FLA:2.4,M0H:4.83,HSL:2.46,FLE:6.17,KOR:10.1,"1VR":3.89,HSO:4.56,TTS:9.41,RVX:7.01,TTQ:7.71,H14:5.27,HTI:7.8,ONH:6.14,LP6:8.58,ONL:4.83,AHH:5.06,HS8:7.4,HS9:4.71,BL2:5.82,AHP:5.26,"6HN":7.34,HRP:5.46,POM:3.6,WPA:5.11,"2ZC":4.29,CPC:2.65,AIB:2.4,XSN:3.47,M2S:5.28,GND:6.67,GNC:4.6,MVA:2.56,OLZ:5.32,M2L:6.15,TRF:6.69,NZH:7.66,SRZ:5.27,OLD:10.47,
CME:5.86,CMH:5.3,ALA:2.38,TRQ:7.36,PPN:7.24,TRP:6.07,TRO:5.82,TRN:5.95,NYS:8.1,ALC:5.26,U3X:11.7,HVA:2.58,TS9:3.92,TRX:7.27,TRW:11.8,LPL:7.51,GMA:4.4,OMT:5.07,CMT:3.54,GME:4.66,NYB:6.07,PR3:5.12,LPD:2.48,GLU:4.49,"1X6":6.84,LPG:2.39,GLX:4.52,PR4:4.52,CML:6.16,FME:4.52,HTR:6.48,PR7:4.66,Z3E:7.2,GLZ:2.39,BMT:6.37,WRP:8.16,GLY:2.37,OMY:6.11,MTY:5.46,OMX:6.15,GLN:4.46,"2XA":8.25,"28X":7.84,"7JA":9.46,FLT:9.65,GLJ:3.7,OMH:5.26,TSY:4.26,PRV:4.28,CS4:11.21,DOA:12.33,"23P":5.42,CS3:8.24,"6CL":6.47,PRR:5.58,
KST:11.58,CS1:7.23,PRS:2.63,ZYJ:11.4,IT1:9.75,UU5:4.98,ESB:6.69,UU4:2.49,ESC:5.65,LSO:10.58,ZYK:11.45,"9NV":8.99,"23F":5.27,ORN:4.25,HOX:6.61,CSD:3.95,FP9:3.03,DO2:4.44,SLL:11.53,P3Q:9.54,ORQ:6.04,MSL:5.21,DNP:2.45,CSB:3.51,WLU:4.24,CSA:5.7,MT2:5.51,CSO:3.53,TPO:4.73,MSP:13.11,"23S":6.09,MSO:4.96,PRO:2.41,TPL:5.41,DNS:8.79,CSK:3.91,Z70:7.4,CSJ:7.51,DNW:7.97,PRK:9.15,GSU:11.81,LTA:6.57,HPE:6.63,TPQ:6.48,PRJ:5.26,PSW:4.65,L3O:3.89,CSU:4.89,ALY:7.38,M3L:7.12,CSW:3.68,XPR:7.68,D4P:5.66,FOE:8.17,SLZ:5.69,
CSP:5.26,TQI:7.68,ALT:2.72,CSR:5.42,CSS:3.61,M3R:7.18,ALO:2.57,R4K:4.67,SMF:9,MSA:2.73,SMC:3.39,CSX:3.47,SME:4.8,ETA:2.4,CSZ:3.6,"22G":8.8,MSE:4.62,ALN:6.16,PSH:7.26,CTE:7.27,DON:6.72,CTH:3.45,U2X:11.54,"6CW":7.56,TQZ:6.97,"3YM":6.52,OSE:4.49,"2VA":9.82,TQQ:7.76,NRG:8.35,BPE:7.24,F2F:6.25,"1TQ":8.58,I2M:3.13,NVA:3.76,R1A:8.2,QPA:6.95,C1X:11.63,FRD:5.05,HR7:6.98,SNC:3.93,QPH:5.15,"26B":8.39,DPQ:6.54,DPP:2.51,"2TY":8.65,TNR:6.88,PTH:8.35,DPL:3.58,APK:8.79,"1TY":8.84,HRG:7.36,PTM:8.74,"1U8":3.62,PTR:8.64,
LVG:3.01,"6FL":4.85,SOC:4.05,KPI:9.79,IPG:2.91,P2Y:2.51,N2C:3.55,T0I:7.34,MPH:5.29,R2T:4.71,TOX:6.78,P2Q:9.8,GPL:10.77,MPJ:5.07,F2Y:6.2,T11:8.58,"9NR":9.33,FPR:8.85,"9NF":8.93,KPY:10.17,"9NE":9.77,TOQ:7.5,MPQ:4.2,FPK:3.08,HQA:7.25,SOY:10.94,"":5};
NGL.ResidueHydrophobicity={ALA:[.17,.5,.33],ARG:[.81,1.81,1],ASN:[.42,.85,.43],ASP:[1.23,3.64,2.41],ASH:[-.07,.43,.5],CYS:[-.24,-.02,.22],GLN:[.58,.77,.19],GLU:[2.02,3.63,1.61],GLH:[-.01,.11,.12],GLY:[.01,1.15,1.14],HIS:[.17,.11,-.06],ILE:[-.31,-1.12,-.81],LEU:[-.56,-1.25,-.69],LYS:[.99,2.8,1.81],MET:[-.23,-.67,-.44],PHE:[-1.13,-1.71,-.58],PRO:[.45,.14,-.31],SER:[.13,.46,.33],THR:[.14,.25,.11],TRP:[-1.85,-2.09,-.24],TYR:[-.94,-.71,.23],VAL:[.07,-.46,-.53],"":[0,0,0]};
NGL.guessElement=function(){var a="HCONSP".split(""),b=["NA","CL"];return function(c){c=c.trim().toUpperCase();parseInt(c.charAt(0))&&(c=c.substr(1));parseInt(c.charAt(0))&&(c=c.substr(1));var d=c.length;if(0===d)return"";if(1===d)return c;if(2===d){if(-1!==b.indexOf(c))return c;if(-1!==a.indexOf(c[0]))return c[0]}return 3<=d&&-1!==a.indexOf(c[0])?c[0]:""}}();NGL.UnknownType=0;NGL.CgType=1;NGL.ProteinType=2;NGL.ProteinBackboneType=3;NGL.NucleicType=4;NGL.RnaBackboneType=5;NGL.DnaBackboneType=6;
NGL.WaterType=7;NGL.AA1={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",ASH:"D",GLH:"E",UNK:""};
NGL.GidPool={nextGid:1,objectList:[],rangeList:[],addObject:function(a){NGL.GidPool.objectList.push(a);NGL.GidPool.rangeList.push(NGL.GidPool.allocateGidRange(a));return NGL.GidPool},removeObject:function(a){a=NGL.GidPool.objectList.indexOf(a);-1!==a&&(NGL.GidPool.objectList.splice(a,1),NGL.GidPool.rangeList.splice(a,1),0===NGL.GidPool.objectList.length&&(NGL.GidPool.nextGid=1));return NGL.GidPool},updateObject:function(a,b){var c=NGL.GidPool.objectList.indexOf(a);if(-1!==c){var d=NGL.GidPool.rangeList[c];
d[1]===NGL.GidPool.nextGid?(c=NGL.GidPool.getGidCount(a),NGL.GidPool.nextGid+=c-(d[1]-d[0]),d[1]=NGL.GidPool.nextGid):NGL.GidPool.rangeList[c]=NGL.GidPool.allocateGidRange(a)}else b||NGL.warn("NGL.GidPool.updateObject: object not found.");return NGL.GidPool},getGidCount:function(a){var b=0;a instanceof NGL.Structure?b=a.atomCount:a instanceof NGL.BondSet?b=a.bondCount:a instanceof NGL.Volume&&(b=a.__data.length);return b},allocateGidRange:function(a){var b=NGL.GidPool.nextGid;NGL.GidPool.nextGid+=
NGL.GidPool.getGidCount(a);NGL.GidPool.nextGid>Math.pow(2,24)&&NGL.error("GidPool overflown");return[b,NGL.GidPool.nextGid]},freeGidRange:function(a){},getNextGid:function(){return NGL.GidPool.nextGid++},getGid:function(a,b){b=b||0;var c=0,d=NGL.GidPool.objectList.indexOf(a);-1!==d?c=NGL.GidPool.rangeList[d][0]+b:NGL.warn("NGL.GidPool.getGid: object not found.");return c},getByGid:function(a){var b;NGL.GidPool.objectList.forEach(function(c,d){if(c instanceof NGL.Structure)c.eachAtom(function(d){NGL.GidPool.getGid(c,
d.index)===a&&(b=d)});else if(c instanceof NGL.BondSet)c.eachBond(function(d){NGL.GidPool.getGid(c,d.index)===a&&(b=d)});else if(c instanceof NGL.Volume){var e=NGL.GidPool.rangeList[d];a>=e[0]&&a<e[1]&&(e=a-e[0],b={volume:c,index:e,value:c.data[e],x:c.dataPosition[3*e],y:c.dataPosition[3*e+1],z:c.dataPosition[3*e+2]})}});return b}};
NGL.ColorMakerRegistry={signals:{typesChanged:new signals.Signal},scales:{"":"",OrRd:"[S] Orange-Red",PuBu:"[S] Purple-Blue",BuPu:"[S] Blue-Purple",Oranges:"[S] Oranges",BuGn:"[S] Blue-Green",YlOrBr:"[S] Yellow-Orange-Brown",YlGn:"[S] Yellow-Green",Reds:"[S] Reds",RdPu:"[S] Red-Purple",Greens:"[S] Greens",YlGnBu:"[S] Yellow-Green-Blue",Purples:"[S] Purples",GnBu:"[S] Green-Blue",Greys:"[S] Greys",YlOrRd:"[S] Yellow-Orange-Red",PuRd:"[S] Purple-Red",Blues:"[S] Blues",PuBuGn:"[S] Purple-Blue-Green",
Spectral:"[D] Spectral",RdYlGn:"[D] Red-Yellow-Green",RdBu:"[D] Red-Blue",PiYG:"[D] Pink-Yellowgreen",PRGn:"[D] Purplered-Green",RdYlBu:"[D] Red-Yellow-Blue",BrBG:"[D] Brown-Bluegreen",RdGy:"[D] Red-Grey",PuOr:"[D] Purple-Orange",Set1:"[Q] Set1",Set2:"[Q] Set2",Set3:"[Q] Set3",Dark2:"[Q] Dark2",Paired:"[Q] Paired",Pastel1:"[Q] Pastel1",Pastel2:"[Q] Pastel2",Accent:"[Q] Accent",roygb:"[?] Rainbow",rwb:"[?] Red-White-Blue"},modes:{"":"",rgb:"Red Green Blue",hsv:"Hue Saturation Value",hsl:"Hue Saturation Lightness",
hsi:"Hue Saturation Intensity",lab:"CIE L*a*b*",hcl:"Hue Chroma Lightness"},types:{},userSchemes:{},getScheme:function(a){var b=(a||{}).scheme||"";return new (b in NGL.ColorMakerRegistry.types?NGL.ColorMakerRegistry.types[b]:b in NGL.ColorMakerRegistry.userSchemes?NGL.ColorMakerRegistry.userSchemes[b]:NGL.ColorMaker)(a)},getPickingScheme:function(a){a=Object.assign(a||{});a.scheme="picking";return NGL.ColorMakerRegistry.getScheme(a)},getTypes:function(){var a={};Object.keys(NGL.ColorMakerRegistry.types).forEach(function(b){a[b]=
b});Object.keys(NGL.ColorMakerRegistry.userSchemes).forEach(function(b){a[b]=b.split("|")[1]});return a},getScales:function(){return NGL.ColorMakerRegistry.scales},getModes:function(){return NGL.ColorMakerRegistry.modes},addScheme:function(a,b){a instanceof NGL.ColorMaker||(a=NGL.ColorMakerRegistry.createScheme(a,b));b=b||"";var c=""+THREE.Math.generateUUID()+"|"+b;NGL.ColorMakerRegistry.userSchemes[c]=a;NGL.ColorMakerRegistry.signals.typesChanged.dispatch();return c},removeScheme:function(a){delete NGL.ColorMakerRegistry.userSchemes[a];
NGL.ColorMakerRegistry.signals.typesChanged.dispatch()},createScheme:function(a,b){var c=function(c){NGL.ColorMaker.call(this,c);this.label=b||"";a.call(this,c)};c.prototype=NGL.ColorMaker.prototype;return c.prototype.constructor=c},addSelectionScheme:function(a,b){return NGL.ColorMakerRegistry.addScheme(function(b){var d=[],e=[];a.forEach(function(a){d.push((new THREE.Color(a[0])).getHex());e.push(new NGL.Selection(a[1]))});var f=a.length;this.atomColor=function(a){for(var b=0;b<f;++b)if(e[b].test(a))return d[b];
return 16777215}},b)}};NGL.ColorMaker=function(a){a=a||{};this.scale=a.scale||"uniform";this.mode=a.mode||"hcl";this.domain=a.domain||[0,1];this.value=(new THREE.Color(a.value||16777215)).getHex();this.structure=a.structure;this.bondSet=a.bondSet;this.volume=a.volume;this.surface=a.surface};
NGL.ColorMaker.prototype={constructor:NGL.ColorMaker,getScale:function(a){a=a||{};var b=a.scale||this.scale;"rainbow"===b||"roygb"===b?b=["red","orange","yellow","green","blue"]:"rwb"===b&&(b=["red","white","blue"]);return chroma.scale(b).mode(a.mode||this.mode).domain(a.domain||this.domain).out("num")},atomColor:function(a){return 16777215},atomColorToArray:function(a,b,c){a=this.atomColor(a);void 0===b&&(b=[]);void 0===c&&(c=0);b[c+0]=(a>>16&255)/255;b[c+1]=(a>>8&255)/255;b[c+2]=(a&255)/255;return b},
bondColor:function(a,b){return this.atomColor(b?a.atom1:a.atom2)},bondColorToArray:function(a,b,c,d){a=this.bondColor(a,b);void 0===c&&(c=[]);void 0===d&&(d=0);c[d+0]=(a>>16&255)/255;c[d+1]=(a>>8&255)/255;c[d+2]=(a&255)/255;return c},volumeColor:function(a){return 16777215},volumeColorToArray:function(a,b,c){a=this.volumeColor(a);void 0===b&&(b=[]);void 0===c&&(c=0);b[c+0]=(a>>16&255)/255;b[c+1]=(a>>8&255)/255;b[c+2]=(a&255)/255;return b}};
NGL.ValueColorMaker=function(a){NGL.ColorMaker.call(this,a);var b=this.getScale();this.volumeColor=function(a){return b(this.volume.data[a])}};NGL.ValueColorMaker.prototype=NGL.ColorMaker.prototype;NGL.ValueColorMaker.prototype.constructor=NGL.ValueColorMaker;
NGL.PickingColorMaker=function(a){NGL.ColorMaker.call(this,a);this.atomColor=function(a){return NGL.GidPool.getGid(this.structure,a.index)};this.bondColor=function(a,c){return NGL.GidPool.getGid(this.bondSet,a.index)};this.volumeColor=function(a){return NGL.GidPool.getGid(this.volume,a)}};NGL.PickingColorMaker.prototype=NGL.ColorMaker.prototype;NGL.PickingColorMaker.prototype.constructor=NGL.PickingColorMaker;
NGL.RandomColorMaker=function(a){NGL.ColorMaker.call(this,a);this.atomColor=function(a){return 16777215*Math.random()}};NGL.RandomColorMaker.prototype=NGL.ColorMaker.prototype;NGL.RandomColorMaker.prototype.constructor=NGL.RandomColorMaker;NGL.UniformColorMaker=function(a){NGL.ColorMaker.call(this,a);var b=this.value;this.atomColor=function(){return b};this.bondColor=function(){return b};this.valueColor=function(){return b}};NGL.UniformColorMaker.prototype=NGL.ColorMaker.prototype;
NGL.UniformColorMaker.prototype.constructor=NGL.UniformColorMaker;NGL.AtomindexColorMaker=function(a){NGL.ColorMaker.call(this,a);a.scale||(this.scale="roygb");a.domain||(this.domain=[0,this.structure.atomCount]);var b=this.getScale();this.atomColor=function(a){return b(a.index)}};NGL.AtomindexColorMaker.prototype=NGL.ColorMaker.prototype;NGL.AtomindexColorMaker.prototype.constructor=NGL.AtomindexColorMaker;
NGL.ResidueindexColorMaker=function(a){NGL.ColorMaker.call(this,a);a.scale||(this.scale="roygb");a.domain||(this.domain=[0,this.structure.residueCount]);var b=this.getScale();this.atomColor=function(a){return b(a.residue.index)}};NGL.ResidueindexColorMaker.prototype=NGL.ColorMaker.prototype;NGL.ResidueindexColorMaker.prototype.constructor=NGL.ResidueindexColorMaker;
NGL.ChainindexColorMaker=function(a){NGL.ColorMaker.call(this,a);a.scale||(this.scale="Spectral");a.domain||(this.domain=[0,this.structure.chainCount]);var b=this.getScale(),c=this.getScale({domain:[0,26]});this.atomColor=function(a){return""===a.residue.chain.chainname?c(10*"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".indexOf(a.chainname)):b(a.residue.chain.index)}};NGL.ChainindexColorMaker.prototype=NGL.ColorMaker.prototype;NGL.ChainindexColorMaker.prototype.constructor=NGL.ChainindexColorMaker;
NGL.ModelindexColorMaker=function(a){NGL.ColorMaker.call(this,a);a.scale||(this.scale="roygb");a.domain||(this.domain=[0,this.structure.modelCount]);var b=this.getScale();this.atomColor=function(a){return b(a.residue.chain.model.index)}};NGL.ModelindexColorMaker.prototype=NGL.ColorMaker.prototype;NGL.ModelindexColorMaker.prototype.constructor=NGL.ModelindexColorMaker;
NGL.SstrucColorMaker=function(a){NGL.ColorMaker.call(this,a);var b=NGL.StructureColors,c=NGL.StructureColors[""];this.atomColor=function(a){return"h"===a.ss?b.alphaHelix:"g"===a.ss?b["3_10Helix"]:"i"===a.ss?b.piHelix:"s"===a.ss?b.betaStrand:a.residue.isNucleic()?b.dna:a.residue.isProtein()||"c"===a.ss?b.coil:c}};NGL.SstrucColorMaker.prototype=NGL.ColorMaker.prototype;NGL.SstrucColorMaker.prototype.constructor=NGL.SstrucColorMaker;
NGL.ElementColorMaker=function(a){NGL.ColorMaker.call(this,a);var b=NGL.ElementColors,c=NGL.ElementColors[""],d=this.value;void 0===a.value&&(d=NGL.ElementColors.C);this.atomColor=function(a){a=a.element;return"C"===a?d:b[a]||c}};NGL.ElementColorMaker.prototype=NGL.ColorMaker.prototype;NGL.ElementColorMaker.prototype.constructor=NGL.ElementColorMaker;
NGL.ResnameColorMaker=function(a){NGL.ColorMaker.call(this,a);var b=NGL.ResidueColors,c=NGL.ResidueColors[""];this.atomColor=function(a){return b[a.resname]||c}};NGL.ResnameColorMaker.prototype=NGL.ColorMaker.prototype;NGL.ResnameColorMaker.prototype.constructor=NGL.ResnameColorMaker;
NGL.BfactorColorMaker=function(a){NGL.ColorMaker.call(this,a);a.scale||(this.scale="OrRd");if(!a.domain){var b,c=Infinity,d=-Infinity;if(a.sele)a=new NGL.Selection(a.sele),this.structure.eachAtom(function(a){b=a.bfactor;c=Math.min(c,b);d=Math.max(d,b)},a);else{a=this.structure.atoms;for(var e=a.length,f=0;f<e;++f)b=a[f].bfactor,c=Math.min(c,b),d=Math.max(d,b)}this.domain=[c,d]}var g=this.getScale();this.atomColor=function(a){return g(a.bfactor)}};NGL.BfactorColorMaker.prototype=NGL.ColorMaker.prototype;
NGL.BfactorColorMaker.prototype.constructor=NGL.BfactorColorMaker;NGL.HydrophobicityColorMaker=function(a){NGL.ColorMaker.call(this,a);a.scale||(this.scale="RdYlGn");var b={},c;for(c in NGL.ResidueHydrophobicity)b[c]=NGL.ResidueHydrophobicity[c][0];var d=b[""];if(!a.domain){var e=Infinity,f=-Infinity;for(c in b)a=b[c],e=Math.min(e,a),f=Math.max(f,a);this.domain=[e,0,f]}var g=this.getScale();this.atomColor=function(a){return g(b[a.resname]||d)}};NGL.HydrophobicityColorMaker.prototype=NGL.ColorMaker.prototype;
NGL.HydrophobicityColorMaker.prototype.constructor=NGL.HydrophobicityColorMaker;
NGL.ColorMakerRegistry.types={"":NGL.ColorMaker,picking:NGL.PickingColorMaker,random:NGL.RandomColorMaker,uniform:NGL.UniformColorMaker,atomindex:NGL.AtomindexColorMaker,residueindex:NGL.ResidueindexColorMaker,chainindex:NGL.ChainindexColorMaker,modelindex:NGL.ModelindexColorMaker,sstruc:NGL.SstrucColorMaker,element:NGL.ElementColorMaker,resname:NGL.ResnameColorMaker,bfactor:NGL.BfactorColorMaker,hydrophobicity:NGL.HydrophobicityColorMaker,value:NGL.ValueColorMaker};
NGL.RadiusFactory=function(a,b){this.type=a;this.scale=b||1;this.max=10};NGL.RadiusFactory.types={"":"",vdw:"by vdW radius",covalent:"by covalent radius",ss:"by secondary structure",bfactor:"by bfactor",size:"size"};
NGL.RadiusFactory.prototype={constructor:NGL.RadiusFactory,atomRadius:function(a){var b=this.type,c=this.scale,d=NGL.VdwRadii,e=NGL.CovalentRadii,f=NGL.VdwRadii[""],g=NGL.CovalentRadii[""],h=["C3'","C3*","C4'","C4*","P"];switch(b){case "vdw":a=d[a.element]||f;break;case "covalent":a=e[a.element]||g;break;case "bfactor":a=a.bfactor||1;break;case "ss":a="h"===a.ss?.25:"g"===a.ss?.25:"i"===a.ss?.25:"s"===a.ss?.25:-1!==h.indexOf(a.atomname)?.4:.1;break;default:a=b||1}return Math.min(a*c,this.max)}};
NGL.LabelFactory=function(a,b){this.type=a;this.text=b||{}};NGL.LabelFactory.types={"":"",atomname:"atom name",atomindex:"atom index",atom:"atom name + index",resname:"residue name",resno:"residue no",res:"residue name + no",text:"text"};
NGL.LabelFactory.prototype={constructor:NGL.LabelFactory,atomLabel:function(a){switch(this.type){case "atomname":a=a.atomname;break;case "atomindex":a=""+a.index;break;case "atom":a=a.atomname+"|"+a.index;break;case "resname":a=a.resname;break;case "resno":a=""+a.resno;break;case "res":a=(NGL.AA1[a.resname.toUpperCase()]||"")+a.resno;break;case "text":a=this.text[a.globalindex];break;default:a=a.qualifiedName()}return void 0===a?"":a}};
NGL.AtomSet=function(a,b){this.atoms=[];this.bonds=[];this.atomCount=0;a&&this.fromStructure(a,b)};
NGL.AtomSet.prototype={constructor:NGL.AtomSet,apply:function(a){a.getAtoms=NGL.AtomSet.prototype.getAtoms;a.getBoundingBox=NGL.AtomSet.prototype.getBoundingBox;a.atomPosition=NGL.AtomSet.prototype.atomPosition;a.atomColor=NGL.AtomSet.prototype.atomColor;a.atomRadius=NGL.AtomSet.prototype.atomRadius;a.atomCenter=NGL.AtomSet.prototype.atomCenter;a.atomIndex=NGL.AtomSet.prototype.atomIndex},getAtoms:function(a,b){var c;a?(c=[],this.eachAtom(function(a){c.push(a)},a)):c=this.atoms;return b?c[0]:c},addAtom:function(a){this.atoms.push(a);
this.atomCount=this.atoms.length},fromStructure:function(a,b){var c=this;this.structure=a;this.selection=b;this.selection.signals.stringChanged.add(function(a){c.applySelection()});this.applySelection()},applySelection:function(){NGL.time("NGL.AtomSet.applySelection#atoms");this.atoms.length=0;var a=this.atoms;this.structure.eachAtom(function(b){a.push(b)},this.selection);this.atomCount=this.atoms.length;this.center=this.atomCenter();this._atomPosition=void 0;NGL.timeEnd("NGL.AtomSet.applySelection#atoms");
NGL.time("NGL.AtomSet.applySelection#bonds");this.bonds.length=0;var b=this.bonds;if(this.selection){var c={};this.eachAtom(function(a){var e=a.bonds,f=e.length;c[a.index]=!0;for(a=0;a<f;++a){var g=e[a];c[g.atom1.index]&&c[g.atom2.index]&&b.push(g)}})}else this.eachAtom(function(a){a=a.bonds;for(var c=a.length,f=0;f<c;++f)b.push(a[f])});this.bondCount=this.bonds.length;this._bondPositionTo=this._bondPositionFrom=void 0;NGL.timeEnd("NGL.AtomSet.applySelection#bonds")},getBoundingBox:function(a){var b=
new THREE.Box3,c=new THREE.Vector3,d=0,e=this.atoms.length;if(a)for(var f=a.test,d=0;d<e;++d)a=this.atoms[d],f(a)&&(c.copy(a),b.expandByPoint(c));else for(d=0;d<e;++d)c.copy(this.atoms[d]),b.expandByPoint(c);return b},eachAtom:function(a,b){if(b){var c=b.test;this.atoms.forEach(function(b){c(b)&&a(b)})}else this.atoms.forEach(a)},atomPosition:function(a){var b,c,d=0,e=this.atomCount;if(a)b=[],this.eachAtom(function(a){b[d+0]=a.x;b[d+1]=a.y;b[d+2]=a.z;d+=3},a),b=new Float32Array(b);else{b=this._atomPosition?
this._atomPosition:new Float32Array(3*this.atomCount);for(a=0;a<e;++a)c=this.atoms[a],b[d+0]=c.x,b[d+1]=c.y,b[d+2]=c.z,d+=3;this._atomPosition=b}return b},getColorMaker:function(a){a=a||{};a.structure=this.structure;a.bondSet=this.structure.bondSet;return NGL.ColorMakerRegistry.getScheme(a)},atomColor:function(a,b){var c,d=this.getColorMaker(b);c=a?[]:new Float32Array(3*this.atomCount);var e=0;this.eachAtom(function(a){d.atomColorToArray(a,c,e);e+=3},a);a&&(c=new Float32Array(c));return c},atomPickingColor:function(a,
b){var c=Object.assign(b||{});c.scheme="picking";return this.atomColor(a,c)},atomRadius:function(a,b,c){var d,e,f=new NGL.RadiusFactory(b,c);e=a?[]:new Float32Array(this.atomCount);d=0;this.eachAtom(function(a){e[d]=f.atomRadius(a);d+=1},a);a&&(e=new Float32Array(e));return e},atomIndex:function(a){var b=[];this.eachAtom(function(a){b.push(a.index)},a);return b},atomCenter:function(){var a=new THREE.Box3,b=new THREE.Vector3;return function(c){var d=0,e=this.atoms.length;a.makeEmpty();if(c)for(var f=
c.test,d=0;d<e;++d)c=this.atoms[d],f(c)&&(b.copy(c),a.expandByPoint(b));else for(d=0;d<e;++d)b.copy(this.atoms[d]),a.expandByPoint(b);return a.center()}}(),eachBond:function(a,b){if((b=b||this.selection)&&b.test){var c=b.test;this.bonds.forEach(function(b){c(b.atom1)&&c(b.atom2)&&a(b)})}else for(var d=this.bonds,e=d.length,f=0;f<e;++f)a(d[f])},bondPosition:function(a,b){var c,d,e,f=0,g=this.bondCount;if(a)d=[],this.eachBond(function(a){b?(d[f+0]=a.atom1.x,d[f+1]=a.atom1.y,d[f+2]=a.atom1.z):(d[f+0]=
a.atom2.x,d[f+1]=a.atom2.y,d[f+2]=a.atom2.z);f+=3},a),d=new Float32Array(d);else{d=[];b?this._bondPositionFrom&&(d=this._bondPositionFrom):this._bondPositionTo&&(d=this._bondPositionTo);for(c=0;c<g;++c)e=this.bonds[c],b?(d[f+0]=e.atom1.x,d[f+1]=e.atom1.y,d[f+2]=e.atom1.z):(d[f+0]=e.atom2.x,d[f+1]=e.atom2.y,d[f+2]=e.atom2.z),f+=3;b?this._bondPositionFrom||(this._bondPositionFrom=new Float32Array(d)):this._bondPositionTo||(this._bondPositionTo=new Float32Array(d))}return d},bondColor:function(a,b,c){var d=
0,e=[],f=this.getColorMaker(c);if(a)this.eachBond(function(a){f.bondColorToArray(a,b,e,d);d+=3},a);else{a=this.bonds;c=a.length;for(var g=0;g<c;++g)f.bondColorToArray(a[g],b,e,d),d+=3}return new Float32Array(e)},bondPickingColor:function(a,b,c){c=Object.assign({},c);c.scheme="picking";return this.bondColor(a,b,c)},bondRadius:function(a,b,c,d){var e=0,f=[],g=new NGL.RadiusFactory(c,d);if(a)this.eachBond(function(a){f[e]=g.atomRadius(b?a.atom1:a.atom2);e+=1},a);else for(a=this.bonds,c=a.length,e=0;e<
c;++e)d=a[e],f[e]=g.atomRadius(b?d.atom1:d.atom2);return new Float32Array(f)},toJSON:function(){for(var a={metadata:{version:.1,type:"AtomSet",generator:"AtomSetExporter"},atomCount:this.atomCount},b=this.atoms,c=b.length,d=new NGL.AtomArray(c),e=new NGL.ProxyAtom(d),f=0;f<c;++f)e.copy(b[f],f);a.atomArray=d.toJSON();return a},fromJSON:function(a){this.atomCount=a.atomCount;var b=this.atoms;a=new NGL.AtomArray(a.atomArray);for(var c=a.length,d=0;d<c;++d)b.push(new NGL.ProxyAtom(a,d));return this},
dispose:function(){this.atoms.length=0;this.bonds.length=0;delete this.structure}};NGL.BondSet=function(){this.bonds=[];this.bondCount=0;NGL.GidPool.addObject(this)};
NGL.BondSet.prototype={constructor:NGL.BondSet,addBond:function(a,b,c,d){d=new NGL.Bond(a,b,d);d.index=this.bondCount;c||(a.bonds.push(d),b.bonds.push(d));this.bonds.push(d);this.bondCount+=1;NGL.GidPool.updateObject(this)},addBondIfConnected:function(a,b,c,d){return a.connectedTo(b)?(this.addBond(a,b,c,d),!0):!1},eachBond:function(a,b){var c=this.bonds,d=c.length;if(b&&b.test)for(var e=b.test,f=0;f<d;++f){var g=c[f];e(g.atom1)&&e(g.atom2)&&a(g)}else for(f=0;f<d;++f)a(c[f])},getColorMaker:function(a){a=
a||{};a.structure=this.structure;a.bondSet=this;return NGL.ColorMakerRegistry.getScheme(a)},bondPosition:NGL.AtomSet.prototype.bondPosition,bondColor:NGL.AtomSet.prototype.bondColor,bondPickingColor:NGL.AtomSet.prototype.bondPickingColor,bondRadius:NGL.AtomSet.prototype.bondRadius,toJSON:function(){for(var a={metadata:{version:.1,type:"BondSet",generator:"BondSetExporter"},bondCount:this.bondCount},b=this.bonds,c=b.length,d=new Uint32Array(3*c),e,f,g=0;g<c;++g)e=3*g,f=b[g],d[e]=f.atom1.index,d[e+
1]=f.atom2.index,d[e+2]=f.bondOrder;a.bondArray=d;return a},fromJSON:function(a,b){this.bondCount=a.bondCount;for(var c=this.bonds,d=a.bondArray,e=d.length,f=0;f<e;f+=3){var g=new NGL.Bond(b[d[f]],b[d[f+1]],d[f+2]);g.index=f/3;c.push(g)}NGL.GidPool.updateObject(this);return this},clear:function(){this.bondCount=this.bonds.length=0;this.__disposed||NGL.GidPool.updateObject(this)},dispose:function(){this.__disposed=!0;this.clear();NGL.GidPool.removeObject(this)}};
NGL.Bond=function(a,b,c){a.index<b.index?(this.atom1=a,this.atom2=b):(this.atom1=b,this.atom2=a);this.bondOrder=c||1};NGL.Bond.prototype={constructor:NGL.Bond,atom1:void 0,atom2:void 0,bondOrder:void 0,index:void 0,qualifiedName:function(){return this.atom1.index+"="+this.atom2.index}};
NGL.Structure=function(a,b){this.name=a;this.path=b;this.id=this.title="";this.atoms=[];this.models=[];this.biomolDict={};this.defaultAssembly="BU1";this.helices=[];this.sheets=[];this.frames=[];this.boxes=[];this.reset();NGL.GidPool.addObject(this)};
NGL.Structure.prototype={constructor:NGL.Structure,atomArray:void 0,reset:function(){this.modelCount=this.chainCount=this.residueCount=this.atomCount=0;this.atoms.length=0;this.models.length=0;this.bondSet?this.bondSet.clear():this.bondSet=new NGL.BondSet;this.biomolDict={};this.helices.length=0;this.sheets.length=0;this.unitcell=new NGL.Unitcell;this.frames.length=0;this.boxes.length=0;this.center=new THREE.Vector3;this.boundingBox=new THREE.Box3;NGL.GidPool.updateObject(this,!0)},setDefaultAssembly:function(a){this.defaultAssembly=
a},postProcess:function(a){var b=this;async.series([function(a){b._dontAutoBond||b.autoBond();a()},function(a){b._doAutoSS&&b.autoSS();a()},function(a){b._doAutoChainName&&b.autoChainName();a()},function(a){b.center=b.atomCenter();b.boundingBox=b.getBoundingBox();a()}],function(){NGL.GidPool.updateObject(b);a()})},nextAtomIndex:function(){return this.atomCount++},nextResidueIndex:function(){return this.residueCount++},nextChainIndex:function(){return this.chainCount++},nextModelIndex:function(){return this.modelCount++},
addModel:function(a){a?a.structure=this:a=new NGL.Model(this);a.index=this.nextModelIndex();this.models.push(a);return a},eachAtom:function(a,b){if(b&&b.modelOnlyTest){var c=b.modelOnlyTest;this.models.forEach(function(d){c(d)&&d.eachAtom(a,b)})}else if(b)this.models.forEach(function(c){c.eachAtom(a,b)});else for(var d=this.atoms,e=this.atomCount,f=0;f<e;++f)a(d[f])},eachResidue:function(a,b){if(b&&b.modelOnlyTest){var c=b.modelOnlyTest;this.models.forEach(function(d){c(d)&&d.eachResidue(a,b)})}else this.models.forEach(function(c){c.eachResidue(a,
b)})},eachResidueN:function(a,b){this.models.forEach(function(c){c.eachResidueN(a,b)})},eachFiber:function(a,b,c){if(b&&b.modelOnlyTest){var d=b.modelOnlyTest;this.models.forEach(function(e){d(e)&&e.eachFiber(a,b,c)})}else this.models.forEach(function(d){d.eachFiber(a,b,c)})},eachChain:function(a,b){if(b&&b.modelOnlyTest){var c=b.modelOnlyTest;this.models.forEach(function(d){c(d)&&d.eachChain(a,b)})}else this.models.forEach(function(c){c.eachChain(a,b)})},eachModel:function(a,b){if(b&&b.modelOnlyTest){var c=
b.modelOnlyTest;this.models.forEach(function(b){c(b)&&a(b)})}else this.models.forEach(a)},getSequence:function(){var a=[];this.eachResidue(function(b){b.getAtomByName("CA")&&a.push(b.getResname1())});return a},autoBond:function(){NGL.time("NGL.Structure.autoBond");var a=this.bondSet,b,c,d,e,f,g,h,k,l,m,p,r,n,q,t,u={};NGL.time("NGL.Structure.autoBond within");this.eachResidue(function(s){g=s.atoms;d=s.atomCount;e=d-1;if(500<d)NGL.warn("more than 500 atoms, skip residue for auto-bonding");else{n=s.resname;
t=!1;if(u[n]&&(q=u[n].atomnameList,d===q.length))for(t=!0,b=0;b<d;++b)if(g[b].atomname!==q[b]){t=!1;break}if(t){var v=u[n].atomIndices1,y=u[n].atomIndices2;s=v.length;for(b=0;b<s;++b)a.addBond(g[v[b]],g[y[b]])}else{v=[];y=[];if(20<d)for(l=new NGL.Kdtree(g,!0),p=s.hasBackbone()?1.2:2.3,b=0;b<=e;++b)for(h=g[b],r=h.covalent+p+.3,m=l.nearest(h,Infinity,r*r),f=m.length,c=0;c<f;++c)k=m[c].atom,h.index<k.index&&a.addBondIfConnected(h,k)&&(v.push(b),y.push(g.indexOf(k)));else for(b=0;b<e;++b)for(h=g[b],c=
b+1;c<=e;++c)k=g[c],a.addBondIfConnected(h,k)&&(v.push(b),y.push(c));u[n]={atomnameList:s.getAtomnameList(),atomIndices1:v,atomIndices2:y}}}});NGL.timeEnd("NGL.Structure.autoBond within");NGL.time("NGL.Structure.autoBond between");this.eachResidueN(2,function(b,c){var d=b.getBackboneType(),e=c.getBackboneType();d!==NGL.UnknownType&&d===e&&a.addBondIfConnected(b.getBackboneAtomStart(),c.getBackboneAtomEnd())});NGL.timeEnd("NGL.Structure.autoBond between");NGL.timeEnd("NGL.Structure.autoBond")},autoSS:function(){var a=
function(){var a,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h){for(var k=Math.max(0,f-2);k<=f;++k)for(var l=2;5>l;++l)if(!(k+l>=e.residueCount)&&(c.copy(e.residues[k].getTraceAtom()),d.copy(e.residues[k+l].getTraceAtom()),a=c.distanceTo(d),Math.abs(a-g[l-2])>h))return!1;return!0}}();return function(){NGL.time("NGL.Structure.autoSS");this.eachFiber(function(b){if(!(4>b.residueCount))if(b.isProtein()){var c,d=b.residueCount;for(c=0;c<d;++c)a(b,c,[5.45,5.18,6.37],2.1)?b.residues[c].ss=
"h":a(b,c,[6.1,10.4,13],1.42)?b.residues[c].ss="s":b.residues[c].ss="c"}else if(b.isCg()){d=new NGL.Helixbundle(b);b=d.position;c=d.fiber.residues;var d=d.size,e=new THREE.Vector3,f=new THREE.Vector3,g,h,k,l;for(g=0;g<d-1;++g)k=c[g],l=c[g+1],e.fromArray(b.center,3*g),f.fromArray(b.center,3*g+3),h=e.distanceTo(f),2>h&&1<h&&20>b.bending[g]&&(k.ss="h",l.ss="h")}});this.eachFiber(function(a){if(a.isProtein()||a.isCg){var c,d=0;a.eachResidueN(2,function(a,b){a.ss===b.ss?d+=1:(1===d&&(a.ss="c"),d=1);c=
b});1===d&&(c.ss="c")}});NGL.timeEnd("NGL.Structure.autoSS")}}(),autoChainName:function(){return function(){NGL.time("NGL.Structure.autoChainName");var a,b;this.eachModel(function(c){a=0;c.eachFiber(function(c){b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[a];c.eachAtom(function(a){a.chainname=b});a+=1;62===a&&(NGL.warn("out of chain names"),a=0)})});NGL.timeEnd("NGL.Structure.autoChainName")}}(),updatePosition:function(a){var b,c,d,e=this.atoms,f=this.atomCount;for(b=0;b<f;++b)d=
e[b],c=3*b,d.x=a[c],d.y=a[c+1],d.z=a[c+2]},copy:function(a){},clone:function(){NGL.time("NGL.Structure.clone");var a=new NGL.Structure;a.name=this.name;a.path=this.path;a.title=this.title;a.id=this.id;this.biomolDict&&(a.biomolDict=this.biomolDict);this.atomArray&&(a.atomArray=this.atomArray.clone());this.eachModel(function(b){b=b.clone(a);a.addModel(b);b.eachAtom(function(b){a.atoms.push(b)})});a.frames=this.frames;a.boxes=this.boxes;this.bondSet.eachBond(function(b){a.bondSet.addBond(a.atoms[b.atom1.index],
a.atoms[b.atom2.index])});NGL.timeEnd("NGL.Structure.clone");NGL.debug&&NGL.log(a);return a},toJSON:function(){NGL.time("NGL.Structure.toJSON");var a={metadata:{version:.1,type:"Structure",generator:"StructureExporter"},name:this.name,path:this.path,title:this.title,id:this.id,biomolDict:this.biomolDict,helices:this.helices,sheets:this.sheets,unitcell:this.unitcell.toJSON(),frames:this.frames,boxes:this.boxes,center:this.center.toArray(),boundingBox:[this.boundingBox.min.toArray(),this.boundingBox.max.toArray()],
atoms:[]};if(this.atomArray)a.atomArray=this.atomArray.toJSON();else for(var b=this.atoms,c=b.length,d=0;d<c;++d)a.atoms.push(b[d].toJSON());a.bondSet=this.bondSet.toJSON();NGL.timeEnd("NGL.Structure.toJSON");return a},fromJSON:function(a){NGL.time("NGL.Structure.fromJSON");this.reset();this.name=a.name;this.path=a.path;this.title=a.title;this.id=a.id;this.biomolDict=a.biomolDict;this.helices=a.helices;this.sheets=a.sheets;this.unitcell=(new NGL.Unitcell).fromJSON(a.unitcell);this.frames=a.frames;
this.boxes=a.boxes;this.center=(new THREE.Vector3).fromArray(a.center);this.boundingBox=new THREE.Box3((new THREE.Vector3).fromArray(a.boundingBox[0]),(new THREE.Vector3).fromArray(a.boundingBox[1]));var b=this.atoms;if(a.atomArray)for(var c=this.atomArray=new NGL.AtomArray(a.atomArray),d=c.usedLength,e=0;e<d;++e)b.push(new NGL.ProxyAtom(c,e));else for(c=a.atoms,d=a.atoms.length,e=0;e<d;++e){var f=(new NGL.Atom).fromJSON(c[e]);f.index=e;b.push(f)}this.bondSet.fromJSON(a.bondSet,this.atoms);this.bondSet.eachBond(function(a){b[a.atom1.index].bonds.push(a);
b[a.atom2.index].bonds.push(a)});NGL.GidPool.updateObject(this);NGL.timeEnd("NGL.Structure.fromJSON");return this},getTransferable:function(){var a=[];this.atomArray&&a.concat(this.atomArray.getTransferable());if(this.frames)for(var b=this.frames,c=this.frames.length,d=0;d<c;++d)a.push(b[d].buffer);if(this.boxes)for(b=this.boxes,c=this.boxes.length,d=0;d<c;++d)a.push(b[d].buffer);return a},dispose:function(){this.modelCount=this.chainCount=this.residueCount=this.atomCount=0;this.atoms.length=0;this.models.length=
0;this.cif&&delete this.cif;this.frames&&(this.frames.length=0);this.boxes&&(this.boxes.length=0);this.bondSet.dispose();this.atomArray&&this.atomArray.dispose();NGL.GidPool.removeObject(this)}};NGL.AtomSet.prototype.apply(NGL.Structure.prototype);NGL.Model=function(a){this.structure=a;this.chains=[];this.chainCount=this.residueCount=this.atomCount=0};
NGL.Model.prototype={constructor:NGL.Model,modelno:void 0,nextAtomIndex:function(){this.atomCount+=1;return this.structure.nextAtomIndex()},nextResidueIndex:function(){this.residueCount+=1;return this.structure.nextResidueIndex()},nextChainIndex:function(){this.chainCount+=1;return this.structure.nextChainIndex()},addChain:function(a){a?a.model=this:a=new NGL.Chain(this);a.index=this.nextChainIndex();this.chains.push(a);return a},eachAtom:function(a,b){if(b&&b.chainOnlyTest){var c=b.chainOnlyTest;
this.chains.forEach(function(d){c(d)&&d.eachAtom(a,b)})}else this.chains.forEach(function(c){c.eachAtom(a,b)})},eachResidue:function(a,b){var c,d,e=this.chainCount;if(b&&b.chainOnlyTest){var f=b.chainOnlyTest;for(c=0;c<e;++c)d=this.chains[c],f(d)&&d.eachResidue(a,b)}else for(c=0;c<e;++c)d=this.chains[c],d.eachResidue(a,b)},eachResidueN:function(a,b){this.chains.forEach(function(c){c.eachResidueN(a,b)})},eachFiber:function(a,b,c){if(b&&b.chainOnlyTest){var d=b.chainOnlyTest;this.chains.forEach(function(e){d(e)&&
e.eachFiber(a,b,c)})}else this.chains.forEach(function(d){d.eachFiber(a,b,c)})},eachChain:function(a,b){var c,d,e=this.chainCount;if(b&&b.chainOnlyTest){var f=b.chainOnlyTest;for(c=0;c<e;++c)d=this.chains[c],f(d)&&a(d)}else for(c=0;c<e;++c)a(this.chains[c])},copy:function(a){},clone:function(a){var b=new NGL.Model(a);b.modelno=this.modelno;this.eachChain(function(a){b.addChain(a.clone(b))});return b},toJSON:function(){var a={modelno:this.modelno,chains:[]};this.eachChain(function(b){a.chains.push(b.toJSON())});
return a},fromJSON:function(a){this.modelno=a.modelno;a.chains.forEach(function(a){this.addChain((new NGL.Chain(this)).fromJSON(a))}.bind(this));return this}};NGL.AtomSet.prototype.apply(NGL.Model.prototype);NGL.Chain=function(a){this.model=a;this.residues=[];this.residueCount=this.atomCount=0};
NGL.Chain.prototype={constructor:NGL.Chain,chainname:void 0,nextAtomIndex:function(){this.atomCount+=1;return this.model.nextAtomIndex()},nextResidueIndex:function(){this.residueCount+=1;return this.model.nextResidueIndex()},addResidue:function(a){a?a.chain=this:a=new NGL.Residue(this);a.index=this.nextResidueIndex();this.residues.push(a);return a},eachAtom:function(a,b){var c,d,e,f,g=this.residueCount;if(b&&b.residueOnlyTest)for(d=b.residueOnlyTest,c=0;c<g;++c)f=this.residues[c],d(f)&&f.eachAtom(a,
b);else if(b&&(b.atomOnlyTest||""===this.chainname&&b.test))for(c=0;c<g;++c)f=this.residues[c],f.eachAtom(a,b);else for(c=0;c<g;++c)for(f=this.residues[c],e=f.atomCount,d=0;d<e;++d)a(f.atoms[d])},eachResidue:function(a,b){var c,d,e=this.residueCount;if(b&&b.residueOnlyTest){var f=b.residueOnlyTest;for(c=0;c<e;++c)d=this.residues[c],f(d)&&a(d)}else for(c=0;c<e;++c)a(this.residues[c])},eachResidueN:function(a,b){if(!(this.residues.length<a)){var c=this.residues,d=Array(a),e=c.length,f;for(f=0;f<a;f++)d[f]=
c[f];b.apply(this,d);for(f=a;f<e;f++)d.shift(),d.push(c[f]),b.apply(this,d)}},getFiber:function(a,b,c){var d=this.residueCount,e=this.residues.slice(a,b);if(c){c=this.residues[a-1];var f=this.residues[a],g=this.residues[b-1],h=this.residues[b];0!==a&&c.getBackboneType(-1)===f.getBackboneType(1)&&c.connectedTo(f)?e.unshift(c):e.unshift(f);b!==d&&h.getBackboneType(1)===f.getBackboneType(-1)&&g.connectedTo(h)?e.push(h):e.push(g)}return new NGL.Fiber(e,this.model.structure)},eachFiber:function(a,b,c){var d=
this,e=0,f=1,g=this.residues,h=b?b.test:void 0,k,l,m,p;this.eachResidueN(2,function(b,g){m=b.getBackboneType(e===f-1?-1:void 0);p=g.getBackboneType();m!==NGL.UnknownType&&m===p?(k=b.getBackboneAtomStart(),l=g.getBackboneAtomEnd(),k&&l&&k.connectedTo(l)&&(!h||h(k)&&h(l))||(a(d.getFiber(e,f,c)),e=f)):(m!==NGL.UnknownType&&a(d.getFiber(e,f,c)),e=f);++f});g[e].hasBackbone(-1)&&a(d.getFiber(e,f,c))},copy:function(a){this.chainname=a.chainname},clone:function(a){var b=new NGL.Chain(a);b.chainname=this.chainname;
this.eachResidue(function(a){b.addResidue(a.clone(b))});return b},toJSON:function(){var a={chainname:this.chainname,residues:[]};this.eachResidue(function(b){a.residues.push(b.toJSON())});return a},fromJSON:function(a){this.chainname=a.chainname;a.residues.forEach(function(a){this.addResidue((new NGL.Residue(this)).fromJSON(a))}.bind(this));return this}};NGL.AtomSet.prototype.apply(NGL.Chain.prototype);
NGL.Fiber=function(a,b){this.structure=b;this.residues=a;this.residueCount=a.length;this.isProtein()||this.isNucleic()||this.isCg()||NGL.error("NGL.fiber: could not determine molecule type");this.computedAtoms={}};
NGL.Fiber.prototype={constructor:NGL.Fiber,eachAtom:NGL.Chain.prototype.eachAtom,eachResidue:NGL.Chain.prototype.eachResidue,eachResidueN:NGL.Chain.prototype.eachResidueN,isProtein:function(){return this.residues[0].isProtein()},isCg:function(){return this.residues[0].isCg()},isNucleic:function(){return this.residues[0].isNucleic()},getType:function(){return this.residues[0].getType()},getBackboneType:function(a){return this.residues[0].getBackboneType(a)},computeAtom:function(a){var b;switch(a){case "trace":b=
function(a){return a.getTraceAtom()};break;case "direction1":b=function(a){return a.getDirectionAtom1()};break;case "direction2":b=function(a){return a.getDirectionAtom2()};break;default:b=function(b){return b.getAtomByName(a)};return}var c=this.residueCount;this.computedAtoms[a]||(this.computedAtoms[a]=Array(c));for(var d=this.computedAtoms[a],e=0;e<c;++e)d[e]=b(this.residues[e])},eachAtomN:function(a,b,c){if(!(this.residues.length<a)){this.computedAtoms[c]||this.computeAtom(c);c=this.computedAtoms[c];
var d=Array(a),e=c.length,f;for(f=0;f<a;f++)d[f]=c[f];b.apply(this,d);for(f=a;f<e;f++)d.shift(),d.push(c[f]),b.apply(this,d)}}};NGL.Residue=function(a){this.chain=a;this.atoms=[];this.atomCount=0};
NGL.Residue.atomnames=function(){var a={};a[NGL.ProteinBackboneType]={trace:"CA",direction1:"C",direction2:["O","OC1","O1"],backboneStart:"C",backboneEnd:"N"};a[NGL.RnaBackboneType]={trace:["C4'","C4*"],direction1:["C1'","C1*"],direction2:["C3'","C3*"],backboneStart:["O3'","O3*"],backboneEnd:"P"};a[NGL.DnaBackboneType]={trace:["C3'","C3*"],direction1:["C2'","C2*"],direction2:["O4'","O4*"],backboneStart:["O3'","O3*"],backboneEnd:"P"};a[NGL.CgType]={trace:["CA","BB"],direction1:null,direction2:null,
backboneStart:["CA","BB"],backboneEnd:["CA","BB"]};a[NGL.UnknownType]={trace:"CA",direction1:null,direction2:null,backboneStart:"CA",backboneEnd:"CA"};return a}();
NGL.Residue.makeHasBackboneFn=function(a,b){return function(c){return-1===c?a.call(this)&&this.hasAtomWithName(b.backboneStart,b.direction1,b.direction2):0===c?a.call(this)&&this.hasAtomWithName(b.direction1,b.direction2):1===c?a.call(this)&&this.hasAtomWithName(b.backboneEnd,b.direction1,b.direction2):a.call(this)&&this.hasAtomWithName(b.backboneStart,b.backboneEnd,b.direction1,b.direction2)}};
NGL.Residue.prototype={constructor:NGL.Residue,index:void 0,chain:void 0,atoms:void 0,atomCount:void 0,resno:void 0,resname:void 0,_ss:void 0,get ss(){return this._ss},set ss(a){this._ss=a;var b,c=this.atomCount,d=this.atoms;for(b=0;b<c;++b)d[b].ss=a},isProtein:function(){return this.hasAtomWithName("CA","C","N")},isCg:function(){var a=Object.keys(NGL.AA1);return function(){return this._cg=!this.isProtein()&&this.hasAtomWithName(["CA","BB"])&&5>=this.atomCount&&-1!==a.indexOf(this.resname)}}(),isNucleic:function(){var a=
"A C T G U DA DC DT DG DU".split(" ");return function(){return-1!==a.indexOf(this.resname)}}(),isRna:function(){var a=["A","C","T","G","U"];return function(){return-1!==a.indexOf(this.resname)}}(),isDna:function(){var a=["DA","DC","DT","DG","DU"];return function(){return-1!==a.indexOf(this.resname)}}(),isHetero:function(){return this.atoms.length&&1===this.atoms[0].hetero},isWater:function(){var a=["SOL","WAT","HOH","H2O","W"];return function(){return-1!==a.indexOf(this.resname)}}(),hasProteinBackbone:function(){return NGL.Residue.makeHasBackboneFn(function(){return this.isProtein()},
NGL.Residue.atomnames[NGL.ProteinBackboneType])}(),hasRnaBackbone:function(){var a=["A","C","T","G","U"];return NGL.Residue.makeHasBackboneFn(function(){return-1!==a.indexOf(this.resname)},NGL.Residue.atomnames[NGL.RnaBackboneType])}(),hasDnaBackbone:function(){var a=["DA","DC","DT","DG","DU"];return NGL.Residue.makeHasBackboneFn(function(){return-1!==a.indexOf(this.resname)},NGL.Residue.atomnames[NGL.DnaBackboneType])}(),hasCgBackbone:function(){return this.isCg()},hasBackbone:function(a){return this.hasProteinBackbone(a)||
this.hasCgBackbone()||this.hasRnaBackbone(a)||this.hasDnaBackbone(a)},getResname1:function(){return NGL.AA1[this.resname.toUpperCase()]||"?"},getType:function(){return this.isProtein()?NGL.ProteinType:this.isNucleic()?NGL.NucleicType:this.isCg()?NGL.CgType:this.isWater()?NGL.WaterType:NGL.UnknownType},getBackboneType:function(a){return this.hasProteinBackbone(a)?NGL.ProteinBackboneType:this.hasRnaBackbone(a)?NGL.RnaBackboneType:this.hasDnaBackbone(a)?NGL.DnaBackboneType:this.isCg()?NGL.CgType:NGL.UnknownType},
nextAtomIndex:function(){this.atomCount+=1;return this.chain.nextAtomIndex()},addAtom:function(a){a?a.residue=this:a=new NGL.Atom(this);a.index=this.nextAtomIndex();this.atoms.push(a);return a},addProxyAtom:function(a){a=new NGL.ProxyAtom(a,this.nextAtomIndex());a.residue=this;this.atoms.push(a);return a},eachAtom:function(a,b){var c,d,e=this.atomCount;if(b&&(b.atomOnlyTest||""===this.chain.chainname&&b.test)){var f;f=""===this.chain.chainname?b.test:b.atomOnlyTest;for(c=0;c<e;++c)d=this.atoms[c],
f(d)&&a(d)}else for(c=0;c<e;++c)a(this.atoms[c])},getAtomByName:function(a){var b,c,d=void 0,e=this.atomCount;if(Array.isArray(a))for(b=0;b<e;++b){if(c=this.atoms[b],-1!==a.indexOf(c.atomname)){d=c;break}}else for(b=0;b<e;++b)if(c=this.atoms[b],a===c.atomname){d=c;break}return d},hasAtomWithName:function(a){for(var b=arguments.length,c=0;c<b;++c)if(void 0===this.getAtomByName(arguments[c]))return!1;return!0},getAtomnameList:function(){for(var a=this.atoms.length,b=[],c=0;c<a;++c)b.push(this.atoms[c].atomname);
return b},getTraceAtom:function(){return this.getAtomByName(NGL.Residue.atomnames[this.getBackboneType(0)].trace)},getDirectionAtom1:function(){return this.getAtomByName(NGL.Residue.atomnames[this.getBackboneType(0)].direction1)},getDirectionAtom2:function(){return this.getAtomByName(NGL.Residue.atomnames[this.getBackboneType(0)].direction2)},getBackboneAtomStart:function(){return this.getAtomByName(NGL.Residue.atomnames[this.getBackboneType(-1)].backboneStart)},getBackboneAtomEnd:function(){return this.getAtomByName(NGL.Residue.atomnames[this.getBackboneType(1)].backboneEnd)},
connectedTo:function(a){return this.getBackboneAtomStart().connectedTo(a.getBackboneAtomEnd())},getNextConnectedResidue:function(){var a=this.chain.residues,b=a.indexOf(this);if(-1!==b&&b<a.length&&(a=a[b+1],this.connectedTo(a)))return a},getPreviousConnectedResidue:function(){var a=this.chain.residues,b=a.indexOf(this);if(-1!==b&&0<b&&(a=a[b-1],a.connectedTo(this)))return a},qualifiedName:function(a){var b="";this.resname&&!a&&(b+="["+this.resname+"]");this.resno&&(b+=this.resno);this.chain&&(b+=
":"+this.chain.chainname);this.chain&&this.chain.model&&(b+="/"+this.chain.model.index);return b},copy:function(a){this.resno=a.resno;this.resname=a.resname;this.ss=a.ss},clone:function(a){var b=new NGL.Residue(a);b.resno=this.resno;b.resname=this.resname;this.eachAtom(function(a){b.addAtom(a.clone(b))});return b},toJSON:function(){var a={resno:this.resno,resname:this.resname,_ss:this._ss,atoms:[]};this.chain.model.structure.atomArray?this.eachAtom(function(b){a.atoms.push(b.index)}):this.eachAtom(function(b){a.atoms.push(b.toJSON())});
return a},fromJSON:function(a){this.resno=a.resno;this.resname=a.resname;this._ss=a._ss;if(this.chain.model.structure.atomArray){var b=this.chain.model.structure.atomArray;a.atoms.forEach(function(a){this.addAtom(new NGL.ProxyAtom(b,a))}.bind(this))}else a.atoms.forEach(function(a){this.addAtom((new NGL.Atom(this)).fromJSON(a))}.bind(this));return this}};NGL.AtomSet.prototype.apply(NGL.Residue.prototype);NGL.Atom=function(a){this.residue=a;this.bonds=[]};
NGL.Atom.prototype={constructor:NGL.Atom,index:void 0,atomno:void 0,resname:void 0,x:void 0,y:void 0,z:void 0,element:void 0,chainname:void 0,resno:void 0,serial:void 0,ss:void 0,vdw:void 0,covalent:void 0,hetero:void 0,bfactor:void 0,altloc:void 0,atomname:void 0,modelindex:void 0,residue:void 0,bonds:void 0,distanceTo:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return Math.sqrt(b*b+c*c+a*a)},connectedTo:function(a){if(""!==this.altloc&&""!==a.altloc&&this.altloc!==a.altloc)return!1;var b=
this.x-a.x,c=this.y-a.y,d=this.z-a.z,b=b*b+c*c+d*d;if(28>b&&this.residue.isCg())return!0;if(isNaN(b))return!1;c=this.covalent+a.covalent;a=c+.3;c-=.5;return b<a*a&&b>c*c},qualifiedName:function(a){var b="";this.resname&&!a&&(b+="["+this.resname+"]");this.resno&&(b+=this.resno);this.chainname&&(b+=":"+this.chainname);this.atomname&&(b+="."+this.atomname);this.residue&&this.residue.chain&&this.residue.chain.model&&(b+="/"+this.residue.chain.model.index);return b},positionFromArray:function(a,b){void 0===
b&&(b=0);this.x=a[b+0];this.y=a[b+1];this.z=a[b+2];return this},positionToArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b+0]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},positionToVector3:function(a){void 0===a&&(a=new THREE.Vector3);a.x=this.x;a.y=this.y;a.z=this.z;return a},positionFromVector3:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},copy:function(a){this.atomno=a.atomno;this.resname=a.resname;this.x=a.x;this.y=a.y;this.z=a.z;this.element=a.element;this.chainname=a.chainname;
this.resno=a.resno;this.serial=a.serial;this.ss=a.ss;this.vdw=a.vdw;this.covalent=a.covalent;this.hetero=a.hetero;this.bfactor=a.bfactor;this.bonds=a.bonds;this.altloc=a.altloc;this.atomname=a.atomname;this.modelindex=a.modelindex;this.residue=a.residue;return this},clone:function(a){a=new NGL.Atom(a);a.atomno=this.atomno;a.resname=this.resname;a.x=this.x;a.y=this.y;a.z=this.z;a.element=this.element;a.chainname=this.chainname;a.resno=this.resno;a.serial=this.serial;a.ss=this.ss;a.vdw=this.vdw;a.covalent=
this.covalent;a.hetero=this.hetero;a.bfactor=this.bfactor;a.altloc=this.altloc;a.atomname=this.atomname;a.modelindex=this.modelindex;return a},toJSON:function(){return{atomno:this.atomno,resname:this.resname,x:this.x,y:this.y,z:this.z,element:this.element,chainname:this.chainname,resno:this.resno,serial:this.serial,ss:this.ss,vdw:this.vdw,covalent:this.covalent,hetero:this.hetero,bfactor:this.bfactor,altloc:this.altloc,atomname:this.atomname,modelindex:this.modelindex}},fromJSON:function(a){this.atomno=
a.atomno;this.resname=a.resname;this.x=a.x;this.y=a.y;this.z=a.z;this.element=a.element;this.chainname=a.chainname;this.resno=a.resno;this.serial=a.serial;this.ss=a.ss;this.vdw=a.vdw;this.covalent=a.covalent;this.hetero=a.hetero;this.bfactor=a.bfactor;this.altloc=a.altloc;this.atomname=a.atomname;this.modelindex=a.modelindex;return this}};NGL.AtomArray=function(a){this.useBuffer=!1;Number.isInteger(a)?this.init(a):this.fromJSON(a)};
NGL.AtomArray.prototype={constructor:NGL.AtomArray,init:function(a){this.length=a;this.usedLength=0;this.useBuffer?(this.makeOffsetAndSize(),this.buffer=new ArrayBuffer(this.byteLength),this.makeTypedArrays()):(this.atomno=new Int32Array(a),this.resname=new Uint8Array(5*a),this.x=new Float32Array(a),this.y=new Float32Array(a),this.z=new Float32Array(a),this.element=new Uint8Array(3*a),this.chainname=new Uint8Array(4*a),this.resno=new Int32Array(a),this.serial=new Int32Array(a),this.ss=new Uint8Array(a),
this.vdw=new Float32Array(a),this.covalent=new Float32Array(a),this.hetero=new Uint8Array(a),this.bfactor=new Float32Array(a),this.altloc=new Uint8Array(a),this.atomname=new Uint8Array(4*a),this.modelindex=new Int32Array(a));this.makeBonds();this.makeResidue()},getTransferable:function(){return this.useBuffer?[this.buffer]:[this.atomno.buffer,this.resname.buffer,this.x.buffer,this.y.buffer,this.z.buffer,this.element.buffer,this.chainname.buffer,this.resno.buffer,this.serial.buffer,this.ss.buffer,
this.vdw.buffer,this.covalent.buffer,this.hetero.buffer,this.bfactor.buffer,this.altloc.buffer,this.atomname.buffer,this.modelindex.buffer]},makeOffsetAndSize:function(){var a=this.length;this.atomnoOffset=0;this.atomnoSize=4*a;this.resnoOffset=this.atomnoOffset+this.atomnoSize;this.resnoSize=4*a;this.serialOffset=this.resnoOffset+this.resnoSize;this.serialSize=4*a;this.modelindexOffset=this.serialOffset+this.serialSize;this.modelindexSize=4*a;this.xOffset=this.modelindexOffset+this.modelindexSize;
this.xSize=4*a;this.yOffset=this.xOffset+this.xSize;this.ySize=4*a;this.zOffset=this.yOffset+this.ySize;this.zSize=4*a;this.vdwOffset=this.zOffset+this.zSize;this.vdwSize=4*a;this.covalentOffset=this.vdwOffset+this.vdwSize;this.covalentSize=4*a;this.bfactorOffset=this.covalentOffset+this.covalentSize;this.bfactorSize=4*a;this.atomnameOffset=this.bfactorOffset+this.bfactorSize;this.atomnameSize=4*a;this.chainnameOffset=this.atomnameOffset+this.atomnameSize;this.chainnameSize=4*a;this.elementOffset=
this.chainnameOffset+this.chainnameSize;this.elementSize=3*a;this.resnameOffset=this.elementOffset+this.elementSize;this.resnameSize=5*a;this.ssOffset=this.resnameOffset+this.resnameSize;this.ssSize=a;this.heteroOffset=this.ssOffset+this.ssSize;this.heteroSize=a;this.altlocOffset=this.heteroOffset+this.heteroSize;this.altlocSize=a;this.byteLength=this.altlocOffset+this.altlocSize},makeTypedArrays:function(){this.atomno=new Int32Array(this.buffer,this.atomnoOffset,this.atomnoSize/4);this.resname=new Uint8Array(this.buffer,
this.resnameOffset,this.resnameSize);this.x=new Float32Array(this.buffer,this.xOffset,this.xSize/4);this.y=new Float32Array(this.buffer,this.yOffset,this.ySize/4);this.z=new Float32Array(this.buffer,this.zOffset,this.zSize/4);this.element=new Uint8Array(this.buffer,this.elementOffset,this.elementSize);this.chainname=new Uint8Array(this.buffer,this.chainnameOffset,this.chainnameSize);this.resno=new Int32Array(this.buffer,this.resnoOffset,this.resnoSize/4);this.serial=new Int32Array(this.buffer,this.serialOffset,
this.serialSize/4);this.ss=new Uint8Array(this.buffer,this.ssOffset,this.ssSize);this.vdw=new Float32Array(this.buffer,this.vdwOffset,this.vdwSize/4);this.covalent=new Float32Array(this.buffer,this.covalentOffset,this.covalentSize/4);this.hetero=new Uint8Array(this.buffer,this.heteroOffset,this.heteroSize);this.bfactor=new Float32Array(this.buffer,this.bfactorOffset,this.bfactorSize/4);this.altloc=new Uint8Array(this.buffer,this.altlocOffset,this.altlocSize);this.atomname=new Uint8Array(this.buffer,
this.atomnameOffset,this.atomnameSize);this.modelindex=new Int32Array(this.buffer,this.modelindexOffset,this.modelindexSize/4)},makeResidue:function(){this.residue=Array(this.length)},makeBonds:function(){var a=this.length;this.bonds=Array(a);for(var b=0;b<a;++b)this.bonds[b]=[]},setResname:function(a,b){var c=5*a;this.resname[c]=b.charCodeAt(0);this.resname[c+1]=b.charCodeAt(1);this.resname[c+2]=b.charCodeAt(2);this.resname[c+3]=b.charCodeAt(3);this.resname[c+4]=b.charCodeAt(4)},getResname:function(a){for(var b=
"",c=5*a,d=0;5>d;++d)if(a=this.resname[c+d])b+=String.fromCharCode(a);else break;return b},setElement:function(a,b){var c=3*a;this.element[c]=b.charCodeAt(0);this.element[c+1]=b.charCodeAt(1);this.element[c+2]=b.charCodeAt(2)},getElement:function(a){for(var b="",c=3*a,d=0;3>d;++d)if(a=this.element[c+d])b+=String.fromCharCode(a);else break;return b},setChainname:function(a,b){var c=4*a;this.chainname[c]=b.charCodeAt(0);this.chainname[c+1]=b.charCodeAt(1);this.chainname[c+2]=b.charCodeAt(2);this.chainname[c+
3]=b.charCodeAt(3)},getChainname:function(a){for(var b="",c=4*a,d=0;4>d;++d)if(a=this.chainname[c+d])b+=String.fromCharCode(a);else break;return b},setSS:function(a,b){this.ss[a]=b.charCodeAt(0)},getSS:function(a){return(a=this.ss[a])?String.fromCharCode(a):""},setAltloc:function(a,b){this.altloc[a]=b.charCodeAt(0)},getAltloc:function(a){return(a=this.altloc[a])?String.fromCharCode(a):""},setAtomname:function(a,b){var c=4*a;this.atomname[c]=b.charCodeAt(0);this.atomname[c+1]=b.charCodeAt(1);this.atomname[c+
2]=b.charCodeAt(2);this.atomname[c+3]=b.charCodeAt(3)},getAtomname:function(a){for(var b="",c=4*a,d=0;4>d;++d)if(a=this.atomname[c+d])b+=String.fromCharCode(a);else break;return b},clone:function(){var a=new NGL.AtomArray(this.length);a.atomno.set(this.atomno);a.resname.set(this.resname);a.x.set(this.x);a.y.set(this.y);a.z.set(this.z);a.element.set(this.element);a.chainname.set(this.chainname);a.resno.set(this.resno);a.serial.set(this.serial);a.ss.set(this.ss);a.vdw.set(this.vdw);a.covalent.set(this.covalent);
a.hetero.set(this.hetero);a.bfactor.set(this.bfactor);a.altloc.set(this.altloc);a.atomname.set(this.atomname);a.modelindex.set(this.modelindex);a.usedLength=this.usedLength;return a},toJSON:function(){return this.useBuffer?{length:this.length,usedLength:this.usedLength,buffer:this.buffer}:{length:this.length,usedLength:this.usedLength,atomno:this.atomno,resname:this.resname,x:this.x,y:this.y,z:this.z,element:this.element,chainname:this.chainname,resno:this.resno,serial:this.serial,ss:this.ss,vdw:this.vdw,
covalent:this.covalent,hetero:this.hetero,bfactor:this.bfactor,altloc:this.altloc,atomname:this.atomname,modelindex:this.modelindex}},fromJSON:function(a){this.length=a.length;this.usedLength=a.usedLength;this.useBuffer?(this.makeOffsetAndSize(),this.buffer=a.buffer,this.makeTypedArrays()):(this.atomno=a.atomno,this.resname=a.resname,this.x=a.x,this.y=a.y,this.z=a.z,this.element=a.element,this.chainname=a.chainname,this.resno=a.resno,this.serial=a.serial,this.ss=a.ss,this.vdw=a.vdw,this.covalent=
a.covalent,this.hetero=a.hetero,this.bfactor=a.bfactor,this.altloc=a.altloc,this.atomname=a.atomname,this.modelindex=a.modelindex);a.bonds?this.bonds=a.bonds:this.makeBonds();a.residue?this.residue=a.residue:this.makeResidue()},dispose:function(){this.useBuffer&&delete this.buffer;delete this.atomno;delete this.resname;delete this.x;delete this.y;delete this.z;delete this.element;delete this.chainname;delete this.resno;delete this.serial;delete this.ss;delete this.vdw;delete this.covalent;delete this.hetero;
delete this.bfactor;delete this.altloc;delete this.atomname;delete this.modelindex;delete this.bonds;delete this.residue;this.usedLength=this.length=0}};NGL.ProxyAtom=function(a,b){this.atomArray=a;this.index=b};
NGL.ProxyAtom.prototype={constructor:NGL.ProxyAtom,atomArray:void 0,index:void 0,get atomno(){return this.atomArray.atomno[this.index]},set atomno(a){this.atomArray.atomno[this.index]=a},get resname(){return this.atomArray.getResname(this.index)},set resname(a){this.atomArray.setResname(this.index,a)},get x(){return this.atomArray.x[this.index]},set x(a){this.atomArray.x[this.index]=a},get y(){return this.atomArray.y[this.index]},set y(a){this.atomArray.y[this.index]=a},get z(){return this.atomArray.z[this.index]},
set z(a){this.atomArray.z[this.index]=a},get element(){return this.atomArray.getElement(this.index)},set element(a){this.atomArray.setElement(this.index,a)},get chainname(){return this.atomArray.getChainname(this.index)},set chainname(a){this.atomArray.setChainname(this.index,a)},get resno(){return this.atomArray.resno[this.index]},set resno(a){this.atomArray.resno[this.index]=a},get serial(){return this.atomArray.serial[this.index]},set serial(a){this.atomArray.serial[this.index]=a},get ss(){return this.atomArray.getSS(this.index)},
set ss(a){this.atomArray.setSS(this.index,a)},get vdw(){return this.atomArray.vdw[this.index]},set vdw(a){this.atomArray.vdw[this.index]=a},get covalent(){return this.atomArray.covalent[this.index]},set covalent(a){this.atomArray.covalent[this.index]=a},get hetero(){return this.atomArray.hetero[this.index]},set hetero(a){this.atomArray.hetero[this.index]=a},get bfactor(){return this.atomArray.bfactor[this.index]},set bfactor(a){this.atomArray.bfactor[this.index]=a},get bonds(){return this.atomArray.bonds[this.index]},
set bonds(a){this.atomArray.bonds[this.index]=a},get altloc(){return this.atomArray.getAltloc(this.index)},set altloc(a){this.atomArray.setAltloc(this.index,a)},get atomname(){return this.atomArray.getAtomname(this.index)},set atomname(a){this.atomArray.setAtomname(this.index,a)},get residue(){return this.atomArray.residue[this.index]},set residue(a){this.atomArray.residue[this.index]=a},get modelindex(){return this.atomArray.modelindex[this.index]},set modelindex(a){this.atomArray.modelindex[this.index]=
a},distanceTo:function(a){var b=this.atomArray,c=a.atomArray,d=this.index,e=a.index;a=b.x[d]-c.x[e];var f=b.y[d]-c.y[e],b=b.z[d]-c.z[e];return Math.sqrt(a*a+f*f+b*b)},connectedTo:function(a){var b=this.atomArray,c=a.atomArray,d=this.index;a=a.index;var e=b.altloc[d],f=c.altloc[a];if(0!==e&&0!==f&&e!==f)return!1;var e=b.x[d]-c.x[a],f=b.y[d]-c.y[a],g=b.z[d]-c.z[a],e=e*e+f*f+g*g;if(28>e&&b.residue[d].isCg())return!0;if(isNaN(e))return!1;c=b.covalent[d]+c.covalent[a];b=c+.3;c-=.5;return e<b*b&&e>c*c},
qualifiedName:NGL.Atom.prototype.qualifiedName,positionFromArray:NGL.Atom.prototype.positionFromArray,positionToArray:NGL.Atom.prototype.positionToArray,positionFromVector3:NGL.Atom.prototype.positionFromVector3,positionToVector3:NGL.Atom.prototype.positionToVector3,copy:function(a,b){void 0!==b?this.index=b:void 0===this.index&&NGL.warn("NGL.ProxyAtom.copy no index set");this.atomno=a.atomno;this.resname=a.resname;this.x=a.x;this.y=a.y;this.z=a.z;this.element=a.element;this.chainname=a.chainname;
this.resno=a.resno;this.serial=a.serial;this.ss=a.ss;this.vdw=a.vdw;this.covalent=a.covalent;this.hetero=a.hetero;this.bfactor=a.bfactor;this.bonds=a.bonds;this.altloc=a.altloc;this.atomname=a.atomname;this.modelindex=a.modelindex;this.residue=a.residue;return this},clone:function(a){return new NGL.ProxyAtom(a.chain.model.structure.atomArray,this.index)},toJSON:function(){return{}},fromJSON:function(a){return this}};
NGL.StructureSubset=function(a,b){NGL.Structure.call(this,a.name,a.path);this.structure=a;this.selection=b;this._build()};NGL.StructureSubset.prototype=Object.create(NGL.Structure.prototype);NGL.StructureSubset.prototype.constructor=NGL.StructureSubset;NGL.StructureSubset.prototype.setDefaultAssembly=function(a){this.defaultAssembly=a;this.structure.setDefaultAssembly(a)};
NGL.StructureSubset.prototype._build=function(){NGL.time("NGL.StructureSubset._build");var a=this.structure,b=this.selection,c=this.atoms,d=this,e,f,g,h,k={};d.copy(a);a.eachModel(function(a){e=d.addModel();e.copy(a);a.eachChain(function(a){f=e.addChain();f.copy(a);a.eachResidue(function(a){g=f.addResidue();g.copy(a);a.eachAtom(function(a){h=g.addAtom();h.copy(a);h.index=c.length;k[a.index]=h;c.push(h)},b);0===g.atoms.length&&(f.residues.pop(),--f.residueCount,--e.residueCount,--d.residueCount)},
b);0===f.residues.length&&(e.chains.pop(),--e.chainCount,--d.chainCount)},b);0===e.chains.length&&(d.models.pop(),--d.modelCount)},b);a.bondSet.eachBond(function(a){d.bondSet.addBond(k[a.atom1.index],k[a.atom2.index])},b);d.title=a.title;d.id=a.id;d.center=d.atomCenter();d.boundingBox=d.getBoundingBox();d.frames=a.frames;d.boxes=a.boxes;d.helices=a.helices;d.sheets=a.sheets;d.biomolDict=a.biomolDict;d.defaultAssembly=a.defaultAssembly;NGL.GidPool.updateObject(this);NGL.timeEnd("NGL.StructureSubset._build")};
NGL.makeTrajectory=function(a,b,c){return!a&&b.frames?new NGL.StructureTrajectory(a,b,c):new NGL.RemoteTrajectory(a,b,c)};
NGL.Trajectory=function(a,b,c){var d=this,e=signals;this.signals={gotNumframes:new e.Signal,frameChanged:new e.Signal,selectionChanged:new e.Signal,playerChanged:new e.Signal};this.params={centerPbc:!0,removePbc:!0,superpose:!0};this.name=a.replace(/^.*[\\\/]/,"");this.selection=new NGL.Selection(c||"backbone and not hydrogen");this.selection.signals.stringChanged.add(function(a){d.makeIndices();d.resetCache()});this.setStructure(b);this.trajPath=a;this.numframes=void 0;this.getNumframes()};
NGL.Trajectory.prototype={constructor:NGL.Trajectory,setStructure:function(a){this.structure=a;this.atomCount=a.atomCount;this.makeAtomIndices();this.saveInitialStructure();this.backboneIndices=this.structure.atomIndex(new NGL.Selection("backbone and not hydrogen"));this.makeIndices();this.frameCache=[];this.boxCache=[];this.pathCache=[];this.frameCacheSize=0;this.currentFrame=-1},saveInitialStructure:function(){var a=0,b=new Float32Array(3*this.atomCount);this.structure.eachAtom(function(c){b[a+
0]=c.x;b[a+1]=c.y;b[a+2]=c.z;a+=3});this.initialStructure=b},setSelection:function(a){this.selection.setString(a);return this},makeIndices:function(){this.indices=this.structure.atomIndex(this.selection);var a,b,c=3*this.indices.length;this.coords1=new Float32Array(c);this.coords2=new Float32Array(c);var d=this.initialStructure,e=this.coords2;for(a=0;a<c;a+=3)b=3*this.indices[a/3],e[a+0]=d[b+0],e[a+1]=d[b+1],e[a+2]=d[b+2]},makeAtomIndices:function(){NGL.error("Trajectory.makeAtomIndices not implemented")},
getNumframes:function(){NGL.error("Trajectory.loadFrame not implemented")},resetCache:function(){this.frameCache=[];this.boxCache=[];this.pathCache=[];this.frameCacheSize=0;this.setFrame(this.currentFrame);return this},setParameters:function(a){var b=this.params,c=!1;void 0!==a.centerPbc&&a.centerPbc!==b.centerPbc&&(b.centerPbc=a.centerPbc,c=!0);void 0!==a.removePbc&&a.removePbc!==b.removePbc&&(b.removePbc=a.removePbc,c=!0);void 0!==a.superpose&&a.superpose!==b.superpose&&(b.superpose=a.superpose,
c=!0);c&&this.resetCache()},setFrame:function(a,b){if(void 0===a)return this;this.inProgress=!0;a=parseInt(a);-1===a||this.frameCache[a]?this.updateStructure(a,b):this.loadFrame(a,function(){this.updateStructure(a,b)}.bind(this));return this},interpolate:function(){var a=function(a,c,d,e,f,g){a=(d-a)*g;e=(e-c)*g;g=f*f;return(2*c-2*d+a+e)*f*g+(-3*c+3*d-2*a-e)*g+a*f+c};return function(b,c,d,e,f,g,h){var k=this.frameCache,l=k[b];c=k[c];d=k[d];var m=k[e];e=l.length;k=new Float32Array(e);if("spline"===
g)for(g=0;g<e;g+=3)k[g+0]=a(m[g+0],d[g+0],c[g+0],l[g+0],f,1),k[g+1]=a(m[g+1],d[g+1],c[g+1],l[g+1],f,1),k[g+2]=a(m[g+2],d[g+2],c[g+2],l[g+2],f,1);else for(g=0;g<e;g+=3)d=c[g+0],k[g+0]=d+(l[g+0]-d)*f,d=c[g+1],k[g+1]=d+(l[g+1]-d)*f,d=c[g+2],k[g+2]=d+(l[g+2]-d)*f;this.structure.updatePosition(k);this.currentFrame=b;this.signals.frameChanged.dispatch(b);"function"===typeof h&&h()}}(),setFrameInterpolated:function(a,b,c,d,e,f,g){if(void 0===a)return this;var h=this.frameCache,k=[];h[d]||k.push(d);h[c]||
k.push(c);h[b]||k.push(b);h[a]||k.push(a);k.length?this.loadFrame(k,function(){this.interpolate(a,b,c,d,e,f,g)}.bind(this)):this.interpolate(a,b,c,d,e,f,g);return this},loadFrame:function(a,b){if(Array.isArray(a)){var c=this;async.eachLimit(a,4,function(a,b){c._loadFrame(a,b)},function(a){"function"===typeof b&&b()})}else this._loadFrame(a,b)},_loadFrame:function(a,b){NGL.error("Trajectory._loadFrame not implemented")},updateStructure:function(a,b){this._disposed||(-1===a?this.structure.updatePosition(this.initialStructure):
this.structure.updatePosition(this.frameCache[a]),this.structure.trajectory={name:this.trajPath,frame:a},"function"===typeof b&&b(),this.currentFrame=a,this.inProgress=!1,this.signals.frameChanged.dispatch(a))},getCircularMean:function(a,b,c){return[NGL.Utils.circularMean(b,c[0],3,0,a),NGL.Utils.circularMean(b,c[1],3,1,a),NGL.Utils.circularMean(b,c[2],3,2,a)]},centerPbc:function(a,b,c){if(0!==c[0]&&0!==c[8]&&0!==c[4]){var d=a.length,e=c[0],f=c[1];c=c[2];var g=-b[0]+e+e/2,h=-b[1]+f+f/2,k=-b[2]+c+c/
2;for(b=0;b<d;b+=3)a[b+0]=(a[b+0]+g)%e,a[b+1]=(a[b+1]+h)%f,a[b+2]=(a[b+2]+k)%c}},removePbc:function(a,b){if(0!==b[0]&&0!==b[8]&&0!==b[4]){var c,d,e,f=a.length;for(c=3;c<f;c+=3)for(d=0;3>d;++d)if(e=a[c+d]-a[c-3+d],Math.abs(e)>.9*b[3*d+d])if(0<e)for(e=0;3>e;++e)a[c+e]-=b[3*d+e];else for(e=0;3>e;++e)a[c+e]+=b[3*d+e];return a}},superpose:function(a){var b,c,d=3*this.indices.length,e=this.coords1,f=this.coords2;for(b=0;b<d;b+=3)c=3*this.indices[b/3],e[b+0]=a[c+0],e[b+1]=a[c+1],e[b+2]=a[c+2];(new NGL.Superposition(e,
f)).transform(a)},process:function(a,b,c,d){this.setNumframes(d);if(b){if(0<this.backboneIndices.length&&this.params.centerPbc){d=[b[0],b[4],b[8]];var e=this.getCircularMean(this.backboneIndices,c,d);this.centerPbc(c,e,d)}this.params.removePbc&&this.removePbc(c,b)}0<this.indices.length&&this.params.superpose&&this.superpose(c);this.frameCache[a]=c;this.boxCache[a]=b;this.frameCacheSize+=1},setNumframes:function(a){a!==this.numframes&&(this.numframes=a,this.signals.gotNumframes.dispatch(a))},dispose:function(){this.frameCache=
[];this._disposed=!0;this.player&&this.player.stop()},setPlayer:function(a){this.player=a;this.signals.playerChanged.dispatch(a)},getPath:function(a,b){NGL.error("Trajectory.getPath not implemented")},download:function(a){for(var b=this,c=this.numframes,d=Math.ceil(c/a),e=0,f=new Float32Array(d*(9+3*this.atomCount)),g=0;g<c;g+=a)this.loadFrame(g,function(){var a=g,c=e,l=c*(9+3*b.atomCount);f.set(b.boxCache[a],l);f.set(b.frameCache[a],l+9);c===d-1&&(a=new Blob([f],{type:"application/octet-binary"}),
NGL.download(a,"traj.bbt"))}),e+=1}};NGL.RemoteTrajectory=function(a,b,c){NGL.Trajectory.call(this,a,b,c)};
NGL.RemoteTrajectory.prototype=NGL.createObject(NGL.Trajectory.prototype,{constructor:NGL.RemoteTrajectory,type:"remote",makeAtomIndices:function(){var a=this.structure,b=[];if(a instanceof NGL.StructureSubset){var a=a.structure.atomIndex(a.selection),c,d,e=a[0],f=a[0],g=a.length;for(c=1;c<g;++c)d=a[c],f+1<d&&(b.push([e,f+1]),e=d),f=d;b.push([e,f+1])}else b.push([0,this.atomCount]);this.atomIndices=b},_loadFrame:function(a,b){var c=new XMLHttpRequest,d=NGL.DatasourceRegistry.trajectory,e=d.getFrameUrl(this.trajPath,
a),d=d.getFrameParams(this.trajPath,this.atomIndices);c.open("POST",e,!0);c.responseType="arraybuffer";c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.addEventListener("load",function(d){var g=c.response;if(g){d=(new Int32Array(g,0,1))[0];new Float32Array(g,4,1);var h=new Float32Array(g,8,9),g=new Float32Array(g,44);this.process(a,h,g,d);"function"===typeof b&&b()}else NGL.error("empty arrayBuffer for '"+e+"'")}.bind(this),!1);c.send(d)},getNumframes:function(){var a=new THREE.XHRLoader,
b=NGL.DatasourceRegistry.trajectory.getNumframesUrl(this.trajPath);a.load(b,function(a){this.setNumframes(parseInt(a))}.bind(this))},getPath:function(a,b){if(this.pathCache[a])b(this.pathCache[a]);else{NGL.time("loadPath");var c=new XMLHttpRequest,d=NGL.DatasourceRegistry.trajectory.getPathUrl(this.trajPath,a);c.open("POST",d,!0);c.responseType="arraybuffer";c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.addEventListener("load",function(e){NGL.timeEnd("loadPath");(e=c.response)?
(e=new Float32Array(e),this.pathCache[a]=e,b(e)):NGL.error("empty arrayBuffer for '"+d+"'")}.bind(this),!1);c.send("")}}});NGL.StructureTrajectory=function(a,b,c){NGL.Trajectory.call(this,"",b,c)};
NGL.StructureTrajectory.prototype=NGL.createObject(NGL.Trajectory.prototype,{constructor:NGL.StructureTrajectory,type:"structure",makeAtomIndices:function(){var a=this.structure;this.atomIndices=a instanceof NGL.StructureSubset?a.structure.atomIndex(a.selection):null},_loadFrame:function(a,b){var c,d=this.structure.frames[a];if(this.atomIndices){var e=this.atomIndices,f=e.length;c=new Float32Array(3*f);for(var g=0;g<f;++g){var h=3*g,k=3*e[g];c[h+0]=d[k+0];c[h+1]=d[k+1];c[h+2]=d[k+2]}}else c=new Float32Array(d);
this.process(a,this.structure.boxes[a],c,this.structure.frames.length);"function"===typeof b&&b()},getNumframes:function(){this.numframes=this.structure.frames.length;this.signals.gotNumframes.dispatch(this.numframes)},getPath:function(a,b){var c,d,e,f=this.numframes,g=3*a,h=new Float32Array(3*f);for(c=0;c<f;++c)d=3*c,e=this.structure.frames[c],h[d+0]=e[g+0],h[d+1]=e[g+1],h[d+2]=e[g+2];b(h)}});
NGL.TrajectoryPlayer=function(a,b,c,d,e){var f=signals;this.signals={startedRunning:new f.Signal,haltedRunning:new f.Signal};var g=this;a.signals.playerChanged.add(function(a){a!==g&&g.pause()});this.traj=a;this.step=b||Math.ceil((a.numframes+1)/100);this.timeout=c||50;this.start=d||0;this.end=e||a.numframes-1;this.end=Math.min(this.end,a.numframes-1);this.interpolateType="";this.interpolateStep=5;this.mode="loop";this.direction="forward";this._running=this._stopFlag=!1};
NGL.TrajectoryPlayer.prototype={constructor:NGL.TrajectoryPlayer,_animate:function(){var a;this._running=!0;if(!this.traj.inProgress&&!this._stopFlag){a="forward"===this.direction?this.traj.currentFrame+this.step:this.traj.currentFrame-this.step;if(a>=this.end||a<this.start)"once"===this.mode?(this.pause(),a="forward"===this.direction?this.end:this.start):a="forward"===this.direction?this.start:this.end;this.interpolateType||this.traj.setFrame(a)}if(this._stopFlag)this._running=!1;else if(!this.traj.inProgress&&
this.interpolateType){var b,c,d;"forward"===this.direction?(b=Math.max(this.start,a-this.step),c=Math.max(this.start,a-2*this.step),d=Math.max(this.start,a-3*this.step)):(b=Math.min(this.end,a+this.step),c=Math.min(this.end,a+2*this.step),d=Math.min(this.end,a+3*this.step));this._interpolate(a,b,c,d,1/this.interpolateStep,0)}else setTimeout(this._animate.bind(this),this.timeout)},_interpolate:function(a,b,c,d,e,f){f+=e;if(1>=f){var g=Math.round(this.timeout*e);this.traj.setFrameInterpolated(a,b,c,
d,f,this.interpolateType,function(){setTimeout(function(){this._interpolate(a,b,c,d,e,f)}.bind(this),g)}.bind(this))}else setTimeout(this._animate.bind(this),0)},toggle:function(){this._running?this.pause():this.play()},play:function(){if(!this._running){this.traj.player!==this&&this.traj.setPlayer(this);var a=this.traj.currentFrame,b=Math.ceil(a/this.step)*this.step;"forward"===this.direction&&a>=this.end?b=this.start:"backward"===this.direction&&a<=this.start&&(b=this.end);this.traj.setFrame(b);
this._stopFlag=!1;this._animate();this.signals.startedRunning.dispatch()}},pause:function(){this._running&&(this._stopFlag=!0,this.signals.haltedRunning.dispatch())},stop:function(){this.traj.setFrame(this.start);this.pause()}};
NGL.Surface=function(a,b,c){this.name=a;this.path=b;this.info={};this.center=new THREE.Vector3;this.boundingBox=new THREE.Box3;c instanceof THREE.Geometry||c instanceof THREE.BufferGeometry||c instanceof THREE.Group?this.fromGeometry(c):c&&this.set(c.position,c.index,c.normal,c.color,c.atomindex)};
NGL.Surface.prototype={constructor:NGL.Surface,set:function(a,b,c,d,e){this.position=a;this.index=b;this.normal=c;this.color=d;this.atomindex=e;this.size=a.length/3},fromGeometry:function(a){NGL.time("NGL.GeometrySurface.fromGeometry");a instanceof THREE.Geometry?(a.computeFaceNormals(!0),a.computeVertexNormals(!0)):a=a instanceof THREE.BufferGeometry?a:a.children[0].geometry;a.computeBoundingSphere();a.computeBoundingBox();this.center.copy(a.boundingSphere.center);this.boundingBox.copy(a.boundingBox);
var b,c;if(a instanceof THREE.BufferGeometry){var d=a.attributes;b=d.normal?d.normal.array:!1;(!b||0===b[0]&&0===b[1]&&0===b[2])&&a.computeVertexNormals();b=d.position.array;c=d.index?d.index.array:null;a=d.normal.array}else NGL.log("TODO non BufferGeometry surface"),b=NGL.Utils.positionFromGeometry(a),c=NGL.Utils.indexFromGeometry(a),a=NGL.Utils.normalFromGeometry(a);this.set(b,c,a,void 0,void 0);NGL.timeEnd("NGL.GeometrySurface.setGeometry")},getPosition:function(){return this.position},getColor:function(a){var b=
a||{};a=this.size;var c;if(this.atomindex){b.volume=this;var d=NGL.ColorMakerRegistry.getScheme(b);c=new Float32Array(3*a);for(var b=b.structure.atoms,e=this.atomindex,f=0,g;f<a;++f)g=b[e[f]],d.atomColorToArray(g,c,3*f)}else c=new THREE.Color(b.value),c=NGL.Utils.uniformArray3(a,c.r,c.g,c.b);return c},getPickingColor:function(a){a=Object.assign(a||{});a.scheme="picking";return this.getColor(a)},getNormal:function(){return this.normal},getSize:function(a){return NGL.Utils.uniformArray(this.size,a)},
getIndex:function(){return this.index},getFilteredIndex:function(a,b){if(a&&this.atomindex){for(var c=new NGL.Selection(a),d=[],e=this.atomindex,f=this.index,g=f.length,c=c.test,h=0;h<g;h+=3){var k=f[h],l=f[h+1],m=f[h+2],p=b[e[l]],r=b[e[m]];c(b[e[k]])&&c(p)&&c(r)&&(d.push(k),d.push(l),d.push(m))}return new Uint32Array(d)}return this.index},getAtomindex:function(){return this.atomindex},toJSON:function(){return{metadata:{version:.1,type:"Surface",generator:"SurfaceExporter"},name:this.name,path:this.path,
info:this.info,position:this.position,index:this.index,normal:this.normal,color:this.color,atomindex:this.atomindex,size:this.size,center:this.center.toArray(),boundingBox:{min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}}},fromJSON:function(a){this.name=a.name;this.path=a.path;this.info=a.info;this.position=a.position;this.index=a.index;this.normal=a.normal;this.color=a.color;this.atomindex=a.atomindex;this.size=a.size;this.center.fromArray(a.center);this.boundingBox.set(a.boundingBox.min,
a.boundingBox.max);return this},getTransferable:function(){var a=[];this.position&&a.push(this.position.buffer);this.index&&a.push(this.index.buffer);this.normal&&a.push(this.normal.buffer);this.color&&a.push(this.color.buffer);this.atomindex&&a.push(this.atomindex.buffer);return a},dispose:function(){}};
NGL.Grid=function(a,b,c,d,e){function f(a,d,f){return((a*b+d)*c+f)*e}d=d||Int32Array;e=e||1;var g,h=new d(a*b*c*e);this.data=h;this.index=f;this.set=function(a,b,c){var d=f(a,b,c);for(g=0;g<e;++g)h[d+g]=arguments[3+g]};this.toArray=function(a,b,c,d,r){a=f(a,b,c);void 0===d&&(d=[]);for(g=0;g<e;++g)d[g]=h[a+g]};this.fromArray=function(a,b,c,d,r){a=f(a,b,c);void 0===r&&(r=0);for(g=0;g<e;++g)h[a+g]=d[r+g]};this.copy=function(a){this.data.set(a.data)};this.clone=function(){return(new NGL.Grid(a,b,c,d,
e)).copy(this)}};NGL.WorkerRegistry.add("surf",function(a,b){NGL.time("WORKER surf");void 0===self.vol&&(self.vol=new NGL.Volume);var c=self.vol,d=a.data,e=d.params;d.vol&&c.fromJSON(d.vol);if(e)var f=c.getSurface(e.isolevel,e.smooth,e.center,e.size);NGL.timeEnd("WORKER surf");e?b(f.toJSON(),f.getTransferable()):b()});
NGL.Volume=function(a,b,c,d,e,f,g){this.name=a;this.path=b;this.matrix=new THREE.Matrix4;this.normalMatrix=new THREE.Matrix3;this.inverseMatrix=new THREE.Matrix4;this.center=new THREE.Vector3;this.boundingBox=new THREE.Box3;this.setData(c,d,e,f,g);this.__data.length<=Math.pow(10,7)&&NGL.GidPool.addObject(this)};
NGL.Volume.prototype={constructor:NGL.Volume,setData:function(a,b,c,d,e){this.nx=b||1;this.ny=c||1;this.nz=d||1;this.__data=this.data=a||new Float32Array(1);this.setDataAtomindex(e);delete this.mc;delete this.__isolevel;delete this.__smooth;delete this.__minValue;delete this.__maxValue;delete this.__dataPositionBuffer;delete this.__dataPosition;delete this.__dataBuffer;delete this.__dataMin;delete this.__dataMax;delete this.__dataMean;delete this.__dataRms;this.worker&&this.worker.terminate();this.__data.length<=
Math.pow(10,7)?NGL.GidPool.updateObject(this,!0):(NGL.warn("Volume too large (>10^7), not adding to GidPool"),NGL.GidPool.removeObject(this))},setMatrix:function(a){this.matrix.copy(a);a=this.boundingBox;var b=this.center,c=this.nx-1,d=this.ny-1,e=this.nz-1;a.makeEmpty();a.expandByPoint(b.set(c,d,e));a.expandByPoint(b.set(c,d,0));a.expandByPoint(b.set(c,0,e));a.expandByPoint(b.set(c,0,0));a.expandByPoint(b.set(0,d,e));a.expandByPoint(b.set(0,0,e));a.expandByPoint(b.set(0,d,0));a.expandByPoint(b.set(0,
0,0));a.applyMatrix4(this.matrix);a.center(this.center);c=this.matrix.elements;a=new THREE.Vector3(c[0],c[1],c[2]);b=new THREE.Vector3(c[4],c[5],c[6]);c=new THREE.Vector3(c[8],c[9],c[10]);d=new THREE.Vector3;e=this.normalMatrix.elements;d.crossVectors(b,c);e[0]=d.x;e[1]=d.y;e[2]=d.z;d.crossVectors(c,a);e[3]=d.x;e[4]=d.y;e[5]=d.z;d.crossVectors(a,b);e[6]=d.x;e[7]=d.y;e[8]=d.z;this.inverseMatrix.getInverse(this.matrix)},setDataAtomindex:function(a){this.__dataAtomindex=this.dataAtomindex=a;delete this.__dataAtomindexBuffer},
getBox:function(a,b,c){c||(c=new THREE.Box3);c.set(a,a);c.expandByScalar(b);c.applyMatrix4(this.inverseMatrix);c.min.round();c.max.round();return c},getSurface:function(a,b,c,d){a=isNaN(a)?this.getValueForSigma(2):a;b=b||0;void 0===this.mc&&(this.mc=new NGL.MarchingCubes2(this.__data,this.nx,this.ny,this.nz,this.__dataAtomindex));var e;c&&d&&(this.__box||(this.__box=new THREE.Box3),e=this.__box,this.getBox(c,d,e));b?(c=this.mc.triangulate(a,!0,e),NGL.laplacianSmooth(c.position,c.index,b,!0),d=new THREE.BufferGeometry,
d.addAttribute("position",new THREE.BufferAttribute(c.position,3)),d.addIndex(new THREE.BufferAttribute(c.index,1)),d.computeVertexNormals(),c.normal=d.attributes.normal.array,d.dispose()):c=this.mc.triangulate(a,!1,e);this.matrix.applyToVector3Array(c.position);c.normal&&this.normalMatrix.applyToVector3Array(c.normal);c=new NGL.Surface("","",c);c.info.isolevel=a;c.info.smooth=b;return c},getSurfaceWorker:function(a,b,c,d,e){a=isNaN(a)?this.getValueForSigma(2):a;b=b||0;if(NGL.useWorker&&"undefined"!==
typeof Worker&&"function"!==typeof importScripts){void 0===this.workerPool&&(this.workerPool=new NGL.WorkerPool("surf",2));var f=this.workerPool.getNextWorker();f.post({vol:0===f.postCount?this.toJSON():null,params:{isolevel:a,smooth:b,center:c,size:d}},void 0,function(a){a=NGL.fromJSON(a.data);e(a)},function(f){console.warn("NGL.Volume.generateSurfaceWorker error - trying without worker",f);f=this.getSurface(a,b,c,d);e(f)}.bind(this))}else f=this.getSurface(a,b,c,d),e(f)},getValueForSigma:function(a){a=
void 0!==a?a:2;return this.getDataMean()+a*this.getDataRms()},getSigmaForValue:function(a){return((void 0!==a?a:0)-this.getDataMean())/this.getDataRms()},filterData:function(a,b,c){isNaN(a)&&this.header&&(a=this.header.DMEAN+2*this.header.ARMS);a=void 0===a||isNaN(a)?-Infinity:a;b=void 0!==b?b:Infinity;c=c||!1;this.dataPosition||this.makeDataPosition();var d=this.__dataPosition,e=this.__data;if(a!==this.__minValue||b!=this.__maxValue||c!==this.__outside){if(-Infinity===a&&Infinity===b)this.dataPosition=
d,this.data=e;else{var f=e.length;this.__dataBuffer||(this.__dataPositionBuffer=new ArrayBuffer(12*f),this.__dataBuffer=new ArrayBuffer(4*f));for(var g=new Float32Array(this.__dataPositionBuffer),h=new Float32Array(this.__dataBuffer),k=0,l=0;l<f;++l){var m=3*l,p=e[l];if(!c&&p>=a&&p<=b||c&&(p<a||p>b)){var r=3*k;g[r+0]=d[m+0];g[r+1]=d[m+1];g[r+2]=d[m+2];h[k]=p;k+=1}}this.dataPosition=new Float32Array(this.__dataPositionBuffer,0,3*k);this.data=new Float32Array(this.__dataBuffer,0,k)}this.__minValue=
a;this.__maxValue=b;this.__outside=c}},makeDataPosition:function(){for(var a=this.nz,b=this.ny,c=this.nx,d=new Float32Array(c*b*a*3),e=0,f=0;f<a;++f)for(var g=0;g<b;++g)for(var h=0;h<c;++h)d[e+0]=h,d[e+1]=g,d[e+2]=f,e+=3;this.matrix.applyToVector3Array(d);this.__dataPosition=this.dataPosition=d},getDataAtomindex:function(){return this.dataAtomindex},getDataPosition:function(){return this.dataPosition},getDataColor:function(a){a=a||{};a.volume=this;a.scale=a.scale||"Spectral";a.domain=a.domain||[this.getDataMin(),
this.getDataMax()];a=NGL.ColorMakerRegistry.getScheme(a);for(var b=this.dataPosition.length/3,c=new Float32Array(3*b),d=0;d<b;++d)a.volumeColorToArray(d,c,3*d);return c},getPickingDataColor:function(a){a=Object.assign(a||{});a.scheme="picking";return this.getDataColor(a)},getDataSize:function(a,b){var c=this.dataPosition.length/3,d;switch(a){case "value":d=new Float32Array(this.data);break;case "abs-value":d=new Float32Array(this.data);for(var e=0;e<c;++e)d[e]=Math.abs(d[e]);break;case "value-min":d=
new Float32Array(this.data);for(var f=this.getDataMin(),e=0;e<c;++e)d[e]-=f;break;case "deviation":d=new Float32Array(this.data);break;default:d=NGL.Utils.uniformArray(c,a)}if(1!==b)for(e=0;e<c;++e)d[e]*=b;return d},getDataMin:function(){if(void 0===this.__dataMin){for(var a=this.__data,b=a.length,c=Infinity,d=0;d<b;++d)c=Math.min(c,a[d]);this.__dataMin=c}return this.__dataMin},getDataMax:function(){if(void 0===this.__dataMax){for(var a=this.__data,b=a.length,c=-Infinity,d=0;d<b;++d)c=Math.max(c,
a[d]);this.__dataMax=c}return this.__dataMax},getDataMean:function(){if(void 0===this.__dataMean){for(var a=this.__data,b=a.length,c=0,d=0;d<b;++d)c+=a[d];this.__dataMean=c/b}return this.__dataMean},getDataRms:function(){if(void 0===this.__dataRms){var a=this.__data,b=a.length,c=0,d,e;for(e=0;e<b;++e)d=a[e],c+=d*d;this.__dataRms=Math.sqrt(c/b)}return this.__dataRms},clone:function(){var a=new NGL.Volume(this.name,this.path,this.__data,this.nx,this.ny,this.nz,this.__dataAtomindex);a.matrix.copy(this.matrix);
this.header&&(a.header=Object.assign({},this.header));return a},toJSON:function(){var a={metadata:{version:.1,type:"Volume",generator:"VolumeExporter"},name:this.name,path:this.path,data:this.__data,nx:this.nx,ny:this.ny,nz:this.nz,dataAtomindex:this.__dataAtomindex,matrix:this.matrix.toArray(),normalMatrix:this.normalMatrix.toArray(),inverseMatrix:this.inverseMatrix.toArray(),center:this.center.toArray(),boundingBox:{min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}};this.header&&
(a.header=Object.assign({},this.header));return a},fromJSON:function(a){this.name=a.name;this.path=a.path;this.setData(a.data,a.nx,a.ny,a.nz,a.dataAtomindex);this.matrix.fromArray(a.matrix);this.normalMatrix.fromArray(a.normalMatrix);this.inverseMatrix.fromArray(a.inverseMatrix);a.header&&(this.header=Object.assign({},a.header));this.center.fromArray(a.center);this.boundingBox.set(a.boundingBox.min,a.boundingBox.max);return this},getTransferable:function(){var a=[this.__data.buffer];this.__dataAtomindex&&
a.push(this.__dataAtomindex.buffer);return a},dispose:function(){this.workerPool&&this.workerPool.terminate();NGL.GidPool.removeObject(this)}};
NGL.MarchingCubes=function(a,b,c,d,e){NGL.time("NGL.MarchingCubes");b=new Int32Array([b,c,d]);c=NGL.MarchingCubes.edgeTable;d=NGL.MarchingCubes.triTable;var f=NGL.MarchingCubes.cubeVerts,g=NGL.MarchingCubes.edgeIndex,h=[],k=[],l=0,m=0,p=0,r=new Float32Array(8),n=new Int32Array(12),q=new Int32Array(3);for(q[2]=0;q[2]<b[2]-1;++q[2],p+=b[0])for(q[1]=0;q[1]<b[1]-1;++q[1],++p)for(q[0]=0;q[0]<b[0]-1;++q[0],++p){for(var t=0,u=0;8>u;++u){var s=f[u],s=a[p+s[0]+b[0]*(s[1]+b[1]*s[2])]-e;r[u]=s;t|=0<s?1<<u:0}s=
c[t];if(0!==s){for(u=0;12>u;++u)if(0!==(s&1<<u)){n[u]=l/3;var v=g[u],y=f[v[0]],x=f[v[1]],B=r[v[0]],v=B-r[v[1]],G=0;1E-6<Math.abs(v)&&(G=B/v);h[l+0]=q[0]+y[0]+G*(x[0]-y[0]);h[l+1]=q[1]+y[1]+G*(x[1]-y[1]);h[l+2]=q[2]+y[2]+G*(x[2]-y[2]);l+=3}t=d[t];for(u=0;u<t.length;u+=3)k[m+0]=n[t[u+0]],k[m+1]=n[t[u+1]],k[m+2]=n[t[u+2]],m+=3}}NGL.timeEnd("NGL.MarchingCubes");return{position:new Float32Array(h),normal:void 0,index:new Uint32Array(k)}};
NGL.MarchingCubes2=function(a,b,c,d,e){function f(a,b,c){return a+(b-a)*c}function g(a,b,c,d,g,h,k){if(0>y[a]){h=(n-h)/(k-h);k=v;var l=3*x;F[l+0]=c+h;F[l+1]=d;F[l+2]=g;q||(c=3*a,w[l]=-f(k[c],k[c+3],h),w[l+1]=-f(k[c+1],k[c+4],h),w[l+2]=-f(k[c+2],k[c+5],h));e&&(C[x]=e[a+h]);y[a]=x;G[b]=x;x+=1}else G[b]=y[a]}function h(a,b,c,d,g,h,k){if(0>y[a]){h=(n-h)/(k-h);k=v;var l=3*x;F[l]=c;F[l+1]=d+h;F[l+2]=g;q||(c=3*a,d=c+3*u,w[l]=-f(k[c],k[d],h),w[l+1]=-f(k[c+1],k[d+1],h),w[l+2]=-f(k[c+2],k[d+2],h));e&&(C[x]=
e[a+h*u]);y[a]=x;G[b]=x;x+=1}else G[b]=y[a]}function k(a,b,c,d,g,h,k){if(0>y[a]){h=(n-h)/(k-h);k=v;var l=3*x;F[l]=c;F[l+1]=d;F[l+2]=g+h;q||(c=3*a,d=c+3*s,w[l]=-f(k[c],k[d],h),w[l+1]=-f(k[c+1],k[d+1],h),w[l+2]=-f(k[c+2],k[d+2],h));e&&(C[x]=e[a+h*s]);y[a]=x;G[b]=x;x+=1}else G[b]=y[a]}function l(b){var c=3*b;0===v[c]&&(v[c]=a[b-1]-a[b+1],v[c+1]=a[b-u]-a[b+u],v[c+2]=a[b-s]-a[b+s])}function m(e,f,m,t,v,w){var A,x,D,C,H,F;e=void 0!==e?e:0;f=void 0!==f?f:0;m=void 0!==m?m:0;t=void 0!==t?t:b-1;v=void 0!==
v?v:c-1;w=void 0!==w?w:d-1;q?(e=Math.max(0,e),f=Math.max(0,f),m=Math.max(0,m),t=Math.min(b-1,t),v=Math.min(c-1,v),w=Math.min(d-1,w)):(e=Math.max(1,e),f=Math.max(1,f),m=Math.max(1,m),t=Math.min(b-2,t),v=Math.min(c-2,v),w=Math.min(d-2,w));var M=Math.max(0,e-2),U=Math.max(0,f-2);x=Math.max(0,m-2);var S=Math.min(b,t+2),ga=Math.min(c,v+2),ja=Math.min(d,w+2);for(C=x;C<ja;++C)for(F=s*C,D=U;D<ga;++D)for(H=F+u*D,x=M;x<S;++x)A=H+x,y[A]=-1;F=e;M=f;U=m;S=t;ga=v;ja=w;H=!1;for(C=m;C<w;++C){for(D=f;D<v;++D){for(x=
e;x<t;++x)if(A=b*c*C+b*D+x,a[A]>=n){U=C;H=!0;break}if(H)break}if(H)break}H=!1;for(D=f;D<v;++D){for(C=U;C<w;++C){for(x=e;x<t;++x)if(A=b*c*C+b*D+x,a[A]>=n){M=D;H=!0;break}if(H)break}if(H)break}H=!1;for(x=e;x<t;++x){for(D=M;D<v;++D){for(C=U;C<w;++C)if(A=b*c*C+b*D+x,a[A]>=n){F=x;H=!0;break}if(H)break}if(H)break}H=!1;for(C=w;C>=m;--C){for(D=v;D>=f;--D){for(x=t;x>=e;--x)if(A=b*c*C+b*D+x,a[A]>=n){ja=C;H=!0;break}if(H)break}if(H)break}H=!1;for(D=v;D>=f;--D){for(C=ja;C>=m;--C){for(x=t;x>=e;--x)if(A=b*c*C+
b*D+x,a[A]>=n){ga=D;H=!0;break}if(H)break}if(H)break}H=!1;for(x=t;x>=e;--x){for(D=ga;D>=f;--D){for(C=ja;C>=m;--C)if(A=b*c*C+b*D+x,a[A]>=n){S=x;H=!0;break}if(H)break}if(H)break}q?(e=Math.max(0,F-1),f=Math.max(0,M-1),m=Math.max(0,U-1),t=Math.min(b-1,S+1),v=Math.min(c-1,ga+1),w=Math.min(d-1,ja+1)):(e=Math.max(1,F-1),f=Math.max(1,M-1),m=Math.max(1,U-1),t=Math.min(b-2,S+1),v=Math.min(c-2,ga+1),w=Math.min(d-2,ja+1));for(C=m;C<w;++C)for(F=s*C,D=f;D<v;++D)for(H=F+u*D,x=e;x<t;++x){A=H+x;m=x;var M=D,U=C,S=
A,ga=S+1,ja=S+u,V=S+s,I=ga+u,Q=ga+s,Y=S+u+s,Z=ga+u+s;A=0;var J=a[S],E=a[ga],sa=a[ja],Da=a[I],ya=a[V],za=a[Q],Ea=a[Y],ta=a[Z];J<n&&(A|=1);E<n&&(A|=2);sa<n&&(A|=8);Da<n&&(A|=4);ya<n&&(A|=16);za<n&&(A|=32);Ea<n&&(A|=128);ta<n&&(A|=64);var la=p[A];if(0!==la){var va=m+1,Fa=M+1,Ga=U+1;la&1&&(q||(l(S),l(ga)),g(S,0,m,M,U,J,E));la&2&&(q||(l(ga),l(I)),h(ga,1,va,M,U,E,Da));la&4&&(q||(l(ja),l(I)),g(ja,2,m,Fa,U,sa,Da));la&8&&(q||(l(S),l(ja)),h(S,3,m,M,U,J,sa));la&16&&(q||(l(V),l(Q)),g(V,4,m,M,Ga,ya,za));la&32&&
(q||(l(Q),l(Z)),h(Q,5,va,M,Ga,za,ta));la&64&&(q||(l(Y),l(Z)),g(Y,6,m,Fa,Ga,Ea,ta));la&128&&(q||(l(V),l(Y)),h(V,7,m,M,Ga,ya,Ea));la&256&&(q||(l(S),l(V)),k(S,8,m,M,U,J,ya));la&512&&(q||(l(ga),l(Q)),k(ga,9,va,M,U,E,za));la&1024&&(q||(l(I),l(Z)),k(I,10,va,Fa,U,Da,ta));la&2048&&(q||(l(ja),l(Y)),k(ja,11,m,Fa,U,sa,Ea));A<<=4;U=M=m=void 0;for(S=0;-1!=r[A+S];)m=A+S,M=m+1,U=m+2,z[B]=G[r[M]],z[B+1]=G[r[m]],z[B+2]=G[r[U]],B+=3,S+=3}}}var p=NGL.MarchingCubes.edgeTable,r=NGL.MarchingCubes.triTable2,n=0,q=!1,t=
b*c*d,u=b,s=b*c,v,y,x,B,G=new Int32Array(12),F=[],w=[],z=[],C=[];this.triangulate=function(a,b,c){NGL.time("NGL.MarchingCubes2.triangulate");n=a;(q=b)||v||(v=new Float32Array(3*t));y||(y=new Int32Array(t));B=x=0;void 0!==c?(c.min.round(),c.max.round(),m(c.min.x,c.min.y,c.min.z,c.max.x,c.max.y,c.max.z)):m();F.length=3*x;q||(w.length=3*x);z.length=B;e&&(C.length=x);NGL.timeEnd("NGL.MarchingCubes2.triangulate");return{position:new Float32Array(F),normal:q?void 0:new Float32Array(w),index:new Uint32Array(z),
atomindex:e?new Int32Array(C):void 0}}};
NGL.MarchingCubes.edgeTable=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,
1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,
1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]);
NGL.MarchingCubes.triTable=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,
3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,
8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,
10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],
[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,
10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,
6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],
[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,
6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,
1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,
2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,
2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]];
NGL.MarchingCubes.triTable2=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,
-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,
9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,
-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,
-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,
-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,
2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,
-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,
-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,
-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,
1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,
-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,
2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,
3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,
6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,
-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,
5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,
0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,
1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,
-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);NGL.MarchingCubes.cubeVerts=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]];NGL.MarchingCubes.edgeIndex=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];
NGL.laplacianSmooth=function(a,b,c,d){NGL.time("NGL.laplacianSmooth");c=c||1;d=d||!0;var e=a.length/3,f=b.length/3;if(d){var g=new THREE.BufferGeometry;g.addAttribute("position",new THREE.BufferAttribute(a,3));g.addIndex(new THREE.BufferAttribute(b,1))}for(var h=new Float32Array(3*e),k=Array(20),l=0;20>l;++l)k[l]=new Uint32Array(e);for(l=0;l<e;++l)k[0][l]=0;for(var m,p,r,l=0;l<f;++l){var n=3*l,q=3*l+1,t=3*l+2;r=!0;m=0;for(p=k[0][b[n]];m<p;++m)if(b[q]==k[m+1][b[n]]){r=!1;break}r&&(k[0][b[n]]++,k[k[0][b[n]]][b[n]]=
b[q]);r=!0;m=0;for(p=k[0][b[n]];m<p;++m)if(b[t]==k[m+1][b[n]]){r=!1;break}r&&(k[0][b[n]]++,k[k[0][b[n]]][b[n]]=b[t]);r=!0;m=0;for(p=k[0][b[q]];m<p;++m)if(b[n]==k[m+1][b[q]]){r=!1;break}r&&(k[0][b[q]]++,k[k[0][b[q]]][b[q]]=b[n]);r=!0;m=0;for(p=k[0][b[q]];m<p;++m)if(b[t]==k[m+1][b[q]]){r=!1;break}r&&(k[0][b[q]]++,k[k[0][b[q]]][b[q]]=b[t]);r=!0;for(m=0;m<k[0][b[t]];++m)if(b[n]==k[m+1][b[t]]){r=!1;break}r&&(k[0][b[t]]++,k[k[0][b[t]]][b[t]]=b[n]);r=!0;m=0;for(p=k[0][b[t]];m<p;++m)if(b[q]==k[m+1][b[t]]){r=
!1;break}r&&(k[0][b[t]]++,k[k[0][b[t]]][b[t]]=b[q])}f=.75/4.5;for(p=0;p<c;++p){for(l=0;l<e;++l)if(b=3*l,n=k[0][l],3>n)h[b]=a[b],h[b+1]=a[b+1],h[b+2]=a[b+2];else{if(3===n||4===n){h[b]=0;h[b+1]=0;for(m=h[b+2]=0;m<n;++m)r=3*k[m+1][l],h[b]+=a[r],h[b+1]+=a[r+1],h[b+2]+=a[r+2];h[b]+=.5*a[b];h[b+1]+=.5*a[b+1];h[b+2]+=.5*a[b+2];m=.5+n}else{h[b]=0;h[b+1]=0;for(m=h[b+2]=0;m<n;++m)r=3*k[m+1][l],h[b]+=a[r],h[b+1]+=a[r+1],h[b+2]+=a[r+2];h[b]+=1*a[b];h[b+1]+=1*a[b+1];h[b+2]+=1*a[b+2];m=1+n}h[b]/=m;h[b+1]/=m;h[b+
2]/=m}a.set(h);if(d)for(g.computeVertexNormals(),l=g.attributes.normal.array,m=3*e,b=0;b<m;b+=3)a[b]+=-1*f*l[b],a[b+1]+=-1*f*l[b+1],a[b+2]+=-1*f*l[b+2]}d&&g.dispose();NGL.timeEnd("NGL.laplacianSmooth")};
NGL.WorkerRegistry.add("molsurf",function(a,b){NGL.time("WORKER molsurf");var c=a.data,d=c.params;c.atomSet&&(self.molsurf=new NGL.MolecularSurface((new NGL.AtomSet).fromJSON(c.atomSet)));c=self.molsurf.getSurface(d.type,d.probeRadius,d.scaleFactor,d.smooth,d.lowRes,d.cutoff);NGL.timeEnd("WORKER molsurf");b(c.toJSON(),c.getTransferable())});NGL.MolecularSurface=function(a){this.atomSet=a};
NGL.MolecularSurface.prototype={getSurface:function(a,b,c,d,e,f){var g=(new NGL.EDTSurface(this.atomSet)).getVolume(a,b,c,e,f),h=g.getSurface(1,d);h.info.type=a;h.info.probeRadius=b;h.info.scaleFactor=c;h.info.smooth=d;h.info.lowRes=e;h.info.cutoff=f;g.dispose();return h},getSurfaceWorker:function(a,b,c,d,e,f,g){if(NGL.useWorker&&"undefined"!==typeof Worker&&"function"!==typeof importScripts){var h=void 0;void 0===this.worker&&(h=this.atomSet.toJSON(),this.worker=new NGL.Worker("molsurf"));this.worker.post({atomSet:h,
params:{type:a,probeRadius:b,scaleFactor:c,smooth:d,lowRes:e,cutoff:f}},void 0,function(a){a=NGL.fromJSON(a.data);g(a)}.bind(this),function(h){console.warn("NGL.MolecularSurface.generateSurfaceWorker error - trying without worker",h);this.worker.terminate();this.worker=void 0;h=this.getSurface(a,b,c,d,e,f);g(h)}.bind(this))}else h=this.getSurface(a,b,c,d,e,f),g(h)},dispose:function(){this.worker&&this.worker.terminate()}};
NGL.EDTSurface=function(a){function b(a){var b,c,d,g,h,k,l,m;for(m in B)if(b=B[m],!n[m]){c=a?(b+e)*f+.5:b*f+.5;b=c*c;h=Math.floor(c)+1;k=new Int32Array(h*h);for(c=l=0;c<h;++c)for(d=0;d<h;++d)g=c*c+d*d,g>b?k[l]=-1:(g=Math.sqrt(b-g),k[l]=Math.floor(g)),++l;q[m]=h;n[m]=k}}var c=a.atoms,d=a.getBoundingBox(),e,f,g,h,k,l,m,p,r,n,q,t,u,s,v,y,x,B,G,F=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,
1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getVolume=
function(a,z,C,L,O,W){NGL.time("NGL.EDTSurface.getVolume");var K="vws"!==a,P=W=!0;e=z||1.4;f=C||2;h=L||!1;u=P||!0;h?(x="resname",B=NGL.ResidueRadii,G=new NGL.Selection(".CA")):(x="element",B=NGL.VdwRadii,G=void 0);var da=0,A;for(A in B)da=Math.max(da,B[A]);var X=NGL.getSurfaceGrid(d,da,f,K?e:0);k=X.dim.x;l=X.dim.y;m=X.dim.z;p=X.matrix;r=X.tran;f=X.scaleFactor;n={};q={};b(K);t=e*f;g=O?O:Math.max(.1,-1.2+f*e);s=new Uint8Array(k*l*m);K&&(v=new Float64Array(k*l*m));u&&(y=new Int32Array(k*l*m));NGL.time("NGL.EDTSurface fillvoxels");
var D,R;D=0;for(R=s.length;D<R;++D)s[D]=0,K&&(v[D]=-1),u&&(y[D]=-1);D=0;for(R=c.length;D<R;++D){var H=D,xa=void 0,M=void 0,U=void 0,S=void 0,ga=void 0,ja=void 0,V=void 0,I=void 0,Q=void 0,Y=void 0,Z=void 0,J=void 0,E=void 0,sa=void 0,Da=void 0,ya=void 0,za=void 0,Ea=void 0,ta=c[H];if(!G||G.test(ta))for(var xa=Math.floor(.5+f*(ta.x+r.x)),M=Math.floor(.5+f*(ta.y+r.y)),U=Math.floor(.5+f*(ta.z+r.z)),la=ta[x],va=n[la],Fa=0,Ga=l*m,Ta=q[la],Qa=void 0,Y=0;Y<Ta;++Y)for(Z=0;Z<Ta;++Z){Qa=va[Fa];if(-1!=Qa)for(ya=
-1;2>ya;++ya)for(za=-1;2>za;++za)for(Ea=-1;2>Ea;++Ea)if(0!==ya&&0!==za&&0!==Ea)for(V=ya*Y,Q=Ea*Z,J=0;J<=Qa;++J)if(I=J*za,E=xa+V,sa=M+I,Da=U+Q,!(0>E||0>sa||0>Da||E>=k||sa>=l||Da>=m)){var Aa=E*Ga+sa*m+Da;if(!u)s[Aa]|=1;else if(!(s[Aa]&1))s[Aa]|=1,y[Aa]=H;else if(s[Aa]&1){var ia=c[y[Aa]];ia!==ta&&(S=xa+V-Math.floor(.5+f*(ia.x+r.x)),ga=M+I-Math.floor(.5+f*(ia.y+r.y)),ja=U+Q-Math.floor(.5+f*(ia.z+r.z)),V*V+I*I+Q*Q<S*S+ga*ga+ja*ja&&(y[Aa]=H))}}Fa++}}D=0;for(R=s.length;D<R;++D)s[D]&1&&(s[D]|=2);NGL.timeEnd("NGL.EDTSurface fillvoxels");
var Ua,Va,Wa,Eb=l*m;for(Ua=0;Ua<k;++Ua)for(Va=0;Va<m;++Va)for(Wa=0;Wa<l;++Wa){var pb=Ua*Eb+Wa*m+Va;if(s[pb]&1)for(var Xa=0;26>Xa;){var qb=Ua+F[Xa][0],rb=Va+F[Xa][2],sb=Wa+F[Xa][1];if(-1<qb&&qb<k&&-1<sb&&sb<l&&-1<rb&&rb<m&&!(s[qb*Eb+sb*m+rb]&1)){s[pb]|=4;break}else Xa++}}if("ms"===a||"ses"===a){NGL.time("NGL.EDTSurface fastdistancemap");var ha,qa,ra,Fb,tb=new NGL.Grid(k,l,m,Uint16Array,3),Ya=l*m,Lb=t*t,Za=0,ub=0,ea;console.log("l, w, h",k,l,m);for(ha=0;ha<k;++ha)for(qa=0;qa<l;++qa)for(ra=0;ra<m;++ra)ea=
ha*Ya+qa*m+ra,s[ea]&=-3,s[ea]&1&&(s[ea]&4?(tb.set(ha,qa,ra,ha,qa,ra),v[ea]=0,s[ea]|=2,Za+=1):ub+=1);console.log("totalsurfacevox",Za);console.log("totalinnervox",ub);var Na=new Int32Array(3*Za),wa=0,Oa=new Int32Array(3*Za),vb=0;for(ha=0;ha<k;++ha)for(qa=0;qa<l;++qa)for(ra=0;ra<m;++ra)ea=ha*Ya+qa*m+ra,s[ea]&4&&(Na[wa]=ha,Na[wa+1]=qa,Na[wa+2]=ra,wa+=3,s[ea]&=-5);do{var Ha=Na,Ia=tb,$a=wa,ma=Oa;console.log("positin",$a/3);var Ja=void 0,Ka=void 0,La=void 0,na=void 0,oa=void 0,pa=void 0,ka=void 0,Ba=void 0,
Ra=void 0,ua=void 0,N=void 0,Ca=void 0,fa=new Uint16Array(3),$=0;if(0!==$a){for(var aa=-1,ba=-1,ca=-1,wb=l*m,ka=0,Ra=$a;ka<Ra;ka+=3)for(Ja=Ha[ka],Ka=Ha[ka+1],La=Ha[ka+2],Ia.toArray(Ja,Ka,La,fa),Ba=0;6>Ba;++Ba)Ca=F[Ba],aa=Ja+Ca[0],ba=Ka+Ca[1],ca=La+Ca[2],aa<k&&-1<aa&&ba<l&&-1<ba&&ca<m&&-1<ca&&(N=aa*wb+m*ba+ca,s[N]&1&&!(s[N]&2)?(Ia.fromArray(aa,ba,ca,fa),na=aa-fa[0],oa=ba-fa[1],pa=ca-fa[2],ua=na*na+oa*oa+pa*pa,v[N]=ua,s[N]|=2,s[N]|=4,ma[$]=aa,ma[$+1]=ba,ma[$+2]=ca,$+=3):s[N]&1&&s[N]&2&&(na=aa-fa[0],
oa=ba-fa[1],pa=ca-fa[2],ua=na*na+oa*oa+pa*pa,ua<v[N]&&(Ia.fromArray(aa,ba,ca,fa),v[N]=ua,s[N]&4||(s[N]|=4,ma[$]=aa,ma[$+1]=ba,ma[$+2]=ca,$+=3))));ka=0;for(Ra=$a;ka<Ra;ka+=3)for(Ja=Ha[ka],Ka=Ha[ka+1],La=Ha[ka+2],Ia.toArray(Ja,Ka,La,fa),Ba=6;18>Ba;Ba++)Ca=F[Ba],aa=Ja+Ca[0],ba=Ka+Ca[1],ca=La+Ca[2],aa<k&&-1<aa&&ba<l&&-1<ba&&ca<m&&-1<ca&&(N=aa*wb+m*ba+ca,s[N]&1&&!(s[N]&2)?(Ia.fromArray(aa,ba,ca,fa),na=aa-fa[0],oa=ba-fa[1],pa=ca-fa[2],ua=na*na+oa*oa+pa*pa,v[N]=ua,s[N]|=2,s[N]|=4,ma[$]=aa,ma[$+1]=ba,ma[$+
2]=ca,$+=3):s[N]&1&&s[N]&2&&(na=aa-fa[0],oa=ba-fa[1],pa=ca-fa[2],ua=na*na+oa*oa+pa*pa,ua<v[N]&&(Ia.fromArray(aa,ba,ca,fa),v[N]=ua,s[N]&4||(s[N]|=4,ma[$]=aa,ma[$+1]=ba,ma[$+2]=ca,$+=3))));ka=0;for(Ra=$a;ka<Ra;ka+=3)for(Ja=Ha[ka],Ka=Ha[ka+1],La=Ha[ka+2],Ia.toArray(Ja,Ka,La,fa),Ba=18;26>Ba;Ba++)Ca=F[Ba],aa=Ja+Ca[0],ba=Ka+Ca[1],ca=La+Ca[2],aa<k&&-1<aa&&ba<l&&-1<ba&&ca<m&&-1<ca&&(N=aa*wb+m*ba+ca,s[N]&1&&!(s[N]&2)?(Ia.fromArray(aa,ba,ca,fa),na=aa-fa[0],oa=ba-fa[1],pa=ca-fa[2],ua=na*na+oa*oa+pa*pa,v[N]=
ua,s[N]|=2,s[N]|=4,ma[$]=aa,ma[$+1]=ba,ma[$+2]=ca,$+=3):s[N]&1&&s[N]&2&&(na=aa-fa[0],oa=ba-fa[1],pa=ca-fa[2],ua=na*na+oa*oa+pa*pa,ua<v[N]&&(Ia.fromArray(aa,ba,ca,fa),v[N]=ua,s[N]&4||(s[N]|=4,ma[$]=aa,ma[$+1]=ba,ma[$+2]=ca,$+=3))))}vb=$;wa=0;console.log("positout",vb/3);ha=0;for(Fb=vb;ha<Fb;ha+=3)ea=Ya*Oa[ha]+m*Oa[ha+1]+Oa[ha+2],s[ea]&=-5,v[ea]<=1.0404*Lb&&(Na[wa]=Oa[ha],Na[wa+1]=Oa[ha+1],Na[wa+2]=Oa[ha+2],wa+=3)}while(0<wa);var Mb=g*g,Gb,db=new Uint16Array(3);for(ha=0;ha<k;++ha)for(qa=0;qa<l;++qa)for(ra=
0;ra<m;++ra)ea=ha*Ya+qa*m+ra,s[ea]&=-5,s[ea]&1&&(!(s[ea]&2)||s[ea]&2&&v[ea]>=Mb)&&(s[ea]|=4,u&&s[ea]&2&&(tb.toArray(ha,qa,ra,db),Gb=db[0]*Ya+db[1]*m+db[2],y[ea]=y[Gb]));NGL.timeEnd("NGL.EDTSurface fastdistancemap")}if("ses"===a){b(!1);var Ma,eb;Ma=0;for(eb=s.length;Ma<eb;++Ma)s[Ma]&=-3;Ma=0;for(eb=c.length;Ma<eb;++Ma){var Hb=void 0,Ib=void 0,Jb=void 0,xb=void 0,yb=void 0,zb=void 0,Ab=0,fb=void 0,gb=void 0,hb=void 0,ib=void 0,jb=void 0,kb=void 0,lb=void 0,mb=void 0,nb=void 0,ab=void 0,bb=void 0,cb=
void 0,Bb=void 0,Pa=c[Ma];if(!G||G.test(Pa))for(var Hb=Math.floor(.5+f*(Pa.x+r.x)),Ib=Math.floor(.5+f*(Pa.y+r.y)),Jb=Math.floor(.5+f*(Pa.z+r.z)),Cb=Pa[x],Nb=l*m,lb=0,Bb=q[Cb];lb<Bb;++lb)for(mb=0;mb<Bb;++mb){if(-1!=n[Cb][Ab])for(ab=-1;2>ab;++ab)for(bb=-1;2>bb;++bb)for(cb=-1;2>cb;++cb)if(0!==ab&&0!==bb&&0!==cb)for(fb=ab*lb,hb=cb*mb,nb=0;nb<=n[Cb][Ab];++nb)if(gb=nb*bb,ib=Hb+fb,jb=Ib+gb,kb=Jb+hb,!(0>ib||0>jb||0>kb||ib>=k||jb>=l||kb>=m)){var Sa=ib*Nb+jb*m+kb;if(!(s[Sa]&2))s[Sa]|=2,u&&(y[Sa]=Pa.index);
else if(u){var Db=c[y[Sa]],xb=Math.floor(.5+f*(Db.x+r.x)),yb=Math.floor(.5+f*(Db.y+r.y)),zb=Math.floor(.5+f*(Db.z+r.z));fb*fb+gb*gb+hb*hb<xb*xb+yb*yb+zb*zb&&(y[Sa]=Pa.index)}}Ab++}}}var ob=s.length;if("vws"===a)for(var T=0;T<ob;++T)s[T]&=-5,s[T]=s[T]&2?1:0;else if("ms"===a)for(T=0;T<ob;++T)s[T]&=-3,s[T]&4&&(s[T]|=2),s[T]&=-5,s[T]=s[T]&2?1:0;else if("ses"===a)for(T=0;T<ob;++T)s[T]&4&&s[T]&2?s[T]&=-5:s[T]&4&&!(s[T]&2)&&(s[T]|=2),s[T]=s[T]&2?1:0;else if("sas"===a)for(T=0;T<ob;++T)s[T]&=-5,s[T]=s[T]&
2?1:0;var Kb=new NGL.Volume(a,"",s,m,l,k,y);Kb.setMatrix(p);NGL.timeEnd("NGL.EDTSurface.getVolume");return Kb}};
NGL.getSurfaceGrid=function(a,b,c,d){var e;e=1/c*3+b;b=(new THREE.Vector3).copy(a.min);a=(new THREE.Vector3).copy(a.max);b.subScalar(d+e);a.addScalar(d+e);b.multiplyScalar(c).floor().divideScalar(c);a.multiplyScalar(c).ceil().divideScalar(c);d=(new THREE.Vector3).subVectors(a,b).multiplyScalar(c).ceil().addScalar(1);e=256*Math.pow(10,6);var f=d.x*d.y*d.z*3;e<=f&&(c*=Math.pow(e/f,1/3),b.multiplyScalar(c).floor().divideScalar(c),a.multiplyScalar(c).ceil().divideScalar(c),d.subVectors(a,b).multiplyScalar(c).ceil().addScalar(1));
b=(new THREE.Vector3).copy(b).negate();a=new THREE.Matrix4;a.multiply((new THREE.Matrix4).makeRotationY(THREE.Math.degToRad(90)));a.multiply((new THREE.Matrix4).makeScale(-1/c,1/c,1/c));a.multiply((new THREE.Matrix4).makeTranslation(-c*b.z,-c*b.y,-c*b.x));return{dim:d,tran:b,matrix:a,scaleFactor:c}};
NGL.Script=function(a,b,c){var d=signals;this.signals={elementAdded:new d.Signal,nameChanged:new d.Signal};this.name=b;this.path=c;this.dir=c.substring(0,c.lastIndexOf("/")+1);try{this.fn=new Function("stage","panel","__name__","__path__","__dir__",Object.keys(NGL.makeScriptHelper()).join(","),a)}catch(e){NGL.error("NGL.Script compilation failed",e),this.fn=null}};
NGL.Script.prototype={constructor:NGL.Script,call:function(a,b){function c(){"function"===typeof b&&b()}var d={add:function(a){this.signals.elementAdded.dispatch(arguments)}.bind(this),setName:function(a){this.signals.nameChanged.dispatch(a)}.bind(this)},e=new NGL.ScriptQueue(a,this.dir,b),f=NGL.makeScriptHelper(a,e,d);if(this.fn){var g=[a,d,this.name,this.path,this.dir];try{var h=[];Object.keys(f).forEach(function(a){h.push(f[a])});this.fn.apply(null,g.concat(h))}catch(k){NGL.error("NGL.Script.fn",
k)}}else NGL.log("NGL.Script.call no function available");e.then(c,function(){d.add(new UI.Text("ERROR"));c()})}};NGL.ScriptQueue=function(a,b,c){this.stage=a;this.dir=b||"";this.onFinish=c;this.promise=new Promise(function(a,b){a()})};
NGL.ScriptQueue.prototype={constructor:NGL.ScriptQueue,load:function(a,b){var c={},d=this.dir+a,e,f=b||{};"function"===typeof b?(e=b,f={}):e=f.onLoad;f.onLoad=function(a){a.requestGuiVisibility(!1);"function"===typeof e&&e(a);c.resolve?c.resolve():c.success=!0};f.onError=function(a){c.reject?c.reject(a):c.error=a||"error"};this.stage.loadFile(d,f);var g=function(a,b){!0===c.success?a():void 0!==c.error?b(c.error):(c.resolve=a,c.reject=b)};this.promise=this.promise.then(function(){return new Promise(g)})},
then:function(a,b){this.promise=this.promise.then(a,function(a){NGL.error("NGL.ScriptQueue.then",a);"function"===typeof b&&b()})}};
NGL.makeScriptHelper=function(a,b,c){function d(a){a.setVisibility(!1)}function e(a,b){b&&d();a.setVisibility(!0)}function f(a){a=void 0===a?1:a;for(var b=0;b<a;++b)c.add(new UI.Break)}var g=NGL.unicodeHelper;return{load:function(){b.load.apply(b,arguments)},then:function(){b.then.apply(b,arguments)},components:function(b){return a.getComponentsByName(b)},representations:function(b){return a.getRepresentationsByName(b)},structures:function(b){return a.getComponentsByName(b,NGL.StructureComponent)},
color:function(a,b){b.setColor(a)},visibility:function(a,b){b.setVisibility(a)},hide:d,show:e,superpose:function(a,b,c,d,e,f,g){a.superpose(b,c,d,e,f,g)},uiText:function(a,b){var d=new UI.Text(g(a));c.add(d);b&&f(1);return d},uiHtml:function(a,b){var d=new UI.Html(g(a));c.add(d);b&&f(1);return d},uiBreak:f,uiSelect:function(a,b){if(Array.isArray(a)){var d={};a.forEach(function(a){d[a]=a});a=d}var e=(new UI.Select).setOptions(a).onChange(function(){b(e)});c.add(e);return e},uiButton:function(a,b){var d=
(new UI.Button(g(a))).onClick(function(){b(d)});c.add(d);return d},uiOpenButton:function(a,b,d){a=(new UI.Button(g(a))).onClick(function(){NGL.open(b,d)});c.add(a);return a},uiDownloadButton:function(a,b,d){a=(new UI.Button(g(a))).onClick(function(){NGL.download(b(),d)});c.add(a);return a},uiVisibilitySelect:function(b){function f(){var a=[];g.forEach(function(b){b.visible&&a.push(b.name)});return a}var g=b.list,m={"":"[show]"};g.forEach(function(a){m[a.name]=a.name;a.signals.visibilityChanged.add(function(){var b=
f();b.length===g.length?p.setValue(""):a.visible?p.setValue(a.name):p.setValue(b[0])})});var p=(new UI.Select).setOptions(m).onChange(function(){var c=p.getValue();""===c?e(b):(d(b),e(a.getAnythingByName(c)))});c.add(p);return p},uiVisibilityButton:function(a,b){function c(){var a=!1;d.forEach(function(b){b.visible&&(a=!0)});return a}a=g(a?a:"all");b=b||new NGL.Collection;b instanceof NGL.Collection||b instanceof NGL.ComponentCollection||b instanceof NGL.RepresentationCollection||(b=new NGL.Collection([b]));
var d=b.list;d.forEach(function(b){b.signals.visibilityChanged.add(function(){e.setLabel((c()?"hide ":"show ")+a)})});var e=(new UI.Button((c()?"hide ":"show ")+a)).onClick(function(){var a=!c();b.setVisibility(a)});return e},uiPlayButton:function(a,b,d,e,f,r){b=b.trajectory;a=g(a);var n=new NGL.TrajectoryPlayer(b,d,e,f,r);n.mode="once";var q=(new UI.Button("play "+a)).onClick(function(){n.toggle()});n.signals.startedRunning.add(function(){q.setLabel("pause "+a)});n.signals.haltedRunning.add(function(){q.setLabel("play "+
a)});c.add(q);return q}}};NGL.Streamer=function(a,b){var c=b||{};this.compressed=void 0!==c.compressed?c.compressed:!1;this.src=a;this.chunkSize=10485760;this.newline="\n";this.__pointer=0;this.__partialLine="";this.__srcName&&(this[this.__srcName]=a)};NGL.Streamer.prototype.constructor=NGL.Streamer;
NGL.Streamer.prototype={constructor:NGL.Streamer,type:"",__srcName:void 0,onload:function(){},onprogress:function(){},onerror:function(){},read:function(a){this._read(function(b){if(this.compressed)NGL.decompressWorker(b,"foo."+this.compressed,!0,function(b){this.data=b;if("function"===typeof this.onload)this.onload(this.data);a()}.bind(this));else{b instanceof ArrayBuffer&&(b=new Uint8Array(b));this.data=b;if("function"===typeof this.onload)this.onload(this.data);a()}}.bind(this))},_read:function(a){a(this.src)},
_chunk:function(a,b){return this.data.subarray(a,b)},chunk:function(a){return this._chunk(a,a+this.chunkSize)},peekLines:function(a){var b=this.data,c=b.length,d=this.newline.charCodeAt(0),e,f=0;for(e=0;e<c&&(b[e]===d&&++f,f!==a);++e);a=this._chunk(0,e+1);return this.chunkToLines(a,"",e>c).lines},lineCount:function(){for(var a=this.data,b=a.length,c=this.newline.charCodeAt(0),d=0,e=0;e<b;++e)a[e]===c&&++d;a[b-1]!==c&&++d;return d},chunkCount:function(){return Math.floor(this.data.length/this.chunkSize)+
1},asText:function(){return NGL.Uint8ToString(this.data)},chunkToLines:function(a,b,c){var d=this.newline;a=NGL.Uint8ToString(a);var e=[],f=a.lastIndexOf(d);-1===f?b+=a:(b+=a.substr(0,f),e=e.concat(b.split(d)),b=f===a.length-d.length?"":a.substr(f+d.length));c&&""!==b&&e.push(b);return{lines:e,partialLine:b}},nextChunk:function(){var a=this.__pointer;if(!(a>this.data.length))return this.__pointer+=this.chunkSize,this.chunk(a)},nextChunkOfLines:function(){var a=this.nextChunk();if(void 0!==a)return a=
this.chunkToLines(a,this.__partialLine,this.__pointer>this.data.length),this.__partialLine=a.partialLine,a.lines},eachChunk:function(a){for(var b=this.chunkSize,c=this.data.length,d=this.chunkCount(),e=0;e<c;e+=b){var f=this.chunk(e),g=Math.round(e/b);a(f,g,d)}},eachChunkOfLines:function(a){var b="";this.eachChunk(function(c,d,e){c=this.chunkToLines(c,b,d===e+1);b=c.partialLine;a(c.lines,d,e)}.bind(this))},eachChunkOfLinesAsync:function(a,b){var c=this;async.timesSeries(c.chunkCount(),function(b,
e){NGL.processArray(c.nextChunkOfLines(),a,e)},b)},toJSON:function(){var a=this.type.substr(0,1).toUpperCase()+this.type.substr(1),a={metadata:{version:.1,type:a+"Streamer",generator:a+"StreamerExporter"},src:this.src,compressed:this.compressed,chunkSize:this.chunkSize,newline:this.newline};this.__srcName&&(a[this.__srcName]=this[this.__srcName]);return a},fromJSON:function(a){this.src=a.src;this.compressed=a.compressed;this.chunkSize=a.chunkSize;this.newline=a.newline;this.__srcName&&(this[this.__srcName]=
a[this.__srcName]);return this},getTransferable:function(){return[]},dispose:function(){delete this.src;this.__srcName&&delete this[this.__srcName]}};NGL.NetworkStreamer=function(a,b){NGL.Streamer.call(this,a,b)};
NGL.NetworkStreamer.prototype=NGL.createObject(NGL.Streamer.prototype,{constructor:NGL.NetworkStreamer,type:"network",__srcName:"url",_read:function(a){var b=this.src;"function"===typeof importScripts&&"../"===b.substr(0,3)&&(b="../"+b);var c=new XMLHttpRequest;c.open("GET",b,!0);c.addEventListener("load",function(b){if(200===c.status||304===c.status||0===c.status)a(c.response);else{if("function"===typeof this.onerror)this.onerror(c.status);throw"NGL.NetworkStreamer._read: status code "+c.status;
}}.bind(this),!1);"function"===typeof this.onprogress&&c.addEventListener("progress",function(a){this.onprogress(a)}.bind(this),!1);"function"===typeof this.onerror&&c.addEventListener("error",function(a){this.onerror(a)}.bind(this),!1);c.responseType="arraybuffer";try{c.send(null)}catch(d){if("function"===typeof this.onerror)this.onerror(d.message)}}});NGL.FileStreamer=function(a,b){NGL.Streamer.call(this,a,b)};
NGL.FileStreamer.prototype=NGL.createObject(NGL.Streamer.prototype,{constructor:NGL.FileStreamer,type:"file",__srcName:"file",_read:function(a){if("function"===typeof importScripts){var b=new FileReaderSync,b=b.readAsArrayBuffer(this.file);a(b)}else b=new FileReader,b.onload=function(b){a(b.target.result)}.bind(this),"function"===typeof this.onprogress&&(b.onprogress=function(a){this.onprogress(a)}.bind(this)),"function"===typeof this.onerror&&(b.onerror=function(a){this.onerror(a)}.bind(this)),b.readAsArrayBuffer(this.file)}});
NGL.StringStreamer=function(a,b){NGL.Streamer.call(this,a,b)};NGL.StringStreamer.prototype=NGL.createObject(NGL.Streamer.prototype,{constructor:NGL.StringStreamer,type:"string",__srcName:"str",_chunk:function(a,b){return this.data.substr(a,b)}});NGL.BinaryStreamer=function(a,b){a instanceof ArrayBuffer&&(a=new Uint8Array(a));NGL.Streamer.call(this,a,b)};
NGL.BinaryStreamer.prototype=NGL.createObject(NGL.Streamer.prototype,{constructor:NGL.BinaryStreamer,type:"binary",__srcName:"bin",getTransferable:function(){var a=NGL.Streamer.prototype.getTransferable.call(this);this.bin instanceof Uint8Array&&a.push(this.bin.buffer);return a}});
NGL.atomArrayQuicksort=function(a,b){function c(a,c){f.index=a;g.index=c;return b(f,g)}function d(a,b){if(a<b){var l=Math.floor((a+b)/2),m=a,p=b;do{for(;0>c(m,l);)m+=1;for(;0<c(p,l);)--p;if(m<=p){m===l?l=p:p===l&&(l=m);var r=p;m!==r&&(f.index=m,g.index=r,e.copy(f),f.copy(g),g.copy(e));m+=1;--p}}while(m<=p);d(a,p);d(m,b)}}NGL.time("NGL.atomArrayQuicksort");var e=new NGL.Atom,f=new NGL.ProxyAtom(a),g=new NGL.ProxyAtom(a);d(0,a.usedLength-1);NGL.timeEnd("NGL.atomArrayQuicksort")};
NGL.reorderAtoms=function(a){function b(a,b){return a.modelindex<b.modelindex?-1:a.modelindex>b.modelindex?1:a.chainname<b.chainname?-1:a.chainname>b.chainname?1:a.resno<b.resno?-1:a.resno>b.resno?1:0}NGL.time("NGL.reorderAtoms");var c=a.atoms;(a=a.atomArray)?NGL.atomArrayQuicksort(a,b):c.sort(b);a=0;for(var d=c.length;a<d;++a)c[a].index=a;NGL.timeEnd("NGL.reorderAtoms")};
NGL.buildStructure=function(a,b){NGL.time("NGL.buildStructure");var c,d,e,f,g,h,k=null,l,m;NGL.processArray(a.atoms,function(b,r,n){for(g=b;g<r;++g){f=n[g];b=f.modelindex;var q=f.chainname,t=f.resno,u=f.resname;k!==b?(c=a.addModel(),h={},d=c.addChain(),d.chainname=q,h[q]=d,e=d.addResidue(),e.resno=t,e.resname=u):l!==q?(h[q]?d=h[q]:(d=c.addChain(),d.chainname=q,h[q]=d),e=d.addResidue(),e.resno=t,e.resname=u):m!==t&&(e=d.addResidue(),e.resno=t,e.resname=u);e.addAtom(f);k=b;l=q;m=t}},function(){NGL.GidPool.updateObject(a);
NGL.timeEnd("NGL.buildStructure");NGL.debug&&NGL.log(a);b()});return a};
NGL.createAtomArray=function(a,b){NGL.time("NGL.createAtomArray");var c=a.atoms;a.atomArray=new NGL.AtomArray(c.length);var d=a.atomArray;NGL.processArray(c,function(a,b){for(var g=a;g<b;++g){var h=c[g],k=new NGL.ProxyAtom(d,g);d.setResname(g,h.resname);d.x[g]=h.x;d.y[g]=h.y;d.z[g]=h.z;d.setElement(g,h.element);d.hetero[g]=h.hetero;d.setChainname(g,h.chainname);d.resno[g]=h.resno;d.serial[g]=h.serial;d.setAtomname(g,h.atomname);d.ss[g]=h.ss.charCodeAt(0);d.bfactor[g]=h.bfactor;d.altloc[g]=h.altloc.charCodeAt(0);
d.vdw[g]=h.vdw;d.covalent[g]=h.covalent;d.modelindex[g]=h.modelindex;d.usedLength+=1;h.bonds.length&&(k.bonds=h.bonds,k.bonds.forEach(function(a){a.atom1.index===k.index?a.atom1=k:a.atom2.index===k.index?a.atom2=k:NGL.warn("NGL.createAtomArray: bond atom not found")}));c[g]=k}},function(){NGL.timeEnd("NGL.createAtomArray");b()},5E4);return a};
NGL.assignSecondaryStructure=function(a,b){NGL.time("NGL.assignSecondaryStructure");var c=[];a.eachModel(function(a){a.eachChain(function(a){c.push(a.chainname)})});var d=c.slice().sort(),e=[];d.forEach(function(a){e.push(c.indexOf(a))});var f=a.helices||[];f.sort(function(a,b){var c=a[0],f=b[0],g=a[1],r=b[1];if(c===f)return g===r?0:g<r?-1:1;c=NGL.binarySearchIndexOf(d,c);f=NGL.binarySearchIndexOf(d,f);return e[c]<e[f]?-1:1});a.eachModel(function(a){var b=0,c=f.length;if(0!==c){var d=f[b],e=!1,g=
!1;a.eachChain(function(a){var h=!1;if(a.chainname===d[0])for(var t=0,u=a.residueCount,t=0;t<u;++t){var s=a.residues[t];s.resno===d[1]&&(e=!0);e&&(s.ss=d[4],s.resno===d[3]&&(e=!1,b+=1,b<c?(t=-1,d=f[b],h=a.chainname!==d[0]):g=!0));if(h||g)break}})}});var g=a.sheets||[];g.sort(function(a,b){var c=a[0],f=b[0];if(c===f)return 0;c=NGL.binarySearchIndexOf(d,c);f=NGL.binarySearchIndexOf(d,f);return e[c]<e[f]?-1:1});a.eachModel(function(a){var b=0,c=g.length;if(0!==c){var d=g[b],e=!1,f=!1;a.eachChain(function(a){var h=
!1;if(a.chainname===d[0])for(var t=0,u=a.residueCount,t=0;t<u;++t){var s=a.residues[t];s.resno===d[1]&&(e=!0);e&&(s.ss="s",s.resno===d[3]&&(e=!1,b+=1,b<c?(t=-1,d=g[b],h=a.chainname!==d[0]):f=!0));if(h||f)break}})}});NGL.timeEnd("NGL.assignSecondaryStructure");b();return a};
NGL.buildUnitcellAssembly=function(a,b){function c(a,b){b=b||"";var c={};Object.keys(g).forEach(function(e){var q=g[e].clone();k.copy(f).applyMatrix4(q);l.setFromMatrixPosition(q);l.sub(h);1<k.x&&--l.x;0>k.x&&(l.x+=1);1<k.y&&--l.y;0>k.y&&(l.y+=1);1<k.z&&--l.z;0>k.z&&(l.z+=1);a&&l.add(a);q.setPosition(l);q.multiplyMatrices(d.fracToCart,q);q.multiply(d.cartToFrac);c[e+b]=q});return c}var d=a.unitcell,e=a.biomolDict,f=a.atomCenter().applyMatrix4(d.cartToFrac),g=NGL.getSymmetryOperations(d.spacegroup),
h=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3;1<f.x&&--h.x;0>f.x&&(h.x+=1);1<f.y&&--h.y;0>f.y&&(h.y+=1);1<f.z&&--h.z;0>f.z&&(h.z+=1);e.UNITCELL={matrixDict:c(),chainList:void 0};e.SUPERCELL={matrixDict:Object.assign({},c(),c(new THREE.Vector3(1,1,1),"_666"),c(new THREE.Vector3(-1,-1,-1),"_444"),c(new THREE.Vector3(1,0,0),"_655"),c(new THREE.Vector3(1,1,0),"_665"),c(new THREE.Vector3(1,0,1),"_656"),c(new THREE.Vector3(0,1,0),"_565"),c(new THREE.Vector3(0,1,1),"_566"),c(new THREE.Vector3(0,
0,1),"_556"),c(new THREE.Vector3(-1,0,0),"_455"),c(new THREE.Vector3(-1,-1,0),"_445"),c(new THREE.Vector3(-1,0,-1),"_454"),c(new THREE.Vector3(0,-1,0),"_545"),c(new THREE.Vector3(0,-1,-1),"_544"),c(new THREE.Vector3(0,0,-1),"_554"),c(new THREE.Vector3(1,-1,-1),"_644"),c(new THREE.Vector3(1,1,-1),"_664"),c(new THREE.Vector3(1,-1,1),"_646"),c(new THREE.Vector3(-1,1,1),"_466"),c(new THREE.Vector3(-1,-1,1),"_446"),c(new THREE.Vector3(-1,1,-1),"_464"),c(new THREE.Vector3(0,1,-1),"_564"),c(new THREE.Vector3(0,
-1,1),"_546"),c(new THREE.Vector3(1,0,-1),"_654"),c(new THREE.Vector3(-1,0,1),"_456"),c(new THREE.Vector3(1,-1,0),"_645"),c(new THREE.Vector3(-1,1,0),"_465")),chainList:void 0};b();return a};NGL.WorkerRegistry.add("parse",function(a,b){NGL.time("WORKER parse");var c=NGL.fromJSON(a.data);c.parse(function(){NGL.timeEnd("WORKER parse");c.streamer.dispose();b(c.toJSON(),c.getTransferable())})});NGL.Parser=function(a,b){var c=b||{};this.streamer=a;this.name=c.name;this.path=c.path};
NGL.Parser.prototype={constructor:NGL.Parser,type:"",__objName:"",parse:function(a){var b=this;async.series([function(a){b.streamer.read(a)},function(a){b._beforeParse(a)},function(a){b._parse(a)},function(a){b._afterParse(a)}],function(){a(this[this.__objName])}.bind(this));return this[this.__objName]},parseWorker:function(a){if(NGL.useWorker&&"undefined"!==typeof Worker&&"function"!==typeof importScripts)var b=(new NGL.Worker("parse")).post(this.toJSON(),this.getTransferable(),function(c){b.terminate();
this.fromJSON(c.data);this._afterWorker(a)}.bind(this),function(c){console.warn("NGL.Parser.parseWorker error - trying without worker",c);b.terminate();this.parse(a)}.bind(this));else this.parse(a);return this[this.__objName]},_parse:function(a){NGL.warn("NGL.Parser._parse not implemented");a()},_beforeParse:function(a){a()},_afterParse:function(a){a()},_afterWorker:function(a){a(this[this.__objName])},toJSON:function(){var a=this.type.substr(0,1).toUpperCase()+this.type.substr(1),a={metadata:{version:.1,
type:a+"Parser",generator:a+"ParserExporter"},streamer:this.streamer.toJSON(),name:this.name,path:this.path};a[this.__objName]="function"===typeof this[this.__objName].toJSON?this[this.__objName].toJSON():this[this.__objName];return a},fromJSON:function(a){this.streamer=NGL.fromJSON(a.streamer);this.name=a.name;this.path=a.path;"function"===typeof this[this.__objName].toJSON?this[this.__objName].fromJSON(a[this.__objName]):this[this.__objName]=a[this.__objName];return this},getTransferable:function(){var a=
[],a=a.concat(this.streamer.getTransferable());"function"===typeof this[this.__objName].toJSON&&(a=a.concat(this[this.__objName].getTransferable()));return a}};NGL.useAtomArrayThreshold=1E3;NGL.StructureParser=function(a,b){var c=b||{};this.firstModelOnly=c.firstModelOnly||!1;this.asTrajectory=c.asTrajectory||!1;this.cAlphaOnly=c.cAlphaOnly||!1;this.reorderAtoms=c.reorderAtoms||!1;NGL.Parser.call(this,a,c);this.structure=new NGL.Structure(this.name,this.path)};
NGL.StructureParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.StructureParser,type:"structure",__objName:"structure",_afterParse:function(a){var b=this;async.series([function(a){b.reorderAtoms&&NGL.reorderAtoms(b.structure);!b.structure.atomArray&&b.structure.atoms.length>NGL.useAtomArrayThreshold?NGL.createAtomArray(b.structure,a):a()},function(a){NGL.buildStructure(b.structure,a)},function(a){NGL.assignSecondaryStructure(b.structure,a)},function(a){NGL.buildUnitcellAssembly(b.structure,
a)},function(a){b._postProcess(a)},function(a){var d=b.structure;0===d.helices.length&&0===d.sheets.length&&(d._doAutoSS=!0);var e=!0;d.eachChain(function(a){a.chainname&&(e=!1)});d._doAutoChainName=e;b.structure.postProcess(a)}],function(){a()})},_afterWorker:function(a){NGL.buildStructure(this.structure,function(){a(this[this.__objName])}.bind(this))},_postProcess:function(a){a()},toJSON:function(){var a=NGL.Parser.prototype.toJSON.call(this);a.firstModelOnly=this.firstModelOnly;a.asTrajectory=
this.asTrajectory;a.cAlphaOnly=this.cAlphaOnly;a.reorderAtoms=this.reorderAtoms;return a},fromJSON:function(a){NGL.Parser.prototype.fromJSON.call(this,a);this.firstModelOnly=a.firstModelOnly;this.asTrajectory=a.asTrajectory;this.cAlphaOnly=a.cAlphaOnly;this.reorderAtoms=a.reorderAtoms;return this}});NGL.PdbParser=function(a,b){NGL.StructureParser.call(this,a,b)};
NGL.PdbParser.prototype=NGL.createObject(NGL.StructureParser.prototype,{constructor:NGL.PdbParser,type:"pdb",_parse:function(a){var b="pqr"===this.type,c=/\s+/,d="NGL.PdbParser._parse "+this.name;NGL.time(d);var e=this.structure,f=this.firstModelOnly,g=this.asTrajectory,h=this.cAlphaOnly,k=e.frames,l=e.boxes,m=!1,p,r,n=e.title,q=e.atoms,t=e.bondSet,u=e.helices,s=e.sheets,v=e.biomolDict,y,x=NGL.guessElement,B=NGL.CovalentRadii,G=NGL.VdwRadii,F=NGL.HelixTypes,w,z,C,L,O,W,K,P,da,A,X,D={},R={};e.hasConnect=
!1;var H,xa=this.streamer.lineCount();xa>NGL.useAtomArrayThreshold&&(H=new NGL.AtomArray(xa),e.atomArray=H);var M=0,U=0,S=!0;this.streamer.eachChunkOfLinesAsync(function(a,d,V){for(;a<d;++a)if(w=V[a],z=w.substr(0,6),"ATOM  "===z||"HETATM"===z){if(S&&(g?(m?(p=new Float32Array(3*q.length),k.push(p)):p=[],r=0):f||(D={})),S=!1,!(f&&0<U)){if(b){var I=w.split(c),Q=10===I.length?1:0;K=I[2];if(h&&"CA"!==K)continue;var Y=parseFloat(I[6-Q]),Z=parseFloat(I[7-Q]),J=parseFloat(I[8-Q])}else{K=w.substr(12,4).trim();
if(h&&"CA"!==K)continue;Y=parseFloat(w.substr(30,8));Z=parseFloat(w.substr(38,8));J=parseFloat(w.substr(46,8))}if(g){var E=3*r;p[E+0]=Y;p[E+1]=Z;p[E+2]=J;r+=1;if(m)continue}b?(C=parseInt(I[1]),P="",da="H"===w[0]?1:0,L=Q?"":I[4],O=parseInt(I[5-Q]),W=I[3],A=parseFloat(I[9-Q]),X=""):(C=parseInt(w.substr(6,5)),P=w.substr(76,2).trim(),da="H"===w[0]?1:0,L=w[21].trim(),O=parseInt(w.substr(22,4)),W=w.substr(17,4).trim(),A=parseFloat(w.substr(60,8)),X=w[16].trim());P||(P=x(K));H?(E=new NGL.ProxyAtom(H,M),
H.setResname(M,W),H.x[M]=Y,H.y[M]=Z,H.z[M]=J,H.setElement(M,P),H.hetero[M]=da,H.setChainname(M,L),H.resno[M]=O,H.serial[M]=C,H.setAtomname(M,K),H.ss[M]=99,H.bfactor[M]=A,H.altloc[M]=X.charCodeAt(0),H.vdw[M]=G[P],H.covalent[M]=B[P],H.modelindex[M]=U,H.usedLength+=1):(E=new NGL.Atom,E.index=M,E.resname=W,E.x=Y,E.y=Z,E.z=J,E.element=P,E.hetero=da,E.chainname=L,E.resno=O,E.serial=C,E.atomname=K,E.ss="c",E.bfactor=A,E.altloc=X,E.vdw=G[P],E.covalent=B[P],E.modelindex=U);D[C]=E;M+=1;q.push(E)}}else if("CONECT"===
z){if(J=D[parseInt(w.substr(6,5))],Y=[11,16,21,26],void 0!==J){for(E=0;4>E;++E)Z=parseInt(w.substr(Y[E],5)),Number.isNaN(Z)||(Z=D[Z],void 0!==Z&&t.addBond(J,Z));e.hasConnect=!0}}else if("HELIX "===z){var J=w[19].trim(),E=parseInt(w.substr(21,4)),Y=w[31].trim(),Z=parseInt(w.substr(33,4)),sa=parseInt(w.substr(39,1)),sa=F[sa]||F[""];u.push([J,E,Y,Z,sa])}else if("SHEET "===z)J=w[21].trim(),E=parseInt(w.substr(22,4)),Y=w[32].trim(),Z=parseInt(w.substr(33,4)),s.push([J,E,Y,Z]);else if("REMARK"===z&&"350"===
w.substr(7,3))"BIOMOLECULE:"===w.substr(11,12)?(J=w.substr(23).trim(),/^(0|[1-9][0-9]*)$/.test(J)&&(J="BU"+J),v[J]={matrixDict:{},chainList:[]},y=v[J]):"BIOMT"===w.substr(13,5)?(I=w.split(/\s+/),J=parseInt(w[18])-1,E=I[3].trim(),0===J&&(y.matrixDict[E]=new THREE.Matrix4),E=y.matrixDict[E].elements,E[0+J]=parseFloat(I[4]),E[4+J]=parseFloat(I[5]),E[8+J]=parseFloat(I[6]),E[12+J]=parseFloat(I[7])):"APPLY THE FOLLOWING TO CHAINS:"!==w.substr(11,30)&&"                   AND CHAINS:"!==w.substr(11,30)||
w.substr(41,30).split(",").forEach(function(a){(a=a.trim())&&y.chainList.push(a)});else if("HEADER"===z)w.substr(62,4);else if("TITLE "===z)n+=w.substr(10,70)+"\n";else if("MODEL "===z)S=!0;else if("ENDMDL"===z||"END"===w.substr(0,3))S||(g&&!m&&(k.push(new Float32Array(p)),m=!0),U+=1,S=!0);else if("MTRIX"===w.substr(0,5))I=w.split(/\s+/),E=I[1].trim(),"1"===w[5]&&"1"===E&&(v.NCS={matrixDict:{},chainList:void 0},y=v.NCS),J=parseInt(w[5])-1,0===J&&(y.matrixDict[E]=new THREE.Matrix4),E=y.matrixDict[E].elements,
E[0+J]=parseFloat(I[2]),E[4+J]=parseFloat(I[3]),E[8+J]=parseFloat(I[4]),E[12+J]=parseFloat(I[5]);else if("ORIGX"===w.substr(0,5))R.origx||(R.origx=new THREE.Matrix4),I=w.split(/\s+/),J=parseInt(w[5])-1,E=R.origx.elements,E[0+J]=parseFloat(I[1]),E[4+J]=parseFloat(I[2]),E[8+J]=parseFloat(I[3]),E[12+J]=parseFloat(I[4]);else if("SCALE"===w.substr(0,5))R.scale||(R.scale=new THREE.Matrix4),I=w.split(/\s+/),J=parseInt(w[5])-1,E=R.scale.elements,E[0+J]=parseFloat(I[1]),E[4+J]=parseFloat(I[2]),E[8+J]=parseFloat(I[3]),
E[12+J]=parseFloat(I[4]);else if("CRYST1"===z){var E=parseFloat(w.substr(6,9)),Y=parseFloat(w.substr(15,9)),Z=parseFloat(w.substr(24,9)),sa=parseFloat(w.substr(33,7)),Da=parseFloat(w.substr(40,7)),ya=parseFloat(w.substr(47,7)),za=w.substr(55,11).trim(),J=parseInt(w.substr(66,4)),J=new Float32Array(9);J[0]=E;J[4]=Y;J[8]=Z;l.push(J);0===U&&(R.a=E,R.b=Y,R.c=Z,R.alpha=sa,R.beta=Da,R.gamma=ya,R.spacegroup=za)}},function(){e.unitcell=new NGL.Unitcell(R.a,R.b,R.c,R.alpha,R.beta,R.gamma,R.spacegroup,R.scale);
NGL.timeEnd(d);a()})}});NGL.PqrParser=function(a,b){NGL.StructureParser.call(this,a,b)};NGL.PqrParser.prototype=NGL.createObject(NGL.PdbParser.prototype,{constructor:NGL.PqrParser,type:"pqr"});NGL.GroParser=function(a,b){NGL.StructureParser.call(this,a,b);this.structure._doAutoSS=!0;this.structure._doAutoChainName=!0};
NGL.GroParser.prototype=NGL.createObject(NGL.StructureParser.prototype,{constructor:NGL.GroParser,type:"gro",_parse:function(a){var b="NGL.GroParser._parse "+this.name;NGL.time(b);var c=this.structure,d=this.firstModelOnly,e=this.asTrajectory,f=this.cAlphaOnly,g=c.frames,h=c.boxes,k,l,m=c.atoms,p=NGL.guessElement,r=NGL.CovalentRadii,n=NGL.VdwRadii,q=this.streamer.peekLines(3);c.title=q[0].trim();var t=5+(q[2].length-q[2].lastIndexOf(".")-1),u=20+t,s=20+2*t,v,y,x,B,G,F=parseInt(q[1]),w=F+3,z,q=this.streamer.lineCount();
q>NGL.useAtomArrayThreshold&&(z=new NGL.AtomArray(q),c.atomArray=z);var C=0,L=0,O=0;this.streamer.eachChunkOfLinesAsync(function(a,b,c){for(;a<b;++a){++O;var q=O-1,A=c[a];if(A)if(0===q%w)e&&(k=new Float32Array(3*F),g.push(k),l=0);else if(1!==q%w)if(q%w===w-1){A.trim().split(/\s+/);var X=new Float32Array(9);X[0]=10*parseFloat(X[0]);X[4]=10*parseFloat(X[1]);X[8]=10*parseFloat(X[2]);h.push(X);if(d)return!0;L+=1}else if(v=A.substr(10,5).trim(),!f||"CA"===v){var X=10*parseFloat(A.substr(20,t)),D=10*parseFloat(A.substr(u,
t)),R=10*parseFloat(A.substr(s,t));if(e){var H=3*l;k[H+0]=X;k[H+1]=D;k[H+2]=R;l+=1;if(q>w)continue}y=A.substr(5,5).trim();x=p(v);B=parseInt(A.substr(0,5));G=parseInt(A.substr(15,5));z?(q=new NGL.ProxyAtom(z,C),z.setResname(C,y),z.x[C]=X,z.y[C]=D,z.z[C]=R,z.setElement(C,x),z.setChainname(C,""),z.resno[C]=B,z.serial[C]=G,z.setAtomname(C,v),z.ss[C]=99,z.setAltloc(C,""),z.vdw[C]=n[x],z.covalent[C]=r[x],z.modelindex[C]=L,z.usedLength+=1):(q=new NGL.Atom,q.index=C,q.resname=y,q.x=X,q.y=D,q.z=R,q.element=
x,q.chainname="",q.resno=B,q.serial=G,q.atomname=v,q.ss="c",q.altloc="",q.vdw=n[x],q.covalent=r[x],q.modelindex=L);C+=1;m.push(q)}}},function(){NGL.timeEnd(b);a()})}});NGL.CifParser=function(a,b){NGL.StructureParser.call(this,a,b)};
NGL.CifParser.prototype=NGL.createObject(NGL.StructureParser.prototype,{constructor:NGL.CifParser,type:"cif",_parse:function(a){function b(a,b,c){for(;a<b;++a)if(t=c[a].trim(),!t&&!x||"#"===t[0])G=F=x=!1,w.length=0,O=L=C=z=null,W.length=0,K.length=0;else if("data_"===t.substring(0,5))t.substring(5);else if(";"===t[0])x?(F?(z===w.length&&(z=0),w[z].push(B),z+=1):y[C][L]=B,x=!1,B=null):(x=!0,B=t.substring(1));else if("loop_"===t)F=!0,w.length=0,z=K.length=0;else if("_"===t[0])if(F){var d=t.split("."),
e=d[0].substring(1),d=d[1];y[e]||(y[e]={});y[e][d]?NGL.warn(e,d,"already exists"):(y[e][d]=[],w.push(y[e][d]),K.push(d));C=e;L=d;O=!0}else{var e=t.match(s),l=e[1],d=e[0].split("."),e=d[0].substring(1),d=d[1];y[e]||(y[e]={});y[e][d]?NGL.warn(e,d,"already exists"):y[e][d]=l;l||(G=!0);C=e;L=d}else if(x)B+=" "+t;else if(F)if("atom_site"===C){l=K.length;e=t.split(u);if(O){for(var d="group_PDB id label_atom_id label_comp_id type_symbol label_asym_id Cartn_x Cartn_y Cartn_z B_iso_or_equiv label_alt_id auth_seq_id pdbx_PDB_model_num".split(" "),
I=W.length=0;I<l;++I)-1!==d.indexOf(K[I])&&W.push(I);P=K.indexOf("label_atom_id");da=K.indexOf("label_alt_id");A=K.indexOf("Cartn_x");X=K.indexOf("Cartn_y");D=K.indexOf("Cartn_z");R=K.indexOf("id");H=K.indexOf("type_symbol");xa=K.indexOf("label_asym_id");M=K.indexOf("label_comp_id");U=K.indexOf("group_PDB");S=K.indexOf("B_iso_or_equiv");ga=K.indexOf("auth_seq_id");ja=K.indexOf("pdbx_PDB_model_num");O=!1;Z=parseInt(e[ja]);g&&(m=[],p=0)}l=parseInt(e[ja]);Z!==l&&(g&&(0===Y&&k.push(new Float32Array(m)),
m=new Float32Array(3*r.length),k.push(m),p=0),Y+=1);Z=l;if(!(f&&0<Y||(l=e[P].replace(v,""),h&&"CA"!==l))){var d=parseFloat(e[A]),ta=parseFloat(e[X]),la=parseFloat(e[D]);if(g&&(I=3*p,m[I+0]=d,m[I+1]=ta,m[I+2]=la,p+=1,0<Y))continue;var I=parseInt(e[R]),va=e[H],Fa="H"===e[U][0]?1:0,Ga=e[xa],Ta=parseInt(e[ga]),Qa=e[M],Aa=parseFloat(e[S]),e=e[da],e="."===e?"":e,ia;V?(ia=new NGL.ProxyAtom(V,Q),V.setResname(Q,Qa),V.x[Q]=d,V.y[Q]=ta,V.z[Q]=la,V.setElement(Q,va),V.hetero[Q]=Fa,V.setChainname(Q,Ga),V.resno[Q]=
Ta,V.serial[Q]=I,V.setAtomname(Q,l),V.ss[Q]=99,V.bfactor[Q]=Aa,V.altloc[Q]=e.charCodeAt(0),V.vdw[Q]=q[va],V.covalent[Q]=n[va],V.modelindex[Q]=Y,V.usedLength+=1):(ia=new NGL.Atom,ia.index=Q,ia.resname=Qa,ia.x=d,ia.y=ta,ia.z=la,ia.element=va,ia.hetero=Fa,ia.chainname=Ga,ia.resno=Ta,ia.serial=I,ia.atomname=l,ia.ss="c",ia.bfactor=Aa,ia.altloc=e,ia.vdw=q[va],ia.covalent=n[va],ia.modelindex=Y);Q+=1;r.push(ia)}}else{e=t.match(s);l=e.length;z===w.length&&(z=0);for(I=0;I<l;++I)w[z+I].push(e[I]);z+=l}else"'"===
t[0]&&"'"===t.substring(t.length-1)?y[C][L]=t.substring(1,t.length-2):G?y[C][L]=t.trim():NGL.log("NGL.CifParser._parse: unknown state",t)}function c(a,b){Array.isArray(a[b])||Object.keys(a).forEach(function(b){a[b]=[a[b]]})}var d="NGL.CifParser._parse "+this.name;NGL.time(d);var e=this.structure,f=this.firstModelOnly,g=this.asTrajectory,h=this.cAlphaOnly,k=e.frames,l=e.boxes,m,p,r=e.atoms,n=NGL.CovalentRadii,q=NGL.VdwRadii,t;e.hasConnect=!1;var u=/\s+/,s=/'(.*?)'|"(.*?)"|(\S+)/g,v=/"/g,y={};this.cif=
y;var x=!1,B=null,G=!1,F=!1,w=[],z=null,C=null,L=null,O=null,W=[],K=[],P,da,A,X,D,R,H,xa,M,U,S,ga,ja,V,I=this.streamer.lineCount();I>NGL.useAtomArrayThreshold&&(V=new NGL.AtomArray(I),e.atomArray=V);var Q=0,Y=0,Z;async.series([function(a){this.streamer.eachChunkOfLinesAsync(b,function(){y.struct&&y.struct.title&&(e.title=y.struct.title.trim().replace(/^['"]+|['"]+$/g,""));a()})}.bind(this),function(a){var b=y.struct_conf;if(b){var d=e.helices,f=NGL.HelixTypes;c(b,"id");NGL.processArray(b.beg_auth_seq_id,
function(a,c){for(var e=a;e<c;++e){var g=parseInt(b.pdbx_PDB_helix_class[e]);Number.isNaN(g)||d.push([b.beg_label_asym_id[e],parseInt(b.beg_auth_seq_id[e]),b.end_label_asym_id[e],parseInt(b.end_auth_seq_id[e]),f[g]||f[""]])}},a,1E3)}else a()},function(a){var b=y.struct_sheet_range;if(b){var d=e.sheets;c(b,"id");NGL.processArray(b.beg_auth_seq_id,function(a,c){for(var e=a;e<c;++e)d.push([b.beg_label_asym_id[e],parseInt(b.beg_auth_seq_id[e]),b.end_label_asym_id[e],parseInt(b.end_auth_seq_id[e])])},
a,1E3)}else a()},function(a){var b={},d=e.biomolDict;if(y.pdbx_struct_oper_list){var f=y.pdbx_struct_oper_list;c(f,"id");f.id.forEach(function(a,c){var d=new THREE.Matrix4,e=d.elements;e[0]=parseFloat(f["matrix[1][1]"][c]);e[1]=parseFloat(f["matrix[1][2]"][c]);e[2]=parseFloat(f["matrix[1][3]"][c]);e[4]=parseFloat(f["matrix[2][1]"][c]);e[5]=parseFloat(f["matrix[2][2]"][c]);e[6]=parseFloat(f["matrix[2][3]"][c]);e[8]=parseFloat(f["matrix[3][1]"][c]);e[9]=parseFloat(f["matrix[3][2]"][c]);e[10]=parseFloat(f["matrix[3][3]"][c]);
e[3]=parseFloat(f["vector[1]"][c]);e[7]=parseFloat(f["vector[2]"][c]);e[11]=parseFloat(f["vector[3]"][c]);d.transpose();b[a]=d})}if(y.pdbx_struct_assembly_gen){var g=y.pdbx_struct_assembly_gen;c(g,"assembly_id");var h=function(a){var c={};a.replace(/[\(\)']/g,"").split(",").forEach(function(a){if(-1!==a.indexOf("-")){var d=a.split("-");a=parseInt(d[0]);for(d=parseInt(d[1]);a<=d;++a)c[a]=b[a]}else c[a]=b[a]});return c};g.assembly_id.forEach(function(a,b){var c={},e=g.oper_expression[b];if(-1!==e.indexOf(")(")){var e=
e.split(")("),f=h(e[0]),k=h(e[1]);Object.keys(f).forEach(function(a){Object.keys(k).forEach(function(b){var d=new THREE.Matrix4;d.multiplyMatrices(f[a],k[b]);c[a+"x"+b]=d})})}else c=h(e);e=a;/^(0|[1-9][0-9]*)$/.test(e)&&(e="BU"+e);d[e]={matrixDict:c,chainList:g.asym_id_list[b].split(",")}})}if(y.struct_ncs_oper){f=y.struct_ncs_oper;c(f,"id");var k={};d.NCS={matrixDict:k,chainList:void 0};f.id.forEach(function(a,b){var c=new THREE.Matrix4,d=c.elements;d[0]=parseFloat(f["matrix[1][1]"][b]);d[1]=parseFloat(f["matrix[1][2]"][b]);
d[2]=parseFloat(f["matrix[1][3]"][b]);d[4]=parseFloat(f["matrix[2][1]"][b]);d[5]=parseFloat(f["matrix[2][2]"][b]);d[6]=parseFloat(f["matrix[2][3]"][b]);d[8]=parseFloat(f["matrix[3][1]"][b]);d[9]=parseFloat(f["matrix[3][2]"][b]);d[10]=parseFloat(f["matrix[3][3]"][b]);d[3]=parseFloat(f["vector[1]"][b]);d[7]=parseFloat(f["vector[2]"][b]);d[11]=parseFloat(f["vector[3]"][b]);c.transpose();k[a]=c})}var m,n,p,q,r,s,t,v;if(y.cell){var u=y.cell;t=y.symmetry||{};m=parseFloat(u.length_a);n=parseFloat(u.length_b);
p=parseFloat(u.length_c);q=parseFloat(u.angle_alpha);r=parseFloat(u.angle_beta);s=parseFloat(u.angle_gamma);t=t["space_group_name_H-M"];t[0]!==t[t.length-1]||"'"!==t[0]&&'"'!==t[0]||(t=t.substring(1,t.length-1));parseInt(u.Z_PDB);u=new Float32Array(9);u[0]=m;u[4]=n;u[8]=p;l.push(u)}var x=new THREE.Matrix4;if(y.database_PDB_matrix){var u=y.database_PDB_matrix,w=x.elements;w[0]=parseFloat(u["origx[1][1]"]);w[1]=parseFloat(u["origx[1][2]"]);w[2]=parseFloat(u["origx[1][3]"]);w[4]=parseFloat(u["origx[2][1]"]);
w[5]=parseFloat(u["origx[2][2]"]);w[6]=parseFloat(u["origx[2][3]"]);w[8]=parseFloat(u["origx[3][1]"]);w[9]=parseFloat(u["origx[3][2]"]);w[10]=parseFloat(u["origx[3][3]"]);w[3]=parseFloat(u["origx_vector[1]"]);w[7]=parseFloat(u["origx_vector[2]"]);w[11]=parseFloat(u["origx_vector[3]"]);x.transpose()}x=new THREE.Matrix4;y.atom_sites&&(u=y.atom_sites,w=x.elements,w[0]=parseFloat(u["fract_transf_matrix[1][1]"]),w[1]=parseFloat(u["fract_transf_matrix[1][2]"]),w[2]=parseFloat(u["fract_transf_matrix[1][3]"]),
w[4]=parseFloat(u["fract_transf_matrix[2][1]"]),w[5]=parseFloat(u["fract_transf_matrix[2][2]"]),w[6]=parseFloat(u["fract_transf_matrix[2][3]"]),w[8]=parseFloat(u["fract_transf_matrix[3][1]"]),w[9]=parseFloat(u["fract_transf_matrix[3][2]"]),w[10]=parseFloat(u["fract_transf_matrix[3][3]"]),w[3]=parseFloat(u["fract_transf_vector[1]"]),w[7]=parseFloat(u["fract_transf_vector[2]"]),w[11]=parseFloat(u["fract_transf_vector[3]"]),x.transpose(),v=x);e.unitcell=new NGL.Unitcell(m,n,p,q,r,s,t,v);a()}],function(){NGL.timeEnd(d);
a()})},_postProcess:function(a){function b(a,b){Array.isArray(a[b])||Object.keys(a).forEach(function(b){a[b]=[a[b]]})}NGL.time("NGL.CifParser._postProcess");var c=this.structure,d=this.cif;async.series([function(a){var f=d.struct_conn;if(f){b(f,"id");var g=/"/g;NGL.processArray(f.id,function(a,b){for(var d=a;d<b;++d){var e=f.conn_type_id[d];if("hydrog"!==e&&"mismat"!==e&&"saltbr"!==e){var e=f.ptnr1_auth_seq_id[d]+":"+f.ptnr1_label_asym_id[d]+"."+f.ptnr1_label_atom_id[d].replace(g,""),p=new NGL.Selection(e);
if(p.selection.error)NGL.warn("invalid selection for connection",e);else{var e=c.getAtoms(p),p=f.ptnr2_auth_seq_id[d]+":"+f.ptnr2_label_asym_id[d]+"."+f.ptnr2_label_atom_id[d].replace(g,""),r=new NGL.Selection(p);if(r.selection.error)NGL.warn("invalid selection for connection",p);else for(var p=c.getAtoms(r),n,q=e.length,t=0;t<q;++t)r=e[t],n=p[t],r&&n?c.bondSet.addBond(r,n):NGL.log("atoms for connection not found")}}}},a,500)}else a()}],function(){NGL.timeEnd("NGL.CifParser._postProcess");a()})}});
NGL.SdfParser=function(a,b){NGL.StructureParser.call(this,a,b)};
NGL.SdfParser.prototype=NGL.createObject(NGL.StructureParser.prototype,{constructor:NGL.SdfParser,type:"sdf",_parse:function(a){var b=this.streamer.peekLines(2),c=this.structure,d=this.firstModelOnly,e=this.asTrajectory;c.id=b[0].trim();c.title=b[1].trim();var f=c.frames,g=!1,h,k,l=c.atoms,m=c.bondSet,p=NGL.CovalentRadii,r=NGL.VdwRadii,n,b=this.streamer.lineCount();b>NGL.useAtomArrayThreshold&&(n=new NGL.AtomArray(b),c.atomArray=n);var q=0,t=0,u=0,s=0,v,y,x,B,G,F;this.streamer.eachChunkOfLinesAsync(function(a,
b,c){for(;a<b;++a){var L=c[a];"$$$$"===L.substr(0,4)&&(t=-1,++u,s=l.length);3===t&&(v=parseInt(L.substr(0,3)),y=parseInt(L.substr(3,3)),x=4,G=B=x+v,F=G+y,e&&(k=0,h=new Float32Array(3*v),f.push(h),0<u&&(g=!0)));if(t>=x&&t<B){if(d&&0<u)continue;var O=parseFloat(L.substr(0,10)),W=parseFloat(L.substr(10,10)),K=parseFloat(L.substr(20,10));if(e){var P=3*k;h[P+0]=O;h[P+1]=W;h[P+2]=K;k+=1;if(g)continue}var P=L.substr(31,3).trim(),da=P+(q+1),A;n?(A=new NGL.ProxyAtom(n,q),n.setResname(q,"HET"),n.x[q]=O,n.y[q]=
W,n.z[q]=K,n.setElement(q,P),n.setChainname(q,""),n.resno[q]=1,n.serial[q]=q,n.setAtomname(q,da),n.ss[q]=99,n.setAltloc(q,""),n.vdw[q]=r[P],n.covalent[q]=p[P],n.modelindex[q]=u,n.usedLength+=1):(A=new NGL.Atom,A.index=q,A.resname="HET",A.x=O,A.y=W,A.z=K,A.element=P,A.hetero=1,A.chainname="",A.resno=1,A.serial=q,A.atomname=da,A.ss="c",A.altloc="",A.vdw=r[P],A.covalent=p[P],A.modelindex=u);q+=1;l.push(A)}if(t>=G&&t<F){if(d&&0<u)continue;if(e&&0<u)continue;O=parseInt(L.substr(0,3))-1+s;W=parseInt(L.substr(3,
3))-1+s;L=parseInt(L.substr(6,3));m.addBond(l[O],l[W],!1,L)}++t}},function(){c._dontAutoBond=!0;a()})}});NGL.Mol2Parser=function(a,b){NGL.StructureParser.call(this,a,b)};
NGL.Mol2Parser.prototype=NGL.createObject(NGL.StructureParser.prototype,{constructor:NGL.Mol2Parser,type:"mol2",_parse:function(a){var b=/\s+/,c=this.structure,d=this.firstModelOnly,e=this.asTrajectory,f=c.frames,g=!1,h,k,l=c.atoms,m=c.bondSet,p=NGL.CovalentRadii,r=NGL.VdwRadii,n,q=this.streamer.lineCount();q>NGL.useAtomArrayThreshold&&(n=new NGL.AtomArray(q),c.atomArray=n);var t=0,u=0,s=0,v=-1,y=0,x=0,B={1:1,2:2,3:3,am:1,ar:1,du:1,un:1,nc:0};this.streamer.eachChunkOfLinesAsync(function(a,q,w){for(;a<
q;++a){var z=w[a].trim();if(""!==z&&"#"!==z[0])if("@"===z[0])"@<TRIPOS>MOLECULE"===z?(x=1,u=0,++v):"@<TRIPOS>ATOM"===z?(x=2,s=l.length,e&&(k=0,h=new Float32Array(3*y),f.push(h),0<v&&(g=!0))):x="@<TRIPOS>BOND"===z?3:0;else if(1===x)0===u?(c.title=z,c.id=z):1===u&&(z=z.split(b),y=parseInt(z[0])),++u;else if(2===x){if(z=z.split(b),!(d&&0<v)){var C=parseFloat(z[2]),L=parseFloat(z[3]),O=parseFloat(z[4]);if(e){var W=3*k;h[W+0]=C;h[W+1]=L;h[W+2]=O;k+=1;if(g)continue}var W=z[1],K=z[5].split(".")[0],P=z[6]?
parseInt(z[6]):1,da=z[7]?z[7]:"",z=z[8]?parseFloat(z[8]):0,A;n?(A=new NGL.ProxyAtom(n,t),n.setResname(t,da),n.x[t]=C,n.y[t]=L,n.z[t]=O,n.setElement(t,K),n.setChainname(t,""),n.resno[t]=P,n.serial[t]=t,n.setAtomname(t,W),n.ss[t]=99,n.setAltloc(t,""),n.bfactor[t]=z,n.vdw[t]=r[K],n.covalent[t]=p[K],n.modelindex[t]=v,n.usedLength+=1):(A=new NGL.Atom,A.index=t,A.resname=da,A.x=C,A.y=L,A.z=O,A.element=K,A.hetero=1,A.chainname="",A.resno=P,A.serial=t,A.atomname=W,A.ss="c",A.altloc="",A.bfactor=z,A.vdw=r[K],
A.covalent=p[K],A.modelindex=v);t+=1;l.push(A)}}else 3!==x||d&&0<v||e&&0<v||(z=z.split(b),C=parseInt(z[1])-1+s,L=parseInt(z[2])-1+s,m.addBond(l[C],l[L],!1,B[z[3]]))}},function(){c._dontAutoBond=!0;a()})}});NGL.VolumeParser=function(a,b){NGL.Parser.call(this,a,b||{});this.volume=new NGL.Volume(this.name,this.path)};
NGL.VolumeParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.VolumeParser,type:"volume",__objName:"volume",_afterParse:function(a){this.volume.setMatrix(this.getMatrix());a()},getMatrix:function(){return new THREE.Matrix4}});NGL.MrcParser=function(a,b){NGL.VolumeParser.call(this,a,b)};
NGL.MrcParser.prototype=NGL.createObject(NGL.VolumeParser.prototype,{constructor:NGL.MrcParser,type:"mrc",_parse:function(a){var b="NGL.MrcParser._parse "+this.name;NGL.time(b);var c=this.streamer.data;c instanceof Uint8Array&&(c=c.buffer);var d=this.volume,e={},f=new Int32Array(c,0,56),g=new Float32Array(c,0,56),h=new DataView(c);e.MAP=String.fromCharCode(h.getUint8(208),h.getUint8(209),h.getUint8(210),h.getUint8(211));e.MACHST=[h.getUint8(212),h.getUint8(213)];if(17===e.MACHST[0]&&17===e.MACHST[1])for(var k=
c.byteLength,l=0;l<k;l+=4)h.setFloat32(l,h.getFloat32(l),!0);e.NX=f[0];e.NY=f[1];e.NZ=f[2];e.MODE=f[3];e.NXSTART=f[4];e.NYSTART=f[5];e.NZSTART=f[6];e.MX=f[7];e.MY=f[8];e.MZ=f[9];e.xlen=g[10];e.ylen=g[11];e.zlen=g[12];e.alpha=g[13];e.beta=g[14];e.gamma=g[15];e.MAPC=f[16];e.MAPR=f[17];e.MAPS=f[18];e.DMIN=g[19];e.DMAX=g[20];e.DMEAN=g[21];e.ISPG=f[22];e.NSYMBT=f[23];e.LSKFLG=f[24];e.originX=g[49];e.originY=g[50];e.originZ=g[51];e.ARMS=g[54];d.header=e;c=new Float32Array(c,1024+e.NSYMBT,e.NX*e.NY*e.NZ);
d.setData(c,e.NX,e.NY,e.NZ);NGL.timeEnd(b);a()},getMatrix:function(){var a=this.volume.header,b=[a.xlen,0,0],c=[a.ylen*Math.cos(Math.PI/180*a.gamma),a.ylen*Math.sin(Math.PI/180*a.gamma),0],d=[a.zlen*Math.cos(Math.PI/180*a.beta),a.zlen*(Math.cos(Math.PI/180*a.alpha)-Math.cos(Math.PI/180*a.gamma)*Math.cos(Math.PI/180*a.beta))/Math.sin(Math.PI/180*a.gamma),0];d[2]=Math.sqrt(a.zlen*a.zlen*Math.sin(Math.PI/180*a.beta)*Math.sin(Math.PI/180*a.beta)-d[1]*d[1]);var b=[0,b,c,d],c=[0,a.MX,a.MY,a.MZ],d=[0,a.MAPC,
a.MAPR,a.MAPS],e=new THREE.Matrix4;e.set(b[d[1]][0]/c[d[1]],b[d[2]][0]/c[d[2]],b[d[3]][0]/c[d[3]],0,b[d[1]][1]/c[d[1]],b[d[2]][1]/c[d[2]],b[d[3]][1]/c[d[3]],0,b[d[1]][2]/c[d[1]],b[d[2]][2]/c[d[2]],b[d[3]][2]/c[d[3]],0,0,0,0,1);e.multiply((new THREE.Matrix4).makeTranslation(a.NXSTART+a.originX,a.NYSTART+a.originY,a.NZSTART+a.originZ));return e}});NGL.CubeParser=function(a,b){NGL.VolumeParser.call(this,a,b)};
NGL.CubeParser.prototype=NGL.createObject(NGL.VolumeParser.prototype,{constructor:NGL.CubeParser,type:"cube",_parse:function(a){function b(a,b){var c=e[a].trim().split(g)[b];return parseFloat(c)}var c="NGL.CubeParser._parse "+this.name;NGL.time(c);var d=this.volume,e=this.streamer.peekLines(6),f={},g=/\s+/;f.atomCount=Math.abs(b(2,0));f.originX=.529177210859*b(2,1);f.originY=.529177210859*b(2,2);f.originZ=.529177210859*b(2,3);f.NVX=b(3,0);f.NVY=b(4,0);f.NVZ=b(5,0);f.AVX=.529177210859*b(3,1);f.AVY=
.529177210859*b(4,2);f.AVZ=.529177210859*b(5,3);var h=new Float32Array(f.NVX*f.NVY*f.NVZ),k=0,l=0;this.streamer.eachChunkOfLinesAsync(function(a,b,c){for(;a<b;++a){var d=c[a].trim();if(""!==d&&l>=f.atomCount+6)for(var d=d.split(g),e=0,t=d.length;e<t;++e)1!==d.length&&(h[k]=parseFloat(d[e]),++k);++l}},function(){d.header=f;d.setData(h,f.NVZ,f.NVY,f.NVX);NGL.timeEnd(c);a()})},getMatrix:function(){var a=this.volume.header,b=new THREE.Matrix4;b.multiply((new THREE.Matrix4).makeRotationY(THREE.Math.degToRad(90)));
b.multiply((new THREE.Matrix4).makeTranslation(-a.originZ,a.originY,a.originX));b.multiply((new THREE.Matrix4).makeScale(-a.AVZ,a.AVY,a.AVX));return b}});NGL.DxParser=function(a,b){NGL.VolumeParser.call(this,a,b)};
NGL.DxParser.prototype=NGL.createObject(NGL.VolumeParser.prototype,{constructor:NGL.DxParser,type:"dx",_parse:function(a){var b="NGL.DxParser._parse "+this.name;NGL.time(b);for(var c=this.volume,d=this.streamer.peekLines(30),e={},f=/\s+/,g=0,h=0,k=0;30>k;++k){var l=d[k];l.startsWith("object 1")?(l=l.split(f),e.nx=parseInt(l[5]),e.ny=parseInt(l[6]),e.nz=parseInt(l[7])):l.startsWith("origin")?(l=l.split(f),e.xmin=parseFloat(l[1]),e.ymin=parseFloat(l[2]),e.zmin=parseFloat(l[3])):l.startsWith("delta")?
(l=l.split(f),0===h?e.hx=parseFloat(l[1]):1===h?e.hy=parseFloat(l[2]):2===h&&(e.hz=parseFloat(l[3])),h+=1):l.startsWith("object 3")&&(g=k)}var m=e.nx*e.ny*e.nz,p=new Float32Array(m),r=0,n=0;this.streamer.eachChunkOfLinesAsync(function(a,b,c){for(;a<b;++a){if(r<m&&n>g){var d=c[a].trim();if(""!==d)for(var d=d.split(f),e=0,h=d.length;e<h;++e)p[r]=parseFloat(d[e]),++r}++n}},function(){c.header=e;c.setData(p,e.nz,e.ny,e.nx);NGL.timeEnd(b);a()})},getMatrix:function(){var a=this.volume.header,b=new THREE.Matrix4;
b.multiply((new THREE.Matrix4).makeRotationY(THREE.Math.degToRad(90)));b.multiply((new THREE.Matrix4).makeTranslation(-a.zmin,a.ymin,a.xmin));b.multiply((new THREE.Matrix4).makeScale(-a.hz,a.hy,a.hx));return b}});NGL.SurfaceParser=function(a,b){NGL.Parser.call(this,a,b||{});this.loader=void 0;this.surface=new NGL.Surface(this.name,this.path)};
NGL.SurfaceParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.SurfaceParser,type:"surface",__objName:"surface",_parse:function(a){var b=NGL.Uint8ToString(this.streamer.data),b=this.loader.parse(b);this.surface.fromGeometry(b);a()}});NGL.PlyParser=function(a,b){NGL.SurfaceParser.call(this,a,b||{});this.loader=new THREE.PLYLoader};NGL.PlyParser.prototype=NGL.createObject(NGL.SurfaceParser.prototype,{constructor:NGL.PlyParser,type:"ply"});
NGL.ObjParser=function(a,b){NGL.SurfaceParser.call(this,a,b||{});this.loader=new THREE.OBJLoader};NGL.ObjParser.prototype=NGL.createObject(NGL.SurfaceParser.prototype,{constructor:NGL.ObjParser,type:"obj"});NGL.TextParser=function(a,b){NGL.Parser.call(this,a,b||{});this.text={name:this.name,path:this.path,data:""}};
NGL.TextParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.TextParser,type:"text",__objName:"text",_parse:function(a){this.text.data=NGL.Uint8ToString(this.streamer.data);a()}});NGL.CsvParser=function(a,b){NGL.Parser.call(this,a,b||{});this.table={name:this.name,path:this.path,colNames:[],data:[]}};
NGL.CsvParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.CsvParser,type:"csv",__objName:"table",_parse:function(a){var b=this.table.data,c=/\s*,\s*/;this.streamer.eachChunkOfLines(function(a,e,f){f=a.length;for(var g=0;g<f;++g){var h=a[g].trim(),k=h.split(c);0===e&&0===g?this.table.colNames=k:h&&b.push(k)}}.bind(this));a()}});NGL.JsonParser=function(a,b){NGL.Parser.call(this,a,b||{});this.json={name:this.name,path:this.path,data:{}}};
NGL.JsonParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.JsonParser,type:"json",__objName:"json",_parse:function(a){var b=NGL.Uint8ToString(this.streamer.data);this.json.data=JSON.parse(b);a()}});NGL.XmlParser=function(a,b){NGL.Parser.call(this,a,b||{});this.xml={name:this.name,path:this.path,data:{}}};
NGL.XmlParser.prototype=NGL.createObject(NGL.Parser.prototype,{constructor:NGL.XmlParser,type:"xml",__objName:"xml",_parse:function(a){var b=NGL.Uint8ToString(this.streamer.data);this.xml.data=function(a){function b(){var g=f(/^<([\w-:.]+)\s*/);if(g){for(g={name:g[1],attributes:{},children:[]};0!=a.length&&0!=a.indexOf(">")&&0!=a.indexOf("?>")&&0!=a.indexOf("/>");){var h=e();if(!h)return g;g.attributes[h.name]=h.value}if(f(/^\s*\/>\s*/))return g;f(/\??>\s*/);h=(h=f(/^([^<]*)/))?h[1]:"";for(g.content=
h;h=b();)g.children.push(h);f(/^<\/[\w-:.]+>\s*/);return g}}function e(){var a=f(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|\w+)\s*/);if(a)return{name:a[1],value:a[2].replace(/^['"]|['"]$/g,"")}}function f(b){if(b=a.match(b))return a=a.slice(b[0].length),b}a=a.trim();a=a.replace(/\x3c!--[\s\S]*?--\x3e/g,"");return{declaration:function(){if(f(/^<\?xml\s*/)){for(var b={attributes:{}};0!=a.length&&0!=a.indexOf("?>");){var d=e();if(!d)return b;b.attributes[d.name]=d.value}f(/\?>\s*/);return b}}(),root:b()}}(b);
a()}});
NGL.PdbWriter=function(a,b){function c(a,b){return void 0!==a?a:b}function d(){h.forEach(function(a){k.push(sprintf("REMARK %-73s",a))});a.trajectory&&(k.push(sprintf("REMARK %-73s","Trajectory '"+a.trajectory.name+"'")),k.push(sprintf("REMARK %-73s","Frame "+a.trajectory.frame+"")))}function e(){var b=1;a.eachModel(function(a){k.push(sprintf("MODEL %-74d",b++));a.eachAtom(function(a){var b=a.hetero?m:l,d=a.atomname;1===d.length&&(d=" "+d);k.push(sprintf(b,a.serial,d,a.resname,c(a.chainname," "),
a.resno,a.x,a.y,a.z,c(a.occurence,1),c(a.bfactor,0),c(a.segid,""),c(a.element,"")))});k.push(sprintf("%-80s","ENDMDL"));b+=1});k.push(sprintf("%-80s","END"))}function f(){k=[];k.push(sprintf("TITEL %-74s",a.name));d();e();return k.join("\n")}function g(){return new Blob([f()],{type:"text/plain"})}var h=Object.assign({},b).remarks||[];Array.isArray(h)||(h=[h]);var k,l="ATOM  %5d %-4s %3s %1s%4d    %8.3f%8.3f%8.3f%6.2f%6.2f      %4s%2s",m="HETATM%5d %-4s %3s %1s%4d    %8.3f%8.3f%8.3f%6.2f%6.2f      %4s%2s";
this.getString=f;this.getBlob=g;this.download=function(a,b){var c=(a||"structure")+"."+(b||"pdb"),d=g();NGL.download(d,c)}};
NGL.DatasourceRegistry={sourceDict:{},listing:void 0,trajectory:void 0,__passThrough:{getUrl:function(a){return a}},add:function(a,b){a=a.toLowerCase();a in this.sourceDict&&NGL.warn("overwriting datasource named '"+a+"'");this.sourceDict[a]=b},get:function(a){a=(a||"").toLowerCase();if(a in this.sourceDict)return this.sourceDict[a];if(-1===["http","https","ftp"].indexOf(a)&&a)NGL.error("no datasource named '"+a+"' found");else return this.__passThrough}};
NGL.getDataInfo=function(a){a=NGL.getFileInfo(a);a=NGL.DatasourceRegistry.get(a.protocol).getUrl(a.src);return NGL.getFileInfo(a)};NGL.StaticDatasource=function(a){a=a||"";this.getUrl=function(b){b=NGL.getFileInfo(b);return NGL.getAbsolutePath(a+b.path)}};NGL.RcsbDatasource=function(){this.getUrl=function(a){a=NGL.getFileInfo(a);return"http://www.rcsb.org/pdb/files/"+(-1===["pdb","cif"].indexOf(a.ext)||!1!==a.compressed&&"gz"!==a.compressed?a.name+".cif.gz":a.path)}};
NGL.DatasourceRegistry.add("rcsb",new NGL.RcsbDatasource);NGL.Loader=function(a,b){var c=Object.assign({},b);this.compressed=c.compressed||!1;this.name=c.name||"";this.ext=c.ext||"";this.dir=c.dir||"";this.path=c.path||"";this.protocol=c.protocol||"";this.params=b;var d={compressed:this.compressed};this.streamer=a instanceof File?new NGL.FileStreamer(a,d):new NGL.NetworkStreamer(a,d);"function"===typeof c.onProgress&&(this.streamer.onprogress=c.onprogress)};
NGL.Loader.prototype={constructor:NGL.Loader,load:function(){return new Promise(function(a,b){this.streamer.onerror=b;try{this._load(a,b)}catch(c){b(c)}}.bind(this))},_load:function(a,b){b("not implemented")}};NGL.ParserLoader=function(a,b){NGL.Loader.call(this,a,b);this.noWorker=this.params.noWorker||!1};
NGL.ParserLoader.prototype=NGL.createObject(NGL.Loader.prototype,{constructor:NGL.ParserLoader,_load:function(a,b){var c=new {gro:NGL.GroParser,pdb:NGL.PdbParser,ent:NGL.PdbParser,pqr:NGL.PqrParser,cif:NGL.CifParser,mcif:NGL.CifParser,mmcif:NGL.CifParser,sdf:NGL.SdfParser,mol2:NGL.Mol2Parser,mrc:NGL.MrcParser,ccp4:NGL.MrcParser,map:NGL.MrcParser,cube:NGL.CubeParser,dx:NGL.DxParser,ply:NGL.PlyParser,obj:NGL.ObjParser,txt:NGL.TextParser,text:NGL.TextParser,csv:NGL.CsvParser,json:NGL.JsonParser,xml:NGL.XmlParser}[this.ext](this.streamer,
this.params);this.noWorker?c.parse(a):c.parseWorker(a)}});NGL.ScriptLoader=function(a,b){NGL.Loader.call(this,a,b)};NGL.ScriptLoader.prototype=NGL.createObject(NGL.Loader.prototype,{constructor:NGL.ScriptLoader,_load:function(a,b){this.streamer.read(function(){var b=NGL.Uint8ToString(this.streamer.data),b=new NGL.Script(b,this.name,this.path);a(b)}.bind(this))}});NGL.PluginLoader=function(a,b){NGL.Loader.call(this,a,b)};
NGL.PluginLoader.prototype=NGL.createObject(NGL.Loader.prototype,{constructor:NGL.PluginLoader,_load:function(a,b){var c;c=this.protocol?this.protocol+"://"+this.dir:this.dir;this.streamer.read(function(){var b=NGL.Uint8ToString(this.streamer.data),e=JSON.parse(b),f=[];e.files.map(function(a){f.push(NGL.autoLoad(c+a,{ext:"text",noWorker:!0}))});Promise.all(f).then(function(b){b=b.reduce(function(a,b){return a+"\n\n"+b.data},"");b+=e.source||"";b=new NGL.Script(b,this.name,this.path);a(b)}.bind(this))}.bind(this))}});
NGL.loaderMap={gro:NGL.ParserLoader,pdb:NGL.ParserLoader,ent:NGL.ParserLoader,pqr:NGL.ParserLoader,cif:NGL.ParserLoader,mcif:NGL.ParserLoader,mmcif:NGL.ParserLoader,sdf:NGL.ParserLoader,mol2:NGL.ParserLoader,mrc:NGL.ParserLoader,ccp4:NGL.ParserLoader,map:NGL.ParserLoader,cube:NGL.ParserLoader,dx:NGL.ParserLoader,obj:NGL.ParserLoader,ply:NGL.ParserLoader,txt:NGL.ParserLoader,text:NGL.ParserLoader,csv:NGL.ParserLoader,json:NGL.ParserLoader,xml:NGL.ParserLoader,ngl:NGL.ScriptLoader,plugin:NGL.PluginLoader};
NGL.autoLoad=function(a,b){var c=Object.assign(NGL.getDataInfo(a),b),d=new NGL.loaderMap[c.ext](c.src,c);return d?d.load():Promise.reject("NGL.autoLoading: ext '"+c.ext+"' unknown")};
NGL.Resources={"fonts/LatoBlack.fnt":null,"fonts/LatoBlack.png":"image","img/radial.png":"image","shader/CylinderImpostor.vert":null,"shader/CylinderImpostor.frag":null,"shader/HyperballStickImpostor.vert":null,"shader/HyperballStickImpostor.frag":null,"shader/Line.vert":null,"shader/Line.frag":null,"shader/LineSprite.vert":null,"shader/LineSprite.frag":null,"shader/Mesh.vert":null,"shader/Mesh.frag":null,"shader/ParticleSprite.vert":null,"shader/ParticleSprite.frag":null,"shader/Quad.vert":null,
"shader/Quad.frag":null,"shader/Ribbon.vert":null,"shader/Ribbon.frag":null,"shader/SDFFont.vert":null,"shader/SDFFont.frag":null,"shader/SphereHalo.vert":null,"shader/SphereHalo.frag":null,"shader/SphereImpostor.vert":null,"shader/SphereImpostor.frag":null,"shader/chunk/fog.glsl":null,"shader/chunk/fog_params.glsl":null,"shader/chunk/light.glsl":null,"shader/chunk/light_params.glsl":null};
NGL.Utils={lineLineIntersect:function(a,b,c,d){var e=NGL.EPS,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3,k,l;f.x=a.x-c.x;f.y=a.y-c.y;f.z=a.z-c.z;g.x=d.x-c.x;g.y=d.y-c.y;g.z=d.z-c.z;if(Math.abs(g.x)<e&&Math.abs(g.y)<e&&Math.abs(g.z)<e)return null;h.x=b.x-a.x;h.y=b.y-a.y;h.z=b.z-a.z;if(Math.abs(h.x)<e&&Math.abs(h.y)<e&&Math.abs(h.z)<e)return null;b=f.x*g.x+f.y*g.y+f.z*g.z;d=g.x*h.x+g.y*h.y+g.z*h.z;k=f.x*h.x+f.y*h.y+f.z*h.z;f=g.x*g.x+g.y*g.y+g.z*g.z;l=(h.x*h.x+h.y*h.y+h.z*h.z)*f-d*d;
if(Math.abs(l)<e)return null;e=(b*d-k*f)/l;b=(b+d*e)/f;a=new THREE.Vector3(a.x+e*h.x,a.y+e*h.y,a.z+e*h.z);c=new THREE.Vector3(c.x+b*g.x,c.y+b*g.y,c.z+b*g.z);return[a,c]},circularMean:function(){var a=2*Math.PI;return function(b,c,d,e,f){d=d||1;e=e||0;var g=f?f.length:b.length,h,k,l=0,m=0;if(f)for(k=0;k<g;++k)h=(b[f[k]*d+e]+c)%c,h=h/c*a-Math.PI,l+=Math.cos(h),m+=Math.sin(h);else for(k=e;k<g;k+=d)h=(b[k]+c)%c,h=h/c*a-Math.PI,l+=Math.cos(h),m+=Math.sin(h);return(Math.atan2(m/g,l/g)+Math.PI)/a*c}}(),
calculateCenterArray:function(a,b,c,d){var e=a.length;c=c||new Float32Array(e);d=d||0;for(var f=0;f<e;f+=3)c[d+f+0]=(a[f+0]+b[f+0])/2,c[d+f+1]=(a[f+1]+b[f+1])/2,c[d+f+2]=(a[f+2]+b[f+2])/2;return c},calculateDirectionArray:function(a,b){for(var c=a.length,d=new Float32Array(c),e=0;e<c;e+=3)d[e+0]=b[e+0]-a[e+0],d[e+1]=b[e+1]-a[e+1],d[e+2]=b[e+2]-a[e+2];return d},positionFromGeometry:function(a){a=a.vertices;for(var b,c,d=a.length,e=new Float32Array(3*d),f=0;f<d;f++)b=3*f,c=a[f],e[b+0]=c.x,e[b+1]=c.y,
e[b+2]=c.z;return e},colorFromGeometry:function(a){for(var b=a.faces,c,d,e=b.length,f=new Float32Array(3*a.vertices.length),g=0;g<e;g++)c=b[g],d=c.color,a=3*c.a,f[a+0]=d.r,f[a+1]=d.g,f[a+2]=d.b,a=3*c.b,f[a+0]=d.r,f[a+1]=d.g,f[a+2]=d.b,a=3*c.c,f[a+0]=d.r,f[a+1]=d.g,f[a+2]=d.b;return f},indexFromGeometry:function(a){a=a.faces;for(var b,c,d=a.length,e=new Uint32Array(3*d),f=0;f<d;f++)b=3*f,c=a[f],e[b+0]=c.a,e[b+1]=c.b,e[b+2]=c.c;return e},normalFromGeometry:function(a){for(var b=a.faces,c,d,e,f,g=b.length,
h=new Float32Array(3*a.vertices.length),k=0;k<g;k++)a=b[k],c=a.vertexNormals,d=c[0],e=c[1],f=c[2],c=3*a.a,h[c+0]=d.x,h[c+1]=d.y,h[c+2]=d.z,c=3*a.b,h[c+0]=e.x,h[c+1]=e.y,h[c+2]=e.z,c=3*a.c,h[c+0]=f.x,h[c+1]=f.y,h[c+2]=f.z;return h},uniformArray:function(a,b){for(var c=new Float32Array(a),d=0;d<a;++d)c[d]=b;return c},uniformArray3:function(a,b,c,d){for(var e=new Float32Array(3*a),f,g=0;g<a;++g)f=3*g,e[f+0]=b,e[f+1]=c,e[f+2]=d;return e},randomColorArray:function(a){for(var b=new Float32Array(3*a),c,
d=0;d<a;++d)c=3*d,b[c+0]=Math.random(),b[c+1]=Math.random(),b[c+2]=Math.random();return b},replicateArray3Entries:function(a,b){var c=a.length/3,d=new Float32Array(c*b*3),e,f,g,h,k,l,m;for(e=0;e<c;++e)for(f=3*e,g=e*b*3,k=a[f+0],l=a[f+1],m=a[f+2],f=0;f<b;++f)h=g+3*f,d[h+0]=k,d[h+1]=l,d[h+2]=m;return d},calculateMeanArray:function(a,b){for(var c=a.length,d=new Float32Array(c),e=0;e<c;e++)d[e]=(a[e]+b[e])/2;return d},calculateMinArray:function(a,b){for(var c=a.length,d=new Float32Array(c),e=0;e<c;e++)d[e]=
Math.min(a[e],b[e]);return d},calculateMeanVector3:function(a){var b=a.length,c=a.length/3,d=0,e=0,f=0,g;for(g=0;g<b;g+=3)d+=a[g+0],e+=a[g+1],f+=a[g+2];return new THREE.Vector3(d/c,e/c,f/c)},isPointOnSegment:function(a,b,c){var d=b.distanceTo(c);return a.distanceTo(b)<=d&&a.distanceTo(c)<=d},pointVectorIntersection:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){a.copy(e);b.subVectors(c,d);c=Math.cos(a.angleTo(b))*b.length();c=a.normalize().multiplyScalar(c);return(new THREE.Vector3).addVectors(c,
d)}}(),copyArray:function(a,b,c,d,e){var f;for(f=0;f<e;++f)b[d+f]=a[c+f]}};NGL.init=function(a){var b=NGL.GET("debug");void 0!==b&&(NGL.debug=b);b=NGL.GET("useWorker");void 0!==b&&(NGL.useWorker=b);b=NGL.GET("disableImpostor");void 0!==b&&(NGL.disableImpostor=b);this.textures=[];NGL.initResources(a);return this};NGL.dataURItoImage=function(a){if("function"!==typeof importScripts){var b=document.createElement("img");b.src=a;return b}};
NGL.initResources=function(a){var b=function(){NGL.log("NGL initialized");void 0!==a&&a()},c=new THREE.LoadingManager(b),d=new THREE.ImageLoader(c),e=new THREE.XHRLoader(c),c=Object.keys(NGL.Resources),f=0;c.forEach(function(a){var b=NGL.Resources[a],c=NGL.assetsDirectory+a;"image"===b?d.load(c,function(b){NGL.Resources[a]=b}):null!==b?f+=1:e.load(c,function(b){NGL.Resources[a]=b})});c.length===f&&b()};
NGL.getShader=function(){function a(a){if(void 0===a)return"";var b=[],c;for(c in a){var g=a[c];!1!==g&&b.push("#define "+c+" "+g)}return b.join("\n")}var b=/^(?!\/\/)\s*#include\s+(\S+)/gmi,c={};return function(d,e){e=e||{};var f=d+"|",g;for(g in e)f+=g+":"+e[g];if(!c[f]){g=a(e);var h=NGL.Resources["shader/"+d],h=h.replace(b,function(a,b){var c=NGL.Resources["shader/chunk/"+b+".glsl"]||THREE.ShaderChunk[b];return c?c:""});c[f]=g+h}return c[f]}}();
NGL.trimCanvas=function(a,b,c,d,e){var f=a.height,g=a.width,h=a.getContext("2d").getImageData(0,0,g,f).data,k,l,m;m=!1;for(l=0;l<f;l++){for(k=0;k<g;k++){var p=4*(l*g+k);if(h[p]!==b||h[p+1]!==c||h[p+2]!==d||h[p+3]!==e){m=!0;break}}if(m)break}var r=l;m=!1;for(k=0;k<g;k++){for(l=0;l<f;l++)if(p=4*(l*g+k),h[p]!==b||h[p+1]!==c||h[p+2]!==d||h[p+3]!==e){m=!0;break}if(m)break}var n=k;m=!1;for(l=f-1;0<=l;l--){for(k=g-1;0<=k;k--)if(p=4*(l*g+k),h[p]!==b||h[p+1]!==c||h[p+2]!==d||h[p+3]!==e){m=!0;break}if(m)break}var q=
l;m=!1;for(k=g-1;0<=k;k--){for(l=f-1;0<=l;l--)if(p=4*(l*g+k),h[p]!==b||h[p+1]!==c||h[p+2]!==d||h[p+3]!==e){m=!0;break}if(m)break}b=k;c=document.createElement("canvas");c.style.display="hidden";document.body.appendChild(c);c.width=b-n;c.height=q-r;c.getContext("2d").drawImage(a,n,r,c.width,c.height,0,0,c.width,c.height);return c};NGL.Stats=function(){this.signals={updated:new signals.Signal};this.begin();this.maxDuration=-Infinity;this.lastFps=this.lastDuration=this.minDuration=Infinity};
NGL.Stats.prototype={update:function(){this.startTime=this.end();this.signals.updated.dispatch()},begin:function(){this.prevFpsTime=this.startTime=Date.now()},end:function(){var a=Date.now();this.lastDuration=a-this.startTime;this.minDuration=Math.min(this.minDuration,this.lastDuration);this.maxDuration=Math.max(this.maxDuration,this.lastDuration);this.frames+=1;a>this.prevFpsTime+1E3&&(this.lastFps=Math.round(1E3*this.frames/(a-this.startTime)),this.prevFpsTime=a);this.frames=0;return a}};
NGL.Viewer=function(a){this.signals={orientationChanged:new signals.Signal};this.container=a?document.getElementById(a):document.createElement("div");this.container===document?(this.width=window.innerWidth,this.height=window.innerHeight):(a=this.container.getBoundingClientRect(),this.width=a.width,this.height=a.height);this.aspect=this.width/this.height;this.initParams();this.initCamera();this.initScene();this.initRenderer();this.initControls();this.initStats();this.setBackground();this.setFog();
this.boundingBox=new THREE.Box3;this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}}};
NGL.Viewer.prototype={constructor:NGL.Viewer,initParams:function(){this.params={fogColor:new THREE.Color(0),fogNear:50,fogFar:100,backgroundColor:new THREE.Color(0),cameraType:1,cameraFov:40,cameraZ:-80,clipNear:0,clipFar:100,clipDist:20}},initCamera:function(){var a=this.params,b=new THREE.Vector3(0,0,0);this.perspectiveCamera=new THREE.PerspectiveCamera(a.cameraFov,this.aspect,.1,1E4);this.perspectiveCamera.position.z=a.cameraZ;this.perspectiveCamera.lookAt(b);this.camera=this.perspectiveCamera;
this.camera.updateProjectionMatrix()},initRenderer:function(){this.renderer=new THREE.WebGLRenderer({preserveDrawingBuffer:!0,alpha:!0,antialias:!0});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(this.width,this.height);this.renderer.autoClear=!1;this.renderer.sortObjects=!0;var a=this.renderer.context;NGL.extensionFragDepth=a.getExtension("EXT_frag_depth");NGL.extensionFragDepth||NGL.info("EXT_frag_depth not supported");this.renderer.extensions.get("OES_standard_derivatives")||
NGL.warn("OES_standard_derivatives not supported");a.getExtension("OES_element_index_uint")||(NGL.indexUint16=!0,NGL.info("OES_element_index_uint not supported"));this.container.appendChild(this.renderer.domElement);var b=this,c=this.renderer.setProgram;this.renderer.setProgram=function(a,e,f,g,h){e=c(a,e,f,g,h);b.updateObjectUniforms(h,g,a);b.renderer.loadUniformsGeneric(b.renderer.properties.get(g).uniformsList);return e};this.renderer.extensions.get("OES_texture_float")||NGL.warn("OES_texture_float not supported");
a.getExtension("WEBGL_color_buffer_float")||NGL.warn("WEBGL_color_buffer_float not supported");this.pickingTexture=new THREE.WebGLRenderTarget(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,stencilBuffer:!1,format:THREE.RGBAFormat,type:this.supportsReadPixelsFloat()?THREE.FloatType:THREE.UnsignedByteType});this.pickingTexture.generateMipmaps=!1},supportsReadPixelsFloat:function(){var a=void 0;return function(){if(void 0===
a){var b=this.renderer.context;a="Chrome"===NGL.browser&&this.renderer.extensions.get("OES_texture_float")||this.renderer.extensions.get("OES_texture_float")&&b.getExtension("WEBGL_color_buffer_float")}return a}}(),initScene:function(){this.scene||(this.scene=new THREE.Scene);this.rotationGroup=new THREE.Group;this.rotationGroup.name="rotationGroup";this.scene.add(this.rotationGroup);this.modelGroup=new THREE.Group;this.modelGroup.name="modelGroup";this.rotationGroup.add(this.modelGroup);this.pickingGroup=
new THREE.Group;this.pickingGroup.name="pickingGroup";this.rotationGroup.add(this.pickingGroup);this.backgroundGroup=new THREE.Group;this.backgroundGroup.name="backgroundGroup";this.rotationGroup.add(this.backgroundGroup);this.modelGroup.fog=new THREE.Fog},initControls:function(){this.controls=new THREE.TrackballControls(this.camera,this.renderer.domElement);this.controls.rotateSpeed=2;this.controls.zoomSpeed=1.2;this.controls.panSpeed=.8;this.controls.staticMoving=!0;this.controls.cylindricalRotation=
!0;this.controls.keys=[65,83,68];this.controls.addEventListener("change",this.requestRender.bind(this));document.addEventListener("mousemove",this.controls.update.bind(this.controls),!1);document.addEventListener("touchmove",this.controls.update.bind(this.controls),!1);this.controls.addEventListener("change",function(){this.signals.orientationChanged.dispatch()}.bind(this),!1)},initStats:function(){this.stats=new NGL.Stats},add:function(a,b){b?b.forEach(function(b){this.addBuffer(a,b)},this):this.addBuffer(a);
a.background?(this.backgroundGroup.add(a.group),this.backgroundGroup.add(a.wireframeGroup)):(this.modelGroup.add(a.group),this.modelGroup.add(a.wireframeGroup));a.pickable&&this.pickingGroup.add(a.pickingGroup);this.rotationGroup.updateMatrixWorld();this.requestRender()},addBuffer:function(a,b){var c=a.getMesh();c.userData.buffer=a;b&&c.applyMatrix(b.matrix);a.group.add(c);var d=a.getWireframeMesh();d.userData.buffer=a;b&&(d.matrix.copy(c.matrix),d.position.copy(c.position),d.quaternion.copy(c.quaternion),
d.scale.copy(c.scale));a.wireframeGroup.add(d);a.pickable&&(d=a.getPickingMesh(),d.userData.buffer=a,b&&(d.matrix.copy(c.matrix),d.position.copy(c.position),d.quaternion.copy(c.quaternion),d.scale.copy(c.scale),d.userData.instance=b),a.pickingGroup.add(d));b?this.updateBoundingBox(a.geometry,b.matrix):this.updateBoundingBox(a.geometry)},remove:function(a){this.rotationGroup.children.forEach(function(b){b.remove(a.group);b.remove(a.wireframeGroup)});a.pickable&&this.pickingGroup.remove(a.pickingGroup);
this.updateBoundingBox()},updateBoundingBox:function(a,b){var c,d=this.boundingBox;this.boundingBoxMesh&&(this.modelGroup.remove(this.boundingBoxMesh),this.boundingBoxMesh.material.dispose(),this.boundingBoxMesh.geometry.dispose());a?(a.boundingBox||a.computeBoundingBox(),b?(c=a.boundingBox.clone(),c.applyMatrix4(b)):c=a.boundingBox,d.expandByPoint(c.min),d.expandByPoint(c.max)):(d.makeEmpty(),this.rotationGroup.traverse(function(a){void 0!==a.geometry&&(a.geometry.boundingBox||a.geometry.computeBoundingBox(),
a.userData.instance?(c=a.geometry.boundingBox.clone(),c.applyMatrix4(a.userData.instance.matrix)):c=a.geometry.boundingBox,d.expandByPoint(c.min),d.expandByPoint(c.max))}));this.controls.maxDistance=10*d.size().length();if(NGL.debug){var e=d.size(),e=new THREE.BoxGeometry(e.x,e.y,e.z),e=new THREE.WireframeGeometry(e);this.boundingBoxMesh=new THREE.LineSegments(e);d.center(this.boundingBoxMesh.position);this.modelGroup.add(this.boundingBoxMesh)}},fullscreen:function(){var a=this.container;a.requestFullscreen?
a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()},getImage:function(a,b){return this.renderer.domElement.toBlob(a,b)},setFog:function(a,b,c){var d=this.params;a&&d.fogColor.set(a);b&&(d.fogNear=b);c&&(d.fogFar=c);this.requestRender()},setBackground:function(a){var b=this.params;a&&b.backgroundColor.set(a);this.setFog(b.backgroundColor);this.renderer.setClearColor(b.backgroundColor,
1);this.requestRender()},setCamera:function(a,b,c,d){var e=this.params;null!==a&&(e.cameraType=a);b&&(e.cameraFov=b);c&&(e.cameraNear=c);d&&(e.cameraFar=d);this.camera=this.perspectiveCamera;this.perspectiveCamera.fov=e.cameraFov;this.perspectiveCamera.near=e.cameraNear;this.perspectiveCamera.far=e.cameraFar;this.controls.object=this.camera;this.camera.updateProjectionMatrix();this.requestRender()},setClip:function(a,b){var c=this.params;a&&(c.clipNear=a);b&&(c.clipFar=b);this.requestRender()},handleResize:function(){if(this.container===
document)this.width=window.innerWidth,this.height=window.innerHeight;else{var a=this.container.getBoundingClientRect();this.width=a.width;this.height=a.height}this.aspect=this.width/this.height;this.perspectiveCamera.aspect=this.aspect;this.camera.updateProjectionMatrix();this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(this.width,this.height);this.pickingTexture.setSize(this.width*window.devicePixelRatio,this.height*window.devicePixelRatio);this.controls.handleResize();
this.requestRender()},updateInfo:function(a){var b=this.info,c=b.memory,b=b.render;if(a)c.programs=0,c.geometries=0,c.textures=0,b.calls=0,b.vertices=0,b.faces=0,b.points=0;else{var d=this.renderer.info;a=d.memory;d=d.render;c.programs=a.programs;c.geometries=a.geometries;c.textures=a.textures;b.calls+=d.calls;b.vertices+=d.vertices;b.faces+=d.faces;b.points+=d.points}},animate:function(){requestAnimationFrame(this.animate.bind(this));this.controls.update()},screenshot:function(a){NGL.screenshot(this,
a)},pick:function(){var a=new Float32Array(4),b=new Uint8Array(4);return function(c,d){var e,f,g,h=this.supportsReadPixelsFloat()?a:b;this.render(null,!0);e=this.renderer.context;this.renderer.setRenderTarget(this.pickingTexture);e.readPixels(c*window.devicePixelRatio,d*window.devicePixelRatio,1,1,e.RGBA,this.supportsReadPixelsFloat()?e.FLOAT:e.UNSIGNED_BYTE,h);this.renderer.setRenderTarget();e=this.supportsReadPixelsFloat()?Math.round(255*h[0])<<16&16711680|Math.round(255*h[1])<<8&65280|Math.round(255*
h[2])&255:h[0]<<16|h[1]<<8|h[2];(f=this.pickingGroup.getObjectById(Math.round(h[3])))&&f.userData.instance&&(g=f.userData.instance);NGL.debug&&(f=Array.apply([],h),NGL.log(h),NGL.log("picked color",[f[0].toPrecision(2),f[1].toPrecision(2),f[2].toPrecision(2),f[3].toPrecision(2)]),NGL.log("picked gid",e),NGL.log("picked instance",g),NGL.log("picked position",c,d),NGL.log("devicePixelRatio",window.devicePixelRatio));return{gid:e,instance:g}}}(),requestRender:function(){this._renderPending||(this._renderPending=
!0,requestAnimationFrame(this.render.bind(this)))},render:function(a,b,c){if(this._rendering)NGL.warn("tried to call 'render' from within 'render'");else{this._rendering=!0;(a=this.camera.position.length())||this.camera.position.set(0,0,this.params.cameraZ);var d=.5*this.boundingBox.size().length(),e=-(50-this.params.clipFar)/50,f=a-(50-this.params.clipNear)/50*d;this.camera.near=Math.max(.1,this.params.clipDist);this.camera.far=Math.max(1,a+d*e);this.nearClip=f;var e=(50-this.params.fogNear)/50,
f=-(50-this.params.fogFar)/50,g=this.modelGroup.fog;g.color.set(this.params.fogColor);g.near=Math.max(.1,a-d*e);g.far=Math.max(1,a+d*f);this.camera.updateMatrix();this.camera.updateMatrixWorld(!0);this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld);c||this.camera.updateProjectionMatrix();this.updateMaterialUniforms(this.scene,this.camera);this.sortProjectedPosition(this.scene,this.camera);this.updateInfo(!0);b?(this.renderer.clearTarget(this.pickingTexture),this.renderer.render(this.pickingGroup,
this.camera,this.pickingTexture),this.updateInfo(),this.renderer.setRenderTarget(),NGL.debug&&(this.renderer.clear(),this.renderer.render(this.pickingGroup,this.camera))):(this.renderer.clear(),this.renderer.render(this.backgroundGroup,this.camera),this.renderer.clearDepth(),this.updateInfo(),this.renderer.render(this.modelGroup,this.camera),this.updateInfo());this._renderPending=this._rendering=!1}},updateMaterialUniforms:function(){var a=new THREE.Matrix4,b=new THREE.Matrix4;return function(c,d){var e=
this.nearClip;a.getInverse(d.projectionMatrix);b.copy(d.projectionMatrix).transpose();c.traverse(function(c){c.material&&(c=c.material.uniforms)&&(c.nearClip&&(c.nearClip.value=e),c.projectionMatrixInverse&&c.projectionMatrixInverse.value.copy(a),c.projectionMatrixTranspose&&c.projectionMatrixTranspose.value.copy(b))})}}(),updateObjectUniforms:function(){var a=new THREE.Matrix4;return function(b,c,d){b.material&&(c=b.material.uniforms)&&(c.objectId&&(c.objectId.value=this.supportsReadPixelsFloat()?
b.id:b.id/255),c.modelViewMatrixInverse&&c.modelViewMatrixInverse.value.getInverse(b.modelViewMatrix),c.modelViewMatrixInverseTranspose&&(c.modelViewMatrixInverse?c.modelViewMatrixInverseTranspose.value.copy(c.modelViewMatrixInverse.value).transpose():c.modelViewMatrixInverseTranspose.value.getInverse(b.modelViewMatrix).transpose()),c.modelViewProjectionMatrix&&c.modelViewProjectionMatrix.value.multiplyMatrices(d.projectionMatrix,b.modelViewMatrix),c.modelViewProjectionMatrixInverse&&(c.modelViewProjectionMatrix?
a.copy(c.modelViewProjectionMatrix.value):a.multiplyMatrices(d.projectionMatrix,b.modelViewMatrix),c.modelViewProjectionMatrixInverse.value.getInverse(a)))}}(),sortProjectedPosition:function(){var a=new THREE.Vector3,b=new THREE.Matrix4,c=new THREE.Matrix4;return function(d,e){d.traverseVisible(function(d){if(d instanceof THREE.PointCloud&&d.sortParticles){b.multiplyMatrices(e.matrixWorldInverse,d.matrixWorld);c.multiplyMatrices(e.projectionMatrix,b);var g=d.geometry.attributes,h=g.position.count;
d.userData.sortData||(d.userData.sortData={});d=d.userData.sortData;d.__sortArray||(d.__sortArray=new Float32Array(2*h));for(var k=d.__sortArray,l=0;l<h;++l){var m=2*l;a.fromArray(g.position.array,3*l);a.applyProjection(c);k[m]=-a.z;k[m+1]=l}THREE.TypedArrayUtils.quicksortIP(k,2,0);var p,r,n,q,t;for(t in g){var l=g[t],m=l.array,u=l.itemSize;d[t]||(d[t]=new Float32Array(u*h));q=d[t];d[t]=m;for(l=0;l<h;++l){p=k[2*l+1];for(var s=0;s<u;++s)r=p*u+s,n=l*u+s,q[n]=m[r]}g[t].array=q;g[t].needsUpdate=!0}}})}}(),
clear:function(){NGL.log("scene cleared");this.scene.remove(this.rotationGroup);this.initScene();this.renderer.clear()},centerView:function(){var a=new THREE.Vector3;return function(b,c){c=c||this.boundingBox.center();this.controls.object.position.sub(this.controls.target);this.controls.target.copy(this.controls.target0);a.copy(c).multiplyScalar(-1);b&&(!0===b&&(b=this.boundingBox.size().length()/2/Math.tan(Math.PI*this.camera.fov/360)),b=Math.max(b,1.2*this.params.clipDist),this.camera.position.multiplyScalar(b/
this.camera.position.length()));this.rotationGroup.position.copy(a);this.rotationGroup.updateMatrixWorld();this.requestRender();this.signals.orientationChanged.dispatch()}}(),getOrientation:function(){return[this.camera.position.toArray(),this.camera.up.toArray(),this.rotationGroup.position.toArray(),this.controls.target.toArray()]},setOrientation:function(a){console.log("setOrientation");this.controls.object.position.sub(this.controls.target);this.controls.target.copy(this.controls.target0);this.controls.target.fromArray(a[3]);
this.rotationGroup.position.fromArray(a[2]);this.rotationGroup.updateMatrixWorld();this.camera.up.fromArray(a[1]);this.camera.position.fromArray(a[0]);this.requestRender();this.signals.orientationChanged.dispatch()}};NGL.TiledRenderer=function(a,b,c,d){d=d||{};this.renderer=a;this.camera=b;this.viewer=c;this.factor=void 0!==d.factor?d.factor:2;this.antialias=void 0!==d.antialias?d.antialias:!1;this.onProgress=d.onProgress;this.onFinish=d.onFinish;this.init()};
NGL.TiledRenderer.prototype={init:function(){this.antialias&&(this.factor*=2);this.n=this.factor*this.factor;var a=document.createElement("canvas");a.style.display="hidden";document.body.appendChild(a);this.antialias?(a.width=this.viewer.width*this.factor/2,a.height=this.viewer.height*this.factor/2):(a.width=this.viewer.width*this.factor,a.height=this.viewer.height*this.factor);this.ctx=a.getContext("2d");this.canvas=a;this.shearMatrix=new THREE.Matrix4;this.scaleMatrix=new THREE.Matrix4;a=THREE.Math.degToRad(.5*
this.camera.fov);this.near=this.camera.near;this.top=Math.tan(a)*this.near;this.bottom=-this.top;this.left=this.camera.aspect*this.bottom;this.right=this.camera.aspect*this.top;this.width=Math.abs(this.right-this.left);this.height=Math.abs(this.top-this.bottom)},makeAsymmetricFrustum:function(a,b){var c=this.factor,d=this.near;this.shearMatrix.set(1,0,(b%c-.5*(c-1))*this.width/d,0,0,1,-(Math.floor(b/c)-.5*(c-1))*this.height/d,0,0,0,1,0,0,0,0,1);this.scaleMatrix.set(c,0,0,0,0,c,0,0,0,0,1,0,0,0,0,1);
a.multiply(this.shearMatrix).multiply(this.scaleMatrix);return a},renderTile:function(a){this.viewer.renderer.setPixelRatio(window.devicePixelRatio*this.factor);this.makeAsymmetricFrustum(this.camera.projectionMatrix,a);this.viewer.render(null,null,!0);var b=a%this.factor*this.viewer.width,c=Math.floor(a/this.factor)*this.viewer.height;this.antialias?this.ctx.drawImage(this.renderer.domElement,Math.floor(b/2),Math.floor(c/2),Math.ceil(this.viewer.width/2),Math.ceil(this.viewer.height/2)):this.ctx.drawImage(this.renderer.domElement,
Math.floor(b),Math.floor(c),Math.ceil(this.viewer.width),Math.ceil(this.viewer.height));this.camera.updateProjectionMatrix();if("function"===typeof this.onProgress)this.onProgress(a+1,this.n,!1);this.viewer.renderer.setPixelRatio(window.devicePixelRatio)},render:function(){for(var a=this.n,b=0;b<=a;++b)if(b===a){if("function"===typeof this.onFinish)this.onFinish(b+1,a,!1)}else this.renderTile(b)},renderAsync:function(){for(var a=this.n,b=this.renderTile.bind(this),c=this.onFinish,d=0;d<=a;++d)setTimeout(function(d){d===
a?"function"===typeof c&&c(d+1,a,!1):b(d)},0,d)},dispose:function(){document.body.removeChild(this.canvas)}};
NGL.screenshot=function(a,b){function c(a,b,c){if("function"===typeof e.onProgress)e.onProgress(a,b,c)}function d(a){var b,d=g.split("/")[1];f?(b=q,b=NGL.trimCanvas(t.canvas,255*b.r|0,255*b.g|0,255*b.b|0,k?0:255)):b=t.canvas;b.toBlob(function(b){NGL.download(b,"screenshot."+d);c(a,a,!0);t.dispose()},g,h)}var e=b||{},f=void 0!==e.trim?e.trim:!1,g=void 0!==e.type?e.type:"image/png",h=void 0!==e.quality?e.quality:1,k=void 0!==e.transparent?e.transparent:!1,l=void 0!==e.factor?e.factor:!1,m=void 0!==
e.antialias?e.antialias:!1,p=a.renderer,r=a.camera,n=p.getClearAlpha(),q=p.getClearColor();k&&p.setClearAlpha(0);var t=new NGL.TiledRenderer(p,r,a,{factor:l,antialias:m,onProgress:c,onFinish:function(b,c){d(c);k&&p.setClearAlpha(n);a.requestRender()}});t.renderAsync()};
NGL.DoubleSidedBuffer=function(a){this.size=a.size;this.side=a.side;this.wireframe=a.wireframe;this.visible=a.visible;this.geometry=a.geometry;this.pickable=a.pickable;this.group=new THREE.Group;this.wireframeGroup=new THREE.Group;this.pickingGroup=new THREE.Group;var b=[],c=[],d=new a.constructor;a.makeMaterial();d.makeMaterial();d.geometry=a.geometry;d.wireframeGeometry=a.wireframeGeometry;d.size=a.size;d.attributeSize=a.attributeSize;d.pickable=a.pickable;d.setParameters(a.getParameters());d.updateShader();
a.setParameters({side:THREE.FrontSide});d.setParameters({side:THREE.BackSide,opacity:d.opacity});this.getMesh=function(e){var f;e?(f=d.getPickingMesh(),e=a.getPickingMesh()):(f=d.getMesh(),e=a.getMesh());b.push(e);c.push(f);this.setParameters({side:this.side});return(new THREE.Group).add(f,e)};this.getWireframeMesh=function(){return a.getWireframeMesh()};this.getPickingMesh=function(){return this.getMesh(!0)};this.setAttributes=function(b){a.setAttributes(b)};this.setParameters=function(e){e=Object.assign({},
e);e.side===THREE.FrontSide?(b.forEach(function(a){a.visible=!0}),c.forEach(function(a){a.visible=!1})):e.side===THREE.BackSide?(b.forEach(function(a){a.visible=!1}),c.forEach(function(a){a.visible=!0})):e.side===THREE.DoubleSide&&(b.forEach(function(a){a.visible=!0}),c.forEach(function(a){a.visible=!0}));void 0!==e.side&&(this.side=e.side);delete e.side;a.setParameters(e);void 0!==e.wireframe&&(this.wireframe=e.wireframe,this.setVisibility(this.visible));delete e.wireframe;d.setParameters(e)};this.setVisibility=
NGL.Buffer.prototype.setVisibility;this.dispose=function(){a.dispose();d.dispose()}};
NGL.Buffer=function(a,b,c,d,e){e=e||{};this.pickable=!1;this.dynamic=!0;this.opaqueBack=void 0!==e.opaqueBack?e.opaqueBack:!1;this.dullInterior=void 0!==e.dullInterior?e.dullInterior:!1;this.side=void 0!==e.side?e.side:THREE.DoubleSide;this.opacity=void 0!==e.opacity?e.opacity:1;this.nearClip=void 0!==e.nearClip?e.nearClip:!0;this.flatShaded=void 0!==e.flatShaded?e.flatShaded:!1;this.background=void 0!==e.background?e.background:!1;this.linewidth=void 0!==e.linewidth?e.linewidth:1;this.wireframe=
void 0!==e.wireframe?e.wireframe:!1;this.wireframeLinewidth=e.wireframeLinewidth||1;this.geometry=new THREE.BufferGeometry;this.addAttributes({position:{type:"v3",value:a},color:{type:"c",value:b}});c&&(this.geometry.addIndex(new THREE.BufferAttribute(c,1)),this.geometry.index.setDynamic(this.dynamic));d&&(this.addAttributes({pickingColor:{type:"c",value:d}}),this.pickable=!0);this.uniforms={fogColor:{type:"c",value:null},fogNear:{type:"f",value:0},fogFar:{type:"f",value:0},opacity:{type:"f",value:this.opacity},
nearClip:{type:"f",value:0}};this.pickingUniforms={nearClip:{type:"f",value:0},objectId:{type:"f",value:0}};this.group=new THREE.Group;this.wireframeGroup=new THREE.Group;this.pickingGroup=new THREE.Group;this.makeWireframeGeometry()};
NGL.Buffer.prototype={constructor:NGL.Buffer,parameters:{opaqueBack:{updateShader:!0},dullInterior:{updateShader:!0},side:{updateShader:!0,property:!0},opacity:{uniform:!0},nearClip:{updateShader:!0},flatShaded:{updateShader:!0},background:{updateShader:!0},linewidth:{property:!0},wireframe:{updateVisibility:!0}},get transparent(){return 1>this.opacity},makeMaterial:function(){this.material=new THREE.RawShaderMaterial({uniforms:this.uniforms,vertexShader:"",fragmentShader:"",depthTest:!0,transparent:this.transparent,
depthWrite:!0,lights:!1,fog:!0,side:this.side,linewidth:this.linewidth});this.wireframeMaterial=new THREE.RawShaderMaterial({uniforms:this.uniforms,vertexShader:"Line.vert",fragmentShader:"Line.frag",depthTest:!0,transparent:this.transparent,depthWrite:!0,lights:!1,fog:!0,side:this.side,linewidth:this.linewidth});this.pickingMaterial=new THREE.RawShaderMaterial({uniforms:this.pickingUniforms,vertexShader:"",fragmentShader:"",depthTest:!0,transparent:!1,depthWrite:!0,lights:!1,fog:!1,side:this.side,
linewidth:this.linewidth});this.updateShader()},makeWireframeGeometry:function(){this.makeWireframeIndex();var a=this.geometry,b=this.wireframeIndex,c=new THREE.BufferGeometry;c.attributes=a.attributes;b&&(c.addIndex((new THREE.BufferAttribute(b,1)).setDynamic(this.dynamic)),c.addGroup(0,this.wireframeIndexCount));this.wireframeGeometry=c},makeWireframeIndex:function(){function a(a,d){if(a>d){var e=a;a=d;d=e}e=b[a];return void 0===e?(b[a]=[d],!0):-1===e.indexOf(d)?(e.push(d),!0):!1}var b=[];return function(){var c=
this.geometry.index;if(c){var c=c.array,d=c.length;this.geometry.groups.length&&(d=this.geometry.groups[0].count);var e;e=this.wireframeIndex&&this.wireframeIndex.length>2*d?this.wireframeIndex:new Uint32Array(2*d);for(var f=0,g=b.length=0;g<d;g+=3){var h=c[g+0],k=c[g+1],l=c[g+2];a(h,k)&&(e[f+0]=h,e[f+1]=k,f+=2);a(k,l)&&(e[f+0]=k,e[f+1]=l,f+=2);a(l,h)&&(e[f+0]=l,e[f+1]=h,f+=2)}this.wireframeIndex=e;this.wireframeIndexCount=f}}}(),updateWireframeIndex:function(){this.wireframeGeometry.clearGroups();
this.makeWireframeIndex();this.wireframeIndex.length>this.wireframeGeometry.index.array.length?this.wireframeGeometry.addIndex((new THREE.BufferAttribute(this.wireframeIndex,1)).setDynamic(this.dynamic)):(this.wireframeGeometry.index.set(this.wireframeIndex),this.wireframeGeometry.index.needsUpdate=0<this.wireframeIndexCount,this.wireframeGeometry.index.updateRange.count=this.wireframeIndexCount);this.wireframeGeometry.addGroup(0,this.wireframeIndexCount)},getRenderOrder:function(){var a=0;this instanceof
NGL.TextBuffer?a=1:this.transparent&&(a=this instanceof NGL.SurfaceBuffer?3:2);return a},getMesh:function(){var a;this.material||this.makeMaterial();this.line?a=new THREE.LineSegments(this.geometry,this.material):this.point?(a=new THREE.PointCloud(this.geometry,this.material),this.sort&&(a.sortParticles=!0)):a=new THREE.Mesh(this.geometry,this.material);a.frustumCulled=!1;a.renderOrder=this.getRenderOrder();return a},getWireframeMesh:function(){var a;this.material||this.makeMaterial();this.wireframeGeometry||
this.makeWireframeGeometry();a=new THREE.LineSegments(this.wireframeGeometry,this.wireframeMaterial);a.frustumCulled=!1;a.renderOrder=this.getRenderOrder();return a},getPickingMesh:function(){var a;this.material||this.makeMaterial();a=new THREE.Mesh(this.geometry,this.pickingMaterial);a.frustumCulled=!1;a.renderOrder=this.getRenderOrder();return a},getShader:function(a,b){return NGL.getShader(a,this.getDefines(b))},getVertexShader:function(a){return this.getShader(this.vertexShader,a)},getFragmentShader:function(a){return this.getShader(this.fragmentShader,
a)},getDefines:function(a){var b={};this.nearClip&&(b.NEAR_CLIP=1);if("picking"===a)this.side===THREE.DoubleSide?b.DOUBLE_SIDED=1:this.side===THREE.BackSide&&(b.FLIP_SIDED=1),b.PICKING=1;else{this.side===THREE.DoubleSide?b.DOUBLE_SIDED=1:this.side===THREE.BackSide&&(b.FLIP_SIDED=1);if("background"===a||this.background)b.NOLIGHT=1;this.flatShaded&&(b.FLAT_SHADED=1);this.opaqueBack&&(b.OPAQUE_BACK=1);this.dullInterior&&(b.DULL_INTERIOR=1);b.USE_FOG=1}return b},getParameters:function(){var a={},b;for(b in this.parameters)a[b]=
this[b];return a},addUniforms:function(a){this.uniforms=THREE.UniformsUtils.merge([this.uniforms,a]);this.pickingUniforms=THREE.UniformsUtils.merge([this.pickingUniforms,a])},addAttributes:function(a){var b={f:1,v2:2,v3:3,c:3},c;for(c in a){var d,e=a[c];e.value?(this.attributeSize*b[e.type]!==e.value.length&&NGL.error("attribute value has wrong length",c),d=e.value):d=new Float32Array(this.attributeSize*b[e.type]);this.geometry.addAttribute(c,(new THREE.BufferAttribute(d,b[e.type])).setDynamic(this.dynamic))}},
updateRenderOrder:function(){function a(a){a.renderOrder=b}var b=this.getRenderOrder();this.group.children.forEach(a);this.pickingGroup&&this.pickingGroup.children.forEach(a)},updateShader:function(){var a=this.material,b=this.wireframeMaterial,c=this.pickingMaterial;a.vertexShader=this.getVertexShader();a.fragmentShader=this.getFragmentShader();a.needsUpdate=!0;b.vertexShader=this.getShader("Line.vert");b.fragmentShader=this.getShader("Line.frag");b.needsUpdate=!0;c.vertexShader=this.getVertexShader("picking");
c.fragmentShader=this.getFragmentShader("picking");c.needsUpdate=!0},setParameters:function(a){if(a){var b=this.parameters,c={},d={},e=!1,f=!1,g;for(g in a)void 0!==a[g]&&void 0!==b[g]&&(this[g]=a[g],b[g].property&&(!0!==b[g].property?c[b[g].property]=a[g]:c[g]=a[g]),b[g].uniform&&(d[g]=a[g]),b[g].updateShader&&(e=!0),b[g].updateVisibility&&(f=!0),this.dynamic&&"wireframe"===g&&!0===a[g]&&this.updateWireframeIndex());this.setProperties(c);this.setUniforms(d);e&&this.updateShader();f&&this.setVisibility(this.visible)}},
setAttributes:function(a){var b=this.geometry,c=b.attributes,d;for(d in a){var e=a[d],f=e.length;if("index"===d)b.clearGroups(),f>b.index.array.length?b.addIndex((new THREE.BufferAttribute(e,1)).setDynamic(this.dynamic)):(b.index.set(e),b.index.needsUpdate=0<f,b.index.updateRange.count=f,b.addGroup(0,f)),this.wireframe&&this.updateWireframeIndex();else{var g=c[d];f>g.array.length?b.addAttribute(d,(new THREE.BufferAttribute(e,g.itemSize)).setDynamic(this.dynamic)):(c[d].set(e),c[d].needsUpdate=0<f,
c[d].updateRange.count=f)}}},setUniforms:function(a){if(a){var b=this.material.uniforms,c=this.wireframeMaterial.uniforms,d=this.pickingMaterial.uniforms,e;for(e in a)"opacity"===e&&this.setProperties({transparent:1>a[e]}),void 0!==b[e]&&(b[e].value=a[e]),void 0!==c[e]&&(c[e].value=a[e]),void 0!==d[e]&&(d[e].value=a[e])}},setProperties:function(a){if(a){var b=this.material,c=this.wireframeMaterial,d=this.pickingMaterial,e;for(e in a)"transparent"===e&&this.updateRenderOrder(),void 0!==b[e]&&(b[e]=
a[e]),void 0!==c[e]&&(c[e]=a[e]),void 0!==d[e]&&(d[e]=a[e]);b.needsUpdate=!0;c.needsUpdate=!0;d.needsUpdate=!0}},setVisibility:function(a){this.visible=a;this.wireframe?(this.group.visible=!1,this.wireframeGroup.visible=a,this.pickable&&(this.pickingGroup.visible=!1)):(this.group.visible=a,this.wireframeGroup.visible=!1,this.pickable&&(this.pickingGroup.visible=a))},dispose:function(){this.material&&this.material.dispose();this.wireframeMaterial&&this.wireframeMaterial.dispose();this.pickingMaterial&&
this.pickingMaterial.dispose();this.geometry.dispose();this.wireframeGeometry&&this.wireframeGeometry.dispose()}};NGL.MeshBuffer=function(a,b,c,d,e,f){f=f||{};this.attributeSize=this.size=a?a.length/3:0;this.vertexShader="Mesh.vert";this.fragmentShader="Mesh.frag";NGL.Buffer.call(this,a,b,c,e,f);this.addAttributes({normal:{type:"v3",value:d}});void 0===d&&this.geometry.computeVertexNormals()};NGL.MeshBuffer.prototype=Object.create(NGL.Buffer.prototype);NGL.MeshBuffer.prototype.constructor=NGL.MeshBuffer;
NGL.MappedBuffer=function(a){this.size=this.count;this.attributeSize=this.count*this.mappingSize;this.index=new Uint32Array(this.count*this.mappingIndicesSize);this.makeIndex();NGL.Buffer.call(this,null,null,this.index,null,a);this.addAttributes({mapping:{type:this.mappingType,value:null}})};NGL.MappedBuffer.prototype=Object.create(NGL.Buffer.prototype);NGL.MappedBuffer.prototype.constructor=NGL.MappedBuffer;
NGL.MappedBuffer.prototype.setAttributes=function(a){var b=this.count,c=this.mappingSize,d=this.geometry.attributes,e,f,g,h,k,l,m,p;for(p in a){f=a[p];e=d[p];g=e.itemSize;h=e.array;for(var r=0;r<b;++r){k=r*g;l=k*c;for(var n=0;n<c;++n){m=l+g*n;for(var q=0;q<g;++q)h[m+q]=f[k+q]}}e.needsUpdate=!0}};NGL.MappedBuffer.prototype.makeMapping=function(){for(var a=this.count,b=this.mapping,c=this.mappingSize,d=this.mappingItemSize,e=this.geometry.attributes.mapping.array,f=0;f<a;f++)e.set(b,f*d*c)};
NGL.MappedBuffer.prototype.makeIndex=function(){for(var a=this.count,b=this.mappingSize,c=this.mappingIndices,d=this.mappingIndicesSize,e=this.index,f,g,h=0;h<a;h++){f=h*d;g=h*b;e.set(c,f);for(var k=0;k<d;++k)e[f+k]+=g}};NGL.QuadBuffer=function(a){this.mapping=new Float32Array([-1,1,-1,-1,1,1,1,-1]);this.mappingIndices=new Uint32Array([0,1,2,1,3,2]);this.mappingIndicesSize=6;this.mappingType="v2";this.mappingSize=4;this.mappingItemSize=2;NGL.MappedBuffer.call(this,a)};NGL.QuadBuffer.prototype=Object.create(NGL.MappedBuffer.prototype);
NGL.QuadBuffer.prototype.constructor=NGL.QuadBuffer;NGL.BoxBuffer=function(a){this.mapping=new Float32Array([-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,-1,1,1,-1,1,1,1,-1,1,1]);this.mappingIndices=new Uint32Array([0,1,2,0,2,3,1,5,6,1,6,2,4,6,5,4,7,6,0,7,4,0,3,7,0,5,1,0,4,5,3,2,6,3,6,7]);this.mappingIndicesSize=36;this.mappingType="v3";this.mappingSize=8;this.mappingItemSize=3;NGL.MappedBuffer.call(this,a)};NGL.BoxBuffer.prototype=Object.create(NGL.MappedBuffer.prototype);
NGL.BoxBuffer.prototype.constructor=NGL.BoxBuffer;NGL.AlignedBoxBuffer=function(a){this.mapping=new Float32Array([-1,1,-1,-1,-1,-1,1,1,-1,1,1,1,1,-1,-1,1,-1,1]);this.mappingIndices=new Uint32Array([0,1,2,1,4,2,2,4,3,4,5,3]);this.mappingIndicesSize=12;this.mappingType="v3";this.mappingSize=6;this.mappingItemSize=3;NGL.MappedBuffer.call(this,a)};NGL.AlignedBoxBuffer.prototype=Object.create(NGL.MappedBuffer.prototype);NGL.AlignedBoxBuffer.prototype.constructor=NGL.AlignedBoxBuffer;
NGL.SphereImpostorBuffer=function(a,b,c,d,e){this.count=a.length/3;this.vertexShader="SphereImpostor.vert";this.fragmentShader="SphereImpostor.frag";NGL.QuadBuffer.call(this,e);this.addUniforms({projectionMatrixInverse:{type:"m4",value:new THREE.Matrix4}});this.addAttributes({radius:{type:"f",value:null}});this.setAttributes({position:a,color:b,radius:c});d&&(this.addAttributes({pickingColor:{type:"c",value:null}}),this.setAttributes({pickingColor:d}),this.pickable=!0);this.makeMapping()};
NGL.SphereImpostorBuffer.prototype=Object.create(NGL.QuadBuffer.prototype);NGL.SphereImpostorBuffer.prototype.constructor=NGL.SphereImpostorBuffer;
NGL.CylinderImpostorBuffer=function(a,b,c,d,e,f,g,h){var k=h||k;this.shift=void 0!==k.shift?k.shift:0;this.cap=void 0!==k.cap?k.cap:!0;this.count=a.length/3;this.vertexShader="CylinderImpostor.vert";this.fragmentShader="CylinderImpostor.frag";NGL.AlignedBoxBuffer.call(this,k);this.addUniforms({modelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},shift:{type:"f",value:this.shift}});this.addAttributes({position1:{type:"v3",value:null},position2:{type:"v3",value:null},color2:{type:"c",value:null},
radius:{type:"f",value:null}});this.setAttributes({position:NGL.Utils.calculateCenterArray(a,b),position1:a,position2:b,color:c,color2:d,radius:e});f&&(this.addAttributes({pickingColor:{type:"c",value:null},pickingColor2:{type:"c",value:null}}),this.setAttributes({pickingColor:f,pickingColor2:g}),this.pickable=!0);this.makeMapping()};NGL.CylinderImpostorBuffer.prototype=Object.create(NGL.AlignedBoxBuffer.prototype);NGL.CylinderImpostorBuffer.prototype.constructor=NGL.CylinderImpostorBuffer;
NGL.CylinderImpostorBuffer.prototype.getMaterial=function(a){a=NGL.Buffer.prototype.getMaterial.call(this,a);this.cap&&(a.defines.CAP=1);return a};
NGL.HyperballStickImpostorBuffer=function(a,b,c,d,e,f,g,h,k){var l=k||l;k=void 0!==l.shrink?l.shrink:.14;this.count=a.length/3;this.vertexShader="HyperballStickImpostor.vert";this.fragmentShader="HyperballStickImpostor.frag";NGL.BoxBuffer.call(this,l);this.addUniforms({modelViewProjectionMatrix:{type:"m4",value:new THREE.Matrix4},modelViewProjectionMatrixInverse:{type:"m4",value:new THREE.Matrix4},modelViewMatrixInverseTranspose:{type:"m4",value:new THREE.Matrix4},shrink:{type:"f",value:k}});this.addAttributes({color:{type:"c",
value:null},color2:{type:"c",value:null},radius:{type:"f",value:null},radius2:{type:"f",value:null},position1:{type:"v3",value:null},position2:{type:"v3",value:null}});this.setAttributes({color:c,color2:d,radius:e,radius2:f,position1:a,position2:b,position:NGL.Utils.calculateCenterArray(a,b)});g&&(this.addAttributes({pickingColor:{type:"c",value:null},pickingColor2:{type:"c",value:null}}),this.setAttributes({pickingColor:g,pickingColor2:h}),this.pickable=!0);this.makeMapping()};
NGL.HyperballStickImpostorBuffer.prototype=Object.create(NGL.BoxBuffer.prototype);NGL.HyperballStickImpostorBuffer.prototype.constructor=NGL.HyperballStickImpostorBuffer;NGL.HyperballStickImpostorBuffer.prototype.parameters=Object.assign({shrink:{uniform:!0}},NGL.BoxBuffer.prototype.parameters);
NGL.GeometryBuffer=function(a,b,c,d){d=d||{};var e=this.geo,f=a.length/3,g=e.vertices.length,h=e.faces.length;this.size=f*g;this.positionCount=f;this.geoPosition=NGL.Utils.positionFromGeometry(e);this.geoNormal=NGL.Utils.normalFromGeometry(e);this.geoIndex=NGL.Utils.indexFromGeometry(e);this.transformedGeoPosition=new Float32Array(3*g);this.transformedGeoNormal=new Float32Array(3*g);this.meshPosition=new Float32Array(3*this.size);this.meshNormal=new Float32Array(3*this.size);this.meshIndex=new Uint32Array(f*
h*3);this.meshColor=new Float32Array(3*this.size);this.meshPickingColor=new Float32Array(3*this.size);this.makeIndex();NGL.MeshBuffer.call(this,this.meshPosition,this.meshColor,this.meshIndex,this.meshNormal,this.meshPickingColor,d);this.initNormals=!0;this.setAttributes({position:a,color:b,pickingColor:c});this.initNormals=!1};NGL.GeometryBuffer.prototype=Object.create(NGL.MeshBuffer.prototype);NGL.GeometryBuffer.prototype.constructor=NGL.GeometryBuffer;
NGL.GeometryBuffer.prototype.applyPositionTransform=function(){};
NGL.GeometryBuffer.prototype.setAttributes=function(){var a=new THREE.Matrix4,b=new THREE.Matrix3;return function(c){var d=this.geometry.attributes,e,f,g,h,k,l,m,p,r,n,q;c.position&&(e=c.position,h=this.geoPosition,p=this.meshPosition,l=this.transformedGeoPosition,d.position.needsUpdate=!0);c.color&&(f=c.color,r=this.meshColor,d.color.needsUpdate=!0);c.pickingColor&&(g=c.pickingColor,n=this.meshPickingColor,d.pickingColor.needsUpdate=!0);c=!(!this.updateNormals||!e);var t=!(!this.initNormals||!e);
if(c||t)k=this.geoNormal,q=this.meshNormal,m=this.transformedGeoNormal,d.normal.needsUpdate=!0;var d=this.positionCount,u=this.geo.vertices.length,s,v,y,x,B;for(s=0;s<d;++s){y=s*u*3;B=3*s;e&&(l.set(h),a.makeTranslation(e[B],e[B+1],e[B+2]),this.applyPositionTransform(a,s,B),a.applyToVector3Array(l),p.set(l,y));c?(m.set(k),b.getNormalMatrix(a),b.applyToVector3Array(m),q.set(m,y)):t&&q.set(k,y);if(f)for(v=0;v<u;++v)x=y+3*v,r[x]=f[B],r[x+1]=f[B+1],r[x+2]=f[B+2];if(g)for(v=0;v<u;++v)x=y+3*v,n[x]=g[B],
n[x+1]=g[B+1],n[x+2]=g[B+2]}}}();NGL.GeometryBuffer.prototype.makeIndex=function(){var a=this.geoIndex,b=this.meshIndex,c=this.positionCount,d=this.geo.vertices.length,e,f,g,h=3*this.geo.faces.length;for(f=0;f<c;++f)for(e=f*h,g=e+h,b.set(a,e);e<g;++e)b[e]+=f*d};NGL.SphereGeometryBuffer=function(a,b,c,d,e){this.geo=new THREE.IcosahedronGeometry(1,void 0!==e.sphereDetail?e.sphereDetail:1);this.setPositionTransform(c);NGL.GeometryBuffer.call(this,a,b,d,e)};NGL.SphereGeometryBuffer.prototype=Object.create(NGL.GeometryBuffer.prototype);
NGL.SphereGeometryBuffer.prototype.constructor=NGL.SphereGeometryBuffer;NGL.SphereGeometryBuffer.prototype.setPositionTransform=function(a){var b,c=new THREE.Vector3;this.applyPositionTransform=function(d,e){b=a[e];c.set(b,b,b);d.scale(c)}};NGL.SphereGeometryBuffer.prototype.setAttributes=function(a){a.radius&&this.setPositionTransform(a.radius);NGL.GeometryBuffer.prototype.setAttributes.call(this,a)};
NGL.CylinderGeometryBuffer=function(a,b,c,d,e,f,g,h){var k=void 0!==h.radiusSegments?h.radiusSegments:10;this.updateNormals=!0;var l=(new THREE.Matrix4).makeRotationX(Math.PI/2);this.geo=new THREE.CylinderGeometry(1,1,1,k,1,!0);this.geo.applyMatrix(l);k=a.length;l=e.length;this._position=new Float32Array(2*k);this._color=new Float32Array(2*k);this._pickingColor=new Float32Array(2*k);this._from=new Float32Array(2*k);this._to=new Float32Array(2*k);this._radius=new Float32Array(2*l);this.__center=new Float32Array(k);
NGL.GeometryBuffer.call(this,this._position,this._color,this._pickingColor,h);this.setPositionTransform(this._from,this._to,this._radius);this.setAttributes({position1:a,position2:b,color:c,color2:d,radius:e,pickingColor:f,pickingColor2:g})};NGL.CylinderGeometryBuffer.prototype=Object.create(NGL.GeometryBuffer.prototype);NGL.CylinderImpostorBuffer.prototype.constructor=NGL.CylinderImpostorBuffer;
NGL.CylinderGeometryBuffer.prototype.setPositionTransform=function(a,b,c){var d,e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3(0,1,0);this.applyPositionTransform=function(k,l,m){f.fromArray(a,m);g.fromArray(b,m);k.lookAt(f,g,h);d=c[l];e.set(d,d,f.distanceTo(g));k.scale(e)}};
NGL.CylinderGeometryBuffer.prototype.setAttributes=function(a){var b=this._position.length/2,c=this._radius.length/2,d={};a.position1&&a.position2&&(NGL.Utils.calculateCenterArray(a.position1,a.position2,this.__center),NGL.Utils.calculateCenterArray(a.position1,this.__center,this._position),NGL.Utils.calculateCenterArray(this.__center,a.position2,this._position,b),this._from.set(a.position1),this._from.set(this.__center,b),this._to.set(this.__center),this._to.set(a.position2,b),d.position=this._position);
a.color&&a.color2&&(this._color.set(a.color),this._color.set(a.color2,b),d.color=this._color);a.pickingColor&&a.pickingColor2&&(this._pickingColor.set(a.pickingColor),this._pickingColor.set(a.pickingColor2,b),d.pickingColor=this._pickingColor);a.radius&&(this._radius.set(a.radius),this._radius.set(a.radius,c));(a.position1&&a.position2||a.radius)&&this.setPositionTransform(this._from,this._to,this._radius);NGL.GeometryBuffer.prototype.setAttributes.call(this,d)};
NGL.PointBuffer=function(a,b,c){c=c||{};this.point=!0;this.pointSize=void 0!==c.pointSize?c.pointSize:1;this.sizeAttenuation=void 0!==c.sizeAttenuation?c.sizeAttenuation:!0;this.sort=void 0!==c.sort?c.sort:!1;this.attributeSize=this.size=a.length/3;this.tex=new THREE.Texture(NGL.Resources["../img/radial.png"]);this.tex.needsUpdate=!0;this.sort||(this.tex.premultiplyAlpha=!0);NGL.Buffer.call(this,a,b,void 0,void 0,c)};NGL.PointBuffer.prototype=Object.create(NGL.Buffer.prototype);
NGL.PointBuffer.prototype.constructor=NGL.PointBuffer;NGL.PointBuffer.prototype.parameters=Object.assign({pointSize:{property:"size"},sizeAttenuation:{property:!0},sort:{}},NGL.Buffer.prototype.parameters,{opacity:{property:!0}});
NGL.PointBuffer.prototype.makeMaterial=function(){var a;this.pickingMaterial=this.wireframeMaterial=this.material=a=this.sort?new THREE.PointCloudMaterial({map:this.tex,blending:THREE.NormalBlending,depthTest:!0,transparent:!0,vertexColors:!0,size:this.pointSize,sizeAttenuation:this.sizeAttenuation,opacity:this.opacity,fog:!0}):new THREE.PointCloudMaterial({map:this.tex,depthTest:!1,transparent:!0,blending:THREE.CustomBlending,blendEquation:THREE.AddEquation,blendSrc:THREE.OneFactor,blendDst:THREE.OneMinusSrcAlphaFactor,
vertexColors:!0,size:this.pointSize,sizeAttenuation:this.sizeAttenuation,opacity:this.opacity,fog:!0})};NGL.PointBuffer.prototype.dispose=function(){NGL.Buffer.prototype.dispose.call(this);this.tex.dispose()};
NGL.LineBuffer=function(a,b,c,d,e){e=e||{};this.size=a.length/3;this.vertexShader="Line.vert";this.fragmentShader="Line.frag";this.line=!0;var f=4*this.size;this.attributeSize=f;this.linePosition=new Float32Array(3*f);this.lineColor=new Float32Array(3*f);NGL.Buffer.call(this,this.linePosition,this.lineColor,void 0,void 0,e);this.setAttributes({from:a,to:b,color:c,color2:d})};NGL.LineBuffer.prototype=Object.create(NGL.Buffer.prototype);NGL.LineBuffer.prototype.constructor=NGL.LineBuffer;
NGL.LineBuffer.prototype.setAttributes=function(a){var b,c,d,e,f,g,h=this.geometry.attributes;a.from&&a.to&&(b=a.from,c=a.to,f=h.position.array,h.position.needsUpdate=!0);a.color&&a.color2&&(d=a.color,e=a.color2,g=h.color.array,h.color.needsUpdate=!0);a=this.size;for(var h=6*a,k,l,m,p,r,n,q,t,u,s,v,y,x=0;x<a;x++)l=3*x,k=6*x,m=k+h,b&&c&&(q=b[l],t=b[l+1],u=b[l+2],s=c[l],v=c[l+1],y=c[l+2],p=(q+s)/2,r=(t+v)/2,n=(u+y)/2,f[k]=q,f[k+1]=t,f[k+2]=u,f[k+3]=p,f[k+4]=r,f[k+5]=n,f[m]=p,f[m+1]=r,f[m+2]=n,f[m+3]=
s,f[m+4]=v,f[m+5]=y),d&&e&&(g[k]=g[k+3]=d[l],g[k+1]=g[k+4]=d[l+1],g[k+2]=g[k+5]=d[l+2],g[m]=g[m+3]=e[l],g[m+1]=g[m+4]=e[l+1],g[m+2]=g[m+5]=e[l+2])};
NGL.TraceBuffer=function(a,b,c){c=c||{};this.size=a.length/3;this.vertexShader="Line.vert";this.fragmentShader="Line.frag";this.line=!0;var d=this.size-1;this.attributeSize=2*d;this.linePosition=new Float32Array(6*d);this.lineColor=new Float32Array(6*d);NGL.Buffer.call(this,this.linePosition,this.lineColor,void 0,void 0,c);this.setAttributes({position:a,color:b})};NGL.TraceBuffer.prototype=Object.create(NGL.Buffer.prototype);NGL.TraceBuffer.prototype.constructor=NGL.TraceBuffer;
NGL.TraceBuffer.prototype.setAttributes=function(a){var b,c,d,e,f=this.geometry.attributes;a.position&&(b=a.position,d=f.position.array,f.position.needsUpdate=!0);a.color&&(c=a.color,e=f.color.array,f.color.needsUpdate=!0);if(b||c)for(var g=this.size-1,h=0;h<g;++h)a=3*h,f=6*h,b&&(d[f]=b[a],d[f+1]=b[a+1],d[f+2]=b[a+2],d[f+3]=b[a+3],d[f+4]=b[a+4],d[f+5]=b[a+5]),c&&(e[f]=c[a],e[f+1]=c[a+1],e[f+2]=c[a+2],e[f+3]=c[a+3],e[f+4]=c[a+4],e[f+5]=c[a+5]);else NGL.warn("NGL.TraceBuffer.prototype.setAttributes no data")};
NGL.ParticleSpriteBuffer=function(a,b,c){this.count=a.length/3;this.vertexShader="ParticleSprite.vert";this.fragmentShader="ParticleSprite.frag";NGL.QuadBuffer.call(this);this.addUniforms({projectionMatrixInverse:{type:"m4",value:new THREE.Matrix4}});this.addAttributes({radius:{type:"f",value:null}});this.setAttributes({position:a,color:b,radius:c});this.material.lights=!1};NGL.ParticleSpriteBuffer.prototype=Object.create(NGL.QuadBuffer.prototype);NGL.ParticleSpriteBuffer.prototype.constructor=NGL.ParticleSpriteBuffer;
NGL.RibbonBuffer=function(a,b,c,d,e,f,g){g=g||{};var h=4*(a.length/3-1),k=3*h;this.meshPosition=new Float32Array(k);this.meshColor=new Float32Array(k);this.meshNormal=new Float32Array(k);this.meshPickingColor=f?new Float32Array(k):void 0;this.meshIndex=new Uint32Array(k);this.makeIndex();NGL.MeshBuffer.call(this,this.meshPosition,this.meshColor,this.meshIndex,this.meshNormal,this.meshPickingColor,g);this.vertexShader="Ribbon.vert";this.fragmentShader="Ribbon.frag";this.geometry.addAttribute("dir",
new THREE.BufferAttribute(new Float32Array(k),3));this.geometry.addAttribute("size",new THREE.BufferAttribute(new Float32Array(h),1));this.setAttributes({position:a,normal:b,dir:c,color:d,size:e,pickingColor:f})};NGL.RibbonBuffer.prototype=Object.create(NGL.MeshBuffer.prototype);NGL.RibbonBuffer.prototype.constructor=NGL.RibbonBuffer;
NGL.RibbonBuffer.prototype.setAttributes=function(a){var b=this.size/4,c=this.geometry.attributes,d,e,f,g,h,k,l,m,p,r,n,q;a.position&&(d=a.position,l=c.position.array,c.position.needsUpdate=!0);a.normal&&(e=a.normal,m=c.normal.array,c.normal.needsUpdate=!0);a.size&&(f=a.size,p=c.size.array,c.size.needsUpdate=!0);a.dir&&(g=a.dir,r=c.dir.array,c.dir.needsUpdate=!0);a.color&&(h=a.color,n=c.color.array,c.color.needsUpdate=!0);a.pickingColor&&(k=a.pickingColor,q=c.pickingColor.array,c.pickingColor.needsUpdate=
!0);var t,u,s,v,y=f?f[0]:null;for(a=0;a<b;++a){v=3*a;c=12*a;s=4*a;d&&(l[c]=l[c+3]=d[v],l[c+1]=l[c+4]=d[v+1],l[c+2]=l[c+5]=d[v+2],l[c+6]=l[c+9]=d[v+3],l[c+7]=l[c+10]=d[v+4],l[c+8]=l[c+11]=d[v+5]);e&&(m[c]=m[c+3]=-e[v],m[c+1]=m[c+4]=-e[v+1],m[c+2]=m[c+5]=-e[v+2],m[c+6]=m[c+9]=-e[v+3],m[c+7]=m[c+10]=-e[v+4],m[c+8]=m[c+11]=-e[v+5]);for(t=0;4>t;++t)u=c+3*t,h&&(n[u]=h[v],n[u+1]=h[v+1],n[u+2]=h[v+2]),k&&(q[u]=k[v],q[u+1]=k[v+1],q[u+2]=k[v+2]);f&&(t=f[a],y!==f[a]?(p[s]=y,p[s+1]=y):(p[s]=t,p[s+1]=t),p[s+2]=
t,y=p[s+3]=t);g&&(r[c]=g[v],r[c+1]=g[v+1],r[c+2]=g[v+2],r[c+3]=-g[v],r[c+4]=-g[v+1],r[c+5]=-g[v+2],r[c+6]=g[v+3],r[c+7]=g[v+4],r[c+8]=g[v+5],r[c+9]=-g[v+3],r[c+10]=-g[v+4],r[c+11]=-g[v+5])}};NGL.RibbonBuffer.prototype.makeIndex=function(){var a=this.meshIndex,b=a.length/4/3,c=new Uint32Array([0,1,2,1,3,2]),d,e,f,g;for(e=0;e<b;++e)for(f=6*e,g=4*e,a.set(c,f),d=0;6>d;++d)a[f+d]+=g};
NGL.TubeMeshBuffer=function(a,b,c,d,e,f,g,h){h=h||{};this.rx=void 0!==h.rx?h.rx:1.5;this.ry=void 0!==h.ry?h.ry:.5;this.radialSegments=void 0!==h.radialSegments?h.radialSegments:4;this.capVertices=(this.capped=void 0!==h.capped?h.capped:!1)?this.radialSegments:0;this.capTriangles=this.capped?this.radialSegments-2:0;var k=a.length/3,l=k-1,m=k*this.radialSegments*3+6*this.capVertices;this.size2=k;this.meshPosition=new Float32Array(m);this.meshColor=new Float32Array(m);this.meshNormal=new Float32Array(m);
this.meshPickingColor=g?new Float32Array(m):void 0;this.meshIndex=new Uint32Array(2*l*this.radialSegments*3+6*this.capTriangles);this.makeIndex();NGL.MeshBuffer.call(this,this.meshPosition,this.meshColor,this.meshIndex,this.meshNormal,this.meshPickingColor,h);this.setAttributes({position:a,normal:b,binormal:c,tangent:d,color:e,size:f,pickingColor:g})};NGL.TubeMeshBuffer.prototype=Object.create(NGL.MeshBuffer.prototype);NGL.TubeMeshBuffer.prototype.constructor=NGL.TubeMeshBuffer;
NGL.TubeMeshBuffer.prototype.setAttributes=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){var d=this.rx,e=this.ry,f=this.size2,g=f-1,h=this.radialSegments,k=this.geometry.attributes,l,m,p,r,n,q,t,u,s,v,y;c.position&&(l=c.position,m=c.normal,p=c.binormal,r=c.tangent,q=c.size,u=k.position.array,v=k.normal.array,k.position.needsUpdate=!0,k.normal.needsUpdate=!0);c.color&&(n=c.color,s=k.color.array,k.color.needsUpdate=!0);c.pickingColor&&(t=c.pickingColor,y=k.pickingColor.array,
k.pickingColor.needsUpdate=!0);var x,B,G,F,w,z,C,L,O,W,K,P,da,A,X,D,R,H,k=[],xa=[],M=[],U=[],S=[],ga=[];if(l)for(c=0;c<h;++c)B=c/h*2*Math.PI,k[c]=d*Math.cos(B),xa[c]=e*Math.sin(B),M[c]=d*Math.cos(B-.01),U[c]=e*Math.sin(B-.01),S[c]=d*Math.cos(B+.01),ga[c]=e*Math.sin(B+.01);for(x=0;x<f;++x)for(d=3*x,e=d*h,l&&(a.set(r[d],r[d+1],r[d+2]),W=m[d],K=m[d+1],P=m[d+2],da=p[d],A=p[d+1],X=p[d+2],D=l[d],R=l[d+1],H=l[d+2],O=q[x]),c=0;c<h;++c)B=e+3*c,l&&(G=-O*k[c],F=O*xa[c],w=-O*M[c],z=O*U[c],C=-O*S[c],L=O*ga[c],
u[B]=D+G*W+F*da,u[B+1]=R+G*K+F*A,u[B+2]=H+G*P+F*X,b.set(C*W+L*da-(w*W+z*da),C*K+L*A-(w*K+z*A),C*P+L*X-(w*P+z*X)).cross(a),v[B]=b.x,v[B+1]=b.y,v[B+2]=b.z),n&&(s[B]=n[d],s[B+1]=n[d+1],s[B+2]=n[d+2]),t&&(y[B]=t[d],y[B+1]=t[d+1],y[B+2]=t[d+2]);d=0;e=3*f*h;for(c=0;c<h;++c)B=d+3*c,m=e+3*c,l&&(u[m]=u[B],u[m+1]=u[B+1],u[m+2]=u[B+2],v[m]=r[d],v[m+1]=r[d+1],v[m+2]=r[d+2]),n&&(s[m]=s[B],s[m+1]=s[B+1],s[m+2]=s[B+2]),t&&(y[m]=y[B],y[m+1]=y[B+1],y[m+2]=y[B+2]);d=3*(f-1)*h;e=3*(f+1)*h;for(c=0;c<h;++c)B=d+3*c,m=
e+3*c,l&&(u[m]=u[B],u[m+1]=u[B+1],u[m+2]=u[B+2],v[m]=r[3*g],v[m+1]=r[3*g+1],v[m+2]=r[3*g+2]),n&&(s[m]=s[B],s[m+1]=s[B+1],s[m+2]=s[B+2]),t&&(y[m]=y[B],y[m+1]=y[B+1],y[m+2]=y[B+2])}}();
NGL.TubeMeshBuffer.prototype.makeIndex=function(){var a=this.meshIndex,b=this.size2,c=b-1,d=this.capTriangles,e=this.radialSegments,f=this.radialSegments+1,g,h,k,l,m,p;for(g=0;g<c;++g)for(h=g*e*6,k=g*e,l=(g+1)*e,p=0;p<e;++p)m=h+6*p,a[m]=k+p,a[m+1]=k+(p+1)%e,a[m+2]=l+p,a[m+3]=l+p,a[m+4]=k+(p+1)%e,a[m+5]=l+(p+1)%e;g=[0];for(p=1;p<f/2;++p)g.push(p),e-p!==p&&g.push(e-p);m=c*e*6;h=b*e;for(p=0;p<g.length-2;++p)0===p%2?(a[m+3*p+0]=h+g[p+0],a[m+3*p+1]=h+g[p+1],a[m+3*p+2]=h+g[p+2]):(a[m+3*p+0]=h+g[p+2],a[m+
3*p+1]=h+g[p+1],a[m+3*p+2]=h+g[p+0]);m=c*e*6+3*d;h=b*e+e;for(p=0;p<g.length-2;++p)0===p%2?(a[m+3*p+0]=h+g[p+0],a[m+3*p+1]=h+g[p+1],a[m+3*p+2]=h+g[p+2]):(a[m+3*p+0]=h+g[p+2],a[m+3*p+1]=h+g[p+1],a[m+3*p+2]=h+g[p+0])};NGL.SurfaceBuffer=function(){NGL.MeshBuffer.apply(this,arguments)};NGL.SurfaceBuffer.prototype=Object.create(NGL.MeshBuffer.prototype);NGL.SurfaceBuffer.prototype.constructor=NGL.SurfaceBuffer;
NGL.SphereBuffer=function(a,b,c,d,e,f){return!NGL.extensionFragDepth||f?new NGL.SphereGeometryBuffer(a,b,c,d,e):new NGL.SphereImpostorBuffer(a,b,c,d,e)};NGL.CylinderBuffer=function(a,b,c,d,e,f,g,h,k){return!NGL.extensionFragDepth||k?new NGL.CylinderGeometryBuffer(a,b,c,d,e,f,g,h):new NGL.CylinderImpostorBuffer(a,b,c,d,e,f,g,h)};
NGL.HyperballStickBuffer=function(a,b,c,d,e,f,g,h,k,l){return!NGL.extensionFragDepth||l?new NGL.CylinderGeometryBuffer(a,b,c,d,NGL.Utils.calculateMinArray(e,f),g,h,k):new NGL.HyperballStickImpostorBuffer(a,b,c,d,e,f,g,h,k)};
NGL.getFont=function(a){var b={},c,d,e,f;NGL.Resources["fonts/"+a+".fnt"].split("\n").forEach(function(a){if("char "===a.substr(0,5)){var h={};a.substr(5).split(/\s+/).forEach(function(a){a=a.split("=");h[a[0]]=parseInt(a[1])});a=h.x;var k=h.y,l=h.width,m=h.height;h.textureCoords=new Float32Array([a/d,1-k/e,a/d,1-(k+m)/e,(a+l)/d,1-k/e,(a+l)/d,1-(k+m)/e]);h.width2=10*l/d;h.height2=10*m/e;h.xadvance2=10*h.xadvance/d;h.xoffset2=10*h.xoffset/d;h.yoffset2=10*h.yoffset/e;h.lineHeight=10*f/e;b[h.id]=h}else"common "===
a.substr(0,7)&&(c=a.match(/scaleW=([0-9]+)/),null!==c&&(d=c[1]),c=a.match(/scaleH=([0-9]+)/),null!==c&&(e=c[1]),c=a.match(/base=([0-9]+)/),c=a.match(/lineHeight=([0-9]+)/),null!==c&&(f=c[1]))});return b};
NGL.TextBuffer=function(a,b,c,d,e){e=e||{};var f=void 0!==e.font?e.font:"LatoBlack";this.font=NGL.getFont(f);this.tex=new THREE.Texture(NGL.Resources["fonts/"+f+".png"]);this.tex.needsUpdate=!0;for(var f=a.length/3,g=0,h=0;h<f;++h)g+=d[h].length;this.text=d;this.count=g;this.positionCount=f;this.vertexShader="SDFFont.vert";this.fragmentShader="SDFFont.frag";NGL.QuadBuffer.call(this,e);this.addUniforms({fontTexture:{type:"t",value:this.tex}});this.addAttributes({inputTexCoord:{type:"v2",value:null},
inputSize:{type:"f",value:null}});this.setAttributes({position:a,size:b,color:c});this.makeMapping()};NGL.TextBuffer.prototype=Object.create(NGL.QuadBuffer.prototype);NGL.TextBuffer.prototype.constructor=NGL.TextBuffer;NGL.TextBuffer.prototype.makeMaterial=function(){NGL.Buffer.prototype.makeMaterial.call(this);this.material.lights=!1;this.material.transparent=!0;this.material.uniforms.fontTexture.value=this.tex;this.material.needsUpdate=!0};
NGL.TextBuffer.prototype.setAttributes=function(a){var b,c,d,e,f,g,h=this.text,k=this.geometry.attributes;a.position&&(b=a.position,e=k.position.array,k.position.needsUpdate=!0);a.size&&(c=a.size,f=k.inputSize.array,k.inputSize.needsUpdate=!0);a.color&&(d=a.color,g=k.color.array,k.color.needsUpdate=!0);a=this.positionCount;for(var l,m=0,p,r,n=0;n<a;n++)for(k=3*n,l=h[n],r=l.length,p=0;p<r;p++,m++)for(var q=0;4>q;q++)l=12*m+3*q,b&&(e[l]=b[k],e[l+1]=b[k+1],e[l+2]=b[k+2]),c&&(f[4*m+q]=c[n]),d&&(g[l]=
d[k],g[l+1]=d[k+1],g[l+2]=d[k+2])};NGL.TextBuffer.prototype.setProperties=function(a){a&&void 0!==a.transparent&&(a.transparent=!0);NGL.QuadBuffer.prototype.setProperties.call(this,a)};
NGL.TextBuffer.prototype.makeMapping=function(){for(var a=this.font,b=this.text,c=this.geometry.attributes.inputTexCoord.array,d=this.geometry.attributes.mapping.array,e=this.positionCount,f,g,h=0,k,l,m,p,r=0;r<e;r++)for(k=b[r],l=0,p=k.length,m=0;m<p;m++,h++)f=a[k.charCodeAt(m)],g=8*h,d[g+0]=l+f.xoffset2,d[g+1]=f.lineHeight-f.yoffset2,d[g+2]=l+f.xoffset2,d[g+3]=f.lineHeight-f.yoffset2-f.height2,d[g+4]=l+f.xoffset2+f.width2,d[g+5]=f.lineHeight-f.yoffset2,d[g+6]=l+f.xoffset2+f.width2,d[g+7]=f.lineHeight-
f.yoffset2-f.height2,c.set(f.textureCoords,g),l+=f.xadvance2};NGL.TextBuffer.prototype.dispose=function(){NGL.Buffer.prototype.dispose.call(this);this.tex.dispose()};
NGL.VectorBuffer=function(a,b,c){c=c||{};this.size=a.length/3;this.vertexShader="Line.vert";this.fragmentShader="Line.frag";this.line=!0;var d=2*this.size;this.attributeSize=d;this.scale=c.scale||1;var e=new THREE.Color(c.color||"grey");this.linePosition=new Float32Array(3*d);this.lineColor=NGL.Utils.uniformArray3(d,e.r,e.g,e.b);NGL.Buffer.call(this,this.linePosition,this.lineColor,void 0,void 0,c);this.setAttributes({position:a,vector:b})};NGL.VectorBuffer.prototype=Object.create(NGL.Buffer.prototype);
NGL.VectorBuffer.prototype.constructor=NGL.VectorBuffer;NGL.VectorBuffer.prototype.setAttributes=function(a){var b=this.geometry.attributes,c,d,e;a.position&&a.vector&&(c=a.position,d=a.vector,e=b.position.array,b.position.needsUpdate=!0);var b=this.size,f=this.scale,g;if(a.position&&a.vector)for(var h=0;h<b;h++)a=6*h,g=3*h,e[a+0]=c[g+0],e[a+1]=c[g+1],e[a+2]=c[g+2],e[a+3]=c[g+0]+d[g+0]*f,e[a+4]=c[g+1]+d[g+1]*f,e[a+5]=c[g+2]+d[g+2]*f};NGL.SideTypes={};NGL.SideTypes[THREE.FrontSide]="front";
NGL.SideTypes[THREE.BackSide]="back";NGL.SideTypes[THREE.DoubleSide]="double";
NGL.makeRepresentation=function(a,b,c,d){NGL.time("NGL.makeRepresentation "+a);var e;if("buffer"===a)e=NGL.BufferRepresentation;else if(b instanceof NGL.Structure){if(e=NGL.representationTypes[a],!e){NGL.error("NGL.makeRepresentation: representation type "+a+" unknown");return}}else if(b instanceof NGL.Surface||b instanceof NGL.Volume)if("surface"===a)e=NGL.SurfaceRepresentation;else if("dot"===a)e=NGL.DotRepresentation;else{NGL.error("NGL.makeRepresentation: representation type "+a+" unknown");return}else if(b instanceof
NGL.Trajectory)e=NGL.TrajectoryRepresentation;else{NGL.error("NGL.makeRepresentation: object "+b+" unknown");return}b=new e(b,c,d);NGL.timeEnd("NGL.makeRepresentation "+a);return b};NGL.Representation=function(a,b,c){this.viewer=b;this.queue=async.queue(this.make.bind(this),1);this.tasks=new NGL.Counter;this.bufferList=[];this.init(c)};
NGL.Representation.prototype={constructor:NGL.Representation,type:"",parameters:{nearClip:{type:"boolean",buffer:!0},flatShaded:{type:"boolean",buffer:!0},opacity:{type:"number",precision:1,max:1,min:0,buffer:!0},side:{type:"select",options:NGL.SideTypes,buffer:!0,int:!0},wireframe:{type:"boolean",buffer:!0},linewidth:{type:"integer",max:50,min:1,buffer:!0},colorScheme:{type:"select",update:"color",options:NGL.ColorMakerRegistry.getTypes()},colorScale:{type:"select",update:"color",options:NGL.ColorMakerRegistry.getScales()},
colorValue:{type:"color",update:"color"},colorDomain:{type:"hidden",update:"color"},colorMode:{type:"select",update:"color",options:NGL.ColorMakerRegistry.getModes()}},init:function(a){a=a||{};this.nearClip=void 0!==a.nearClip?a.nearClip:!0;this.flatShaded=a.flatShaded||!1;this.side=void 0!==a.side?a.side:THREE.DoubleSide;this.opacity=void 0!==a.opacity?a.opacity:1;this.wireframe=a.wireframe||!1;this.linewidth=a.linewidth||1;this.setColor(a.color,a);this.colorScheme=a.colorScheme||"uniform";this.colorScale=
a.colorScale||"";this.colorValue=a.colorValue||9474192;this.colorDomain=a.colorDomain||"";this.colorMode=a.colorMode||"hcl";this.visible=void 0!==a.visible?a.visible:!0;this.quality=a.quality},getColorParams:function(){return{scheme:this.colorScheme,scale:this.colorScale,value:this.colorValue,domain:this.colorDomain,mode:this.colorMode}},getBufferParams:function(a){return Object.assign({nearClip:this.nearClip,flatShaded:this.flatShaded,opacity:this.opacity,side:this.side,wireframe:this.wireframe,
linewidth:this.linewidth},a)},setColor:function(a,b){-1!==Object.keys(NGL.ColorMakerRegistry.getTypes()).indexOf(a)?b?b.colorScheme=a:this.setParameters({colorScheme:a}):void 0!==a&&(a=(new THREE.Color(a)).getHex(),b?(b.colorScheme="uniform",b.colorValue=a):this.setParameters({colorScheme:"uniform",colorValue:a}));return this},prepare:function(a){a()},create:function(){},update:function(){this.build()},build:function(a){0<this.queue.length()?(this.tasks.change(1-this.queue.length()),this.queue.kill()):
this.tasks.increment();a||(a=this.getParameters(),delete a.quality);this.queue.push(a)},make:function(a,b){NGL.time("NGL.Representation.make "+this.type);a&&!a.__update&&this.init(a);this.prepare(function(){a.__update?(this.update(a.__update),this.viewer.requestRender(),this.tasks.decrement(),b()):(this.clear(),this.create(),this.manualAttach||this.disposed||(NGL.time("NGL.Representation.attach "+this.type),this.attach(function(){NGL.timeEnd("NGL.Representation.attach "+this.type);this.tasks.decrement();
b()}.bind(this))));NGL.timeEnd("NGL.Representation.make "+this.type)}.bind(this))},attach:function(a){this.setVisibility(this.visible);a()},setVisibility:function(a){this.visible=a;this.bufferList.forEach(function(b){b.setVisibility(a)});this.viewer.requestRender();return this},setParameters:function(a,b,c){a=a||{};var d=this.parameters;b=b||{};c=c||!1;var e={},f;for(f in a)void 0!==a[f]&&void 0!==d[f]&&(d[f].int&&(a[f]=parseInt(a[f])),d[f].float&&(a[f]=parseFloat(a[f])),a[f]!==this[f]&&(this[f]=
a[f],d[f].buffer&&(!0===d[f].buffer?e[f]=a[f]:e[d[f].buffer]=a[f]),d[f].update&&(b[d[f].update]=!0),!d[f].rebuild||"impostor"===d[f].rebuild&&NGL.extensionFragDepth&&!this.disableImpostor||(c=!0)));c?this.build():(this.bufferList.forEach(function(a){a.setParameters(e)}),Object.keys(b).length&&this.update(b),this.viewer.requestRender());return this},getParameters:function(){var a={visible:this.visible,sele:this.selection?this.selection.string:void 0,disableImpostor:this.disableImpostor,quality:this.quality};
Object.keys(this.parameters).forEach(function(b){a[b]=this[b]},this);return a},clear:function(){this.bufferList.forEach(function(a){this.viewer.remove(a);a.dispose()},this);this.bufferList.length=0;this.viewer.requestRender()},dispose:function(){this.disposed=!0;this.queue.kill();this.tasks.dispose();this.clear()}};NGL.BufferRepresentation=function(a,b,c){NGL.Representation.call(this,a,b,c);this.buffer=a;this.build()};
NGL.BufferRepresentation.prototype=NGL.createObject(NGL.Representation.prototype,{constructor:NGL.BufferRepresentation,type:"buffer",parameters:Object.assign({},NGL.Representation.prototype.parameters,{colorScheme:null,colorScale:null,colorValue:null,colorDomain:null,colorMode:null}),create:function(){this.bufferList.push(this.buffer)},attach:function(a){this.bufferList.forEach(function(a){this.viewer.add(a)},this);this.setVisibility(this.visible);a()}});
NGL.StructureRepresentation=function(a,b,c){this.fiberList=[];this.selection=new NGL.Selection(c.sele,this.getAssemblySele(c.assembly,a));this.atomSet=new NGL.AtomSet;this.setStructure(a);NGL.Representation.call(this,a,b,c);if(a.biomolDict){var d={__AU:"AU"};Object.keys(a.biomolDict).forEach(function(a){d[a]=a});d[""]="";this.parameters.assembly={type:"select",options:d,rebuild:!0}}else this.parameters.assembly=null;this.selection.signals.stringChanged.add(function(){this.build()}.bind(this));this.build()};
NGL.StructureRepresentation.prototype=NGL.createObject(NGL.Representation.prototype,{constructor:NGL.StructureRepresentation,type:"structure",parameters:Object.assign({radiusType:{type:"select",options:NGL.RadiusFactory.types},radius:{type:"number",precision:3,max:10,min:.001},scale:{type:"number",precision:3,max:10,min:.001},assembly:null},NGL.Representation.prototype.parameters),defaultScale:{vdw:1,covalent:1,bfactor:.01,ss:1},defaultSize:1,init:function(a){a=a||{};a.colorScheme=a.colorScheme||
"element";this.radius=a.radius||"vdw";this.scale=a.scale||1;this.assembly=a.assembly||"";var b=this.selection.combinedString;this.setSelection(a.sele,this.getAssemblySele(a.assembly),!0);b!==this.selection.combinedString&&this.atomSet.applySelection();NGL.Representation.prototype.init.call(this,a)},setStructure:function(a){this.structure=a||this.structure;this.atomSet.fromStructure(this.structure,this.selection);return this},getAssemblySele:function(a,b){b=b||this.structure;a=a||b.defaultAssembly;
var c=b.biomolDict[a],d="";c&&c.chainList&&c.chainList.length<b.chainCount&&(d=":"+c.chainList.join(" OR :"));return d},getColorParams:function(){var a=NGL.Representation.prototype.getColorParams.call(this);a.structure=this.structure;a.atomSet=this.atomSet;return a},setSelection:function(a,b,c){this.selection.setString(a,b,c);return this},setParameters:function(a,b,c){b=b||{};a&&void 0!==a.radiusType&&(this.radius="size"===a.radiusType?this.defaultSize:a.radiusType,b.radius=!0,!NGL.extensionFragDepth||
this.disableImpostor)&&(c=!0);a&&void 0!==a.radius&&(b.radius=!0,!NGL.extensionFragDepth||this.disableImpostor)&&(c=!0);a&&void 0!==a.scale&&(b.scale=!0,!NGL.extensionFragDepth||this.disableImpostor)&&(c=!0);a&&void 0!==a.assembly&&this.setSelection(void 0,this.getAssemblySele(a.assembly));NGL.Representation.prototype.setParameters.call(this,a,b,c);return this},attach:function(a){var b=this.viewer,c=this.structure,d=this.assembly;""===d&&(d=c.defaultAssembly);var e=[];if(c.biomolDict&&c.biomolDict[d]){var f=
c.biomolDict[d].matrixDict;Object.keys(f).forEach(function(a,b){e.push({id:b+1,name:a,assembly:d,matrix:f[a]})})}this.bufferList.forEach(function(c,d,f){requestAnimationFrame(function(){1<=e.length?b.add(c,e):b.add(c);d===f.length-1&&a()})});this.setVisibility(this.visible);0===this.bufferList.length&&a()},clear:function(){this.fiberList.length=0;NGL.Representation.prototype.clear.call(this)},dispose:function(){this.atomSet.dispose();delete this.structure;NGL.Representation.prototype.dispose.call(this)}});
NGL.SpacefillRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.SpacefillRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.SpacefillRepresentation,type:"spacefill",parameters:Object.assign({sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};this.disableImpostor=a.disableImpostor||!1;this.sphereDetail="low"===a.quality?0:"medium"===a.quality?1:"high"===a.quality?2:void 0!==a.sphereDetail?a.sphereDetail:1;NGL.StructureRepresentation.prototype.init.call(this,
a)},create:function(){0!==this.atomSet.atomCount&&(this.sphereBuffer=new NGL.SphereBuffer(this.atomSet.atomPosition(),this.atomSet.atomColor(null,this.getColorParams()),this.atomSet.atomRadius(null,this.radius,this.scale),this.atomSet.atomPickingColor(),this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0}),this.disableImpostor),this.bufferList.push(this.sphereBuffer))},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b={};a.position&&(b.position=
this.atomSet.atomPosition());a.color&&(b.color=this.atomSet.atomColor(null,this.getColorParams()));if(a.radius||a.scale)b.radius=this.atomSet.atomRadius(null,this.radius,this.scale);this.sphereBuffer.setAttributes(b)}}});NGL.PointRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.PointRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.PointRepresentation,type:"point",parameters:Object.assign({pointSize:{type:"integer",max:20,min:1,buffer:!0},sizeAttenuation:{type:"boolean",buffer:!0},sort:{type:"boolean",rebuild:!0}},NGL.Representation.prototype.parameters,{nearClip:null,flatShaded:null,wireframe:null,linewidth:null}),init:function(a){a=a||{};this.pointSize=a.pointSize||1;this.sizeAttenuation=void 0!==a.sizeAttenuation?a.sizeAttenuation:
!0;this.sort=void 0!==a.sort?a.sort:!1;a.opacity=void 0!==a.opacity?a.opacity:.6;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){0!==this.atomSet.atomCount&&(this.pointBuffer=new NGL.PointBuffer(this.atomSet.atomPosition(),this.atomSet.atomColor(null,this.getColorParams()),this.getBufferParams({pointSize:this.pointSize,sizeAttenuation:this.sizeAttenuation,sort:this.sort})),this.bufferList.push(this.pointBuffer))},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=
a||{};var b={};a.position&&(b.position=this.atomSet.atomPosition());a.color&&(b.color=this.atomSet.atomColor(null,this.colorScheme,this.getColorParams()));this.pointBuffer.setAttributes(b)}}});NGL.LabelRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.LabelRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.LabelRepresentation,type:"label",parameters:Object.assign({labelType:{type:"select",options:NGL.LabelFactory.types,rebuild:!0},font:{type:"select",options:{LatoBlack:"LatoBlack"},rebuild:!0}},NGL.StructureRepresentation.prototype.parameters,{side:null,flatShaded:null}),init:function(a){a=a||{};this.labelType=a.labelType||"res";this.labelText=a.labelText||{};this.font=a.font||"LatoBlack";NGL.StructureRepresentation.prototype.init.call(this,
a)},create:function(){if(0!==this.atomSet.atomCount){var a=[],b=new NGL.LabelFactory(this.labelType,this.labelText);this.atomSet.eachAtom(function(c){a.push(b.atomLabel(c))});this.textBuffer=new NGL.TextBuffer(this.atomSet.atomPosition(),this.atomSet.atomRadius(null,this.radius,this.scale),this.atomSet.atomColor(null,this.getColorParams()),a,this.getBufferParams({font:this.font}));this.bufferList.push(this.textBuffer)}},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=
a||{};var b={};a.position&&(b.position=this.atomSet.atomPosition());if(a.radius||a.scale)b.size=this.atomSet.atomRadius(null,this.radius,this.scale);a.color&&(b.color=this.atomSet.atomColor(null,this.getColorParams()));this.textBuffer.setAttributes(b)}}});NGL.BallAndStickRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.BallAndStickRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.BallAndStickRepresentation,type:"ball+stick",defaultSize:.15,parameters:Object.assign({aspectRatio:{type:"number",precision:1,max:10,min:1},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.radius=a.radius||this.defaultSize;this.disableImpostor=
a.disableImpostor||!1;"low"===a.quality?(this.sphereDetail=0,this.radiusSegments=5):"medium"===a.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===a.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==a.sphereDetail?a.sphereDetail:1,this.radiusSegments=void 0!==a.radiusSegments?a.radiusSegments:10);this.aspectRatio=a.aspectRatio||2;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this.scale*this.aspectRatio;
this.sphereBuffer=new NGL.SphereBuffer(this.atomSet.atomPosition(),this.atomSet.atomColor(null,this.getColorParams()),this.atomSet.atomRadius(null,this.radius,a),this.atomSet.atomPickingColor(null),this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0}),this.disableImpostor);this.__center=new Float32Array(3*this.atomSet.bondCount);this.cylinderBuffer=new NGL.CylinderBuffer(this.atomSet.bondPosition(null,0),this.atomSet.bondPosition(null,1),this.atomSet.bondColor(null,0,this.getColorParams()),
this.atomSet.bondColor(null,1,this.getColorParams()),this.atomSet.bondRadius(null,null,this.radius,this.scale),this.atomSet.bondPickingColor(null,0),this.atomSet.bondPickingColor(null,1),this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor);this.bufferList.push(this.sphereBuffer,this.cylinderBuffer)}},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b={},c={};if(a.position){b.position=this.atomSet.atomPosition();
var d=this.atomSet.bondPosition(null,0),e=this.atomSet.bondPosition(null,1);c.position=NGL.Utils.calculateCenterArray(d,e,this.__center);c.position1=d;c.position2=e}a.color&&(b.color=this.atomSet.atomColor(null,this.getColorParams()),c.color=this.atomSet.bondColor(null,0,this.getColorParams()),c.color2=this.atomSet.bondColor(null,1,this.getColorParams()));if(a.radius||a.scale)b.radius=this.atomSet.atomRadius(null,this.radius,this.scale*this.aspectRatio),c.radius=this.atomSet.bondRadius(null,null,
this.radius,this.scale);this.sphereBuffer.setAttributes(b);this.cylinderBuffer.setAttributes(c)}},setParameters:function(a){var b=!1,c={};a&&a.aspectRatio&&(c.radius=!0,c.scale=!0,!NGL.extensionFragDepth||this.disableImpostor)&&(b=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,a,c,b);return this}});NGL.LicoriceRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.LicoriceRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.LicoriceRepresentation,type:"licorice",defaultSize:.15,parameters:Object.assign({sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.radius=a.radius||this.defaultSize;this.disableImpostor=a.disableImpostor||!1;"low"===a.quality?(this.sphereDetail=
0,this.radiusSegments=5):"medium"===a.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===a.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==a.sphereDetail?a.sphereDetail:1,this.radiusSegments=void 0!==a.radiusSegments?a.radiusSegments:10);NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){0!==this.atomSet.atomCount&&(this.sphereBuffer=new NGL.SphereBuffer(this.atomSet.atomPosition(),this.atomSet.atomColor(null,this.getColorParams()),
this.atomSet.atomRadius(null,this.radius,this.scale),this.atomSet.atomPickingColor(),this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0}),this.disableImpostor),this.cylinderBuffer=new NGL.CylinderBuffer(this.atomSet.bondPosition(null,0),this.atomSet.bondPosition(null,1),this.atomSet.bondColor(null,0,this.getColorParams()),this.atomSet.bondColor(null,1,this.getColorParams()),this.atomSet.bondRadius(null,null,this.radius,this.scale),this.atomSet.bondPickingColor(null,0),this.atomSet.bondPickingColor(null,
1),this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor),this.bufferList.push(this.sphereBuffer,this.cylinderBuffer))},update:function(a){this.aspectRatio=1;NGL.BallAndStickRepresentation.prototype.update.call(this,a)}});NGL.LineRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.LineRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.LineRepresentation,type:"line",parameters:Object.assign({},NGL.Representation.prototype.parameters,{flatShaded:null,side:null,wireframe:null}),init:function(a){a=a||{};this.linewidth=a.linewidth||1;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){0!==this.atomSet.atomCount&&(this.lineBuffer=new NGL.LineBuffer(this.atomSet.bondPosition(null,0),this.atomSet.bondPosition(null,
1),this.atomSet.bondColor(null,0,this.getColorParams()),this.atomSet.bondColor(null,1,this.getColorParams()),this.getBufferParams()),this.bufferList.push(this.lineBuffer))},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b={};a.position&&(b.from=this.atomSet.bondPosition(null,0),b.to=this.atomSet.bondPosition(null,1));a.color&&(b.color=this.atomSet.bondColor(null,0,this.getColorParams()),b.color2=this.atomSet.bondColor(null,1,this.getColorParams()));this.lineBuffer.setAttributes(b)}}});
NGL.HyperballRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c);this.defaultScale.vdw=.2};
NGL.HyperballRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.HyperballRepresentation,type:"hyperball",parameters:Object.assign({shrink:{type:"number",precision:3,max:1,min:.001,buffer:!0},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.scale=a.scale||.2;this.disableImpostor=a.disableImpostor||!1;
"low"===a.quality?(this.sphereDetail=0,this.radiusSegments=5):"medium"===a.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===a.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==a.sphereDetail?a.sphereDetail:1,this.radiusSegments=void 0!==a.radiusSegments?a.radiusSegments:10);this.shrink=a.shrink||.12;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){0!==this.atomSet.atomCount&&(this.sphereBuffer=new NGL.SphereBuffer(this.atomSet.atomPosition(),
this.atomSet.atomColor(null,this.getColorParams()),this.atomSet.atomRadius(null,this.radius,this.scale),this.atomSet.atomPickingColor(),this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0}),this.disableImpostor),this.__center=new Float32Array(3*this.atomSet.bondCount),this.cylinderBuffer=new NGL.HyperballStickBuffer(this.atomSet.bondPosition(null,0),this.atomSet.bondPosition(null,1),this.atomSet.bondColor(null,0,this.getColorParams()),this.atomSet.bondColor(null,1,this.getColorParams()),
this.atomSet.bondRadius(null,0,this.radius,this.scale),this.atomSet.bondRadius(null,1,this.radius,this.scale),this.atomSet.bondPickingColor(null,0),this.atomSet.bondPickingColor(null,1),this.getBufferParams({shrink:this.shrink,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor),this.bufferList.push(this.sphereBuffer,this.cylinderBuffer))},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b={},c={};if(a.position){b.position=this.atomSet.atomPosition();
var d=this.atomSet.bondPosition(null,0),e=this.atomSet.bondPosition(null,1);c.position=NGL.Utils.calculateCenterArray(d,e,this.__center);c.position1=d;c.position2=e}a.color&&(b.color=this.atomSet.atomColor(null,this.getColorParams()),c.color=this.atomSet.bondColor(null,0,this.getColorParams()),c.color2=this.atomSet.bondColor(null,1,this.getColorParams()));if(a.radius||a.scale)b.radius=this.atomSet.atomRadius(null,this.radius,this.scale),c.radius=this.atomSet.bondRadius(null,0,this.radius,this.scale),
c.radius2=this.atomSet.bondRadius(null,1,this.radius,this.scale);this.sphereBuffer.setAttributes(b);this.cylinderBuffer.setAttributes(c)}}});NGL.BackboneRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.BackboneRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.BackboneRepresentation,type:"backbone",defaultSize:.25,parameters:Object.assign({aspectRatio:{type:"number",precision:1,max:10,min:1},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:50,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.radius=a.radius||this.defaultSize;this.disableImpostor=
a.disableImpostor||!1;"low"===a.quality?(this.sphereDetail=0,this.radiusSegments=5):"medium"===a.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===a.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==a.sphereDetail?a.sphereDetail:1,this.radiusSegments=void 0!==a.radiusSegments?a.radiusSegments:10);this.aspectRatio=a.aspectRatio||1;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this.selection.test;
this.backboneAtomSet=new NGL.AtomSet;this.backboneBondSet=new NGL.BondSet;var b=this.backboneAtomSet,c=this.backboneBondSet;b.structure=this.structure;c.structure=this.structure;var d,e;this.structure.eachFiber(function(f){2>f.residueCount||(f.eachResidueN(2,function(f,g){d=f.getTraceAtom();e=g.getTraceAtom();if(!a||a(d)&&a(e))b.addAtom(d),c.addBond(d,e,!0)}),(!a||a(d)&&a(e))&&b.addAtom(e))});if(0!==b.atomCount){var f=this.scale*this.aspectRatio;this.sphereBuffer=new NGL.SphereBuffer(b.atomPosition(),
b.atomColor(null,this.getColorParams()),b.atomRadius(null,this.radius,f),b.atomPickingColor(),this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0}),this.disableImpostor);this.cylinderBuffer=new NGL.CylinderBuffer(c.bondPosition(null,0),c.bondPosition(null,1),c.bondColor(null,0,this.getColorParams()),c.bondColor(null,1,this.getColorParams()),c.bondRadius(null,0,this.radius,this.scale),c.bondPickingColor(null,0),c.bondPickingColor(null,1),this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,
dullInterior:!0}),this.disableImpostor);this.bufferList.push(this.sphereBuffer,this.cylinderBuffer)}}},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b=this.backboneAtomSet,c=this.backboneBondSet;if(0!==b.atomCount){var d={},e={};if(a.position){d.position=b.atomPosition();var f=c.bondPosition(null,0),g=c.bondPosition(null,1);e.position=NGL.Utils.calculateCenterArray(f,g);e.position1=f;e.position2=g}a.color&&(d.color=b.atomColor(null,this.getColorParams()),
e.color=c.bondColor(null,0,this.getColorParams()),e.color2=c.bondColor(null,1,this.getColorParams()));if(a.radius||a.scale)d.radius=b.atomRadius(null,this.radius,this.scale*this.aspectRatio),e.radius=c.bondRadius(null,0,this.radius,this.scale);this.sphereBuffer.setAttributes(d);this.cylinderBuffer.setAttributes(e)}}},setParameters:function(a){var b=!1,c={};a&&a.aspectRatio&&(c.radius=!0,c.scale=!0,!NGL.extensionFragDepth||this.disableImpostor)&&(b=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,
a,c,b);return this},clear:function(){this.backboneAtomSet&&this.backboneAtomSet.dispose();this.backboneBondSet&&this.backboneBondSet.dispose();NGL.StructureRepresentation.prototype.clear.call(this)}});NGL.BaseRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.BaseRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.BaseRepresentation,type:"base",defaultSize:.2,parameters:Object.assign({aspectRatio:{type:"number",precision:1,max:10,min:1},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"},radiusSegments:{type:"integer",max:50,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.radius=a.radius||this.defaultSize;this.disableImpostor=a.disableImpostor||
!1;"low"===a.quality?(this.sphereDetail=0,this.radiusSegments=5):"medium"===a.quality?(this.sphereDetail=1,this.radiusSegments=10):"high"===a.quality?(this.sphereDetail=2,this.radiusSegments=20):(this.sphereDetail=void 0!==a.sphereDetail?a.sphereDetail:1,this.radiusSegments=void 0!==a.radiusSegments?a.radiusSegments:10);this.aspectRatio=a.aspectRatio||1;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this.selection.test;this.baseAtomSet=
new NGL.AtomSet;this.baseBondSet=new NGL.BondSet;var b=this.baseAtomSet,c=this.baseBondSet;b.structure=this.structure;c.structure=this.structure;var d,e,f=["A","G","DA","DG"];this.structure.eachFiber(function(g){1>g.residueCount||!g.isNucleic()||g.eachResidue(function(g){d=g.getTraceAtom();e=-1!==f.indexOf(g.resname)?g.getAtomByName("N1"):g.getAtomByName("N3");if(!a||a(d))b.addAtom(d),b.addAtom(e),c.addBond(d,e,!0)})});if(0!==b.atomCount){var g=this.scale*this.aspectRatio;this.sphereBuffer=new NGL.SphereBuffer(b.atomPosition(),
b.atomColor(null,this.getColorParams()),b.atomRadius(null,this.radius,g),b.atomPickingColor(),this.getBufferParams({sphereDetail:this.sphereDetail,dullInterior:!0}),this.disableImpostor);this.cylinderBuffer=new NGL.CylinderBuffer(c.bondPosition(null,0),c.bondPosition(null,1),c.bondColor(null,0,this.getColorParams()),c.bondColor(null,1,this.getColorParams()),c.bondRadius(null,0,this.radius,this.scale),c.bondPickingColor(null,0),c.bondPickingColor(null,1),this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,
dullInterior:!0}),this.disableImpostor);this.bufferList.push(this.sphereBuffer,this.cylinderBuffer)}}},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b=this.baseAtomSet,c=this.baseBondSet;if(0!==b.atomCount){var d={},e={};if(a.position){d.position=b.atomPosition();var f=c.bondPosition(null,0),g=c.bondPosition(null,1);e.position=NGL.Utils.calculateCenterArray(f,g);e.position1=f;e.position2=g}a.color&&(d.color=b.atomColor(null,this.getColorParams()),e.color=
c.bondColor(null,0,this.getColorParams()),e.color2=c.bondColor(null,1,this.getColorParams()));if(a.radius||a.scale)d.radius=b.atomRadius(null,this.radius,this.scale*this.aspectRatio),e.radius=c.bondRadius(null,0,this.radius,this.scale);this.sphereBuffer.setAttributes(d);this.cylinderBuffer.setAttributes(e)}}},setParameters:function(a){var b=!1,c={};a&&a.aspectRatio&&(c.radius=!0,c.scale=!0,!NGL.extensionFragDepth||this.disableImpostor)&&(b=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,
a,c,b);return this},clear:function(){this.baseAtomSet&&this.baseAtomSet.dispose();this.baseBondSet&&this.baseAtomSet.dispose();NGL.StructureRepresentation.prototype.clear.call(this)}});NGL.TubeRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.TubeRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.TubeRepresentation,type:"tube",defaultSize:.25,parameters:Object.assign({subdiv:{type:"integer",max:50,min:1,rebuild:!0},radialSegments:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1},capped:{type:"boolean",rebuild:!0}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"sstruc";a.radius=a.radius||this.defaultSize;
"low"===a.quality?(this.subdiv=3,this.radialSegments=5):"medium"===a.quality?(this.subdiv=6,this.radialSegments=10):"high"===a.quality?(this.subdiv=12,this.radialSegments=20):(this.subdiv=a.subdiv||6,this.radialSegments=a.radialSegments||10);this.tension=a.tension||NaN;this.capped=a.capped||!0;NGL.StructureRepresentation.prototype.init.call(this,a);this.__fiberList=[];this.__bufferList=[]},prepare:function(a){this.__fiberList.length=0;this.__bufferList.length=0;if(0===this.atomSet.atomCount)a();else{var b=
this;this.structure.eachFiber(function(a){4>a.residueCount||b.__fiberList.push(a)},this.selection,!0);NGL.processArray(this.__fiberList,function(a,d,e){for(;a<d;++a){var f=new NGL.Spline(e[a]),g=f.getSubdividedPosition(b.subdiv,b.tension),h=f.getSubdividedOrientation(b.subdiv,b.tension),k=f.getSubdividedColor(b.subdiv,b.getColorParams()),f=f.getSubdividedSize(b.subdiv,b.radius,b.scale);b.__bufferList.push(new NGL.TubeMeshBuffer(g.position,h.normal,h.binormal,h.tangent,k.color,f.size,k.pickingColor,
b.getBufferParams({radialSegments:b.radialSegments,rx:1,ry:1,capped:b.capped,dullInterior:!0})))}},a,50)}},create:function(){for(var a=this.__fiberList.length,b=0;b<a;++b)this.fiberList.push(this.__fiberList[b]),this.bufferList.push(this.__bufferList[b])},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};for(var b=0,c=this.fiberList.length,b=0;b<c;++b){var d=this.fiberList[b];if(4>d.residueCount)break;var e={},d=new NGL.Spline(d);if(a.position||a.radius||a.scale){var f=
d.getSubdividedPosition(this.subdiv,this.tension),g=d.getSubdividedOrientation(this.subdiv,this.tension),h=d.getSubdividedSize(this.subdiv,this.radius,this.scale);e.position=f.position;e.normal=g.normal;e.binormal=g.binormal;e.tangent=g.tangent;e.size=h.size}a.color&&(d=d.getSubdividedColor(this.subdiv,this.getColorParams()),e.color=d.color,e.pickingColor=d.pickingColor);this.bufferList[b].setAttributes(e)}}},setParameters:function(a){var b={};a&&a.tension&&(b.position=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,
a,b,!1);return this}});NGL.CartoonRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.CartoonRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.CartoonRepresentation,type:"cartoon",parameters:Object.assign({aspectRatio:{type:"number",precision:1,max:10,min:1},subdiv:{type:"integer",max:50,min:1,rebuild:!0},radialSegments:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1},capped:{type:"boolean",rebuild:!0},arrows:{type:"boolean",rebuild:!0}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=
a||{};a.colorScheme=a.colorScheme||"sstruc";a.radius=a.radius||"ss";"low"===a.quality?(this.subdiv=3,this.radialSegments=6):"medium"===a.quality?(this.subdiv=6,this.radialSegments=10):"high"===a.quality?(this.subdiv=12,this.radialSegments=20):(this.subdiv=a.subdiv||6,this.radialSegments=a.radialSegments||10);this.aspectRatio=a.aspectRatio||3;this.tension=a.tension||NaN;this.capped=a.capped||!0;this.arrows=a.arrows||!1;NGL.StructureRepresentation.prototype.init.call(this,a);this.__fiberList=[];this.__bufferList=
[]},prepare:function(a){this.__fiberList.length=0;this.__bufferList.length=0;if(0===this.atomSet.atomCount)a();else{var b=this;this.structure.eachFiber(function(a){4>a.residueCount||b.__fiberList.push(a)},this.selection,!0);NGL.processArray(this.__fiberList,function(a,d,e){for(;a<d;++a){var f=e[a],g=new NGL.Spline(f,b.arrows),h=g.getSubdividedPosition(b.subdiv,b.tension),k=g.getSubdividedOrientation(b.subdiv,b.tension),l=g.getSubdividedColor(b.subdiv,b.getColorParams()),g=g.getSubdividedSize(b.subdiv,
b.radius,b.scale),m=1*b.aspectRatio,p=1;f.isCg()&&(p=m);b.__bufferList.push(new NGL.TubeMeshBuffer(h.position,k.normal,k.binormal,k.tangent,l.color,g.size,l.pickingColor,b.getBufferParams({radialSegments:b.radialSegments,rx:m,ry:p,capped:b.capped,dullInterior:!0})))}},a,50)}},create:function(){for(var a=this.__fiberList.length,b=0;b<a;++b)this.fiberList.push(this.__fiberList[b]),this.bufferList.push(this.__bufferList[b])},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=
a||{};for(var b=0,c=this.fiberList.length,b=0;b<c;++b){var d=this.fiberList[b];if(4>d.residueCount)break;var e={},d=new NGL.Spline(d,this.arrows);this.bufferList[b].rx=this.aspectRatio;if(a.position||a.radius||a.scale){var f=d.getSubdividedPosition(this.subdiv,this.tension),g=d.getSubdividedOrientation(this.subdiv,this.tension),h=d.getSubdividedSize(this.subdiv,this.radius,this.scale);e.position=f.position;e.normal=g.normal;e.binormal=g.binormal;e.tangent=g.tangent;e.size=h.size}a.color&&(d=d.getSubdividedColor(this.subdiv,
this.getColorParams()),e.color=d.color,e.pickingColor=d.pickingColor);this.bufferList[b].setAttributes(e)}}},setParameters:function(a){var b={};a&&a.aspectRatio&&(b.radius=!0);a&&a.tension&&(b.position=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,a,b,!1);return this}});NGL.RibbonRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c);this.defaultScale.ss*=3};
NGL.RibbonRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.RibbonRepresentation,type:"ribbon",parameters:Object.assign({subdiv:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1}},NGL.StructureRepresentation.prototype.parameters,{side:null,wireframe:null,linewidth:null}),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"sstruc";a.radius=a.radius||"ss";a.scale=a.scale||3;this.subdiv="low"===a.quality?3:"medium"===
a.quality?6:"high"===a.quality?12:a.subdiv||6;this.tension=a.tension||NaN;NGL.StructureRepresentation.prototype.init.call(this,a);this.__fiberList=[];this.__bufferList=[]},prepare:function(a){this.__fiberList.length=0;this.__bufferList.length=0;if(0===this.atomSet.atomCount)a();else{var b=this;this.structure.eachFiber(function(a){4>a.residueCount||b.__fiberList.push(a)},this.selection,!0);NGL.processArray(this.__fiberList,function(a,d,e){for(;a<d;++a){var f=new NGL.Spline(e[a]),g=f.getSubdividedPosition(b.subdiv,
b.tension),h=f.getSubdividedOrientation(b.subdiv,b.tension),k=f.getSubdividedColor(b.subdiv,b.getColorParams()),f=f.getSubdividedSize(b.subdiv,b.radius,b.scale);b.__bufferList.push(new NGL.RibbonBuffer(g.position,h.binormal,h.normal,k.color,f.size,k.pickingColor,b.getBufferParams()))}},a,50)}},create:function(){for(var a=this.__fiberList.length,b=0;b<a;++b)this.fiberList.push(this.__fiberList[b]),this.bufferList.push(this.__bufferList[b])},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=
a||{};for(var b=0,c=this.fiberList.length,b=0;b<c;++b){var d=this.fiberList[b];if(4>d.residueCount)break;var e={},d=new NGL.Spline(d);if(a.position){var f=d.getSubdividedPosition(this.subdiv,this.tension),g=d.getSubdividedOrientation(this.subdiv,this.tension);e.position=f.position;e.normal=g.binormal;e.dir=g.normal}if(a.radius||a.scale)f=d.getSubdividedSize(this.subdiv,this.radius,this.scale),e.size=f.size;a.color&&(d=d.getSubdividedColor(this.subdiv,this.getColorParams()),e.color=d.color);this.bufferList[b].setAttributes(e)}}},
setParameters:function(a){var b={};a&&a.tension&&(b.position=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,a,b,!1);return this}});NGL.TraceRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.TraceRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.TraceRepresentation,type:"trace",parameters:Object.assign({subdiv:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1}},NGL.Representation.prototype.parameters,{flatShaded:null,side:null,wireframe:null}),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"sstruc";this.subdiv="low"===a.quality?3:"medium"===a.quality?6:"high"===a.quality?12:a.subdiv||6;this.tension=
a.tension||NaN;NGL.StructureRepresentation.prototype.init.call(this,a);this.__fiberList=[];this.__bufferList=[]},prepare:function(a){this.__fiberList.length=0;this.__bufferList.length=0;if(0===this.atomSet.atomCount)a();else{var b=this;this.structure.eachFiber(function(a){4>a.residueCount||b.__fiberList.push(a)},this.selection,!0);NGL.processArray(this.__fiberList,function(a,d,e){for(;a<d;++a){var f=new NGL.Spline(e[a]),g=f.getSubdividedPosition(b.subdiv,b.tension),f=f.getSubdividedColor(b.subdiv,
b.getColorParams());b.__bufferList.push(new NGL.TraceBuffer(g.position,f.color,b.getBufferParams()))}},a,50)}},create:function(){for(var a=this.__fiberList.length,b=0;b<a;++b)this.fiberList.push(this.__fiberList[b]),this.bufferList.push(this.__bufferList[b])},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};for(var b=0,c=this.fiberList.length,b=0;b<c;++b){var d=this.fiberList[b];if(4>d.residueCount)break;var e={},d=new NGL.Spline(d);if(a.position){var f=d.getSubdividedPosition(this.subdiv,
this.tension);e.position=f.position}a.color&&(d=d.getSubdividedColor(this.subdiv,this.getColorParams()),e.color=d.color);this.bufferList[b].setAttributes(e)}}},setParameters:function(a){var b={};a&&a.tension&&(b.position=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,a,b,!1);return this}});NGL.HelixorientRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.HelixorientRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.HelixorientRepresentation,type:"helixorient",parameters:Object.assign({},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"sstruc";a.radius=a.radius||.15;a.scale=a.scale||1;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this;this.structure.eachFiber(function(b){if(!(4>
b.residueCount||b.isNucleic())){var c=new NGL.Helixorient(b),d=c.getPosition(),e=c.getColor(a.getColorParams()),c=c.getSize(a.radius,a.scale);a.bufferList.push(new NGL.SphereBuffer(d.center,e.color,c.size,e.pickingColor,a.getBufferParams({sphereDetail:a.sphereDetail,dullInterior:!0}),a.disableImpostor));a.bufferList.push(new NGL.VectorBuffer(d.center,d.axis,{color:"skyblue",scale:1}));a.bufferList.push(new NGL.VectorBuffer(d.center,d.resdir,{color:"lightgreen",scale:1}));a.fiberList.push(b)}},this.selection)}},
update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};for(var b,c=0,d=this.fiberList.length,c=0;c<d;++c){b=3*c;var e=this.fiberList[c];if(4>e.residueCount)break;var f={},e=new NGL.Helixorient(e);a.position&&(e=e.getPosition(),f.position=e.center,this.bufferList[b+1].setAttributes({position:e.center,vector:e.axis}),this.bufferList[b+2].setAttributes({position:e.center,vector:e.resdir}));this.bufferList[b].setAttributes(f)}}}});
NGL.RocketRepresentation=function(a,b,c){this.helixbundleList=[];NGL.StructureRepresentation.call(this,a,b,c)};
NGL.RocketRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.RocketRepresentation,type:"rocket",parameters:Object.assign({localAngle:{type:"integer",max:180,min:0,rebuild:!0},centerDist:{type:"number",precision:1,max:10,min:0,rebuild:!0},ssBorder:{type:"boolean",rebuild:!0},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"sstruc";a.radius=
a.radius||1.5;a.scale=a.scale||1;this.disableImpostor=a.disableImpostor||!1;this.radiusSegments="low"===a.quality?5:"medium"===a.quality?10:"high"===a.quality?20:void 0!==a.radiusSegments?a.radiusSegments:10;this.localAngle=a.localAngle||30;this.centerDist=a.centerDist||2.5;this.ssBorder=void 0===a.ssBorder?!1:a.ssBorder;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this,b=0,c=[];this.structure.eachFiber(function(d){if(!(4>d.residueCount||
d.isNucleic())){d=new NGL.Helixbundle(d);var e=d.getAxis(a.localAngle,a.centerDist,a.ssBorder,a.getColorParams(),a.radius,a.scale);b+=e.size.length;c.push(e);a.helixbundleList.push(d)}},this.selection);var d=this.axisData={begin:new Float32Array(3*b),end:new Float32Array(3*b),size:new Float32Array(b),color:new Float32Array(3*b),pickingColor:new Float32Array(3*b)},e=0;c.forEach(function(a){d.begin.set(a.begin,3*e);d.end.set(a.end,3*e);d.size.set(a.size,e);d.color.set(a.color,3*e);d.pickingColor.set(a.pickingColor,
3*e);e+=a.size.length});this.cylinderBuffer=new NGL.CylinderBuffer(d.begin,d.end,d.color,d.color,d.size,d.pickingColor,d.pickingColor,this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor);this.bufferList.push(this.cylinderBuffer)}},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b=this,c={};if(a.position)this.build();else{if(a.color||a.radius||a.scale){var d=0,e=this.axisData;this.helixbundleList.forEach(function(c){c=
c.getAxis(b.localAngle,b.centerDist,b.ssBorder,b.getColorParams(),b.radius,b.scale);a.color&&e.color.set(c.color,3*d);(a.radius||a.scale)&&e.size.set(c.size,d);d+=c.size.length});a.color&&(c.color=e.color,c.color2=e.color);if(a.radius||a.scale)c.radius=e.size}this.cylinderBuffer.setAttributes(c)}}},clear:function(){this.helixbundleList.length=0;NGL.StructureRepresentation.prototype.clear.call(this)}});NGL.RopeRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.RopeRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.RopeRepresentation,type:"rope",parameters:Object.assign({subdiv:{type:"integer",max:50,min:1,rebuild:!0},radialSegments:{type:"integer",max:50,min:1,rebuild:!0},tension:{type:"number",precision:1,max:1,min:.1},capped:{type:"boolean",rebuild:!0},smooth:{type:"integer",max:15,min:0,rebuild:!0}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.colorScheme=a.colorScheme||
"sstruc";a.radius=a.radius||this.defaultSize;"low"===a.quality?(this.subdiv=3,this.radialSegments=5):"medium"===a.quality?(this.subdiv=6,this.radialSegments=10):"high"===a.quality?(this.subdiv=12,this.radialSegments=20):(this.subdiv=a.subdiv||6,this.radialSegments=a.radialSegments||10);this.tension=a.tension||.5;this.capped=a.capped||!0;this.smooth=void 0===a.smooth?2:a.smooth;NGL.StructureRepresentation.prototype.init.call(this,a);this.__fiberList=[];this.__bufferList=[]},prepare:function(a){this.__fiberList.length=
0;this.__bufferList.length=0;if(0===this.atomSet.atomCount)a();else{var b=this;this.structure.eachFiber(function(a){4>a.residueCount||a.isNucleic()||b.__fiberList.push(a)},this.selection,!0);NGL.processArray(this.__fiberList,function(a,d,e){for(;a<d;++a){var f=new NGL.Helixorient(e[a]),g=new NGL.Spline(f.getFiber(b.smooth,!0)),f=g.getSubdividedPosition(b.subdiv,b.tension),h=g.getSubdividedOrientation(b.subdiv,b.tension),k=g.getSubdividedColor(b.subdiv,b.getColorParams()),g=g.getSubdividedSize(b.subdiv,
b.radius,b.scale);b.__bufferList.push(new NGL.TubeMeshBuffer(f.position,h.normal,h.binormal,h.tangent,k.color,g.size,k.pickingColor,b.getBufferParams({radialSegments:b.radialSegments,rx:1,ry:1,capped:b.capped,dullInterior:!0})))}},a,50)}},create:function(){for(var a=this.__fiberList.length,b=0;b<a;++b)this.fiberList.push(this.__fiberList[b]),this.bufferList.push(this.__bufferList[b])},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};for(var b=0,c=this.fiberList.length,
b=0;b<c;++b){var d=this.fiberList[b];if(4>d.residueCount)break;var e={},d=new NGL.Helixorient(d),d=new NGL.Spline(d.getFiber(this.smooth,!0));if(a.position||a.radius||a.scale){var f=d.getSubdividedPosition(this.subdiv,this.tension),g=d.getSubdividedOrientation(this.subdiv,this.tension),h=d.getSubdividedSize(this.subdiv,this.radius,this.scale);e.position=f.position;e.normal=g.normal;e.binormal=g.binormal;e.tangent=g.tangent;e.size=h.size}a.color&&(d=d.getSubdividedColor(this.subdiv,this.getColorParams()),
e.color=d.color,e.pickingColor=d.pickingColor);this.bufferList[b].setAttributes(e)}}},setParameters:function(a){var b={};a&&a.tension&&(b.radius=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,a,b,!1);return this}});NGL.CrossingRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.CrossingRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.CrossingRepresentation,type:"crossing",parameters:Object.assign({localAngle:{type:"integer",max:180,min:0,rebuild:!0},centerDist:{type:"number",precision:1,max:10,min:0,rebuild:!0},ssBorder:{type:"boolean",rebuild:!0},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"},helixDist:{type:"number",precision:1,max:30,min:0,rebuild:!0},displayLabel:{type:"boolean",rebuild:!0},download:{type:"button",
methodName:"download"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"sstruc";a.radius=a.radius||.7;a.scale=a.scale||1;this.disableImpostor=a.disableImpostor||!1;this.radiusSegments="low"===a.quality?5:"medium"===a.quality?10:"high"===a.quality?20:void 0!==a.radiusSegments?a.radiusSegments:10;this.localAngle=a.localAngle||30;this.centerDist=a.centerDist||2.5;this.ssBorder=void 0===a.ssBorder?!1:a.ssBorder;this.helixDist=a.helixDist||12;this.displayLabel=
void 0===a.displayLabel?!0:a.displayLabel;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this,b=[];this.structure.eachFiber(function(c){if(!(4>c.residueCount||c.isNucleic())){var d=(new NGL.Helixbundle(c)).getAxis(a.localAngle,a.centerDist,a.ssBorder,a.getColorParams(),a.radius,a.scale);a.bufferList.push(new NGL.CylinderBuffer(d.begin,d.end,d.color,d.color,d.size,d.pickingColor,d.pickingColor,a.getBufferParams({shift:0,cap:!0,radiusSegments:a.radiusSegments,
dullInterior:!0}),a.disableImpostor));a.fiberList.push(c);for(c=0;c<d.residue.length;++c){var g=new NGL.Helix;g.fromHelixbundleAxis(d,c);b.push(g)}}},this.selection);var c=(new NGL.HelixCrossing(b)).getCrossing(this.helixDist);this.crossing=c;var d=c.end.length/3;this.bufferList.push(new NGL.CylinderBuffer(new Float32Array(c.begin),new Float32Array(c.end),NGL.Utils.uniformArray3(d,.2,.2,.9),NGL.Utils.uniformArray3(d,.2,.2,.9),NGL.Utils.uniformArray(d,.1),NGL.Utils.uniformArray3(d,0,0,0),NGL.Utils.uniformArray3(d,
0,0,0),{shift:0,cap:!0,radiusSegments:this.radiusSegments,side:this.side,opacity:this.opacity,nearClip:this.nearClip,flatShaded:this.flatShaded,dullInterior:!0},this.disableImpostor));this.displayLabel&&(d=c.helixLabel.length,this.bufferList.push(new NGL.TextBuffer(c.helixCenter,NGL.Utils.uniformArray(d,2.5),NGL.Utils.uniformArray3(d,1,1,1),c.helixLabel,{nearClip:this.nearClip})))}},update:function(a){this.build()},download:function(){var a=JSON.stringify(this.crossing.info,null,"\t");NGL.download(new Blob([a],
{type:"text/plain"}),"helixCrossing.json")}});NGL.ContactRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.ContactRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.ContactRepresentation,type:"contact",defaultSize:.25,parameters:Object.assign({contactType:{type:"select",rebuild:!0,options:{polar:"polar",polarBackbone:"polar backbone"}},maxDistance:{type:"number",precision:1,max:10,min:.1,rebuild:!0},maxAngle:{type:"integer",max:180,min:0,rebuild:!0}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.radius=a.radius||this.defaultSize;
this.disableImpostor=a.disableImpostor||!1;this.sphereDetail="low"===a.quality?0:"medium"===a.quality?1:"high"===a.quality?2:void 0!==a.sphereDetail?a.sphereDetail:1;this.contactType=a.contactType||"polar";this.maxDistance=a.maxDistance||3.5;this.maxAngle=a.maxAngle||40;NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=new NGL.StructureSubset(this.structure,this.selection),b={polar:NGL.polarContacts,polarBackbone:NGL.polarBackboneContacts}[this.contactType](a,
this.maxDistance,this.maxAngle);this.contactAtomSet=b.atomSet;b=this.contactBondSet=b.bondSet;0!==this.contactAtomSet.atomCount&&(this.cylinderBuffer=new NGL.CylinderBuffer(b.bondPosition(null,0),b.bondPosition(null,1),b.bondColor(null,0,this.getColorParams()),b.bondColor(null,1,this.getColorParams()),b.bondRadius(null,0,this.radius,this.scale),b.bondPickingColor(null,0),b.bondPickingColor(null,1),this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor),
this.bufferList.push(this.cylinderBuffer),a.dispose())}},update:function(a){if(a.position)this.build();else if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){a=a||{};var b=this.contactBondSet;if(0!==this.contactAtomSet.atomCount){var c={};if(a.position){var d=b.bondPosition(null,0),e=b.bondPosition(null,1);c.position=NGL.Utils.calculateCenterArray(d,e);c.position1=d;c.position2=e}a.color&&(c.color=b.bondColor(null,0,this.getColorParams()),c.color2=b.bondColor(null,1,this.getColorParams()));
if(a.radius||a.scale)c.radius=b.bondRadius(null,0,this.radius,this.scale);this.cylinderBuffer.setAttributes(c)}}},clear:function(){this.contactAtomSet&&this.contactAtomSet.dispose();this.contactBondSet&&this.contactBondSet.dispose();NGL.StructureRepresentation.prototype.clear.call(this)}});NGL.MolecularSurfaceRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.MolecularSurfaceRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.MolecularSurfaceRepresentation,type:"surface",parameters:Object.assign({surfaceType:{type:"select",rebuild:!0,options:{vws:"vws",sas:"sas",ms:"ms",ses:"ses"}},probeRadius:{type:"number",precision:1,max:20,min:0,rebuild:!0},smooth:{type:"integer",precision:1,max:10,min:0,rebuild:!0},scaleFactor:{type:"number",precision:1,max:5,min:0,rebuild:!0},cutoff:{type:"number",precision:2,max:50,
min:0,rebuild:!0},background:{type:"boolean",rebuild:!0},opaqueBack:{type:"boolean",buffer:!0},lowResolution:{type:"boolean",rebuild:!0},filterSele:{type:"text",rebuild:!0}},NGL.StructureRepresentation.prototype.parameters,{radiusType:null,radius:null,scale:null}),init:function(a){var b=a||{};b.colorScheme=b.colorScheme||"uniform";b.colorValue=void 0!==b.colorValue?b.colorValue:14540253;this.surfaceType=void 0!==b.surfaceType?b.surfaceType:"ms";this.probeRadius=void 0!==b.probeRadius?b.probeRadius:
1.4;this.smooth=void 0!==b.smooth?b.smooth:2;this.scaleFactor=void 0!==b.scaleFactor?b.scaleFactor:2;this.cutoff=b.cutoff||0;this.background=b.background||!1;this.opaqueBack=void 0!==b.opaqueBack?b.opaqueBack:!0;this.lowResolution=void 0!==b.lowResolution?b.lowResolution:!1;this.filterSele=void 0!==b.filterSele?b.filterSele:"";NGL.StructureRepresentation.prototype.init.call(this,a)},prepare:function(a){!this.molsurf||this.__forceNewMolsurf||this.__sele!==this.selection.combinedString||this.__smooth!==
this.smooth||this.__surfaceType!==this.surfaceType||this.__probeRadius!==this.probeRadius||this.__scaleFactor!==this.scaleFactor||this.__cutoff!==this.cutoff||this.__lowResolution!==this.lowResolution?(this.molsurf&&this.molsurf.dispose(),this.molsurf=new NGL.MolecularSurface(this.atomSet),this.__forceNewMolsurf=!1,this.__sele=this.selection.combinedString,this.__smooth=this.smooth,this.__surfaceType=this.surfaceType,this.__probeRadius=this.probeRadius,this.__scaleFactor=this.scaleFactor,this.__cutoff=
this.cutoff,this.__lowResolution=this.lowResolution,this.molsurf.getSurfaceWorker(this.surfaceType,this.probeRadius,this.scaleFactor,this.smooth,this.lowResolution,this.cutoff,function(b){this.surface=b;a()}.bind(this))):a()},create:function(){if(0!==this.atomSet.atomCount){var a=new NGL.SurfaceBuffer(this.surface.getPosition(),this.surface.getColor(this.getColorParams()),this.surface.getFilteredIndex(this.filterSele,this.atomSet.atoms),this.surface.getNormal(),this.surface.getPickingColor(this.getColorParams()),
this.getBufferParams({background:this.background,opaqueBack:this.opaqueBack,dullInterior:!1})),a=new NGL.DoubleSidedBuffer(a);this.bufferList.push(a)}},update:function(a){if(0!==this.bufferList.length){a=a||{};var b={};a.position?(this.__forceNewMolsurf=!0,this.build()):(a.color&&(b.color=this.surface.getColor(this.getColorParams())),this.bufferList.forEach(function(a){a.setAttributes(b)}))}},setParameters:function(a,b,c){b=b||{};NGL.StructureRepresentation.prototype.setParameters.call(this,a,b,c);
return this},clear:function(){NGL.StructureRepresentation.prototype.clear.call(this)},dispose:function(){this.molsurf&&this.molsurf.dispose();NGL.StructureRepresentation.prototype.dispose.call(this)}});NGL.DistanceRepresentation=function(a,b,c){NGL.StructureRepresentation.call(this,a,b,c)};
NGL.DistanceRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.DistanceRepresentation,type:"distance",defaultSize:.15,parameters:Object.assign({font:{type:"select",options:{LatoBlack:"LatoBlack"},rebuild:!0},labelSize:{type:"number",precision:3,max:10,min:.001},labelColor:{type:"color"},atomPair:{type:"hidden"},radiusSegments:{type:"integer",max:25,min:5,rebuild:"impostor"}},NGL.StructureRepresentation.prototype.parameters),init:function(a){a=a||{};a.radius=
a.radius||this.defaultSize;this.disableImpostor=a.disableImpostor||!1;this.radiusSegments="low"===a.quality?5:"medium"===a.quality?10:"high"===a.quality?20:void 0!==a.radiusSegments?a.radiusSegments:10;this.font=a.font||"LatoBlack";this.labelSize=a.labelSize||1;this.labelColor=a.labelColor||16777215;this.antialias=void 0!==a.antialias?a.antialias:!0;this.atomPair=a.atomPair||[];NGL.StructureRepresentation.prototype.init.call(this,a)},create:function(){if(0!==this.atomSet.atomCount){var a=this.atomPair.length;
if(0!==a){var b=Array(a),c=new Float32Array(3*a),d=new NGL.Selection,e=new NGL.Selection;this.bondSet=new NGL.BondSet;this.bondSet.structure=this.structure;var f=this.bondSet,g=0;this.atomPair.forEach(function(a,h){h-=g;var m=3*h;d.setString(a[0]);e.setString(a[1]);var p=this.atomSet.getAtoms(d,!0),r=this.atomSet.getAtoms(e,!0);p&&r?(f.addBond(p,r,!0),b[h]=p.distanceTo(r).toFixed(2),c[m+0]=(p.x+r.x)/2,c[m+1]=(p.y+r.y)/2,c[m+2]=(p.z+r.z)/2):g+=1},this);0<g&&(a-=g,c=c.subarray(0,3*a));var h=new THREE.Color(this.labelColor);
this.textBuffer=new NGL.TextBuffer(c,NGL.Utils.uniformArray(a,this.labelSize),NGL.Utils.uniformArray3(a,h.r,h.g,h.b),b,this.getBufferParams({font:this.font,antialias:this.antialias}));this.__center=new Float32Array(3*f.bondCount);this.cylinderBuffer=new NGL.CylinderBuffer(f.bondPosition(null,0),f.bondPosition(null,1),f.bondColor(null,0,this.getColorParams()),f.bondColor(null,1,this.getColorParams()),f.bondRadius(null,null,this.radius,this.scale),f.bondPickingColor(null,0),f.bondPickingColor(null,
1),this.getBufferParams({shift:0,cap:!0,radiusSegments:this.radiusSegments,dullInterior:!0}),this.disableImpostor);this.bufferList.push(this.textBuffer,this.cylinderBuffer)}}},update:function(a){if(0!==this.atomSet.atomCount&&0!==this.bufferList.length){var b=this.atomPair.length;if(0!==b){a=a||{};var c=this.bondSet,d={},e={};if(a.position){var f=new Float32Array(3*b),g=new NGL.Selection,h=new NGL.Selection;this.atomPair.forEach(function(a,b){var c=3*b;g.setString(a[0]);h.setString(a[1]);var d=this.atomSet.getAtoms(g,
!0),e=this.atomSet.getAtoms(h,!0);f[c+0]=(d.x+e.x)/2;f[c+1]=(d.y+e.y)/2;f[c+2]=(d.z+e.z)/2},this);d.position=f;var k=c.bondPosition(null,0),l=c.bondPosition(null,1);e.position=NGL.Utils.calculateCenterArray(k,l);e.position1=k;e.position2=l}a.labelSize&&(d.size=NGL.Utils.uniformArray(b,this.labelSize));a.labelColor&&(k=new THREE.Color(this.labelColor),d.color=NGL.Utils.uniformArray3(b,k.r,k.g,k.b));a.color&&(e.color=c.bondColor(null,0,this.getColorParams()),e.color2=c.bondColor(null,1,this.getColorParams()));
if(a.radius||a.scale)e.radius=c.bondRadius(null,0,this.radius,this.scale);this.textBuffer.setAttributes(d);this.cylinderBuffer.setAttributes(e)}}},setParameters:function(a){var b={};a&&a.labelSize&&(b.labelSize=!0);a&&a.labelColor&&(b.labelColor=!0);NGL.StructureRepresentation.prototype.setParameters.call(this,a,b,!1);return this},clear:function(){this.bondSet&&this.bondSet.dispose();NGL.StructureRepresentation.prototype.clear.call(this)}});
NGL.TrajectoryRepresentation=function(a,b,c){this.manualAttach=!0;this.trajectory=a;NGL.StructureRepresentation.call(this,a.structure,b,c)};
NGL.TrajectoryRepresentation.prototype=NGL.createObject(NGL.StructureRepresentation.prototype,{constructor:NGL.TrajectoryRepresentation,type:"",parameters:Object.assign({drawLine:{type:"boolean",rebuild:!0},drawCylinder:{type:"boolean",rebuild:!0},drawPoint:{type:"boolean",rebuild:!0},drawSphere:{type:"boolean",rebuild:!0},linewidth:{type:"integer",max:20,min:1,rebuild:!0},pointSize:{type:"integer",max:20,min:1,rebuild:!0},sizeAttenuation:{type:"boolean",rebuild:!0},sort:{type:"boolean",rebuild:!0}},
NGL.Representation.prototype.parameters),init:function(a){a=a||{};a.colorScheme=a.colorScheme||"uniform";a.colorValue=a.colorValue||14540253;this.drawLine=a.drawLine||!0;this.drawCylinder=a.drawCylinder||!1;this.drawPoint=a.drawPoint||!1;this.drawSphere=a.drawSphere||!1;this.pointSize=a.pointSize||1;this.sizeAttenuation=void 0!==a.sizeAttenuation?a.sizeAttenuation:!1;this.sort=void 0!==a.sort?a.sort:!0;NGL.StructureRepresentation.prototype.init.call(this,a)},attach:function(a){this.bufferList.forEach(function(a){this.viewer.add(a)},
this);this.setVisibility(this.visible);a()},prepare:function(a){a()},create:function(){if(0!==this.atomSet.atomCount){var a=this;this.trajectory.getPath(this.atomSet.atoms[0].index,function(b){var c=b.length/3,d=new THREE.Color(a.colorValue);if(a.drawSphere){var e=new NGL.SphereBuffer(b,NGL.Utils.uniformArray3(c,d.r,d.g,d.b),NGL.Utils.uniformArray(c,.2),NGL.Utils.uniformArray3(c,d.r,d.g,d.b),a.getBufferParams({sphereDetail:a.sphereDetail,dullInterior:!0}),a.disableImpostor);a.bufferList.push(e)}a.drawCylinder&&
(e=new NGL.CylinderBuffer(b.subarray(0,-3),b.subarray(3),NGL.Utils.uniformArray3(c-1,d.r,d.g,d.b),NGL.Utils.uniformArray3(c-1,d.r,d.g,d.b),NGL.Utils.uniformArray(c,.05),NGL.Utils.uniformArray3(c-1,d.r,d.g,d.b),NGL.Utils.uniformArray3(c-1,d.r,d.g,d.b),a.getBufferParams({shift:0,cap:!0,radiusSegments:a.radiusSegments,dullInterior:!0}),a.disableImpostor),a.bufferList.push(e));a.drawPoint&&(e=new NGL.PointBuffer(b,NGL.Utils.uniformArray3(c,d.r,d.g,d.b),a.getBufferParams({pointSize:a.pointSize,sizeAttenuation:a.sizeAttenuation,
sort:a.sort})),a.bufferList.push(e));a.drawLine&&(b=new NGL.LineBuffer(b.subarray(0,-3),b.subarray(3),NGL.Utils.uniformArray3(c-1,d.r,d.g,d.b),NGL.Utils.uniformArray3(c-1,d.r,d.g,d.b),a.getBufferParams()),a.bufferList.push(b));a.attach()})}}});
NGL.SurfaceRepresentation=function(a,b,c){NGL.Representation.call(this,a,b,c);a instanceof NGL.Volume?(this.surface=void 0,this.volume=a):(this.surface=a,this.volume=void 0);this.boxCenter=new THREE.Vector3;this.__boxCenter=new THREE.Vector3;this.box=new THREE.Box3;this.__box=new THREE.Box3;this.setBox=function(){var a=new THREE.Vector3;return function(){var c=b.controls.target;a.copy(b.rotationGroup.position).negate().add(c);this.setParameters({boxCenter:a})}.bind(this)}.call(this);this.viewer.signals.orientationChanged.add(this.setBox);
this.build()};
NGL.SurfaceRepresentation.prototype=NGL.createObject(NGL.Representation.prototype,{constructor:NGL.SurfaceRepresentation,type:"surface",parameters:Object.assign({isolevelType:{type:"select",options:{value:"value",sigma:"sigma"}},isolevel:{type:"number",precision:2,max:1E3,min:-1E3},smooth:{type:"integer",precision:1,max:10,min:0},background:{type:"boolean",rebuild:!0},opaqueBack:{type:"boolean",buffer:!0},boxSize:{type:"integer",precision:1,max:100,min:0}},NGL.Representation.prototype.parameters),init:function(a){a=
a||{};a.colorScheme=a.colorScheme||"uniform";a.colorValue=void 0!==a.colorValue?a.colorValue:14540253;this.isolevelType=void 0!==a.isolevelType?a.isolevelType:"sigma";this.isolevel=void 0!==a.isolevel?a.isolevel:2;this.smooth=void 0!==a.smooth?a.smooth:0;this.background=a.background||!1;this.opaqueBack=void 0!==a.opaqueBack?a.opaqueBack:!0;this.boxSize=void 0!==a.boxSize?a.boxSize:0;NGL.Representation.prototype.init.call(this,a)},attach:function(a){this.bufferList.forEach(function(a){this.viewer.add(a)},
this);this.setVisibility(this.visible);a()},prepare:function(a){if(this.volume){var b;b="sigma"===this.isolevelType?this.volume.getValueForSigma(this.isolevel):this.isolevel;!this.surface||this.__isolevel!==b||this.__smooth!==this.smooth||this.__boxSize!==this.boxSize||0<this.boxSize&&!this.__boxCenter.equals(this.boxCenter)?(this.__isolevel=b,this.__smooth=this.smooth,this.__boxSize=this.boxSize,this.__boxCenter.copy(this.boxCenter),this.__box.copy(this.box),this.volume.getSurfaceWorker(b,this.smooth,
this.boxCenter,this.boxSize,function(b){this.surface=b;a()}.bind(this))):a()}else a()},create:function(){var a=new NGL.SurfaceBuffer(this.surface.getPosition(),this.surface.getColor(this.getColorParams()),this.surface.getIndex(),this.surface.getNormal(),void 0,this.getBufferParams({background:this.background,opaqueBack:this.opaqueBack,dullInterior:!1})),a=new NGL.DoubleSidedBuffer(a);this.bufferList.push(a)},update:function(a){if(0!==this.bufferList.length){a=a||{};var b={};a.position&&(b.position=
this.surface.getPosition());a.color&&(b.color=this.surface.getColor(this.getColorParams()));a.index&&(b.index=this.surface.getIndex());a.normal&&(b.normal=this.surface.getNormal());this.bufferList.forEach(function(a){a.setAttributes(b)})}},setParameters:function(a,b,c){a&&void 0!==a.isolevelType&&this.volume&&("value"===this.isolevelType&&"sigma"===a.isolevelType?this.isolevel=this.volume.getSigmaForValue(this.isolevel):"sigma"===this.isolevelType&&"value"===a.isolevelType&&(this.isolevel=this.volume.getValueForSigma(this.isolevel)),
this.isolevelType=a.isolevelType);a&&a.boxCenter&&(this.boxCenter.copy(a.boxCenter),delete a.boxCenter);NGL.Representation.prototype.setParameters.call(this,a,b,c);this.volume.getBox(this.boxCenter,this.boxSize,this.box);this.surface&&(void 0!==a.isolevel||void 0!==a.smooth||void 0!==a.boxSize||0<this.boxSize&&!this.__box.equals(this.box))&&this.build({__update:{position:!0,color:!0,index:!0,normal:!0}});return this},dispose:function(){this.viewer.signals.orientationChanged.remove(this.setBox);NGL.Representation.prototype.dispose.call(this)}});
NGL.DotRepresentation=function(a,b,c){NGL.Representation.call(this,a,b,c);a instanceof NGL.Volume?(this.surface=void 0,this.volume=a):(this.surface=a,this.volume=void 0);this.build()};
NGL.DotRepresentation.prototype=NGL.createObject(NGL.Representation.prototype,{constructor:NGL.DotRepresentation,type:"dot",parameters:Object.assign({thresholdType:{type:"select",rebuild:!0,options:{value:"value",sigma:"sigma"}},thresholdMin:{type:"number",precision:3,max:1E3,min:-1E3,rebuild:!0},thresholdMax:{type:"number",precision:3,max:1E3,min:-1E3,rebuild:!0},thresholdOut:{type:"boolean",rebuild:!0},dotType:{type:"select",rebuild:!0,options:{"":"",sphere:"sphere",point:"point"}},radiusType:{type:"select",
options:{"":"",value:"value","abs-value":"abs-value","value-min":"value-min",deviation:"deviation",size:"size"}},radius:{type:"number",precision:3,max:10,min:.001,property:"size"},scale:{type:"number",precision:3,max:10,min:.001},sort:{type:"boolean",rebuild:!0},sphereDetail:{type:"integer",max:3,min:0,rebuild:"impostor"}},NGL.Representation.prototype.parameters,{colorScheme:{type:"select",update:"color",options:{"":"",value:"value",uniform:"uniform"}}}),defaultSize:.1,init:function(a){a=a||{};a.colorScheme=
a.colorScheme||"uniform";a.colorValue=a.colorValue||14540253;this.disableImpostor=a.disableImpostor||!1;this.sphereDetail="low"===a.quality?0:"medium"===a.quality?1:"high"===a.quality?2:a.sphereDetail||1;this.thresholdType=void 0!==a.thresholdType?a.thresholdType:"sigma";this.thresholdMin=void 0!==a.thresholdMin?a.thresholdMin:2;this.thresholdMax=void 0!==a.thresholdMax?a.thresholdMax:Infinity;this.thresholdOut=void 0!==a.thresholdOut?a.thresholdOut:!1;this.dotType=void 0!==a.dotType?a.dotType:"point";
this.radius=void 0!==a.radius?a.radius:.1;this.scale=void 0!==a.scale?a.scale:1;this.sort=void 0!==a.sort?a.sort:!1;NGL.Representation.prototype.init.call(this,a)},attach:function(a){this.bufferList.forEach(function(a){this.viewer.add(a)},this);this.setVisibility(this.visible);a()},create:function(){var a,b,c,d;this.volume?("sigma"===this.thresholdType?(a=this.volume.getValueForSigma(this.thresholdMin),b=this.volume.getValueForSigma(this.thresholdMax)):(a=this.thresholdMin,b=this.thresholdMax),this.volume.filterData(a,
b,this.thresholdOut),a=this.volume.getDataPosition(),b=this.volume.getDataColor(this.getColorParams()),c=this.volume.getDataSize(this.radius,this.scale),d=this.volume.getPickingDataColor(this.getColorParams())):(a=this.surface.getPosition(),b=this.surface.getColor(this.getColorParams()),c=this.surface.getSize(this.radius,this.scale),d=this.surface.getPickingColor(this.getColorParams()));this.dotBuffer="sphere"===this.dotType?new NGL.SphereBuffer(a,b,c,d,this.getBufferParams({sphereDetail:this.sphereDetail,
dullInterior:!1}),this.disableImpostor):new NGL.PointBuffer(a,b,this.getBufferParams({pointSize:this.radius,sizeAttenuation:!0,sort:this.sort}));this.bufferList.push(this.dotBuffer)},update:function(a){if(0!==this.bufferList.length){a=a||{};var b={};a.color&&(b.color=this.volume?this.volume.getDataColor(this.getColorParams()):this.surface.getColor(this.getColorParams()));"sphere"===this.dotType&&(a.radius||a.scale)&&(b.radius=this.volume?this.volume.getDataSize(this.radius,this.scale):this.surface.getSize(this.radius,
this.scale));this.dotBuffer.setAttributes(b)}},setParameters:function(a,b,c){b=b||{};a&&void 0!==a.thresholdType&&this.volume instanceof NGL.Volume&&("value"===this.thresholdType&&"sigma"===a.thresholdType?(this.thresholdMin=this.volume.getSigmaForValue(this.thresholdMin),this.thresholdMax=this.volume.getSigmaForValue(this.thresholdMax)):"sigma"===this.thresholdType&&"value"===a.thresholdType&&(this.thresholdMin=this.volume.getValueForSigma(this.thresholdMin),this.thresholdMax=this.volume.getValueForSigma(this.thresholdMax)),
this.thresholdType=a.thresholdType);a&&void 0!==a.radiusType&&(this.radius="radius"===a.radiusType?this.defaultSize:a.radiusType,b.radius=!0,"sphere"!==this.dotType||NGL.extensionFragDepth&&!this.disableImpostor||(c=!0));a&&void 0!==a.radius&&(b.radius=!0,"sphere"!==this.dotType||NGL.extensionFragDepth&&!this.disableImpostor||(c=!0));a&&void 0!==a.scale&&(b.scale=!0,"sphere"!==this.dotType||NGL.extensionFragDepth&&!this.disableImpostor||(c=!0));NGL.Representation.prototype.setParameters.call(this,
a,b,c);return this}});(function(){NGL.representationTypes={};var a=[],b;for(b in NGL){var c=NGL[b];c.prototype instanceof NGL.StructureRepresentation&&c.prototype.type&&a.push(c)}a.sort(function(a,b){return a.prototype.type.localeCompare(b.prototype.type)}).forEach(function(a){NGL.representationTypes[a.prototype.type]=a})})();
NGL.Stage=function(a){var b=signals;this.signals={themeChanged:new b.Signal,componentAdded:new b.Signal,componentRemoved:new b.Signal,atomPicked:new b.Signal,bondPicked:new b.Signal,volumePicked:new b.Signal,nothingPicked:new b.Signal,onPicking:new b.Signal,requestTheme:new b.Signal};this.tasks=new NGL.Counter;this.compList=[];this.preferences=new NGL.Preferences(this);this.viewer=new NGL.Viewer(a);this.preferences.setTheme();this.defaultFileParams={};this.initFileDragDrop();this.viewer.animate();
this.pickingControls=new NGL.PickingControls(this.viewer,this)};
NGL.Stage.prototype={constructor:NGL.Stage,defaultFileRepresentation:function(a){a instanceof NGL.StructureComponent?(1E5<a.structure.atomCount?a.addRepresentation("line"):(a.addRepresentation("cartoon",{sele:"*"}),a.addRepresentation("licorice",{sele:"hetero"})),a.centerView(!0),a.structure.frames.length&&a.addTrajectory()):a instanceof NGL.SurfaceComponent&&(a.addRepresentation("surface"),a.centerView())},initFileDragDrop:function(){this.viewer.container.addEventListener("dragover",function(a){a.stopPropagation();
a.preventDefault();a.dataTransfer.dropEffect="copy"},!1);this.viewer.container.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();a=a.dataTransfer.files;for(var b=a.length,c=0;c<b;++c)this.loadFile(a[c])}.bind(this),!1)},loadFile:function(a,b){var c=Object.assign({},this.defaultFileParams,b),d=new NGL.Component(this,c);d.name=NGL.getFileInfo(a).name;this.addComponent(d);var e=function(a){this.removeComponent(d);d=this.addComponentFromObject(a,c);d instanceof NGL.ScriptComponent&&
d.run();c.defaultRepresentation&&this.defaultFileRepresentation(d);return d}.bind(this);return NGL.autoLoad(a,c).then(e,function(a){d.setStatus(a);throw a;})},addComponent:function(a){a?(this.compList.push(a),this.signals.componentAdded.dispatch(a)):NGL.warn("NGL.Stage.addComponent: no component given")},addComponentFromObject:function(a,b){var c=NGL.makeComponent(this,a,b);this.addComponent(c);return c},removeComponent:function(a){var b=this.compList.indexOf(a);-1!==b&&this.compList.splice(b,1);
a.dispose();this.signals.componentRemoved.dispatch(a)},removeAllComponents:function(a){this.compList.slice().forEach(function(b,c){(!a||b instanceof a)&&this.removeComponent(b)},this)},handleResize:function(){this.viewer.handleResize()},centerView:function(){if(0<this.tasks.count){var a=function(b,c){0===c&&this.tasks.signals.countChanged.remove(a,this);this.viewer.centerView(!0)};this.tasks.signals.countChanged.add(a,this)}this.viewer.centerView(!0)},setOrientation:function(a){this.tasks.onZeroOnce(function(){this.viewer.setOrientation(a)},
this)},getOrientation:function(){return this.viewer.getOrientation()},exportImage:function(a,b,c,d,e){var f=[];this.tasks.onZeroOnce(function(){this.viewer.screenshot({factor:a,type:"image/png",quality:1,antialias:b,transparent:c,trim:d,onProgress:function(a,b,c){"function"===typeof e&&e(a,b,c);c&&f.forEach(function(a){a.repr.setParameters(a.params)})}})},this)},setTheme:function(a){var b;b="light"===a?"white":"black";this.signals.requestTheme.dispatch(a);this.viewer.setBackground(b)},eachComponent:function(a,
b){this.compList.forEach(function(c,d){(!b||c instanceof b)&&a(c,d)})},eachRepresentation:function(a,b){this.eachComponent(function(b){b.reprList.forEach(function(d){a(d,b)})},b)},getComponentsByName:function(a,b){var c=[];this.eachComponent(function(b){void 0!==a&&null===b.name.match(a)||c.push(b)},b);return new NGL.ComponentCollection(c)},getRepresentationsByName:function(a,b){var c,d;"object"!==typeof a?(c=void 0,d=a):(c=a.comp,d=a.repr);var e=[];this.eachRepresentation(function(a,b){if(void 0===
c||null!==b.name.match(c))void 0!==d&&null===a.name.match(d)||e.push(a)},b);return new NGL.RepresentationCollection(e)},getAnythingByName:function(a){var b=this.getComponentsByName(a).list;a=this.getRepresentationsByName(a).list;return new NGL.Collection(b.concat(a))},dispose:function(){this.tasks.dispose()}};
NGL.PickingControls=function(a,b){var c=new THREE.Vector3,d={position:new THREE.Vector2,down:new THREE.Vector2,moving:!1,distance:function(){return d.position.distanceTo(d.down)}};a.renderer.domElement.addEventListener("mousemove",function(a){a.preventDefault();d.moving=!0;d.position.x=a.layerX;d.position.y=a.layerY});a.renderer.domElement.addEventListener("mousedown",function(a){a.preventDefault();d.moving=!1;d.down.x=a.layerX;d.down.y=a.layerY});a.renderer.domElement.addEventListener("mouseup",
function(e){e.preventDefault();if(!(3<d.distance()||e.which===NGL.RightMouseButton)){var f=a.renderer.domElement.getBoundingClientRect(),g=a.pick(e.clientX-f.left,f.height-(e.clientY-f.top)),f=g.instance,h=void 0,k=void 0,l=void 0,g=NGL.GidPool.getByGid(g.gid);g instanceof NGL.Atom||g instanceof NGL.ProxyAtom?h=g:g instanceof NGL.Bond?k=g:g&&g.volume instanceof NGL.Volume&&(l=g);(h||k||l)&&e.which===NGL.MiddleMouseButton&&(h?c.copy(h):k?c.set(0,0,0).addVectors(k.atom1,k.atom2).multiplyScalar(.5):
l&&c.copy(l),f&&c.applyProjection(f.matrix),a.centerView(!1,c));h?b.signals.atomPicked.dispatch(h):k?b.signals.bondPicked.dispatch(k):l?b.signals.volumePicked.dispatch(l):b.signals.nothingPicked.dispatch();b.signals.onPicking.dispatch({atom:h,bond:k,volume:l,instance:f});NGL.debug&&(NGL.log("picked atom",h),NGL.log("picked bond",k),NGL.log("picked volume",l))}})};
NGL.Preferences=function(a,b){this.id=b||"ngl-stage";this.stage=a;this.storage={impostor:!0,quality:"medium",theme:"dark",overview:!0};try{if(void 0===window.localStorage[this.id])window.localStorage[this.id]=JSON.stringify(this.storage);else{var c=JSON.parse(window.localStorage[this.id]),d;for(d in c)this.storage[d]=c[d]}}catch(e){NGL.error("localStorage not accessible/available")}};
NGL.Preferences.prototype={constructor:NGL.Preferences,setImpostor:function(a){void 0!==a?this.setKey("impostor",a):a=this.getKey("impostor");var b="spacefill ball+stick licorice hyperball backbone rocket crossing contact dot".split(" ");this.stage.eachRepresentation(function(c){if(!(c instanceof NGL.ScriptComponent)&&-1!==b.indexOf(c.getType())){var d=c.getParameters();d.disableImpostor=!a;c.build(d)}})},setQuality:function(a){void 0!==a?this.setKey("quality",a):a=this.getKey("quality");var b=["tube",
"cartoon","ribbon","trace","rope"],c="spacefill ball+stick licorice hyperball backbone rocket crossing contact dot".split(" ");this.stage.eachRepresentation(function(d){if(!(d instanceof NGL.ScriptComponent)){var e=d.getParameters();if(-1===b.indexOf(d.getType())){if(-1===c.indexOf(d.getType()))return;if(NGL.extensionFragDepth&&!e.disableImpostor){d.repr.quality=a;return}}e.quality=a;d.build(e)}})},setTheme:function(a){void 0!==a?this.setKey("theme",a):a=this.getKey("theme");this.stage.setTheme(a)},
getKey:function(a){return this.storage[a]},setKey:function(a,b){this.storage[a]=b;try{window.localStorage[this.id]=JSON.stringify(this.storage)}catch(c){22===c.code||1014===c.code?NGL.error("localStorage full"):NGL.error("localStorage not accessible/available")}},clear:function(){try{delete window.localStorage[this.id]}catch(a){NGL.error("localStorage not accessible/available")}}};
NGL.makeComponent=function(a,b,c){var d;b instanceof NGL.Structure?d=new NGL.StructureComponent(a,b,c):b instanceof NGL.Surface||b instanceof NGL.Volume?d=new NGL.SurfaceComponent(a,b,c):b instanceof NGL.Script?d=new NGL.ScriptComponent(a,b,c):NGL.warn("NGL.makeComponent: object type unknown",b);return d};NGL.nextComponentId=0;
NGL.Component=function(a,b){Object.defineProperty(this,"id",{value:NGL.nextComponentId++});var c=b||{};this.name=c.name;this.uuid=THREE.Math.generateUUID();this.visible=void 0!==c.visible?c.visible:!0;c=Object.keys(this.signals);this.signals={};c.forEach(function(a){this.signals[a]=new signals.Signal},this);this.stage=a;this.viewer=a.viewer;this.reprList=[]};
NGL.Component.prototype={constructor:NGL.Component,type:"component",signals:{representationAdded:null,representationRemoved:null,visibilityChanged:null,requestGuiVisibility:null,statusChanged:null,nameChanged:null,disposed:null},addRepresentation:function(a,b,c){var d=this.stage.preferences;c=c||{};c.quality=c.quality||d.getKey("quality");c.disableImpostor=void 0!==c.disableImpostor?c.disableImpostor:!d.getKey("impostor");c.visible=void 0!==c.visible?c.visible:!0;d=Object.assign({},c,{visible:this.visible&&
c.visible});a=NGL.makeRepresentation(a,b,this.viewer,d);a=new NGL.RepresentationComponent(this.stage,a,c,this);this.reprList.push(a);this.signals.representationAdded.dispatch(a);return a},addBufferRepresentation:function(a,b){return NGL.Component.prototype.addRepresentation.call(this,"buffer",a,b)},removeRepresentation:function(a){var b=this.reprList.indexOf(a);-1!==b&&this.reprList.splice(b,1);this.signals.representationRemoved.dispatch(a)},updateRepresentations:function(a){this.reprList.forEach(function(b){b.update(a)});
this.stage.viewer.requestRender()},dispose:function(){this.reprList.slice().forEach(function(a){a.dispose()});delete this.reprList;this.signals.disposed.dispatch()},setVisibility:function(a){this.visible=a;this.eachRepresentation(function(a){a.updateVisibility()});this.signals.visibilityChanged.dispatch(a);return this},setStatus:function(a){this.status=a;this.signals.statusChanged.dispatch(a);return this},setName:function(a){this.name=a;this.signals.nameChanged.dispatch(a);return this},getCenter:function(){},
requestGuiVisibility:function(a){this.signals.requestGuiVisibility.dispatch(a);return this},eachRepresentation:function(a){this.reprList.forEach(a)}};NGL.StructureComponent=function(a,b,c){c=c||{};c.name=void 0!==c.name?c.name:b.name;NGL.Component.call(this,a,c);this.structure=this.__structure=b;this.trajList=[];this.initSelection(c.sele);void 0!==c.assembly&&this.structure.setDefaultAssembly(c.assembly)};
NGL.StructureComponent.prototype=NGL.createObject(NGL.Component.prototype,{constructor:NGL.StructureComponent,type:"structure",signals:Object.assign({trajectoryAdded:null,trajectoryRemoved:null},NGL.Component.prototype.signals),initSelection:function(a){this.selection=new NGL.Selection(a);this.selection.signals.stringChanged.add(function(a){this.applySelection();this.rebuildRepresentations(!0);this.rebuildTrajectories()},this);this.applySelection()},applySelection:function(){this.structure=this.selection.string?
new NGL.StructureSubset(this.__structure,this.selection):this.__structure},setSelection:function(a){this.selection.setString(a);return this},rebuildRepresentations:function(a){this.reprList.forEach(function(b){a&&b.setStructure(this.structure);b.build(b.getParameters())},this)},rebuildTrajectories:function(){this.trajList.slice(0).forEach(function(a){a.trajectory.setStructure(this.structure)},this)},addRepresentation:function(a,b){return NGL.Component.prototype.addRepresentation.call(this,a,this.structure,
b)},addTrajectory:function(a,b,c){c={i:c};a=NGL.makeTrajectory(a,this.structure,b);a.signals.frameChanged.add(function(a){this.updateRepresentations({position:!0})},this);a=new NGL.TrajectoryComponent(this.stage,a,c,this);this.trajList.push(a);this.signals.trajectoryAdded.dispatch(a);return a},removeTrajectory:function(a){var b=this.trajList.indexOf(a);-1!==b&&this.trajList.splice(b,1);a.dispose();this.signals.trajectoryRemoved.dispatch(a)},dispose:function(){this.trajList.slice().forEach(function(a){a.dispose()});
this.trajList=[];this.structure.dispose();this.__structure.dispose();NGL.Component.prototype.dispose.call(this)},centerView:function(a,b){var c;if(b){var d=new NGL.Selection(b);c=this.structure.atomCenter(d);a&&(a=this.structure.getBoundingBox(d).size().length())}else c=this.structure.center,a&&(a=this.structure.boundingBox.size().length());this.viewer.centerView(a,c);return this},getCenter:function(){return this.structure.center},superpose:function(a,b,c,d,e,f){NGL.superpose(this.structure,a.structure,
b,c,d,e,f);this.structure!==this.__structure&&NGL.superpose(this.__structure,a.structure,b,c,d,e,f);this.updateRepresentations({position:!0});return this},setVisibility:function(a){NGL.Component.prototype.setVisibility.call(this,a);this.trajList.forEach(function(b){b.setVisibility(a)});return this}});NGL.SurfaceComponent=function(a,b,c){c=c||{};c.name=void 0!==c.name?c.name:b.name;NGL.Component.call(this,a,c);this.surface=b};
NGL.SurfaceComponent.prototype=NGL.createObject(NGL.Component.prototype,{constructor:NGL.SurfaceComponent,type:"surface",addRepresentation:function(a,b){return NGL.Component.prototype.addRepresentation.call(this,a,this.surface,b)},dispose:function(){this.surface.dispose();NGL.Component.prototype.dispose.call(this)},centerView:function(a){var b=this.surface.center;a&&(a=this.surface.boundingBox.size().length());this.viewer.centerView(a,b)}});
NGL.TrajectoryComponent=function(a,b,c,d){c=c||{};c.name=void 0!==c.name?c.name:b.name;NGL.Component.call(this,a,c);this.trajectory=b;this.parent=d;this.status="loaded";b.signals.frameChanged.add(function(a){this.signals.frameChanged.dispatch(a)},this);b.signals.playerChanged.add(function(a){this.signals.playerChanged.dispatch(a)},this);b.signals.gotNumframes.add(function(a){this.signals.gotNumframes.dispatch(a)},this);void 0!==c.i&&this.setFrame(c.i)};
NGL.TrajectoryComponent.prototype=NGL.createObject(NGL.Component.prototype,{constructor:NGL.TrajectoryComponent,type:"trajectory",signals:Object.assign({frameChanged:null,playerChanged:null,gotNumframes:null,parametersChanged:null},NGL.Component.prototype.signals),addRepresentation:function(a,b){return NGL.Component.prototype.addRepresentation.call(this,a,this.trajectory,b)},setFrame:function(a){this.trajectory.setFrame(a)},setParameters:function(a){this.trajectory.setParameters(a);this.signals.parametersChanged.dispatch(a);
return this},dispose:function(){this.trajectory.dispose();NGL.Component.prototype.dispose.call(this)},getCenter:function(){}});NGL.ScriptComponent=function(a,b,c){c=c||{};c.name=void 0!==c.name?c.name:b.name;NGL.Component.call(this,a,c);this.script=b;this.status="loaded";this.script.signals.nameChanged.add(function(a){this.setName(a)},this)};
NGL.ScriptComponent.prototype=NGL.createObject(NGL.Component.prototype,{constructor:NGL.ScriptComponent,type:"script",addRepresentation:function(a){},removeRepresentation:function(a){},run:function(){var a=this;this.setStatus("running");this.script.call(this.stage,function(){a.setStatus("finished")});this.setStatus("called")},dispose:function(){this.signals.disposed.dispatch()},setVisibility:function(a){},getCenter:function(){}});
NGL.RepresentationComponent=function(a,b,c,d){c=c||{};c.name=void 0!==c.name?c.name:b.type;NGL.Component.call(this,a,c);this.parent=d;this.setRepresentation(b)};
NGL.RepresentationComponent.prototype=NGL.createObject(NGL.Component.prototype,{constructor:NGL.RepresentationComponent,type:"representation",signals:Object.assign({parametersChanged:null},NGL.Component.prototype.signals),getType:function(){return this.repr.type},setRepresentation:function(a){this.repr&&this.repr.dispose();this.repr=a;this.stage.tasks.listen(this.repr.tasks);this.updateVisibility()},addRepresentation:function(a){},removeRepresentation:function(a){},dispose:function(){this.parent&&
this.parent.removeRepresentation(this);this.repr.dispose();this.signals.disposed.dispatch()},setVisibility:function(a){this.visible=a;this.updateVisibility();this.signals.visibilityChanged.dispatch(this.visible);return this},updateVisibility:function(){this.parent?this.repr.setVisibility(this.parent.visible&&this.visible):this.repr.setVisibility(this.visible)},update:function(a){this.repr.update(a);return this},build:function(a){this.repr.build(a);return this},setStructure:function(a){this.repr.setStructure(a);
return this},setSelection:function(a){this.repr.setSelection(a);return this},setParameters:function(a){this.repr.setParameters(a);this.signals.parametersChanged.dispatch(this.repr.getParameters());return this},getParameters:function(){return this.repr.getParameters()},setColor:function(a){this.repr.setColor(a);return this},getCenter:function(){}});
NGL.Collection=function(a){this.list=a||[];a=this.list.length;for(var b=0;b<a;++b){var c=this.list[b];c.signals.disposed.add(function(){this._remove(c)},this)}};
NGL.Collection.prototype={constructor:NGL.Collection,_remove:function(a){a=this.list.indexOf(a);-1!==a&&this.list.splice(a,1)},_invoke:function(a,b){for(var c=this.list.length,d=0;d<c;++d){var e=this.list[d],f=e[a];"function"===typeof f&&f.apply(e,b)}return this},setVisibility:function(a){return this._invoke("setVisibility",[a])},setSelection:function(a){return this._invoke("setSelection",[a])},requestGuiVisibility:function(a){return this._invoke("requestGuiVisibility",[a])},dispose:function(){return this._invoke("dispose")}};
NGL.ComponentCollection=function(a){NGL.Collection.call(this,a)};NGL.ComponentCollection.prototype=NGL.createObject(NGL.Collection.prototype,{constructor:NGL.ComponentCollection,addRepresentation:function(a,b){return this._invoke("addRepresentation",[a,b])},centerView:function(a,b){return this._invoke("centerView",[a,b])}});NGL.RepresentationCollection=function(a){NGL.Collection.call(this,a)};
NGL.RepresentationCollection.prototype=NGL.createObject(NGL.Collection.prototype,{constructor:NGL.RepresentationCollection,setParameters:function(a){return this._invoke("setParameters",[a])},setColor:function(a){return this._invoke("setColor",[a])}});NGL.Resources["shader/CylinderImpostor.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\n\n// Open-Source PyMOL is Copyright (C) Schrodinger, LLC.\n\n//  All Rights Reserved\n\n//  Permission to use, copy, modify, distribute, and distribute modified\n//  versions of this software and its built-in documentation for any\n//  purpose and without fee is hereby granted, provided that the above\n//  copyright notice appears in all copies and that both the copyright\n//  notice and this permission notice appear in supporting documentation,\n//  and that the name of Schrodinger, LLC not be used in advertising or\n//  publicity pertaining to distribution of the software without specific,\n//  written prior permission.\n\n//  SCHRODINGER, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,\n//  INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN\n//  NO EVENT SHALL SCHRODINGER, LLC BE LIABLE FOR ANY SPECIAL, INDIRECT OR\n//  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n//  OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n//  OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\n//  USE OR PERFORMANCE OF THIS SOFTWARE.\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n// - shift\n\nattribute vec3 mapping;\nattribute vec3 position1;\nattribute vec3 position2;\nattribute float radius;\n\nvarying vec3 axis;\nvarying vec4 base_radius;\nvarying vec4 end_b;\nvarying vec3 U;\nvarying vec3 V;\nvarying vec4 w;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    attribute vec3 pickingColor2;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    attribute vec3 color;\n    attribute vec3 color2;\n    varying vec3 vColor;\n    varying vec3 vColor2;\n#endif\n\nuniform mat4 modelViewMatrixInverse;\nuniform float shift;\n\n\nvoid main()\n{\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n        vPickingColor2 = pickingColor2;\n    #else\n        vColor = color;\n        vColor2 = color2;\n    #endif\n\n    // vRadius = radius;\n    base_radius.w = radius;\n\n    vec3 center = position;\n    vec3 dir = normalize( position2 - position1 );\n    float ext = length( position2 - position1 ) / 2.0;\n\n    vec3 cam_dir = normalize(\n        ( modelViewMatrixInverse * vec4( 0, 0, 0, 1 ) ).xyz - center\n    );\n\n    vec3 ldir;\n\n    float b = dot( cam_dir, dir );\n    end_b.w = b;\n    if( b < 0.0 ) // direction vector looks away, so flip\n        ldir = -ext * dir;\n    else // direction vector already looks in my direction\n        ldir = ext * dir;\n\n    vec3 left = normalize( cross( cam_dir, ldir ) );\n    vec3 leftShift = shift * left * radius;\n    if( b < 0.0 )\n        leftShift *= -1.0;\n    left = radius * left;\n    vec3 up = radius * normalize( cross( left, ldir ) );\n\n    // transform to modelview coordinates\n    axis = normalize( normalMatrix * ldir );\n    U = normalize( normalMatrix * up );\n    V = normalize( normalMatrix * left );\n\n    vec4 base4 = modelViewMatrix * vec4( center - ldir + leftShift, 1.0 );\n    base_radius.xyz = base4.xyz / base4.w;\n\n    vec4 top_position = modelViewMatrix * vec4( center + ldir + leftShift, 1.0 );\n    vec4 end4 = top_position;\n    end_b.xyz = end4.xyz / end4.w;\n\n    w = modelViewMatrix * vec4(\n        center + leftShift + mapping.x*ldir + mapping.y*left + mapping.z*up, 1.0\n    );\n\n    gl_Position = projectionMatrix * w;\n\n    // avoid clipping\n    gl_Position.z = 1.0;\n\n}\n\n\n";
NGL.Resources["shader/CylinderImpostor.frag"]="\n#extension GL_EXT_frag_depth : enable\n\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\n// Open-Source PyMOL is Copyright (C) Schrodinger, LLC.\n\n//  All Rights Reserved\n\n//  Permission to use, copy, modify, distribute, and distribute modified\n//  versions of this software and its built-in documentation for any\n//  purpose and without fee is hereby granted, provided that the above\n//  copyright notice appears in all copies and that both the copyright\n//  notice and this permission notice appear in supporting documentation,\n//  and that the name of Schrodinger, LLC not be used in advertising or\n//  publicity pertaining to distribution of the software without specific,\n//  written prior permission.\n\n//  SCHRODINGER, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,\n//  INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN\n//  NO EVENT SHALL SCHRODINGER, LLC BE LIABLE FOR ANY SPECIAL, INDIRECT OR\n//  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n//  OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n//  OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\n//  USE OR PERFORMANCE OF THIS SOFTWARE.\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n\nuniform float opacity;\nuniform float nearClip;\n\nuniform mat4 projectionMatrix;\n// uniform mat3 normalMatrix;\n\nvarying vec3 axis;\nvarying vec4 base_radius;\nvarying vec4 end_b;\nvarying vec3 U;\nvarying vec3 V;\nvarying vec4 w;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    varying vec3 vColor;\n    varying vec3 vColor2;\n#endif\n\n#include light_params\n\n#include fog_params\n\n\nfloat distSq3( vec3 v3a, vec3 v3b ){\n\n    return (\n        ( v3a.x - v3b.x ) * ( v3a.x - v3b.x ) +\n        ( v3a.y - v3b.y ) * ( v3a.y - v3b.y ) +\n        ( v3a.z - v3b.z ) * ( v3a.z - v3b.z )\n    );\n\n}\n\n\n// round caps\n// http://sourceforge.net/p/pymol/code/HEAD/tree/trunk/pymol/data/shaders/cylinder.fs\n\n\n// void main2(void)\n// {\n//     #ifdef PICKING\n//         gl_FragColor = vec4( vPickingColor, 1.0 );\n//     #else\n//         gl_FragColor = vec4( vColor, 1.0 );\n//     #endif\n// }\n\n// Calculate depth based on the given camera position.\nfloat calcDepth( in vec3 cameraPos )\n{\n    vec2 clipZW = cameraPos.z * projectionMatrix[2].zw + projectionMatrix[3].zw;\n    return 0.5 + 0.5 * clipZW.x / clipZW.y;\n}\n\n\nfloat calcClip( vec3 cameraPos )\n{\n    return dot( vec4( cameraPos, 1.0 ), vec4( 0.0, 0.0, 1.0, nearClip - 0.5 ) );\n}\n\n\nvoid main()\n{\n    vec3 point = w.xyz / w.w;\n\n    // unpacking\n    vec3 base = base_radius.xyz;\n    float vRadius = base_radius.w;\n    vec3 end = end_b.xyz;\n    float b = end_b.w;\n\n    vec3 end_cyl = end;\n    vec3 surface_point = point;\n\n    const float ortho=0.0;\n\n    vec3 ray_target = surface_point;\n    vec3 ray_origin = vec3(0.0);\n    vec3 ray_direction = mix(normalize(ray_origin - ray_target), vec3(0.0, 0.0, 1.0), ortho);\n    mat3 basis = mat3( U, V, axis );\n\n    vec3 diff = ray_target - 0.5 * (base + end_cyl);\n    vec3 P = diff * basis;\n\n    // angle (cos) between cylinder cylinder_axis and ray direction\n    float dz = dot( axis, ray_direction );\n\n    float radius2 = vRadius*vRadius;\n\n    // calculate distance to the cylinder from ray origin\n    vec3 D = vec3(dot(U, ray_direction),\n                dot(V, ray_direction),\n                dz);\n    float a0 = P.x*P.x + P.y*P.y - radius2;\n    float a1 = P.x*D.x + P.y*D.y;\n    float a2 = D.x*D.x + D.y*D.y;\n\n    // calculate a dicriminant of the above quadratic equation\n    float d = a1*a1 - a0*a2;\n    if (d < 0.0)\n        // outside of the cylinder\n        discard;\n\n    float dist = (-a1 + sqrt(d)) / a2;\n\n    // point of intersection on cylinder surface\n    vec3 new_point = ray_target + dist * ray_direction;\n\n    vec3 tmp_point = new_point - base;\n    vec3 normal = normalize( tmp_point - axis * dot(tmp_point, axis) );\n\n    ray_origin = mix( ray_origin, surface_point, ortho );\n\n    // test front cap\n    float cap_test = dot( new_point - base, axis );\n\n    // to calculate caps, simply check the angle between\n    // the point of intersection - cylinder end vector\n    // and a cap plane normal (which is the cylinder cylinder_axis)\n    // if the angle < 0, the point is outside of cylinder\n    // test front cap\n\n    #ifndef CAP\n        vec3 new_point2 = ray_target + ( (-a1 - sqrt(d)) / a2 ) * ray_direction;\n        vec3 tmp_point2 = new_point2 - base;\n    #endif\n\n    // flat\n    if (cap_test < 0.0)\n    {\n        // ray-plane intersection\n        float dNV = dot(-axis, ray_direction);\n        if (dNV < 0.0)\n            discard;\n        float near = dot(-axis, (base)) / dNV;\n        new_point = ray_direction * near + ray_origin;\n        // within the cap radius?\n        if (dot(new_point - base, new_point-base) > radius2)\n            discard;\n\n        #ifdef CAP\n            normal = axis;\n        #else\n            normal = -normalize( tmp_point2 - axis * dot(tmp_point2, axis) );\n        #endif\n    }\n\n    // test end cap\n    cap_test = dot((new_point - end_cyl), axis);\n\n    // flat\n    if( cap_test > 0.0 )\n    {\n        // ray-plane intersection\n        float dNV = dot(axis, ray_direction);\n        if (dNV < 0.0)\n            discard;\n        float near = dot(axis, end_cyl) / dNV;\n        new_point = ray_direction * near + ray_origin;\n        // within the cap radius?\n        if( dot(new_point - end_cyl, new_point-base) > radius2 )\n            discard;\n\n        #ifdef CAP\n            normal = axis;\n        #else\n            normal = -normalize( tmp_point2 - axis * dot(tmp_point2, axis) );\n        #endif\n    }\n\n    gl_FragDepthEXT = calcDepth( new_point );\n\n    #ifdef NEAR_CLIP\n        if( calcClip( new_point ) > 0.0 ){\n            dist = (-a1 - sqrt(d)) / a2;\n            new_point = ray_target + dist * ray_direction;\n            if( calcClip( new_point ) > 0.0 )\n                discard;\n            normal = vec3( 0.0, 0.0, 0.4 );\n            gl_FragDepthEXT = calcDepth( new_point );\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = max( 0.0, calcDepth( vec3( - ( nearClip - 0.5 ) ) ) + ( 0.0000001 / vRadius ) );\n            }\n        }else if( gl_FragDepthEXT <= 0.0 ){\n            dist = (-a1 - sqrt(d)) / a2;\n            new_point = ray_target + dist * ray_direction;\n            normal = vec3( 0.0, 0.0, 0.4 );\n            gl_FragDepthEXT = calcDepth( new_point );\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / vRadius );\n            }\n        }\n    #else\n        if( gl_FragDepthEXT <= 0.0 ){\n            dist = (-a1 - sqrt(d)) / a2;\n            new_point = ray_target + dist * ray_direction;\n            normal = vec3( 0.0, 0.0, 0.4 );\n            gl_FragDepthEXT = calcDepth( new_point );\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / vRadius );\n            }\n        }\n    #endif\n\n    // this is a workaround necessary for Mac\n    // otherwise the modified fragment won't clip properly\n    if (gl_FragDepthEXT < 0.0)\n        discard;\n    if (gl_FragDepthEXT > 1.0)\n        discard;\n\n\n    vec3 transformedNormal = normal;\n    vec3 vLightFront = vec3( 0.0, 0.0, 0.0 );\n\n    #include light\n\n    #ifdef PICKING\n        if( distSq3( new_point, end_cyl ) < distSq3( new_point, base ) ){\n            if( b < 0.0 ){\n                gl_FragColor = vec4( vPickingColor, objectId );\n            }else{\n                gl_FragColor = vec4( vPickingColor2, objectId );\n            }\n        }else{\n            if( b > 0.0 ){\n                gl_FragColor = vec4( vPickingColor, objectId );\n            }else{\n                gl_FragColor = vec4( vPickingColor2, objectId );\n            }\n        }\n    #else\n        if( distSq3( new_point, end_cyl ) < distSq3( new_point, base ) ){\n            if( b < 0.0 ){\n                gl_FragColor = vec4( vColor, opacity );\n            }else{\n                gl_FragColor = vec4( vColor2, opacity );\n            }\n        }else{\n            if( b > 0.0 ){\n                gl_FragColor = vec4( vColor, opacity );\n            }else{\n                gl_FragColor = vec4( vColor2, opacity );\n            }\n        }\n        gl_FragColor.rgb *= vLightFront;\n        //gl_FragColor.rgb = transformedNormal;\n    #endif\n\n    // #include fog\n\n    #ifdef USE_FOG\n        float depth = gl_FragDepthEXT / gl_FragCoord.w;\n        #ifdef FOG_EXP2\n            const float LOG2 = 1.442695;\n            float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n            fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n        #else\n            float fogFactor = smoothstep( fogNear, fogFar, depth );\n        #endif\n        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n    #endif\n}\n\n\n\n\n\n\n\n\n";
NGL.Resources["shader/HyperballStickImpostor.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\n// uniform mat4 modelViewMatrix;\n// uniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\n\n// Copyright (C) 2010-2011 by\n// Laboratoire de Biochimie Theorique (CNRS),\n// Laboratoire d'Informatique Fondamentale d'Orleans (Universite d'Orleans), (INRIA) and\n// Departement des Sciences de la Simulation et de l'Information (CEA).\n\n// License: CeCILL-C license (http://www.cecill.info/)\n\n// Contact: Marc Baaden\n// E-mail: baaden@smplinux.de\n// Webpage: http://hyperballs.sourceforge.net\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n\nattribute vec3 mapping;\nattribute float radius;\nattribute float radius2;\nattribute vec3 position1;\nattribute vec3 position2;\n\nvarying mat4 matrix_near;\nvarying vec4 prime1;\nvarying vec4 prime2;\nvarying float vRadius;\nvarying float vRadius2;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    attribute vec3 pickingColor2;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    attribute vec3 color;\n    attribute vec3 color2;\n    varying vec3 vColor;\n    varying vec3 vColor2;\n#endif\n\nuniform float shrink;\nuniform mat4 modelViewProjectionMatrix;\nuniform mat4 modelViewProjectionMatrixInverse;\n\n\nvoid main()\n{\n\n    vRadius = radius;\n    vRadius2 = radius2;\n\n    vec4 spaceposition;\n    vec3 position_atom1;\n    vec3 position_atom2;\n    vec4 vertex_position;\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n        vPickingColor2 = pickingColor2;\n    #else\n        vColor = color;\n        vColor2 = color2;\n    #endif\n\n    float radius1 = radius;\n\n    position_atom1 = position1;\n    position_atom2 = position2;\n\n    float distance = distance( position_atom1, position_atom2 );\n\n    spaceposition.z = mapping.z * distance;\n\n    if (radius1 > radius2) {\n        spaceposition.y = mapping.y * 1.5 * radius1;\n        spaceposition.x = mapping.x * 1.5 * radius1;\n    } else {\n        spaceposition.y = mapping.y * 1.5 * radius2;\n        spaceposition.x = mapping.x * 1.5 * radius2;\n    }\n    spaceposition.w = 1.0;\n\n    vec4 e3 = vec4( 1.0 );\n    vec3 e1, e1_temp, e2, e2_temp;\n\n    // Calculation of bond direction: e3\n    e3.xyz = normalize(position_atom1-position_atom2);\n\n    // little hack to avoid some problems of precision due to graphic card limitation using float: To improve soon\n    if (e3.z == 0.0) { e3.z = 0.0000000000001;}\n    if ( (position_atom1.x - position_atom2.x) == 0.0) { position_atom1.x += 0.001;}\n    if ( (position_atom1.y - position_atom2.y) == 0.0) { position_atom1.y += 0.001;}\n    if ( (position_atom1.z - position_atom2.z) == 0.0) { position_atom1.z += 0.001;}\n\n    // Focus calculation\n    vec4 focus = vec4( 1.0 );\n    focus.x = ( position_atom1.x*position_atom1.x - position_atom2.x*position_atom2.x +\n        ( radius2*radius2 - radius1*radius1 )*e3.x*e3.x/shrink )/(2.0*(position_atom1.x - position_atom2.x));\n    focus.y = ( position_atom1.y*position_atom1.y - position_atom2.y*position_atom2.y +\n        ( radius2*radius2 - radius1*radius1 )*e3.y*e3.y/shrink )/(2.0*(position_atom1.y - position_atom2.y));\n    focus.z = ( position_atom1.z*position_atom1.z - position_atom2.z*position_atom2.z +\n        ( radius2*radius2 - radius1*radius1 )*e3.z*e3.z/shrink )/(2.0*(position_atom1.z - position_atom2.z));\n\n    // e1 calculation\n    e1.x = 1.0;\n    e1.y = 1.0;\n    e1.z = ( (e3.x*focus.x + e3.y*focus.y + e3.z*focus.z) - e1.x*e3.x - e1.y*e3.y)/e3.z;\n    e1_temp = e1 - focus.xyz;\n    e1 = normalize(e1_temp);\n\n    // e2 calculation\n    e2_temp = e1.yzx * e3.zxy - e1.zxy * e3.yzx;\n    e2 = normalize(e2_temp);\n\n    //ROTATION:\n    // final form of change of basis matrix:\n    mat3 R= mat3( e1.xyz, e2.xyz, e3.xyz );\n    // Apply rotation and translation to the bond primitive\n    vertex_position.xyz = R * spaceposition.xyz;\n    vertex_position.w = 1.0;\n\n    // TRANSLATION:\n    vertex_position.x += (position_atom1.x+position_atom2.x) / 2.0;\n    vertex_position.y += (position_atom1.y+position_atom2.y) / 2.0;\n    vertex_position.z += (position_atom1.z+position_atom2.z) / 2.0;\n\n    // New position\n    gl_Position = modelViewProjectionMatrix * vertex_position;\n\n    vec4 i_near, i_far;\n\n    // Calculate near from position\n    vec4 near = gl_Position;\n    near.z = 0.0 ;\n    near = modelViewProjectionMatrixInverse * near;\n    i_near = near;\n\n    // Calculate far from position\n    vec4 far = gl_Position;\n    far.z = far.w ;\n    i_far = modelViewProjectionMatrixInverse * far;\n\n    prime1 = vec4( position_atom1 - (position_atom1 - focus.xyz)*shrink, 1.0 );\n    prime2 = vec4( position_atom2 - (position_atom2 - focus.xyz)*shrink, 1.0 );\n\n    float Rsquare = (radius1*radius1/shrink) - (\n                        (position_atom1.x - focus.x)*(position_atom1.x - focus.x) +\n                        (position_atom1.y - focus.y)*(position_atom1.y - focus.y) +\n                        (position_atom1.z - focus.z)*(position_atom1.z - focus.z)\n                    );\n\n    focus.w = Rsquare;\n\n    matrix_near = mat4( i_near, i_far, focus, e3 );\n\n    // avoid clipping\n    gl_Position.z = 1.0;\n\n}\n\n";
NGL.Resources["shader/HyperballStickImpostor.frag"]="\n#extension GL_EXT_frag_depth : enable\n\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\n// Copyright (C) 2010-2011 by\n// Laboratoire de Biochimie Theorique (CNRS),\n// Laboratoire d'Informatique Fondamentale d'Orleans (Universite d'Orleans), (INRIA) and\n// Departement des Sciences de la Simulation et de l'Information (CEA).\n\n// License: CeCILL-C license (http://www.cecill.info/)\n\n// Contact: Marc Baaden\n// E-mail: baaden@smplinux.de\n// Webpage: http://hyperballs.sourceforge.net\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - picking color\n\n\nvarying mat4 matrix_near;\nvarying vec4 prime1;\nvarying vec4 prime2;\nvarying float vRadius;\nvarying float vRadius2;\n\nuniform float opacity;\nuniform float nearClip;\nuniform float shrink;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelViewProjectionMatrix;\nuniform mat4 modelViewMatrixInverseTranspose;\nuniform mat4 projectionMatrix;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n    varying vec3 vPickingColor2;\n#else\n    varying vec3 vColor;\n    varying vec3 vColor2;\n#endif\n\n#include light_params\n\n#include fog_params\n\n\nfloat calcClip( vec4 cameraPos )\n{\n    return dot( cameraPos, vec4( 0.0, 0.0, 1.0, nearClip - 0.5 ) );\n}\nfloat calcClip( vec3 cameraPos )\n{\n    return calcClip( vec4( cameraPos, 1.0 ) );\n}\n\n\nfloat calcDepth( in vec3 cameraPos )\n{\n    vec2 clipZW = cameraPos.z * projectionMatrix[2].zw + projectionMatrix[3].zw;\n    return 0.5 + 0.5 * clipZW.x / clipZW.y;\n}\n\n\nstruct Ray {\n    vec3 origin ;\n    vec3 direction ;\n};\n\n\nbool cutoff_plane (vec3 M, vec3 cutoff, vec3 x3){\n    float a = x3.x;\n    float b = x3.y;\n    float c = x3.z;\n    float d = -x3.x*cutoff.x-x3.y*cutoff.y-x3.z*cutoff.z;\n    float l = a*M.x+b*M.y+c*M.z+d;\n    if (l<0.0) {return true;}\n    else{return false;}\n}\n\n\nvec3 isect_surf(Ray r, mat4 matrix_coef){\n    vec4 direction = vec4(r.direction, 0.0);\n    vec4 origin = vec4(r.origin, 1.0);\n    float a = dot(direction,(matrix_coef*direction));\n    float b = dot(origin,(matrix_coef*direction));\n    float c = dot(origin,(matrix_coef*origin));\n    float delta =b*b-a*c;\n    gl_FragColor.a = 1.0;\n    if (delta<0.0){\n        discard;\n        // gl_FragColor.a = 0.5;\n    }\n    float t1 =(-b-sqrt(delta))/a;\n\n    // Second solution not necessary if you don't want\n    // to see inside spheres and cylinders, save some fps\n    //float t2 = (-b+sqrt(delta)) / a  ;\n    //float t =(t1<t2) ? t1 : t2;\n\n    return r.origin+t1*r.direction;\n}\n\n\nvec3 isect_surf2(Ray r, mat4 matrix_coef){\n    vec4 direction = vec4(r.direction, 0.0);\n    vec4 origin = vec4(r.origin, 1.0);\n    float a = dot(direction,(matrix_coef*direction));\n    float b = dot(origin,(matrix_coef*direction));\n    float c = dot(origin,(matrix_coef*origin));\n    float delta =b*b-a*c;\n    gl_FragColor.a = 1.0;\n    if (delta<0.0){\n        discard;\n        // gl_FragColor.a = 0.5;\n    }\n    float t2 =(-b+sqrt(delta))/a;\n\n    return r.origin+t2*r.direction;\n}\n\n\nRay primary_ray(vec4 near1, vec4 far1){\n    vec3 near=near1.xyz/near1.w;\n    vec3 far=far1.xyz/far1.w;\n    return Ray(near,far-near);\n}\n\n\nfloat update_z_buffer(vec3 M, mat4 ModelViewP){\n    float  depth1;\n    vec4 Ms=(ModelViewP*vec4(M,1.0));\n    return depth1=(1.0+Ms.z/Ms.w)/2.0;\n}\n\n\n// void main2(void)\n// {\n//     gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n// }\n\n// void main(void)\n// {\n//     #ifdef PICKING\n//         gl_FragColor = vec4( vPickingColor, 1.0 );\n//     #else\n//         gl_FragColor = vec4( vColor, 1.0 );\n//     #endif\n// }\n\n\nvoid main()\n{\n\n    float radius = max( vRadius, vRadius2 );\n\n    vec4 i_near, i_far, focus;\n    vec3 e3, e1, e1_temp, e2;\n\n    i_near = vec4(matrix_near[0][0],matrix_near[0][1],matrix_near[0][2],matrix_near[0][3]);\n    i_far  = vec4(matrix_near[1][0],matrix_near[1][1],matrix_near[1][2],matrix_near[1][3]);\n    focus = vec4(matrix_near[2][0],matrix_near[2][1],matrix_near[2][2],matrix_near[2][3]);\n    e3 = vec3(matrix_near[3][0],matrix_near[3][1],matrix_near[3][2]);\n\n    e1.x = 1.0;\n    e1.y = 1.0;\n    e1.z = ( (e3.x*focus.x + e3.y*focus.y + e3.z*focus.z) - e1.x*e3.x - e1.y*e3.y)/e3.z;\n    e1_temp = e1 - focus.xyz;\n    e1 = normalize(e1_temp);\n\n    e2 = normalize(cross(e1,e3));\n\n\n    vec4 equation = focus;\n\n    float shrinkfactor = shrink;\n    float t1 = -1.0/(1.0-shrinkfactor);\n    float t2 = 1.0/(shrinkfactor);\n    // float t3 = 2.0/(shrinkfactor);\n\n    vec4 colonne1, colonne2, colonne3, colonne4;\n    mat4 mat;\n\n    vec3 equation1 = vec3(t2,t2,t1);\n\n\n    float A1 = - e1.x*equation.x - e1.y*equation.y - e1.z*equation.z;\n    float A2 = - e2.x*equation.x - e2.y*equation.y - e2.z*equation.z;\n    float A3 = - e3.x*equation.x - e3.y*equation.y - e3.z*equation.z;\n\n    float A11 = equation1.x*e1.x*e1.x +  equation1.y*e2.x*e2.x + equation1.z*e3.x*e3.x;\n    float A21 = equation1.x*e1.x*e1.y +  equation1.y*e2.x*e2.y + equation1.z*e3.x*e3.y;\n    float A31 = equation1.x*e1.x*e1.z +  equation1.y*e2.x*e2.z + equation1.z*e3.x*e3.z;\n    float A41 = equation1.x*e1.x*A1   +  equation1.y*e2.x*A2   + equation1.z*e3.x*A3;\n\n    float A22 = equation1.x*e1.y*e1.y +  equation1.y*e2.y*e2.y + equation1.z*e3.y*e3.y;\n    float A32 = equation1.x*e1.y*e1.z +  equation1.y*e2.y*e2.z + equation1.z*e3.y*e3.z;\n    float A42 = equation1.x*e1.y*A1   +  equation1.y*e2.y*A2   + equation1.z*e3.y*A3;\n\n    float A33 = equation1.x*e1.z*e1.z +  equation1.y*e2.z*e2.z + equation1.z*e3.z*e3.z;\n    float A43 = equation1.x*e1.z*A1   +  equation1.y*e2.z*A2   + equation1.z*e3.z*A3;\n\n    float A44 = equation1.x*A1*A1 +  equation1.y*A2*A2 + equation1.z*A3*A3 - equation.w;\n\n    colonne1 = vec4(A11,A21,A31,A41);\n    colonne2 = vec4(A21,A22,A32,A42);\n    colonne3 = vec4(A31,A32,A33,A43);\n    colonne4 = vec4(A41,A42,A43,A44);\n\n    mat = mat4(colonne1,colonne2,colonne3,colonne4);\n\n\n\n    // Ray calculation using near and far\n    Ray ray = primary_ray(i_near,i_far) ;\n\n    // Intersection between ray and surface for each pixel\n    vec3 M;\n    M = isect_surf(ray, mat);\n\n    // cut the extremities of bonds to superimpose bond and spheres surfaces\n    if (cutoff_plane(M, prime1.xyz, -e3) || cutoff_plane(M, prime2.xyz, e3)){ discard; }\n\n    // Transform normal to model space to view-space\n    vec4 M1 = vec4(M,1.0);\n    vec4 M2 =  mat*M1;\n    vec3 normal = normalize( ( modelViewMatrixInverseTranspose * M2 ).xyz );\n\n    // Recalculate the depth in function of the new pixel position\n    gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix) ;\n\n    #ifdef NEAR_CLIP\n        if( calcClip( modelViewMatrix * vec4( M, 1.0 ) ) > 0.0 ){\n            M = isect_surf2(ray, mat);\n            if( calcClip( modelViewMatrix * vec4( M, 1.0 ) ) > 0.0 )\n                discard;\n            normal = vec3( 0.0, 0.0, 0.4 );\n            gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix) ;\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = max( 0.0, calcDepth( vec3( - ( nearClip - 0.5 ) ) ) + ( 0.0000001 / radius ) );\n            }\n        }else if( gl_FragDepthEXT <= 0.0 ){\n            M = isect_surf2(ray, mat);\n            normal = vec3( 0.0, 0.0, 0.4 );\n            gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix);\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / radius );\n            }\n        }\n    #else\n        if( gl_FragDepthEXT <= 0.0 ){\n            M = isect_surf2(ray, mat);\n            normal = vec3( 0.0, 0.0, 0.4 );\n            gl_FragDepthEXT = update_z_buffer(M, modelViewProjectionMatrix) ;\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / radius );\n            }\n        }\n    #endif\n\n    // cut the extremities of bonds to superimpose bond and spheres surfaces\n    if (cutoff_plane(M, prime1.xyz, -e3) || cutoff_plane(M, prime2.xyz, e3)){ discard; }\n\n    if (gl_FragDepthEXT < 0.0)\n        discard;\n    if (gl_FragDepthEXT > 1.0)\n        discard;\n\n    // Give color parameters to the Graphic card\n    //gl_FragColor.rgb = lighting.y * diffusecolor + lighting.z * specularcolor;\n    //gl_FragColor.a = 1.0;\n\n    vec3 transformedNormal = normal;\n    vec3 vLightFront = vec3( 0.0, 0.0, 0.0 );\n\n    #include light\n\n    // Mix the color bond in function of the two atom colors\n    float distance_ratio = ((M.x-prime2.x)*e3.x + (M.y-prime2.y)*e3.y +(M.z-prime2.z)*e3.z) /\n                                distance(prime2.xyz,prime1.xyz);\n\n    #ifdef PICKING\n        // lerp function not in GLSL. Find something else ...\n        vec3 diffusecolor = mix( vPickingColor2, vPickingColor, distance_ratio );\n        if( distance_ratio>0.5 ){\n            diffusecolor = vPickingColor;\n        }else{\n            diffusecolor = vPickingColor2;\n        }\n        gl_FragColor = vec4( diffusecolor, objectId );\n    #else\n        // lerp function not in GLSL. Find something else ...\n        vec3 diffusecolor = mix( vColor2, vColor, distance_ratio );\n        if( distance_ratio>0.5 ){\n            diffusecolor = vColor;\n        }else{\n            diffusecolor = vColor2;\n        }\n        gl_FragColor = vec4( diffusecolor, opacity );\n        gl_FragColor.rgb *= vLightFront;\n    #endif\n\n    // #include fog\n\n    #ifdef USE_FOG\n        float depth = gl_FragDepthEXT / gl_FragCoord.w;\n        #ifdef FOG_EXP2\n            const float LOG2 = 1.442695;\n            float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n            fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n        #else\n            float fogFactor = smoothstep( fogNear, fogFar, depth );\n        #endif\n        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n    #endif\n\n    // ############## Fog effect #####################################################\n    // To use fog comment the two previous lines: ie  gl_FragColor.rgb = E and   gl_FragColor.a = 1.0;\n    // and uncomment the next lines.\n    // Color of the fog: white\n    //float fogDistance  = update_z_buffer(M, gl_ModelViewMatrix) ;\n    //float fogExponent  = fogDistance * fogDistance * 0.007;\n    //vec3 fogColor   = vec3(1.0, 1.0, 1.0);\n    //float fogFactor   = exp2(-abs(fogExponent));\n    //fogFactor = clamp(fogFactor, 0.0, 1.0);\n\n    //vec3 final_color = lighting.y * diffusecolor + lighting.z * specularcolor;\n    //gl_FragColor.rgb = mix(fogColor,final_color,fogFactor);\n    //gl_FragColor.a = 1.0;\n    // ##################################################################################\n\n}\n";
NGL.Resources["shader/Line.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\nattribute vec3 color;\n\nvarying vec3 vColor;\nvarying vec4 cameraPos;\n\n\nvoid main()\n{\n\n    vColor = color;\n\n    cameraPos =  modelViewMatrix * vec4( position, 1.0 );\n\n    gl_Position = projectionMatrix * vec4( cameraPos.xyz, 1.0 );\n\n}\n";
NGL.Resources["shader/Line.frag"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nuniform float opacity;\nuniform float nearClip;\n\nvarying vec3 vColor;\nvarying vec4 cameraPos;\n\n#ifdef PICKING\n    uniform float objectId;\n#endif\n\n#include fog_params\n\n\nvoid main()\n{\n\n\t#ifdef NEAR_CLIP\n\t\tif( dot( cameraPos, vec4( 0.0, 0.0, 1.0, nearClip ) ) > 0.0 )\n        \tdiscard;\n    #endif\n\n    gl_FragColor = vec4( vColor, opacity );\n\n    #include fog\n\n}\n";
NGL.Resources["shader/LineSprite.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\n\n// Open-Source PyMOL is Copyright (C) Schrodinger, LLC.\n\n//  All Rights Reserved\n\n//  Permission to use, copy, modify, distribute, and distribute modified\n//  versions of this software and its built-in documentation for any\n//  purpose and without fee is hereby granted, provided that the above\n//  copyright notice appears in all copies and that both the copyright\n//  notice and this permission notice appear in supporting documentation,\n//  and that the name of Schrodinger, LLC not be used in advertising or\n//  publicity pertaining to distribution of the software without specific,\n//  written prior permission.\n\n//  SCHRODINGER, LLC DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,\n//  INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN\n//  NO EVENT SHALL SCHRODINGER, LLC BE LIABLE FOR ANY SPECIAL, INDIRECT OR\n//  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n//  OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n//  OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\n//  USE OR PERFORMANCE OF THIS SOFTWARE.\n\n// Note: here the box screen aligned code from Open-Source PyMOL is used\n\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - dual color\n// - adapted for line sprites\n\nattribute vec3 position;\nattribute lowp vec2 inputMapping;\nattribute lowp vec3 inputColor;\nattribute lowp vec3 inputColor2;\nattribute lowp vec3 inputAxis;\nattribute lowp float inputWidth;\n\nvarying float dist;\nvarying lowp vec3 color;\nvarying lowp vec3 color2;\n\n\n// void main2(void){\n//     colorx = inputColor;\n\n//     vec2 B;\n//     vec3 C;\n//     if (inputAxis.y != 0.0 || inputAxis.z != 0.0){\n//         C = vec3(1.0, 0.0, 0.0);\n//     }else{\n//         C = vec3(0.0, 1.0, 0.0);\n//     }\n//     B = normalize(cross(inputAxis, C).xy);\n\n//     vec4 cameraCornerPos = modelViewMatrix * vec4( position, 1.0 );\n//     cameraCornerPos.xy += inputMapping * (B.xy * inputWidth);\n\n//     gl_Position = projectionMatrix * cameraCornerPos;\n// }\n\n\nvoid main(void){\n    mat4 MVMatrix = modelViewMatrix;\n    mat4 PMatrix = projectionMatrix;\n    vec4 EyePoint = vec4( cameraPosition, 1.0 );\n\n    vec3 center = position.xyz;\n    vec3 dir = normalize(inputAxis);\n    // float ext = inputCylinderHeight/2.0;\n    vec3 ldir;\n\n    vec3 cam_dir = normalize(EyePoint.xyz - center);\n    float b = dot(cam_dir, dir);\n    if(b<0.0) // direction vector looks away, so flip\n        //ldir = -ext*dir;\n        ldir = -(length(inputAxis)/2.0) * normalize(inputAxis);\n    else // direction vector already looks in my direction\n        //ldir = ext*dir;\n        ldir = (length(inputAxis)/2.0) * normalize(inputAxis);\n\n    vec3 left = cross(cam_dir, ldir);\n    vec3 up = cross(left, ldir);\n    left = inputWidth*normalize(left);\n    up = inputWidth*normalize(up);\n\n    vec4 w = MVMatrix * vec4(\n        center + inputMapping.x*ldir + inputMapping.y*left, 1.0\n    );\n\n    gl_Position = PMatrix * w;\n\n\n    vec4 base4 = MVMatrix * vec4(center-ldir, 1.0);\n    vec3 base = base4.xyz / base4.w;\n\n    vec4 top_position = MVMatrix*(vec4(center+ldir,1.0));\n    vec4 end4 = top_position;\n    vec3 end = end4.xyz / end4.w;\n\n    vec3 point = w.xyz / w.w;\n\n    color = inputColor;\n    color2 = inputColor2;\n\n    // TODO compare without sqrt\n    if( distance( point, end ) < distance( point, base ) ){\n        dist = b > 0.0 ? 1.0 : 0.0;\n    }else{\n        dist = b < 0.0 ? 1.0 : 0.0;\n    }\n\n}";
NGL.Resources["shader/LineSprite.frag"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nvarying float dist;\nvarying highp vec3 color;\nvarying highp vec3 color2;\n\n#include fog_params\n\n\nvoid main() {\n\n    if( dist > 0.5 ){\n        gl_FragColor = vec4( color, 1.0 );\n    }else{\n        gl_FragColor = vec4( color2, 1.0 );\n    }\n\n    #include fog\n}\n";NGL.Resources["shader/Mesh.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\n\nvarying vec4 cameraPos;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    varying vec3 vPickingColor;\n#else\n    attribute vec3 color;\n    attribute vec3 normal;\n    varying vec3 vColor;\n    varying vec3 vNormal;\n#endif\n\nvoid main()\n{\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n    #else\n        vColor = color;\n        vNormal = normalize( normalMatrix * normal );\n    #endif\n\n    cameraPos = modelViewMatrix * vec4( position, 1.0 );\n\n    gl_Position = projectionMatrix * vec4( cameraPos.xyz, 1.0 );\n\n}\n";
NGL.Resources["shader/Mesh.frag"]="\n#ifdef FLAT_SHADED\n    #extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nuniform float opacity;\nuniform float nearClip;\n\nvarying vec4 cameraPos;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n#else\n    varying vec3 vColor;\n    varying vec3 vNormal;\n#endif\n\n#include light_params\n\n#include fog_params\n\nvoid main()\n{\n\n    #ifdef NEAR_CLIP\n        if( dot( cameraPos, vec4( 0.0, 0.0, 1.0, nearClip ) ) > 0.0 )\n            discard;\n    #endif\n\n    #ifdef PICKING\n\n        gl_FragColor = vec4( vPickingColor, objectId );\n\n    #else\n\n        #ifdef FLAT_SHADED\n            vec3 fdx = dFdx( cameraPos.xyz );\n            vec3 fdy = dFdy( cameraPos.xyz );\n            vec3 normal = normalize( cross( fdx, fdy ) );\n        #else\n            vec3 normal = normalize( vNormal );\n        #endif\n\n        vec3 transformedNormal = normalize( normal );\n        #ifndef FLAT_SHADED\n            #ifdef DOUBLE_SIDED\n                transformedNormal = transformedNormal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n            #endif\n            #ifdef FLIP_SIDED\n                transformedNormal = -transformedNormal;\n            #endif\n        #endif\n\n        #ifdef DULL_INTERIOR\n            if( !gl_FrontFacing ){\n                transformedNormal = vec3( 0.0, 0.0, 0.4 );\n            }\n        #endif\n\n        vec3 vLightFront = vec3( 0.0, 0.0, 0.0 );\n\n        #ifndef NOLIGHT\n            #include light\n        #endif\n\n        #ifdef OPAQUE_BACK\n            #ifdef FLIP_SIDED\n                if( float( gl_FrontFacing ) == 1.0 ){\n                    gl_FragColor = vec4( vColor, 1.0 );\n                }else{\n                    gl_FragColor = vec4( vColor, opacity );\n                }\n            #else\n                if( float( gl_FrontFacing ) == 1.0 ){\n                    gl_FragColor = vec4( vColor, opacity );\n                }else{\n                    gl_FragColor = vec4( vColor, 1.0 );\n                }\n            #endif\n        #else\n            gl_FragColor = vec4( vColor, opacity );\n        #endif\n\n        #ifndef NOLIGHT\n            gl_FragColor.rgb *= vLightFront;\n        #endif\n\n    #endif\n\n    #include fog\n\n}\n";
NGL.Resources["shader/ParticleSprite.vert"]='\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\n// uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\nattribute vec2 mapping;\nattribute vec3 color;\nattribute float radius;\n\nvarying vec3 point;\nvarying vec3 vColor;\nvarying vec3 cameraSpherePos;\nvarying float sphereRadius;\n\nuniform mat4 projectionMatrixInverse;\n\nconst mat4 D = mat4(\n    1.0, 0.0, 0.0, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, -1.0\n);\n\nmat4 transpose( in mat4 inMatrix ) {\n    vec4 i0 = inMatrix[0];\n    vec4 i1 = inMatrix[1];\n    vec4 i2 = inMatrix[2];\n    vec4 i3 = inMatrix[3];\n\n    mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n    return outMatrix;\n}\n\n\n//------------------------------------------------------------------------------\n// Compute point size and center using the technique described in:\n// "GPU-Based Ray-Casting of Quadratic Surfaces"\n// by Christian Sigg, Tim Weyrich, Mario Botsch, Markus Gross.\n//\n// Code based on\n/*=========================================================================\n\n Program:   Visualization Toolkit\n Module:    Quadrics_fs.glsl and Quadrics_vs.glsl\n\n Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n All rights reserved.\n See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n This software is distributed WITHOUT ANY WARRANTY; without even\n the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n PURPOSE.  See the above copyright notice for more information.\n\n =========================================================================*/\n\n// .NAME Quadrics_fs.glsl and Quadrics_vs.glsl\n// .SECTION Thanks\n// <verbatim>\n//\n//  This file is part of the PointSprites plugin developed and contributed by\n//\n//  Copyright (c) CSCS - Swiss National Supercomputing Centre\n//                EDF - Electricite de France\n//\n//  John Biddiscombe, Ugo Varetto (CSCS)\n//  Stephane Ploix (EDF)\n//\n// </verbatim>\n//\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - adapted to work with quads\nvoid ComputePointSizeAndPositionInClipCoordSphere(){\n\n    vec2 xbc;\n    vec2 ybc;\n\n    mat4 T = mat4(\n        sphereRadius, 0.0, 0.0, 0.0,\n        0.0, sphereRadius, 0.0, 0.0,\n        0.0, 0.0, sphereRadius, 0.0,\n        position.x, position.y, position.z, 1.0\n    );\n\n    mat4 R = transpose( projectionMatrix * modelViewMatrix * T );\n    float A = dot( R[ 3 ], D * R[ 3 ] );\n    float B = -2.0 * dot( R[ 0 ], D * R[ 3 ] );\n    float C = dot( R[ 0 ], D * R[ 0 ] );\n    xbc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    xbc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sx = abs( xbc[ 0 ] - xbc[ 1 ] ) * 0.5;\n\n    A = dot( R[ 3 ], D * R[ 3 ] );\n    B = -2.0 * dot( R[ 1 ], D * R[ 3 ] );\n    C = dot( R[ 1 ], D * R[ 1 ] );\n    ybc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    ybc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sy = abs( ybc[ 0 ] - ybc[ 1 ]  ) * 0.5;\n\n    gl_Position.xy = vec2( 0.5 * ( xbc.x + xbc.y ), 0.5 * ( ybc.x + ybc.y ) );\n    gl_Position.xy -= mapping * vec2( sx, sy );\n    gl_Position.xy *= gl_Position.w;\n}\n\n\nvoid main(void){\n\n    vColor = color;\n    cameraSpherePos = ( modelViewMatrix * vec4( position, 1.0 ) ).xyz;\n    sphereRadius = radius;\n\n    gl_Position = projectionMatrix * vec4( cameraSpherePos, 1.0 );\n    ComputePointSizeAndPositionInClipCoordSphere();\n\n    point = ( projectionMatrixInverse * gl_Position ).xyz;\n\n    // move out of viewing frustum to avoid clipping artifacts\n    if( gl_Position.z-sphereRadius<=1.0 )\n        gl_Position.z = -10.0;\n}\n\n\n\n\n';
NGL.Resources["shader/ParticleSprite.frag"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nvarying vec3 point;\nvarying vec3 vColor;\nvarying vec3 cameraSpherePos;\nvarying float sphereRadius;\n\n#include fog_params\n\n\nvoid main() {\n\n    vec3 rayDirection = normalize( point );\n\n    float B = -2.0 * dot(rayDirection, cameraSpherePos);\n    float C = dot(cameraSpherePos, cameraSpherePos) - (sphereRadius*sphereRadius);\n    float det = (B * B) - (4.0 * C);\n    if(det < 0.0)\n        discard;\n\n\tgl_FragColor = vec4( vColor, 1.0 );\n\n    #include fog\n\n}\n";
NGL.Resources["shader/Quad.vert"]="\nprecision highp float;\nprecision highp int;\n\nattribute vec2 position;\nattribute vec2 texture;\nvarying vec2 texCoord;\n\nvoid main(void) {\n    texCoord = texture;\n    gl_Position = vec4(position, 0.0, 1.0);\n}\n";NGL.Resources["shader/Quad.frag"]="\nprecision mediump float;\nprecision mediump int;\n\nuniform sampler2D diffuse;\nvarying vec2 texCoord;\n\nvoid main(void) {\n    vec4 color = texture2D(diffuse, texCoord);\n    gl_FragColor = vec4(color.rgb, color.a);\n}\n";
NGL.Resources["shader/Ribbon.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n#ifndef PICKING\n    uniform mat3 normalMatrix;\n#endif\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\nattribute vec3 dir;\nattribute float size;\nattribute vec3 normal;\n\nvarying vec4 cameraPos;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    varying vec3 vPickingColor;\n#else\n    attribute vec3 color;\n    varying vec3 vColor;\n    varying vec3 vNormal;\n#endif\n\nvoid main(void){\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n    #else\n        vColor = color;\n        vNormal = normalize( normalMatrix * normal );\n    #endif\n\n    cameraPos = modelViewMatrix * vec4(\n        position + ( normalize( dir ) * size ), 1.0\n    );\n\n    gl_Position = projectionMatrix * vec4( cameraPos.xyz, 1.0 );\n\n}\n";
NGL.Resources["shader/Ribbon.frag"]="\n#ifdef FLAT_SHADED\n    #extension GL_OES_standard_derivatives : enable\n#endif\n\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nuniform float opacity;\nuniform float nearClip;\n\nvarying vec4 cameraPos;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n#else\n    varying vec3 vColor;\n    varying vec3 vNormal;\n#endif\n\n#include light_params\n\n#include fog_params\n\n\nvoid main() {\n\n    #ifdef NEAR_CLIP\n        if( dot( cameraPos, vec4( 0.0, 0.0, 1.0, nearClip ) ) > 0.0 )\n            discard;\n    #endif\n\n    #ifdef PICKING\n        gl_FragColor = vec4( vPickingColor, objectId );\n        //gl_FragColor.rgb = vec3( 1.0, 0.0, 0.0 );\n    #else\n\n        #ifdef FLAT_SHADED\n            vec3 fdx = dFdx( cameraPos.xyz );\n            vec3 fdy = dFdy( cameraPos.xyz );\n            vec3 normal = cross( fdx, fdy );\n        #else\n            vec3 normal = vNormal;\n        #endif\n\n        vec3 transformedNormal = normalize( normal );\n        #ifndef FLAT_SHADED\n            #ifdef DOUBLE_SIDED\n                transformedNormal = transformedNormal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n            #endif\n            #ifdef FLIP_SIDED\n                transformedNormal = -transformedNormal;\n            #endif\n        #endif\n\n        vec3 vLightFront = vec3( 0.0, 0.0, 0.0 );\n\n        #include light\n\n        gl_FragColor = vec4( vColor, opacity );\n        // gl_FragColor.rgb = vec3( 1.0, 0.0, 0.0 );\n        gl_FragColor.rgb *= vLightFront;\n        // gl_FragColor.rgb = normalx;\n        //gl_FragColor.rgb = vColor;\n    #endif\n\n    #include fog\n}\n";
NGL.Resources["shader/SDFFont.vert"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\nattribute vec2 mapping;\nattribute vec2 inputTexCoord;\nattribute float inputSize;\nattribute vec3 color;\n\nvarying vec3 vColor;\nvarying vec2 texCoord;\n\nuniform float nearClip;\n\n\nvoid main(void){\n\n    vColor = color;\n    texCoord = inputTexCoord;\n\n    vec4 cameraPos = ( modelViewMatrix * vec4( position, 1.0 ) );\n    vec4 cameraCornerPos = vec4( cameraPos.xyz, 1.0 );\n    cameraCornerPos.xy += mapping * inputSize;\n\n    cameraCornerPos.z += 0.5;\n\n    gl_Position = projectionMatrix * cameraCornerPos;\n\n    #ifdef NEAR_CLIP\n        // move out of viewing frustum for custom clipping\n        if( dot( cameraPos, vec4( 0.0, 0.0, 1.0, nearClip ) ) > 0.0 )\n            gl_Position.w = -10.0;\n    #endif\n\n}\n";
NGL.Resources["shader/SDFFont.frag"]="\n#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nuniform sampler2D fontTexture;\nuniform float opacity;\n\nvarying vec3 vColor;\nvarying vec2 texCoord;\n\n#include fog_params\n\nconst float smoothness = 16.0;\nconst float gamma = 2.2;\n\nvoid main() {\n\n    // retrieve signed distance\n    float sdf = texture2D( fontTexture, texCoord ).a;\n\n    // perform adaptive anti-aliasing of the edges\n    float w = clamp(\n        smoothness * ( abs( dFdx( texCoord.x ) ) + abs( dFdy( texCoord.y ) ) ),\n        0.0,\n        0.5\n    );\n    float a = smoothstep( 0.5 - w, 0.5 + w, sdf );\n\n    // gamma correction for linear attenuation\n    a = pow( a, 1.0 / gamma );\n\n    if( a < 0.2 ) discard;\n\n    a *= opacity;\n\n    gl_FragColor = vec4( vColor, a );\n\n    #include fog\n\n}\n\n";
NGL.Resources["shader/SphereHalo.vert"]='\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\nattribute vec2 mapping;\nattribute float radius;\n\nvarying vec3 point;\nvarying vec3 cameraSpherePos;\nvarying float sphereRadius;\n\nuniform mat4 projectionMatrixInverse;\n\nconst mat4 D = mat4(\n    1.0, 0.0, 0.0, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, -1.0\n);\n\nmat4 transpose( in mat4 inMatrix ) {\n    vec4 i0 = inMatrix[0];\n    vec4 i1 = inMatrix[1];\n    vec4 i2 = inMatrix[2];\n    vec4 i3 = inMatrix[3];\n\n    mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n    return outMatrix;\n}\n\n\n//------------------------------------------------------------------------------\n// Compute point size and center using the technique described in:\n// "GPU-Based Ray-Casting of Quadratic Surfaces"\n// by Christian Sigg, Tim Weyrich, Mario Botsch, Markus Gross.\n//\n// Code based on\n/*=========================================================================\n\n Program:   Visualization Toolkit\n Module:    Quadrics_fs.glsl and Quadrics_vs.glsl\n\n Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n All rights reserved.\n See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n This software is distributed WITHOUT ANY WARRANTY; without even\n the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n PURPOSE.  See the above copyright notice for more information.\n\n =========================================================================*/\n\n// .NAME Quadrics_fs.glsl and Quadrics_vs.glsl\n// .SECTION Thanks\n// <verbatim>\n//\n//  This file is part of the PointSprites plugin developed and contributed by\n//\n//  Copyright (c) CSCS - Swiss National Supercomputing Centre\n//                EDF - Electricite de France\n//\n//  John Biddiscombe, Ugo Varetto (CSCS)\n//  Stephane Ploix (EDF)\n//\n// </verbatim>\n//\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - adapted to work with quads\nvoid ComputePointSizeAndPositionInClipCoordSphere(){\n\n    vec2 xbc;\n    vec2 ybc;\n\n    mat4 T = mat4(\n        sphereRadius, 0.0, 0.0, 0.0,\n        0.0, sphereRadius, 0.0, 0.0,\n        0.0, 0.0, sphereRadius, 0.0,\n        position.x, position.y, position.z, 1.0\n    );\n\n    mat4 R = transpose( projectionMatrix * modelViewMatrix * T );\n    float A = dot( R[ 3 ], D * R[ 3 ] );\n    float B = -2.0 * dot( R[ 0 ], D * R[ 3 ] );\n    float C = dot( R[ 0 ], D * R[ 0 ] );\n    xbc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    xbc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sx = abs( xbc[ 0 ] - xbc[ 1 ] ) * 0.5;\n\n    A = dot( R[ 3 ], D * R[ 3 ] );\n    B = -2.0 * dot( R[ 1 ], D * R[ 3 ] );\n    C = dot( R[ 1 ], D * R[ 1 ] );\n    ybc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    ybc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sy = abs( ybc[ 0 ] - ybc[ 1 ]  ) * 0.5;\n\n    gl_Position.xy = vec2( 0.5 * ( xbc.x + xbc.y ), 0.5 * ( ybc.x + ybc.y ) );\n    gl_Position.xy -= mapping * vec2( sx, sy );\n    gl_Position.xy *= gl_Position.w;\n}\n\n\nvoid main(void){\n\n    cameraSpherePos = ( modelViewMatrix * vec4( position, 1.0 ) ).xyz;\n    sphereRadius = radius * 1.3;\n\n    gl_Position = projectionMatrix * vec4( cameraSpherePos, 1.0 );\n    ComputePointSizeAndPositionInClipCoordSphere();\n\n    point = ( projectionMatrixInverse * gl_Position ).xyz;\n\n    // move out of viewing frustum to avoid clipping artifacts\n    if( gl_Position.z-sphereRadius<=1.0 )\n        gl_Position.z = -10.0;\n}\n\n\n\n\n\n';
NGL.Resources["shader/SphereHalo.frag"]="\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nvarying vec3 point;\nvarying vec3 cameraSpherePos;\nvarying float sphereRadius;\n\nuniform vec3 color;\n\n#include fog_params\n\n\nvoid main(void)\n{\n    vec3 rayDirection = normalize( point );\n\n    float B = -2.0 * dot(rayDirection, cameraSpherePos);\n    float C = dot(cameraSpherePos, cameraSpherePos) - (sphereRadius*sphereRadius);\n    float det = (B * B) - (4.0 * C);\n    if(det < 0.0)\n        discard;\n\n    float r2 = sphereRadius*0.97;\n    B = -2.0 * dot(rayDirection, cameraSpherePos);\n    C = dot(cameraSpherePos, cameraSpherePos) - (r2*r2);\n    det = (B * B) - (4.0 * C);\n\n    if(det < 0.0){\n        gl_FragColor = vec4( color, 1.0 );\n\n    }else{\n    \tgl_FragColor = vec4( color, 0.5 );\n    }\n\n    #include fog\n}\n\n\n";
NGL.Resources["shader/SphereImpostor.vert"]='\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\n// uniform mat4 viewMatrix;\n// uniform mat3 normalMatrix;\n// uniform vec3 cameraPosition;\n\nattribute vec3 position;\nattribute vec2 mapping;\nattribute float radius;\n\nvarying vec3 point;\nvarying vec4 cameraSpherePos;\nvarying float sphereRadius;\n\n#ifdef PICKING\n    attribute vec3 pickingColor;\n    varying vec3 vPickingColor;\n#else\n    attribute vec3 color;\n    varying vec3 vColor;\n#endif\n\nuniform mat4 projectionMatrixInverse;\nuniform float nearClip;\n\nconst mat4 D = mat4(\n    1.0, 0.0, 0.0, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, -1.0\n);\n\nmat4 transpose( in mat4 inMatrix ) {\n    vec4 i0 = inMatrix[0];\n    vec4 i1 = inMatrix[1];\n    vec4 i2 = inMatrix[2];\n    vec4 i3 = inMatrix[3];\n\n    mat4 outMatrix = mat4(\n        vec4(i0.x, i1.x, i2.x, i3.x),\n        vec4(i0.y, i1.y, i2.y, i3.y),\n        vec4(i0.z, i1.z, i2.z, i3.z),\n        vec4(i0.w, i1.w, i2.w, i3.w)\n    );\n    return outMatrix;\n}\n\n\n//------------------------------------------------------------------------------\n// Compute point size and center using the technique described in:\n// "GPU-Based Ray-Casting of Quadratic Surfaces"\n// by Christian Sigg, Tim Weyrich, Mario Botsch, Markus Gross.\n//\n// Code based on\n/*=========================================================================\n\n Program:   Visualization Toolkit\n Module:    Quadrics_fs.glsl and Quadrics_vs.glsl\n\n Copyright (c) Ken Martin, Will Schroeder, Bill Lorensen\n All rights reserved.\n See Copyright.txt or http://www.kitware.com/Copyright.htm for details.\n\n This software is distributed WITHOUT ANY WARRANTY; without even\n the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n PURPOSE.  See the above copyright notice for more information.\n\n =========================================================================*/\n\n// .NAME Quadrics_fs.glsl and Quadrics_vs.glsl\n// .SECTION Thanks\n// <verbatim>\n//\n//  This file is part of the PointSprites plugin developed and contributed by\n//\n//  Copyright (c) CSCS - Swiss National Supercomputing Centre\n//                EDF - Electricite de France\n//\n//  John Biddiscombe, Ugo Varetto (CSCS)\n//  Stephane Ploix (EDF)\n//\n// </verbatim>\n//\n// Contributions by Alexander Rose\n// - ported to WebGL\n// - adapted to work with quads\nvoid ComputePointSizeAndPositionInClipCoordSphere(){\n\n    vec2 xbc;\n    vec2 ybc;\n\n    mat4 T = mat4(\n        sphereRadius, 0.0, 0.0, 0.0,\n        0.0, sphereRadius, 0.0, 0.0,\n        0.0, 0.0, sphereRadius, 0.0,\n        position.x, position.y, position.z, 1.0\n    );\n\n    mat4 R = transpose( projectionMatrix * modelViewMatrix * T );\n    float A = dot( R[ 3 ], D * R[ 3 ] );\n    float B = -2.0 * dot( R[ 0 ], D * R[ 3 ] );\n    float C = dot( R[ 0 ], D * R[ 0 ] );\n    xbc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    xbc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sx = abs( xbc[ 0 ] - xbc[ 1 ] ) * 0.5;\n\n    A = dot( R[ 3 ], D * R[ 3 ] );\n    B = -2.0 * dot( R[ 1 ], D * R[ 3 ] );\n    C = dot( R[ 1 ], D * R[ 1 ] );\n    ybc[ 0 ] = ( -B - sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    ybc[ 1 ] = ( -B + sqrt( B * B - 4.0 * A * C ) ) / ( 2.0 * A );\n    float sy = abs( ybc[ 0 ] - ybc[ 1 ]  ) * 0.5;\n\n    gl_Position.xy = vec2( 0.5 * ( xbc.x + xbc.y ), 0.5 * ( ybc.x + ybc.y ) );\n    gl_Position.xy -= mapping * vec2( sx, sy );\n    gl_Position.xy *= gl_Position.w;\n\n}\n\n\nvoid main(void){\n\n    #ifdef PICKING\n        vPickingColor = pickingColor;\n    #else\n        vColor = color;\n    #endif\n\n    cameraSpherePos = ( modelViewMatrix * vec4( position, 1.0 ) ).xyzw;\n    sphereRadius = radius;\n\n    // avoid clipping, added again in fragment shader\n    cameraSpherePos.z -= radius;\n\n    gl_Position = projectionMatrix * vec4( cameraSpherePos.xyz, 1.0 );\n    ComputePointSizeAndPositionInClipCoordSphere();\n\n    point = ( projectionMatrixInverse * gl_Position ).xyz;\n\n}\n\n\n\n\n\n';
NGL.Resources["shader/SphereImpostor.frag"]="\n#extension GL_EXT_frag_depth : enable\n\n// not available in WebGL\n// #extension GL_ARB_conservative_depth : enable\n// layout(depth_less) out float gl_FragDepthEXT;\n\nprecision highp float;\nprecision highp int;\n\n// uniform mat4 viewMatrix;\n// uniform vec3 cameraPosition;\n\nuniform float opacity;\nuniform float nearClip;\nuniform mat4 projectionMatrix;\n\nvarying vec3 point;\nvarying vec4 cameraSpherePos;\nvarying float sphereRadius;\n\n#ifdef PICKING\n    uniform float objectId;\n    varying vec3 vPickingColor;\n#else\n    varying vec3 vColor;\n#endif\n\n#include light_params\n\n#include fog_params\n\n\nvec3 cameraPos;\nvec3 cameraNormal;\n\n\n// vec4 poly_color = gl_Color;\n\n//   if(uf_use_border_hinting == 1.0)\n//   {\n//     vec3 wc_eye_dir = normalize(wc_sp_pt);\n//     float n_dot_e   = abs(dot(wc_sp_nrml,wc_eye_dir));\n//     float alpha     = max(uf_border_color_start_cosine - n_dot_e,0.0)/uf_border_color_start_cosine;\n//     poly_color      = mix(gl_Color,uf_border_color,0.75*alpha);\n//   }\n\n//   color += (diff + amb)*poly_color + spec*gl_FrontMaterial.specular;\n\n\n// Calculate depth based on the given camera position.\nfloat calcDepth( in vec3 cameraPos )\n{\n    vec2 clipZW = cameraPos.z * projectionMatrix[2].zw + projectionMatrix[3].zw;\n    return 0.5 + 0.5 * clipZW.x / clipZW.y;\n}\n\n\nfloat calcClip( vec3 cameraPos )\n{\n    return dot( vec4( cameraPos, 1.0 ), vec4( 0.0, 0.0, 1.0, nearClip - 0.5 ) );\n}\n\n\nbool flag2 = false;\n\n\nbool Impostor(out vec3 cameraPos, out vec3 cameraNormal)\n{\n\n    vec3 cameraSpherePos2 = cameraSpherePos.xyz;\n    cameraSpherePos2.z += sphereRadius;\n\n    vec3 rayDirection = normalize( point );\n\n    float B = -2.0 * dot(rayDirection, cameraSpherePos2);\n    float C = dot(cameraSpherePos2, cameraSpherePos2) - (sphereRadius*sphereRadius);\n\n    float det = (B * B) - (4.0 * C);\n    if(det < 0.0){\n        discard;\n        return false;\n    }else{\n        float sqrtDet = sqrt(det);\n        float posT = (-B + sqrtDet)/2.0;\n        float negT = (-B - sqrtDet)/2.0;\n\n        float intersectT = min(posT, negT);\n        cameraPos = rayDirection * intersectT;\n\n        #ifdef NEAR_CLIP\n            if( calcDepth( cameraPos ) <= 0.0 ){\n                cameraPos = rayDirection * max(posT, negT);\n                cameraNormal = vec3( 0.0, 0.0, 0.4 );\n                return false;\n            }else if( calcClip( cameraPos ) > 0.0 ){\n                cameraPos = rayDirection * max(posT, negT);\n                cameraNormal = vec3( 0.0, 0.0, 0.4 );\n                flag2 = true;\n                return false;\n            }else{\n                cameraNormal = normalize(cameraPos - cameraSpherePos2);\n            }\n        #else\n            if( calcDepth( cameraPos ) <= 0.0 ){\n                cameraPos = rayDirection * max(posT, negT);\n                cameraNormal = vec3( 0.0, 0.0, 0.4 );\n                return false;\n            }else{\n                cameraNormal = normalize(cameraPos - cameraSpherePos2);\n            }\n        #endif\n\n        return true;\n    }\n\n    return false; // ensure that each control flow has a return\n\n}\n\n\nvoid main(void)\n{\n\n    bool flag = Impostor( cameraPos, cameraNormal );\n\n    #ifdef NEAR_CLIP\n        if( calcClip( cameraPos ) > 0.0 )\n            discard;\n    #endif\n\n    // FIXME not compatible with custom clipping plane\n    //Set the depth based on the new cameraPos.\n    gl_FragDepthEXT = calcDepth( cameraPos );\n    if( !flag ){\n\n        // clamp to near clipping plane and add a tiny value to\n        // make spheres with a greater radius occlude smaller ones\n        #ifdef NEAR_CLIP\n            if( flag2 ){\n                gl_FragDepthEXT = max( 0.0, calcDepth( vec3( - ( nearClip - 0.5 ) ) ) + ( 0.0000001 / sphereRadius ) );\n            }else if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / sphereRadius );\n            }\n        #else\n            if( gl_FragDepthEXT >= 0.0 ){\n                gl_FragDepthEXT = 0.0 + ( 0.0000001 / sphereRadius );\n            }\n        #endif\n\n    }\n\n    // bugfix (mac only?)\n    if (gl_FragDepthEXT < 0.0)\n        discard;\n    if (gl_FragDepthEXT > 1.0)\n        discard;\n\n    #ifdef PICKING\n        gl_FragColor = vec4( vPickingColor, objectId );\n        //gl_FragColor.rgb = vec3( 1.0, 0.0, 0.0 );\n    #else\n        vec3 transformedNormal = cameraNormal;\n        vec3 vLightFront = vec3( 0.0, 0.0, 0.0 );\n\n        #include light\n\n        gl_FragColor = vec4( vColor, opacity );\n        gl_FragColor.rgb *= vLightFront;\n\n        // gl_FragColor.a = 0.5;\n        // gl_FragColor.rgb = transformedNormal;\n        // gl_FragColor.rgb = point;\n    #endif\n\n    // #include fog\n\n    #ifdef USE_FOG\n        float depth = gl_FragDepthEXT / gl_FragCoord.w;\n        #ifdef FOG_EXP2\n            const float LOG2 = 1.442695;\n            float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n            fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n        #else\n            float fogFactor = smoothstep( fogNear, fogFar, depth );\n        #endif\n        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n    #endif\n\n}\n\n\n// void main2(void)\n// {\n//     gl_FragColor = vec4( vColor, 1.0 );\n// }\n\n\n\n";
NGL.Resources["shader/chunk/fog.glsl"]="#ifdef USE_FOG\n\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\tgl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif";NGL.Resources["shader/chunk/fog_params.glsl"]="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tuniform float fogNear;\n\tuniform float fogFar;\n#endif";NGL.Resources["shader/chunk/light.glsl"]="// LIGHT\n// IN: transformedNormal, vLightFront\n// OUT: vLightFront\n\n// Give light vector position perpendicular to the screen\nvec3 lightvec = normalize( vec3( 0.0, 0.0, 1.2 ) );\nvec3 eyepos = vec3( 0.0, 0.0, 1.0 );\n\n// calculate half-angle vector\nvec3 halfvec = normalize( lightvec + eyepos );\n\n// Parameters used to calculate per pixel lighting\n// see http://http.developer.nvidia.com/CgTutorial/cg_tutorial_chapter05.html\nfloat diffuse = dot( transformedNormal,lightvec );\nfloat specular = dot( transformedNormal, halfvec );\nvec4 lighting = lit( diffuse, specular, 512.0 );\n\nvec3 specularcolor = vec3( 1.0, 1.0, 1.0 );\n\nvLightFront = ( vLightFront + lighting.y * vec3( 1.0, 1.0, 1.0 ) + lighting.z * specularcolor ).xyz;";
NGL.Resources["shader/chunk/light_params.glsl"]="vec4 lit( float NdotL, float NdotH, float m ){\n    float ambient = 1.0;\n    float diffuse = max( NdotL, 0.0 );\n    float specular = pow( abs( NdotH ), m );\n    if( NdotL < 0.0 || NdotH < 0.0 )\n        specular = 0.0;\n    return vec4( ambient, diffuse, specular, 1.0 );\n}";NGL.Resources["fonts/LatoBlack.fnt"]='info face="Lato Black" size=32 bold=0 italic=0 charset="" unicode=0 stretchH=100 smooth=1 aa=1 padding=4,4,4,4 spacing=-8,-8\ncommon lineHeight=39 base=32 scaleW=512 scaleH=512 pages=1 packed=0\npage id=0 file="LatoBlack-sdf.png"\nchars count=95\nchar id=32   x=0     y=0     width=0     height=0     xoffset=0     yoffset=32    xadvance=6     page=0  chnl=0\nchar id=41   x=0     y=0     width=17     height=41     xoffset=-3     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=40   x=17     y=0     width=17     height=41     xoffset=-3     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=36   x=34     y=0     width=27     height=40     xoffset=-4     yoffset=0    xadvance=19     page=0  chnl=0\nchar id=124   x=61     y=0     width=14     height=40     xoffset=-2     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=125   x=75     y=0     width=19     height=40     xoffset=-4     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=123   x=94     y=0     width=18     height=40     xoffset=-4     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=93   x=112     y=0     width=18     height=40     xoffset=-4     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=91   x=130     y=0     width=17     height=40     xoffset=-3     yoffset=2    xadvance=10     page=0  chnl=0\nchar id=106   x=147     y=0     width=18     height=38     xoffset=-5     yoffset=4    xadvance=9     page=0  chnl=0\nchar id=81   x=165     y=0     width=36     height=38     xoffset=-4     yoffset=3    xadvance=26     page=0  chnl=0\nchar id=92   x=201     y=0     width=24     height=36     xoffset=-5     yoffset=3    xadvance=13     page=0  chnl=0\nchar id=64   x=225     y=0     width=35     height=36     xoffset=-4     yoffset=5    xadvance=26     page=0  chnl=0\nchar id=47   x=260     y=0     width=24     height=36     xoffset=-5     yoffset=3    xadvance=13     page=0  chnl=0\nchar id=127   x=284     y=0     width=27     height=34     xoffset=-4     yoffset=3    xadvance=18     page=0  chnl=0\nchar id=38   x=311     y=0     width=33     height=34     xoffset=-4     yoffset=3    xadvance=23     page=0  chnl=0\nchar id=35   x=344     y=0     width=28     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=37   x=372     y=0     width=35     height=34     xoffset=-4     yoffset=3    xadvance=26     page=0  chnl=0\nchar id=63   x=407     y=0     width=23     height=34     xoffset=-4     yoffset=3    xadvance=14     page=0  chnl=0\nchar id=33   x=430     y=0     width=15     height=34     xoffset=-1     yoffset=3    xadvance=12     page=0  chnl=0\nchar id=48   x=445     y=0     width=27     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=56   x=472     y=0     width=27     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=55   x=0     y=41     width=26     height=34     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=54   x=26     y=41     width=26     height=34     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=53   x=52     y=41     width=26     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=52   x=78     y=41     width=28     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=51   x=106     y=41     width=26     height=34     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=50   x=132     y=41     width=26     height=34     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=49   x=158     y=41     width=25     height=34     xoffset=-2     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=108   x=183     y=41     width=15     height=34     xoffset=-2     yoffset=3    xadvance=9     page=0  chnl=0\nchar id=107   x=198     y=41     width=27     height=34     xoffset=-3     yoffset=3    xadvance=18     page=0  chnl=0\nchar id=104   x=225     y=41     width=25     height=34     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=100   x=250     y=41     width=26     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=98   x=276     y=41     width=26     height=34     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=90   x=302     y=41     width=28     height=34     xoffset=-4     yoffset=3    xadvance=20     page=0  chnl=0\nchar id=89   x=330     y=41     width=32     height=34     xoffset=-5     yoffset=3    xadvance=22     page=0  chnl=0\nchar id=88   x=362     y=41     width=32     height=34     xoffset=-4     yoffset=3    xadvance=23     page=0  chnl=0\nchar id=87   x=394     y=41     width=44     height=34     xoffset=-4     yoffset=3    xadvance=34     page=0  chnl=0\nchar id=86   x=438     y=41     width=33     height=34     xoffset=-4     yoffset=3    xadvance=24     page=0  chnl=0\nchar id=85   x=471     y=41     width=30     height=34     xoffset=-3     yoffset=3    xadvance=23     page=0  chnl=0\nchar id=84   x=0     y=75     width=28     height=34     xoffset=-4     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=83   x=28     y=75     width=26     height=34     xoffset=-4     yoffset=3    xadvance=17     page=0  chnl=0\nchar id=82   x=54     y=75     width=29     height=34     xoffset=-3     yoffset=3    xadvance=21     page=0  chnl=0\nchar id=80   x=83     y=75     width=28     height=34     xoffset=-3     yoffset=3    xadvance=20     page=0  chnl=0\nchar id=79   x=111     y=75     width=34     height=34     xoffset=-4     yoffset=3    xadvance=26     page=0  chnl=0\nchar id=78   x=145     y=75     width=31     height=34     xoffset=-3     yoffset=3    xadvance=24     page=0  chnl=0\nchar id=77   x=176     y=75     width=37     height=34     xoffset=-3     yoffset=3    xadvance=30     page=0  chnl=0\nchar id=76   x=213     y=75     width=24     height=34     xoffset=-3     yoffset=3    xadvance=17     page=0  chnl=0\nchar id=75   x=237     y=75     width=31     height=34     xoffset=-3     yoffset=3    xadvance=23     page=0  chnl=0\nchar id=74   x=268     y=75     width=21     height=34     xoffset=-4     yoffset=3    xadvance=14     page=0  chnl=0\nchar id=73   x=289     y=75     width=15     height=34     xoffset=-2     yoffset=3    xadvance=10     page=0  chnl=0\nchar id=72   x=304     y=75     width=31     height=34     xoffset=-3     yoffset=3    xadvance=24     page=0  chnl=0\nchar id=71   x=335     y=75     width=31     height=34     xoffset=-4     yoffset=3    xadvance=23     page=0  chnl=0\nchar id=70   x=366     y=75     width=25     height=34     xoffset=-3     yoffset=3    xadvance=18     page=0  chnl=0\nchar id=69   x=391     y=75     width=25     height=34     xoffset=-3     yoffset=3    xadvance=18     page=0  chnl=0\nchar id=68   x=416     y=75     width=32     height=34     xoffset=-3     yoffset=3    xadvance=24     page=0  chnl=0\nchar id=67   x=448     y=75     width=30     height=34     xoffset=-4     yoffset=3    xadvance=21     page=0  chnl=0\nchar id=66   x=478     y=75     width=28     height=34     xoffset=-3     yoffset=3    xadvance=21     page=0  chnl=0\nchar id=65   x=0     y=109     width=33     height=34     xoffset=-4     yoffset=3    xadvance=24     page=0  chnl=0\nchar id=57   x=33     y=109     width=27     height=33     xoffset=-3     yoffset=4    xadvance=19     page=0  chnl=0\nchar id=105   x=60     y=109     width=16     height=33     xoffset=-3     yoffset=4    xadvance=9     page=0  chnl=0\nchar id=102   x=76     y=109     width=21     height=33     xoffset=-4     yoffset=4    xadvance=12     page=0  chnl=0\nchar id=121   x=97     y=109     width=27     height=32     xoffset=-4     yoffset=10    xadvance=18     page=0  chnl=0\nchar id=116   x=124     y=109     width=22     height=32     xoffset=-4     yoffset=5    xadvance=13     page=0  chnl=0\nchar id=113   x=146     y=109     width=26     height=32     xoffset=-4     yoffset=10    xadvance=19     page=0  chnl=0\nchar id=112   x=172     y=109     width=26     height=32     xoffset=-3     yoffset=10    xadvance=19     page=0  chnl=0\nchar id=103   x=198     y=109     width=26     height=32     xoffset=-4     yoffset=10    xadvance=17     page=0  chnl=0\nchar id=59   x=224     y=109     width=16     height=31     xoffset=-3     yoffset=11    xadvance=9     page=0  chnl=0\nchar id=122   x=240     y=109     width=23     height=27     xoffset=-3     yoffset=10    xadvance=15     page=0  chnl=0\nchar id=120   x=263     y=109     width=27     height=27     xoffset=-4     yoffset=10    xadvance=18     page=0  chnl=0\nchar id=119   x=290     y=109     width=35     height=27     xoffset=-4     yoffset=10    xadvance=26     page=0  chnl=0\nchar id=118   x=325     y=109     width=27     height=27     xoffset=-4     yoffset=10    xadvance=18     page=0  chnl=0\nchar id=117   x=352     y=109     width=25     height=27     xoffset=-3     yoffset=10    xadvance=19     page=0  chnl=0\nchar id=115   x=377     y=109     width=23     height=27     xoffset=-4     yoffset=10    xadvance=14     page=0  chnl=0\nchar id=114   x=400     y=109     width=21     height=27     xoffset=-3     yoffset=10    xadvance=13     page=0  chnl=0\nchar id=110   x=421     y=109     width=25     height=27     xoffset=-3     yoffset=10    xadvance=19     page=0  chnl=0\nchar id=109   x=446     y=109     width=34     height=27     xoffset=-3     yoffset=10    xadvance=28     page=0  chnl=0\nchar id=101   x=480     y=109     width=26     height=27     xoffset=-4     yoffset=10    xadvance=17     page=0  chnl=0\nchar id=99   x=0     y=143     width=25     height=27     xoffset=-4     yoffset=10    xadvance=16     page=0  chnl=0\nchar id=97   x=25     y=143     width=24     height=27     xoffset=-3     yoffset=10    xadvance=17     page=0  chnl=0\nchar id=43   x=49     y=143     width=26     height=26     xoffset=-3     yoffset=8    xadvance=19     page=0  chnl=0\nchar id=58   x=75     y=143     width=16     height=26     xoffset=-3     yoffset=11    xadvance=9     page=0  chnl=0\nchar id=111   x=91     y=143     width=27     height=26     xoffset=-4     yoffset=11    xadvance=19     page=0  chnl=0\nchar id=62   x=118     y=143     width=23     height=25     xoffset=-1     yoffset=9    xadvance=19     page=0  chnl=0\nchar id=60   x=141     y=143     width=23     height=25     xoffset=-2     yoffset=9    xadvance=19     page=0  chnl=0\nchar id=42   x=164     y=143     width=21     height=21     xoffset=-4     yoffset=3    xadvance=13     page=0  chnl=0\nchar id=94   x=185     y=143     width=25     height=21     xoffset=-3     yoffset=3    xadvance=19     page=0  chnl=0\nchar id=44   x=210     y=143     width=15     height=20     xoffset=-3     yoffset=22    xadvance=8     page=0  chnl=0\nchar id=61   x=225     y=143     width=25     height=19     xoffset=-3     yoffset=12    xadvance=19     page=0  chnl=0\nchar id=39   x=250     y=143     width=15     height=19     xoffset=-3     yoffset=3    xadvance=8     page=0  chnl=0\nchar id=34   x=265     y=143     width=21     height=19     xoffset=-3     yoffset=3    xadvance=14     page=0  chnl=0\nchar id=126   x=286     y=143     width=26     height=17     xoffset=-3     yoffset=14    xadvance=19     page=0  chnl=0\nchar id=46   x=312     y=143     width=16     height=16     xoffset=-4     yoffset=21    xadvance=8     page=0  chnl=0\nchar id=96   x=328     y=143     width=18     height=15     xoffset=-5     yoffset=3    xadvance=11     page=0  chnl=0\nchar id=95   x=346     y=143     width=22     height=13     xoffset=-4     yoffset=29    xadvance=13     page=0  chnl=0\nchar id=45   x=368     y=143     width=19     height=13     xoffset=-3     yoffset=16    xadvance=12     page=0  chnl=0\n';
NGL.Resources["fonts/LatoBlack.png"]=NGL.dataURItoImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AACAAElEQVR42uy99ZNcybLnecUMJZZK\nzMxQYmaVmKHEzMwyMUslZsYWt5i7JTXDvX3pvTf7xnbGdm1szOaH/RvOZu18fNMVikOZWWqpb6ZZ\nmLqrKs+J8HD4hofDn/6U/CQ/H+HjOE7eyCgaGSmRUSwy8iepkvwkP8lP8vNpKutSkVEhMspGRqE4\nnlWQZ6RGRplPUfFH5pQvMgpbRv4AdJK/LRQZBSIjdwLnlStrDjxb3pPP5zt5XNZS2JhrzgD75vec\nfAHWkId9rxUZjSOjWWQ0iYzakVE+i2bZsJ85spFXcrD2omoUTuS+h+CNrPeWjIxyyFdF/i2P/BbJ\nov9HnFMBgy5FP+b7PxceSn6sMpUjyQ+/M++xEVkntGoo6naR0RplXSyG52UpqBqR0Soy2kdGC/6/\nVCIUZuQZxVF4ldUoFwZkoEBrRkZDy8hadxmX75VgLfK3DSKjHj+rEAu9DLplraN6ZNTl2fKeLENa\n2uV7Kcac3EZ9aFXQBQxVZC1+z8maSykfYJX1nuaR0S0y0iNjSGQMjIwe8EX1OAFmfvigHPOuAv9W\n5b+z+KM0xih3nPwmtGkAmJHRgHWU8gNWCTKyZVhjfWibhnx14N80ZK0h/JAFCIpk45yygEYleLWR\noksj6FLMg56lmV8iRkqsyhOZK8M6qioeqsTPC2cj/XLDw2WN9ZRh6J9l/U3ROHinlJKTqkpnFgtw\nKChsmY+MkkHli3mURE9WUfSuws9KBtXhAOESHjxRMqzc88xi0LqSMb9UnlkgQXufV+mvygbvVUQ+\nCv8puz8IYypKoyPKemxkDEOxVAuD5gETlVBGgyNjXGQMiozOnACtBijgs3OyuVlzbRsZndRoyVyD\nnE6LokS7RMYAy+iGEithEYQ6vE/+tn9k9OE7aRiFimEYhdNyOYxva+bVm2fLe7ry7OLGdwsBWDoZ\nf28bfSOjDXuQ03hOKjTs7fMMmUt9DwUvz8qaT0ZkzI2MxZExLzImwQ9tYfY8MRidVNbchPV0gL+6\nQrvOGMSW8Er1eLxQKKeW7PNANfopvs76m1zZ5JUry3pb8L6+AKpRyNd4/h0dGUOhezd4qR5zK5jg\neaUgC23hmXRFlwHsSQ1THjEC1QAwbRMw0pDV8iHnXxQ9VR9A2gHeER7qwJ7XQ54LJZh+hTEsjeFh\nvaaWzEn/rDXyXyGEwc2jeKc5MtGZ9XXkvQ2ZR1EXfVsWGrRyoX9T6JPbZ60V4JdmSncLvTvzs2bM\ntZyXHmdeqchdW495VQqiX7BZJeDLRtC6ozG/dtCwDjYoVhuWB+Neg/mnWd4luqs+ayiaXcY/B5sn\nyi1LgcyKjFWRMRNBbuZ28vRQDI143rTIWBsZc1BQ/WG6LMWfN4b5lkJgeqH8MtQYiIIsHeA55SH8\nSIzTPGOMQQFUMr5XBkEYxprm8f2ZGLaRrLs1zFQwoIKvBHP14NkTI2OGesc81pvFhKnG90uzf0ON\nv7eNaRiP+lqhAQKzBK9nZEz2ecY81pklZBVcFGsDjELWs1ZGxq7IOBgZe+CHGYq3SoU4PVRg7mnQ\naiBzGQ/NJrMPGQrE9ke4muPxKRXmtIjA1uJ9Wc9foMZs+Lo3wlw6wfJZBFkRT0oWoJ4Avy2KjBWR\nsSYy1kHXlQCtOdBhOLLSmrWnJGheBaFJJ96RxVfzDboMhCYmYC2HDA1EzuIdo1ljg6CKEh6oCw/3\ngU/GQTPhoXH8vBc6q1YC6VcAUNoW/hxprGkwAE//bAR81jwI2EGmKyFj3XneWORkEnw0An3QDsNm\nHnjKsofdoYWN/n0xtiVdTtRleHYb9Msg9iyDeYi8juF33dHj1dxOwNiYxspm2ebVL4h+Qf+mYrM6\n8r0R6BThhwy1L+LBDC1PAKGqzKsLoHkkeyHvmsg+DWW/2wHAyibcy4iybgghs16+NDK2RsYRQMB4\nUEmtIKcnXFpVMZ5ZG7MsMg5Exg6U1TSl+EuGdM0UhSk6I5xZc93AWAPR2tmMksuJrh3fyfruPjU2\nsOFZyq2yRSDaYIxX8vd7WN9G5jQF5SYn7dwB5tICxpuIYl8fGdt59j4U/HjoWtECSlrDSCuMtZhj\nHvRvqIULd3pd+GAWBtvtGWuhf3sTjCgatcYwLImM/ZFxJTLuR8YXkXEY3hprA1kuNCoGYm6NQh4B\nnbPWs5w5ZdF/EyNrD1fz/tkImHihGiPw+QLyXl4FAKbw/EzWtQMeH49A14gF2HooudrwaTo8OZ+1\nbmcOxyLjVGSciYzTkXEcoLUTHlrEnIfAz/WDAi6fuYkRHwIA3gRvZMKz86F3U1NJctrsDK+vTsBY\nCq+1DLI2AHND9JqAl8XogSwe2sy/a6DfVJRxJ2SkeALpNwgwvNxY0xTmZa5zIka0rtfhghOyHOz6\nwTsLeM4G1reOZ86ADp15bjHFfw3g+/HQwqT9SgxjWxOUYAsqwgPdABACoFfCn1peV8I3E9GfbQFJ\nBVx0jOjh5S7z8rUHyHZl9G9v1jILmdY6Rea3AEM9GH6oZ4KmANfibdHBEwDqy9kLU3cthgdGAIqa\ncHDNkUgAUIrFD1PK+gIKeycKdhB/Uyag0moMqp0JmMh63qXIOITitzKMByOXAFQ0RGh68+wsJXgu\nMk6wOaM5GVb0OwlYAECW8rwTGedDAoCsd9+KjGuRcRYFuJaN68+mlfQxbA0wapN45h7mczUybvLc\nMADgOGsxR1gAcMPyjDMBAEAqvxPaZhmo55Hx18j4OjIuwuiTUcLVvJhauZo7wIuTEY4N0OoI9DrP\nsy/CFycxhjuYx1zm3QfFWDkECEiFZ0XhZIGYu/D1TgQ5nf1OSZDxrwsPDoPfs5TCbnjuCu+/Ce9d\ngV++4OfXoYmAxznMXa6RSsYxt7wosq4o63XM6TZ034gB6wGAKeABADZyQNgf4ziKsg4EADhE1MUg\njUGhC6A7BQ9d4t+TvGMDvDOCE2L1eAKaOcxUV/Rbi248xdiILpjDfp9iLnsjYyHGp5kXn3FX3YTT\nuXjhhHfOo5PPIB+b0Asj1JVvYeXhGYXx3808ZJ5bocsQ9HIZi21pyhzGQ+sNrOMYek3k9Sw/24Os\nzkDWW3scMkw9fEqNNQEBgBy++kPzLF7axn6chk6iT44z9/XszUj4uE4Ae5MPuraFXjOwhTvRX2fU\nu4T3MtmbRdCvF7a1dCIBQEkIMBSlmokgP2TBa0AqXf1ON1wnVIaJxihFeY/T3xFlqH0BAG7GSixa\nXDPDUeIiHDeVEhgBkdpy0qngpuBdAMDLEABAjO1B6HQ5Mp6hgA/yu7HMu4qbgVOGZSQAbB+K/BmK\n/QR0W+sBAEojgMNB9Pv5zhEY90UcAOA1TCnPO6hO714AQGi7mjU8iozvAQLnlJLrArjL4QGQ6ihX\n82wMzj6E5ga8+gJw8TYy3jDvLBp+iXE8rk7rkxH4lvBX7gByUhw+HADv7WSfHkCXFfB1uyAejQBu\n/9rwzgiU7EZk6aoCqodRmNtRxtuYVyYK5Cr0Oc7vFzDHLux10TjASRMAj9DiGrQ+DI1Hwdc2/jAB\nwA5OfmHH8hgAQCXmNQJ67ED2b8Mvj9FVj/n/m/DvFngv8GHIx/1fVx1kdkC/Z+zbamRnEXt5D9oe\nQEcP8QIAnLyrITNjoVMmcvAluuqiAvinWN8s9rQpe9QWuzAX3soy0k/5/m7mN4r31DI9EhzEOqCv\nl6NTTvHex8jsM/59jY64jjytA0T2RpcXCQAA5FmngwAADpaNeMck9JocgO/xrK8i4xXze4x+Pw69\n5sF37dBhXjEQZeGbdIz/BmTlCjrkOf9+yXuewpNnoPVS6NgV3VAwUQCgMATOUvzTcX+dZ9FXLaeb\nEj6KqwHPmgGRLkC8KzD6bJRoU59nFQIltwFBjkVYlrC5G9isO8rgLsBdNxIgIEGBhRIIAET5DeCU\nvxTG2YMQf4VwbYWevRH2Ai6CWoPTyGSU4VmY4RZCu4Z3zAL5t7QgbX2NMwklsRShy0LVT+IAAC8Q\nWnFBLvG7xgGQtEBRzWffz0Cf86DopcpIVPBBze05Bc+FP48xt+eAiq9QHneh220EOEuI3gEKHrAv\n+9mvyfBV1hrKBowDkFNvBgrqFErnPPOaBt/VjTNAqCq8KWvegoK7w+n0IO9bzn7O4N3Tka9FAEZR\nuHeh/zb2Q5RWlViyI1Ds7QATK1DY99EXIuP9AUzFAwKAGeiYUaxjAYZ9BetcxN+M5u9GhAUA6JT6\nyOQ0Tlen4Z2X8Ocx6HsMY/QaXjqGLGYAoKrHmlmCvDZmHfORBzl0CYAaqdb3CCCyB34Q+S3ic63b\nH1neDt88gI+2qSubK6zviHKbd0B+B7AXG/ieXOFlsi8T8PI0sIERdKwcbhYpHSmg/DTPFW/nU2T1\nBnK6mH1tbcqoBwB4GQQAKJDUkcPqUnX4esG4gWyfAfRkrf9b5n8KGs7w8/Six2qi5zPQpYfRVV8r\n+TwEyDsGfZ6juy9ih+ejU1sG0VlhggAro2S1e/O+cboZw99U9LnX0ne/B1BaT9igNZxiOyNAeTwI\nVhV3/iCM+nIY96By1V1RCvgoG7gJxpmEgLVlo/MmCADkRoG1wSMxTLlBz/CMWwj1PObQyCXCtgB3\nSGJ0d6J03rDpm1n7cISxPYxUwLKHqeoea6hSkIkEAGNYb1+vQE48N7UxlmNxW4qi36zuMnvbshoM\nfmrBfeAs9vYkAiOG/R4g8yhKYy/jAH97DUT9k1LymSiNCdyt1Q2SKqfubYcpb9kd9nsf6xwSzwmR\n65xm7NEM6HYCpXOOfVmBYh4Ff/VGEfeEJ4eqO9/NfP+ei9IqEXJ+BaFXT3hzEzLzlOev9TOSHgBg\nKryxWXmxjqm93cLvM2IEAKWUt3OR8nZ+h2Hbr+5eV8NDt9AxchgScNMwbHoltKsI/fS16yH07R3m\nsAA9uRa99AJdt41978UBqq7NEKigYP38L+H9nYCIKQDhYwCMi9B3Krwkp+LVfP8WcneUeU1RwX9l\nPbx39XmexHuIJ3E7OnMVz9vNHF5h+E7z+wno4SoJBgApyqM3C9pegNavAEz7VKzEdiVH37NXhw1P\nb1VbFhDeQ/GYzUWGr6LnH+BR2ARvL4Ime9nzN+zPSSVbnb28prEoHZt7U06zF5Qh6oliz+9xr9WF\nzV7PRjx3UZClfSL0W0Kw6Sz8AAxyj43+CiPwKxv2WN2X71P3SOkugUgxAQAlyJUx7GmcSlaxSc+V\nu24hAKaJLV2OE0kDFMpcEPItTh1nlQB05BnV3Ny2KpJVUpqyCwC05buuqZyGkZiAspiilPwU6Cvu\nvcIuz6iDgZ7IHh1FCX0Hcr6BMtmiPECS0bFYKZYzKNgf4ZUr/HwhhiPNC9i6eMtm4OW55AJwq4VN\nCWQPagGcJsBThzFSF5DLxbyjHyeKgSobZoqir0QSz4E+Z+GBQwrQd/C6nvIIoBPvzkJ46iZz3I8C\nGwYPuhkGNwCwDqN8Xp2In6AA7yjv0RLjhBwUAJRX8roSxfsEuT+DzprM2qYytzPs7SHevcjPBe8T\n9d8Gvh/EHqxiHk8B/wIyJmMULqDrzqtrs8GM7shiccs626rni3G8oGJvBrOWA+irL3j3LOVxlVPx\nNfbgNLZglrqfr+TF5waIn4mMrOIZE9iLCcbB8y1ytRle7gbtciYQAJherMPQ4Ud4L5M5TVHBepuV\nh/Yr5riNdfVFlxdxAfWik5ehsx6gxzQoG8G+ZChwlmXXvrEAwNpB45eCuh3FvTkJAyinWXE9zXNL\n61HKsQGEmIVQC8q5hBKa7ucixSjWBTVOYiMPo+xfwYg3eOZtCHQVw/mUzbnGnBeD9luY7pl4AIAK\nTjQFLSwAKIhB6QeD7YHeX3Ha0/OoEjCftfRHAADlvdJRuApqpFycWyzDjzZlWcdQ/lbch29B4LdQ\nymuZr6QQSR0EOQUvxFCfgVf+Cj1Oo1CnwpP1/PK88bRUAZCNNU5QVzglzGI/G4a9Y1fGdTD7tIvn\niktU7gF7sFapr7AC47WZtW6Gd1YBihYrQy0nvRnste+6DZAvd8vjkZsTyk25RV171fdI4XIDAPNZ\n82X49Sr/fRvA9wy52IRiDgsATJk/BX8/xQivxKCk8bwF0FWuv+ar66/GYQp+ITOtlEdzgcr2OatO\nnVv4+SKX2AD53UJ1hVY+4DoFREiU/QIVY3ATUDzbiI+4gE67oGI1huONrO5X68S4xhvEnMagGzop\nL6+eyzv2fUt2AACXrJ7zHLwEbG1SKdOdoMkS5fX7lbke4OfDbYGQCgRp4Clz1UBnMutsBsDU4Own\ndMAu9EsfdHXiKuvCoG0Usj4CAn/Ify/nd1l/U84lmLC5mnwmpzVh3jUor45uRlWhpZZK8e9VbvG7\nPGs3zHFa3Tvuh9GvMd/VKmWmnqmM4gUAliCXteoZt1G482H0xh5XANro7jCuAHSkfPUgOaAfCwAE\nCGLTAGA/Ai3DExwpQ9OFfVjLvmet4+/K3bwBgzOQfWgKCG0ED3WDZxfCM1dRLj+g8PbBq0ND1I8o\nhZAOYm17oNM9rqeWQvu0IOmoBqCsahjX44CLU+p02pvnz1b3/EcwIpcADJdU1PIWdd99XrmZ5STb\nPGhGgLpb7qeycC4zx2PGHbKX3LgBgPE84yD6YxuA5hCy/wMn1V2sPxYPQFvlsTsBL71Q1xfjVUGp\nEZz+5OpLrlvS2KsyQSrXccCqyYl9Eu/ZzzoPKr68on52kH29w/zOGr9zDaZWBmcU4FBOkpeUm1+u\naQ+q+I3t7MMsjJLER1xDVpayv111umBAvqmBjLVH7zZDXnugP1com/NKHYAmSqBwoq4AlH4aoILJ\nb8BfjxUvj+H7EtcmPH+VWIDnim9cbZsx1xXK8/TO4unQNvQgAOAH5R2aqeLKEgoA5J5ioApMuaWi\nKvV9TGWPgA/TvfYlC1mCELX0uh/FtdxR3YGdREifMo9NzG+9UnpyolwPkTZAqHSYrlyiggA9FNkG\nvvuV2ixxp9VzKb2bWymGqazjEsjwCspvGiCm1qfkAYgBANzFlfVlAAAgwVqmN+kbXHQ3VUrUMJRd\nNaJ6C/F+qV4mgTf6tPpP+Omkctt7AlODTrXV6WGjyrQ4Cx9MZk9rhUgzLKSuF2Zi/C4b12dDLcGQ\n1/ib8+yTjmg/pdYnrubH6rQrabPlA86xAopsBMbgIMDnC5SoeAmb+aS+ugGA/vD7ErwWM6DFTt7x\nIzy5O0YAUMq4G5f5v4XW2zEIQ9ENUqGtHd9rhttbj+aA88I+V0cNAE6zka0vMLz30Tt/4d/7ajxg\nbj/Bt/eNbIChNgAHKGmGJ0lf09xEFlfw/Y3wyxN4ZR16aK26bhNP22rASy9ku1RI+5If3ZSKrLaG\nHlJfYCe67zXvPcT+jrKB6TgBgBxWJfNNDO1v6lSvAXI1dbW9AXn/yojVmoLM1zDjXozYk8U8/55x\nBTCH96UDJlYq4GZexXfHbuROJADIz51rbwRPkM5bAzlaXw4i7oyy3YAyfG2JXm3kcY+dCwJ2h6Cb\nlUHUjD9J3Y+dV0hxIgpjihLiai6BavFeAbjNVdxXYrx7eBlvpQwzFHO9NkBEH7dMgs8MAPwlIAAo\nYbjCxJv0Z0uApBRFKeziTdL31fuV++6NJfApKMjSqZvLVJBVKEPosubBxlwvqVN8PzweGwEv9+A1\nyRdeo0CkCbyXcJX2gOuQdQr4BCnElA/6dDeuCd2AT/4YAEAvQN8w5FfysiVY7626C50RAwAoojwY\ns5QH442KkJfDw2BViKYWdBrEnusxyC+GxNhb4eezKg/+GafJS+rnZ5U38AF64Sx6SgyGNRhRxeD0\nUrEMp3jOJZXOewoeu4KOXgg4yET27yuaTEdvtEB3FokhxiUPe5+GfEzlfbtZn6RgnkK+Z7JXjS1x\nDvEAgLJG3RQxtL+oAG6dbWGra/KCq8hr8K+czOuYvK+y4/oatXGesSfHoPEi9OUydRX2tRFwKMH4\nlf6UyA8uyGoqDmAjk/zaYozqaWOkXFw91En2MsZQu5Z6QaB8Hvmr8pxpCPoVlXohCm0qRLysCtNI\nxcLeGIU0BLdIIusAGGuuxbumM1eJebgQIs/djbluIZQi6A2C3NX+QQCAFDYaYaRC/dPirnWtJMip\nup7yJEiWxQ+GW83K1x7rK8b6+nOiEw/FQ+YayBXuU1/iKErptFrrWH53CIN4DWW1HJmYq9yZ4iqf\nowyPuHsDe7mMU1NTFPc83vMF+3lIpa75Xn34AIAmKP2p8Nw+jNZLePgoPx8fBgAgrxU50fVUXpEj\nrOFbaHoUT+IMZdxbAiLnQH89fD10Fplcp4bc88rJU/9OYoqET6Xc82JOiVJ5Mo/L9WQaYGo++ukE\nz5K6LDcxvHtZixT7uYyH7Kwq9iMHKulTIP0DioewMcJD/Y3g7svoqFvMcStzHoFu/CC63mLEj6vr\nHD8AoGO3Vis667v22cp763aH/5PhkeqHF6+g5bBY1Ug53APtxcsihX/2Y+wvQpPr6PCN8WTvBN2g\nSiit8cadtk5r+yAH1TAeMy3pbJtUkEN1N+To4wF4rhhyoQqQOWlUF6yDMKb6uOXiBQB5cQX3YmN2\nqMyJcygReUYDl3SdUjCYLZPgtkKi/2oAoJxBExG4/7AEbFljUgyQZgOUv8QBsnKrjJcM46oqcDCc\nBz+uhubmWiXz4KK6d1+DIZUiUJJSdkEFyw3BaMjvTP4MAgB0ga+VGMqHqr6HBD828rsb9gEAHRTQ\nOYhMCSAWRTgrbBog9G2OUs/gILFFAYDvObDcQgGvM+JLJM7nGHtynIPN9AAAoDh06etEGzeN98jz\nn2h4A7WbeRxr7eFVFc6JNi3rAu/MY027MDQH0S+boMVceMut2M9oFcA3jL3u4KbbfOzLWHjokCo2\ndo05SdXFUapgVTEX715rFbMmp/jnKmByTMAgSdH9P6psCH2iL+MCNrQO8dTTgJ9G8PgExX9yLfcE\nYHYXGX2FDd2rAp2HqqJD+bIDANii2p8xqUwiNT9Q2iqdrZ9Roe91WGWDoumkQIgowp8gzBkILsFX\nx9RdUTpeAGk9nJKNAEAbF/F6XFT3NaJ8R/A39QyDW0Dlyg9XhkTyfq+plKC+NmT5BwYAbgj931nL\nMQRxJIJZJgCgFK+RAIBfYwVZ6gTSUuWU7+d5gdPhXDxBYmjOqLVKAO4C9R6dnTOI761R8nJCVZQz\ni8qcVCckazVHF09KbwyeFPh6qvKTJ6j0x9xxAAD98wvqTvgIemQWdA0MAMj5bsj8J8I7e9FN95CN\na9BbCtEcdqIlvQeoOZ1XBnJLkDtZ9f4uyHJftc/i8buqrjamKQ/nS3VlM4E1dBTD63iX0C6J3ugM\nCJTywguVu3mapdjPDVXsZwp/v1Kl8C1hnqPQbY386l6QQSMeZklxFH15G52wmvnovhUlfWo6DAP4\nHlZpo1o/tLEUETJlTXS/eAWFH/0AQCAd4kS7tXYBSM2Hl+Qq6Bl0v4Vc31EekaPYgVXQJh0+L58d\nAMDNrXIfdLbIsdShBm02RFDmqspWL50Pa8dXDDAHKbYi1aOugoh+hDBfoMglQ2EjymAOhnSQYqDS\n2QEAjFORRrQ62GatWyoibuQmKpp8tVrrbZh4LYqnmy245A/uATDv954qD8AJBMKzpLTy0pjXNFkA\n4GeV+jRHue+CAgCbUbyogu/WGQVx8oTwAKxx8QAsUYruqsoL7mmAULkuW6zSIdfB4+KyX+qVuuSR\nkqnBzi0Fdob6BfgGBAAdDQ/kTQyhGMfB6JFAAMDF/bpPFRG7hQ7ZpYz7G3j/IHw/VfHPFXWwkdij\nzj7XfHLyHQ2gl2HL858NP4r8aYM2m5PpaCfaoM0vDa8Ef9cKPdJf1RFI9yn2M4c17oMPTyF7B+G1\nxfBrd2TBrx5+VSNoWoLpdMzUAHV9W8InaL0pOmShihN6wFok9qWFhSfc0iRtHoC6lus5mwdAdIgN\nAJTHrg5F/27jnRKsexke3Is+2q9+/1Blh0ggZs8w6bth85BtxkOIaq1DbSj8eTDMHSdEXWYDTNRT\n1aNWsbmSbvQGd923qhjMOQi4k3dJ45NuKPXi2QQAzDutdWzeWZWOuFQxohsAWIhRvIICP6CUwWD2\npFyce/g5AQCpZDbcQPd/BwhK0ZYJSvnm9Ehb62+k+/xIBK6OT7EG8AR0i4813OK6atwAx6Ukrk+u\n8HGV7igptFJE5JECANNUzvoeVZRH9lq69UnvAl2Su79XUG6A644LKkCxd1Cl5AMAdOzHbjXWqiyk\nViEAgJm6uFVVfHvMWjZgMHYrECfZPHIyXQBNb7mkilXw8EJVd6LlvjepNUltCwEUer0HkRm56pGf\nSzlna6dFlzkUxAjVhBZNnWiVTq9iPxvhQzmVXlcg4Sw8tZC9aBvgcFdRnbzXqLTts8pL3Bn+KBTA\nTjQwZPuaSllcoOrWFAuQl//U407flj76TAGGXUbGVwFLzQEJnl0Pzz1QMXISgzFPeWiE9g8UL+4L\nC7bDAgAz+CosABhgAICXYQGA2qDmbO4UiLMTgkgBoCcgsO8xCpLLesyJNj4Z5US7W+XOBgBQXLkW\nJzHPHWzw7RgAwE0lWKud92vul/4XAgBuKak/q3xpXYGrkfNhH3NpRdrGyHmWdB9RuhKs2dUrPsUD\nADZzCYw7rK6m2gZws5spauZd/mQjZUlSIZfy883s0yN1ZbcE+m1Adu6pILoJToCa9ur+2ivgMVRk\ncoAgQGmYok/LcgfaKiQAkCpsw43Uv59UbJOU3pXgrEtcOcnddCY0k7oMOjVzsFctBbInbNlV4imU\nYLKH6mcC4qTa6V31c1edEoDuUo2wvU+xH2nXe1hdj0hL973oyMcAcSmY49sDw5IPv12NwE3iFF0l\nBku8M/p5rinYLpX5HiqXvlnDxS027luXCn15LZknGqh8wQFE18jJ4H1SyltKBl/Hxj016ul0cLIh\nE8BWsCDMFUB/4wrglXEF0MEJVnJVejS3Urmi8xDCrWzQOeXCe4Bn4J2KE5DuVv1d0kgSAQCk690o\nhaQvI7CHnWjd+yAAYJNKv7nqRLvu6dKyOf9FAEABlcY03Yiv+JVnHUR4R0Of+hj8sgDIqvBpH1y4\nkrYmbYnFgOkufqkh5UWnxk1W6a8vnffb4vbECBTweJZuEGOL5p/rvN+FUEq7HoSe0g75qKoLIL0R\npFWvdH2bDWhp7gcsnffbIC9zoiVTrzPHuTyrqRO8L7oXAOgKz0uQ1C5kQwP6MADAzLKReJLvjGsU\nCc5a5kTrsL90ok3RDiPbr5wQzZ+caL+PvqoGwFUFAt7wni/Uz68CUn5Q3h4ZmW562IfmuTBkrZE7\nr2I/WubEA7EawL0Y+ty0AKGmPnFXJRRglmsVGVPDpM4SUyCFs8YYz5ruRDvn2fLyU5irmXL7Z+zH\nIaNujTTymaKubb52PizR3NXU0+qqYrA66N3jEPIAvlqq3lXfJQj+a3UY8M0uixUAiFE0g6+CBAHW\ntwQBWkvahqhLUEm5qyTQabqKkpY0qKNOtIvTTxD4sAqeSgsRCRo0CFB38hPGkIIwkrst1c36YHCL\nWe6QezKHKcqASL367Qjdv1QdABf3unSck94PF1Dec9njnij6Nux3J8BfhhNth3pTRXtfU4Y1lAGz\n8FEac9DFcW6o06WcEksFONH0MPhJGnJJ8yK5r73mRNvE3lD54ZvU/eEd/r2CjGxR6VUdOA3m8zkx\nuhU9OgO/TkIGwhQ98gIA4k3ZiSzeUIBeZCEMAKioTm/SsOsVpzcTAOggwf0q9ug1gFGqfGrw6dn+\n2fmw7Oxa3rlNBWXeVZUPZUgdFbmy0b/TWSuFQxzumgJEpvgU+5mrrpPuOtEGRYOMAMVHzvut2Fv5\nFHkrDhBu70Rbu4/ixNsLOaoe9BoOoN8Y+zDQqM3Qld+VdYnfsRUa+9Y4lY9HjzRVVQP1qVyKaq1S\nV0GpFrDRTGXiSCru3xTY0EWdqlsCJd86H5YNFrCRUAAgEfgTDGGxFUewGQ/d3/o6k75olDqsEcTN\nihFJBX3Vgjgd1dzOKoJIvrCU1DQjZz8odpINaYDbjTRA/YxmrCWHhYGbMD8zDfDWv2oaoBFfkc7J\nSXfr+gXDeFIFI01VEe+j2PeZGM69Kpf8FwTvuBPtrtUNPssXg8wUsxSXuaKUw2pVJrSq491DoaJx\n2pYSuJeQqbko4NXszwHGHgzpAui9mb0+hGHZwXekzrukV/nFJZRC7gY73mWP24SJSvYBABL3IW7Z\nH51o+WJxy4YBAGZ65UnldjcrSnbHKEyCbzKdaP+Jfyi9shHQ0NfNyFjm0BojNZE91KWIdXnjaS7B\ngdPUGK9AV94A9E5Bf/RALqTYzxeWYj9aZu8YUe4DMD5yMpUg1SAZOfnQ/R3Zq5ns80o8GlPU3qYG\nXFNDgP849NoKdZc+jt81dD5sBOfWuO6ZURVSYrD6QnPd+lqXE1/gdhWkPL0DVRaPFCPTsSRj2Z8u\n0NksO2wNPE2k8TdPtJsx3m9UasTMEIWALqmTlg608j3Jsrl1QITd2ciOEEcXKdJVANco4f7a8W/r\nmwgAoAsBCQD42nm/6YYEqdnaouZ0yf9+ESS69A8OAPIgpOLiW8ZzBGR9z7Ok++Mm5rgCgVoHaDjs\nRHtr/wItzqmT1CAnjv7aTrRvQWeUq+5bcElFr7t2C7Pct/fjO1uUF0BXqctg7tIYRtq7DmffpzvR\nJkALnWjntYHMs4GfmxXerILcjVN34I+VgpRKbaEaH/kAgCEq0+CGE220tEudfMMAALM1rrQol/K6\n0iJ5vhPtWjmLv92sDkF/Uzn5u/n9uCBpcHhSqjGPruzfenXK11HwMx17EyAxEGIkmgRMLy2MnuoE\nsLQV+9mmiv30D+EBkCws7QEo7QMmB6oMiEPw1H508BQneGOuyiqzYgkeo6MqbW4Jv+tg8zo777eu\nX8wcxEN4XxWEmgs/LFXV+b5SdWmkoVhP21UQAZj1nA9LfL/hORfZ74VOtIvnDOXpuwdY0DE3EitR\nIZEAQE90lmJC8xTvVgpYhFozt/YezGfzPbto4Z4Rhh3OO6chbP09qgDqmIVXH8EDYKvjL9UPfUsn\nu3hdNN08o0v/6ABA3Rk2AjhOZg66OMxPKMmb7NtJVaTlNPtxD0GTQKtzrG0xgtSJ/ckfh+yUUdXi\n5E5RoqV1t7DWXrQDTFTBRTpK3bdeVVXqpFDKWJXONQDDkAZPS7vZIfx+vEovkzV7piY675cv9Wp9\n3MkJ2frYBwD0dqL16DNZ814Un3hr0kIAAHMdm1Wxm++d9xuMbWbsYN/O8vvHKs5Ish92GWlwDR3v\nFuf5jaJUoi9eG1Hw81UM1UMA7DKVslmTvSvtFxPEIaUK9BpqFPt5Yin204k9mGaJAVgDDy1xor0F\nbgAU5qtrtBSfDADdRfOu8oCYDapK+FyX1TFihM4z10f891Z1tfNB9Vkn2tq7l7p+PQnN37G+49Bn\nJ7x4Abp9raLyF3tlQTjvN/kap6pPSlvzh+zHHnhvIyDhkDpQvkT2dsZ7ZemXLypdzrSrQlL5xNC6\ndTxyawb0QDHxCJRgWY9TRyVcipK+tJHNXIEAz7BUAZzivN/CWLtWrGgpAQBAglC0V+I8G2bWh7Z6\nPVShGtPr8taS5107oLvvjwQAcnB10pI56/Kw5zHur3ETfw0qf6pKgr4FPf8ne3uWk+tidXprEK8g\nOdEW1qI8N6vI6tMo90nqqiGvjxegAXs+ER4+AE/dxvhuRx7mAIzGocDl+mMs/DsNWV4NP24Pmppo\nnJD0yfmmCvwa4gTsohgQAIxWYyoGYRnvmmj8fnRAAJBTgaqR7P1uZdy+5d8vULKXoPVdBS5PorRv\nwFNP4L8dzHGMSjku6cEjtoZAuq7FGCMD5I5x+m4Cf+QMSOcK7M8Al2I/B+CjCUoWdCXGw/DcdeYk\nOeoXeIakUE7m+7XdDinqoJNh1AD4pxFLEKSngy2w8gYgXxpG+bbORbe0wTs0D/k4q1L0HqpAXLGF\nErBpNkiq77j3uJEOoukq+FICc1/DTzfgyQt4vO5Cnyf8vzRxGo/NienKMki072gnWov8kcWAt3EJ\nrHBrB6wBhOTxuuVtl4LJ+6rI7RMI5SEIt0xFSEuVtDUqgv47lwCsktmQBVBJFS6xxUyIsW1kc/06\n9gZM11xiJwKlqP3eAAA+qJ4IAKDQfhWM0QAEbimg8LAKFPsSfn2igOcddY/8GuHaqZR2VwS3RALk\npxJGZoySnwcoTwk2TGe9KT7PKm+kwa5i7y447zd0kQj5NQAFuf5YDejYCh8eR4no1MR2bhk5nBxr\nQh99R/pcRcBPDZL6FQIArIpxBKkEWIx97qHS/XZiwK5jzIRvJCjvGvK8H32wFvrdBHjeU4ByIXpT\nYisKu1xr6mjwTBWAJz1OdHOae6ooja4GGrRQVYoTLT1rFvu5o4r9TOXZTQkUbALfzWBvjjGPe6oe\ngICibeiTochnBR/7oj0AR3nWY3Wa1mmVfh6A2oa34jyy8YD/lvoUcnjK53I9oiv0LXKiPROuolOk\nTO9DI7tmTdDKfMhTNdY/XB1sDyHTksn2BED4CHpfQ/fuRq4ns1dNwoLusOlMEu37Wrl55ikFVtwn\nslIHMOi87RkYmPouQlJFuUqWq9z4rxCWcwjhYf7/OIwjbVFfqaCW9QqZfpCClSAAYGZNnEJJ3kPA\n/e65C3pkT5w3Aj6CZk/8bgAA49+Q+fZVefwaANwLAwAU4q+CoPVGWGexvk2qcMpReOIYPCIVtR5Q\nQ+AxPLRdpZV1hj+KxylDJVTQouTwXlNR/IE7eRH/IGmw/Z1oV7ztrO2KSsW7oCq0HVcV28460XbC\nX2DM9gFUPXkK4yH5+HPUWr5Ua/GNgA8BADLjHEF6AYhx64V+kZbiu1DEUuP/CM/cye8XA8JmQLu9\nlvdLcZ5hHiBE11hZpr67DzmX5kNyEpXf626VNZ0A3SoN3TRapSjLM/c70Z4Kg5hXJa41q/C9ofx+\nLfr/CDx2VM15npKh2l7gxKiZITEAB9Xz1qCvewYBlciHvirbwRyP8N+LVdqoXzG3BhyyRiO7a9n/\ng4ovDjNPSe2ewlrSnAC1+QGhdbApw5xoN8st8JTmwaPoSGkAtYDDc1/4q6ITshOjH7O4dfp6jSGS\nuvY9PNCUBENJxbB1KKJnGJ9MNmWYrbKdE60V3UUhVsn31+4X6Yn9hn9vg5he83ennGgHqyFuyDQe\nAICglAU02Rr5BA10K6SqWc1VBW/0vaDEMNRhzvk93OWluVLIbgBQCxdxboMm1VEGY9Sds7gS72OE\nA3lHXEBqBebdEZqJq3guvLVcRQIvRXAkpUrafT5kr7cyh+E8r1aYQDaX+Um+sASlHsRAXwiaN27s\nR2VcuL3h0zk8dwcK4zTegOsqL/sm/38Jo38EeZZ2o5M5ZbX2AHIVlfGQyOeLTrRT2+yg3gwP5S3B\nhQsSMOaqu+OSHteL5VXamLQbnsPpW/hmGXSaze+Hs2eD0IHzPeYgJb/dAIAUJJqnvjcfHh6iTqJz\njGePC5NCbVzJjnKZ7wx0cXvktoC6vqvFzwdDg/nI1kr+XQAthjFnXy8a8lEdgywGcAnPWwhfShZA\nkGJxxVUWgMjGMsZcFTTZMEC2S2n0cCfWnMH+a52yjHVPg6a9mWu1kF6Z2uxLP/TkNOi71HiX8OBE\n+Ko7AKpSol3/ula2WdL0vgXxV/TJNW3NBi92on28dX30iSqFJb/l3rGlcvVKMZCDTrQ/tgSOvHOi\n/aNvoWQPqYheQaa1bMo2TgBQgc3oxlzHq9KWz420JdfAR+UB6GvcC5oFJgbA6K1A6HlcaN8Ygeyf\njQCgv2LGVLnKsaxlOyeHg5xYv1JR1FuMAJ0w5XdTELrG7F8P1jOENUsu8DDl1tvhROu8/6juLzej\nOIai8Go4cdTXhn9boMimITeb1Fig+KFogOflhcaN4OWBAMLZKIl10HKHEy0tu5v/3wKAXI5C1Mas\nFWst6AIkzaYtMtbCPyPRF9WDnkhdrvp6sqZ4RzqyWtunEp2A5NpOtDb+AHhF+GY4RqAfNGgDX7dm\nvukecxBvUiEXd3Nd5NP8ruTAN+AZA4zf94RepULQWAxkN5f59kF+alsKcRVVB4ke/P0IFWcymDm3\n4ftBC0AV4+/boSekqdNg1tgSWxS0DkBZZKML9B/OSOdnjZzgnQpLAOAlU6M/emGE4otBrLs9tE0N\nEphtiY+qgg5or2pfaB4cgT4THmwFX5V1AvSDCSuMtlrZUnVNilDMgSmb+FR6KoKw9HHe7xr2ShVe\nke5lzSz38vkhTgsIIy1Ql2KUJRrznBNtmHOIE+UWFSg43A+ZxgoAVN53b/5mrnJBXeb+3iziU89F\n2ZodBSV47DVAYA9rnwfilrLApSzKRfonjGO/5mUDAJjHejP4u0aCrh17Q6hbuPxfAQKvq8CjMX7u\nOZ+U1RROqrWYR3MEpTWjJcpvrBOt834J0PiCeR1XrtDBIPNqQYItPU45VVGM/VnjJDXGO9FGHgUD\nPjMHHroarLGzAngT4JuZyuMiDWOmsk8jUYjdmVc9eN/LUIoHYLgx/wkops48JyVGOuUELNVFESZi\n1AxRFa+QE62N3wh9I3zTChlrAM3Lq5okdQLMoYSPp7WW5Xt1obnscyPL78sFDf4zvA5uc66PJ6aI\nx7VbeQx2U+jSBho1Y06pQQsRGfamMrqiBc9tzvMqhDwM5ABM1sA2SZnoJuxFqZBzK4CRrcH8mht8\n0ZR5VgJg5YiR/3Ohvyqp/TF5sLniwXJOohv/GGhc8mR1JbMHqgSkRB76pQ7lUHczEqUrxUwknWSV\nciVX8HD1NuA5fVFik1Bu4mqX+gJS73yaOqG2Y6NKBrgjCwsA9F3eUgyLtHV86ES7aa1x3m+Rmitg\n8NhB3LhPVanXPaxb2rdWdNlD6da2E2O/z7iGiQUAvFS59vtY7zInWuO+ghLsxsa9/xX26RLzkLu+\nqQDOJgmIwM+Lgi7B6a4MozSKtCf8K8Gjx5jLaYbk+0oRlGbxzAlPSGXW1h65kdGJn5ePEVyUUQGW\nbXheD8BoX2jal//vwe/b8M5aYswCKuk67K85/5aOT6e2kLQqmqCRL0beKYr8aL5JAdDmthxQ4pqD\nyzPMmipFjN8XjIPGBVzmWiiIAWO+KdCmLKNEnHPKyRpLQe+ScT4vLwa5NKN4PG5ytQclDb4oHvbE\nH5C+xSw8WMLGg9kNAJZwcpMAIjn9B6obbkSf6mIm5zFmB5xo85C2PlGjxRVSTOM0J80Yzjjv9+NO\nV66ZxngR/FpT2gDA0wAAQPdLkE5SdwFNVzEomzCiQrcyPvRqDL2m4dY9xPruqGI361h/BwsAsPWr\nvsN4wKk3VgDwGPAmzzPbO6cqz4jubSD5rNvZp3XqDjpdBR7lykbeLgdq7w0Ymw991liGbzGTkB6K\nEpzqqqpRBeHOFadyKsbaqnDSqcuJvD6jLka6CkY/JaxCxEiY868MrxX8U/KT/CQ/n/9HFcqQOtjS\nWewQBm4c6L9GQIRrFjNZygl5K0p2KgaoacBqZMWMqOENGOsTKkq+CyeWyije3AHmaQKA42qEAQBH\nVeTwDp41C0AVpN56LuadhvGcznO3cYo+zDvCAICjLiMsAHB7jg0AFOT73fH+TALQSKOPCdBE3/UV\nyGbezsU+NwVADlZ58uYYgww08stK+MTkNzd7V1CN/LHczSc/yU/y868JAipwUu2FEZmh7tP7o0Bj\nCUDprfKYZ6Fk+2KsqgRRUpagJH1qm4tRaRPWrWqk8Ono8RWqOIYbAGitioosA+RI1GYGJ/8OtgAb\nl7kUAiikQe9x3OMu5NkS3ep2BaDbWy5Wf28b0gfeq5/DDJ9nLHWi7Z1TjXk05OddMPY9AQXSx13u\noPN9JN7OxZ7Vxr0v1fJsowlzy5HUCslP8pP8/KsAgNy4CuujCCXFagj/XyXsXQQBItIAYzRu346c\nsCqGOf2hlNtwgtOntiEq+jdsMEoJFH4fFX2pR3+b+x6PhFRqG6YiTyVyuIsT7epULMR8CkHnpqyp\nDx4B/Y4+Ns8J7lpp9qH/3jYG2yK4VfxGW/ZsuM/oDf3MuaSw99VwQ9fCTV0FQ1z4d+LxAux5OfjJ\nNkqEDbRKfpKf5Cf5+aMAAXG3N+GkJL2Qi8bwrIIYgeY8qxn/nxL2hIVxrMF89IlNApJiyUXOpVKs\nWltGEwxiXst3ywKWWqohkcPVOQnHEpSUh5iMqjy/KdGh8o5GzDlXwDnZRnNoZivmVIT5NwvwnIYY\nzZwua8nJevJkeyBL8pP8JD/JT/KTEBCQS52USscZnZkPg1aOiMq8cTyrAIZVn9hKJyAatbiKvtQj\nxctwqShWGSmJitpkXoV4pn5HMS/wZJmTbZT08r6wZyUCPKdY0lWe/CQ/yU/yk/wkP8lP8pP8JD/J\nT/KT/CQ/yU/yk/wkP8lP8pP8JD/JT/KT/CQ/yU/yk/wkP9n7IaI/x8d4z2dAi9yWymoyiviloqpq\ncW7fz5XAuX60dwWcj1flu0Kf01qSn+Qn+XEX1oIEvpVPwCiTgLKOKUS1255fLmyhFpROuRjWUi6e\nDnHGHIp7vKd0mBrYLvtXksDIKmRbVOO/UwnaKxjn/HMT+FeWCn5VeUdV/r8cv8+dQJ4s65KuVzpg\nUarCzK+hSz30RqyhqMee2Wqzy2gIjQsmiD8+yrsCzqcU6bVude+lnkPu35luEmhcPkGjnAc/5EbO\nvHRf0QBylOKhj7zenx/e95p7Ca9gayXDbs8o5fZ9gJuXXi7uEzhd1PL9Uj59KQp67G85r05/qmKm\n214VCchjeXz2rLRHl9Y8Pvzptd+FffaqdNzF1NjUmhRpaZuAIamDRWKYSwnS0JqQ9297vnTnKh1C\nkdX3eJ7XkOYppeKkcTmUYZrLe1qw7oIhn1sIJVyX9L521BDoQuGkzvxMN9sI+46cKL1qKmWyg3pH\nF+oKtEG5V+fvc8ZpDIUnbQV7mvt1DVNdLttS08HWEW2Aaoeax6Jsa7I2tw5w/Vh3pXi8IR/zXSEA\nc332160DXy/SRcv8znSrCj+0TdCwyjyGuyKpuW7fbU0qsBswKsR8m3joArf3F4RPW3i8P435VTU9\nNMxf2ml76cJmgLN8xvdT0CGtPebdhHcXthzqUqFNa4vuq23T5xi4Oh5rTmM9ZV2+66X3W/H78gGy\nvfz2rAX6sYBl3ZWhaVsfe1bKogNre9BbbG1cHUylN3c7iuqMScAYwuQqxXDikJ7M6RTjsT1/JGVd\n6/ihHxREbRTZyBjWMgIDVyvWynWAGulbPcrlPYNghAohnluStbXh2YN5Vobq3pah9qQnzBS4bgL0\nq4hh76S60I3n+ZNVl7sRGFRpeFMpFq8GfFAXAzLEpWxvOsxf1uf031D1pLD1RJ/FnD9oz4vCa8re\nzHH5/jTV7bFAHDL40d4VArC2QWbmu8wnA9mopo34R6ZbWfggPUG6y1XmkbemVDJ1++5wBYzKG3Mt\ngAFvC8+NCvl+KYY2yOP9UnAtzSzeBq2aMb8RHs8YgEErY4CH6sj2cJfvjUI/tOVv86vryIo8s7fx\nbik21xVZLWHQuyG/G+Lxzh7wUSGD1nWwEyMD7FU5F/4qgIFt57NnA9Gt5S0gpDnfHeNhz7qiy/Mb\nh5cOFHYb42M3UmMVIGlH2xOhXJ2AMZVNqRnUHcyJoy6EGI3iWO7y/AUsvInfVYBqUCMd6sKuZR4C\n1ShGj0Zh6NuZDVvi8p7JrL1awA5dpVXv8KGUW15IyeUNqn/7Bn62kL+Ryon1/Lq5qdbMrVDWYzGY\nS+kFsJGeERv5fykzPBYl2cp2kvA5sZdTQj+C59ka90wAIFTyQe6N2D/pTphpjIVuvARwaw59l1i+\nuwc+7QeCj+fa66O9K+B8yqPIx8Cf5ny2wE/dUPY5fye6VYafMxKku1xl3qDJSpfvLmEuvVhbUeP7\nreA3KbUe6P2Wcuhuc19B743+8HQppYekT0cGMuz2jA9kC+9DffZstsv3lrOuQRpAqPbpfTgs6Hev\nQp+PQZdVB2zkwfCK3lzA35rvXIROa6YPNUZjsgUu810MLXpAm0IuQLgVh6uZHns2CdBW1fh+RYz4\neJf5r0Y3DdSHEKMvy0yPvbLKYKwAYDqd207FMbYBJAIDAO7wquGKHc6GbaPBzkn17CMYmqkYmAZ+\nZWUxlLrV8eEQa9nP5sQEAKBtFdD4UPoWbLO8Z3MYAIBrqD4bPxqFsYEujsfpHHiRcY6f7aPl7VwQ\nZ2ev8sm4/SvC/AOY33Lmf4hmTOd5xwX+/zD8sxzGHADtUwPygLhXeyL08zE0x1Xr3tOsI1YAIF0b\n79GZMgwAOKy+eyubAUC2vStGAHBKzedySACQnXTTAGBDnLrLU+ZVv40h/M1O47snkcHFgNe20rMD\nA1oHvTgJPWbTRRvQb72hTSFjrR2Q+aXM1fz+IYyUNHCrySm2InpoGDy/2/Ld3fxuBH9bweJJ7cn8\nNlu+f5h1SQ+VKgCX8sqbJPMWvX4CnaH7k0igaEN+Noe/OWG8bxe/Ew9eMePg1QA7MYNGdOZe7WG9\nQ9FTZSz6uwZ6eSLN2I4Yzzmqutt2MPWRAQDWWWiWib3zAgDSmM387pbsAgBZ/dtfxDCuhgUAMEgF\nNmAgaGcTiv5+ZDynHa50/puh3C2VAhjLCkqRreI5TwOs5W4CAEA5FGF/aLuB9z9Q77kUBgBgKKtj\n/EYpsHRSte59HRlfRcbX/PuE351AEObB9Gluxhk3fBMEaIo6BV5kP56r579hLV+ynkzl1eiNIBf3\niWOoCg/0RYEshhdPYzheMs4lAAD8hbnGAgAeRsYvHwkAZMu74gAAWXv8TYwAILvoZgKA8zHqLl+Z\nx4jLdeIE9MkReOkFMnEWj9hU5QUook6SQ5HZLBp8od59DQO8QDU3q2i5JtIN1ta56JMdAP3ByFR5\ndQKfqrqpPlHrPsJ6MvAS1LNciVXCmI3lb4+rZ7yAL7ai63phwOTao6vq5HoGWonOOAQwGI5eL6vA\nlrSoP6jo/AI9sBEd0x1bk9c4wFRFR4xjvsdoa/4CG3BSAZbO6N5cxkGrMQBjDoDvmrFnu6B1OoeX\nEj4A4Kz6/r2QAOCGQetsBQBfBhxPEex3igGmqk3xAwClELTeqtPfEZjyBzbsNIudgwC1swVcuDxf\n2ghnYDjOYiCfe6wpa2OuIJBzba1zAyp0aRiUAQMeQgF+Fxn/Cc3CAoDSuLsGgpq3IFAPUM5fMvdz\nnMy/YI++A1CdRAinKCEtaAlcqQ7dxnGiz2LU6xjhLAa8yfPPse93AQKv4J/9CPUo9quSxxVNTcBI\nuvI07EaZZxmOHyPjvwI2PgsAgAL6YCQSADAKJCqdDtdrQU5PHxUAqLXkSQAAuBlg3Iaf/ktk/B+A\n2aso+TmA9gaWYLYyyF86inkr73wJn96Czxark3QqwKGbOkmexHj+Gbk8iu4TA1zHpm9Ug7XB6KYd\ngPJX8PVDDPNaPA09Mebac5DJPL9HN5xFB81E1zV3Caorxe+GIDf7oWPWvv7MM/cql3ZTBVrk6kCM\n6LfQ/jn6fR1rF0NcWRnvNdDrWWT8nTUexdMxGj5NdZlvM+R7HjrlC3ThO/TkdtbdV7wPBq3bosOW\nw8dZe/UbcznFvCeiu2ua2RMuAOA1z4gFAPwURAbDCn1NmG4KqOpAiHEe5ntiIKpO5n2Ii4Kujatq\nLMy5D0PzFiKfh8kX4ELqCGApEgLc9MArsQXCvcHwuq0pE0ZdCVN24zl5A9K0EH/fCQZdjNK7itIR\nRRoKAHBHXg0hGY9iPoox+xYBPAZTb2Av90DDZzD+TWi8ECXSzIJaUzCI6SjDHczzFQJ7CeHfzHu2\nIhw3mccL3rkZuvdCoeW3GL26CMhgAOhqnn1Zgcu/RcZ/+xwAAKeXqgikOarx+zwJAAD1+Lcuzy4f\nS4yKolMF3J31UIQNPiIAqKvWVAulWTxgLIwJAHYHHAfhhT9z0LgNQF8Fb4lCz2MBx9XgPZtBfQ4g\n36hAdj1O4oPhw93ouG+RqYt48eZgCFq4BbfCYzXRAWMxTAfU+7/h2Xu5Hx+hAthmsm8CWN6gk/ao\nv20P/+Z1eXc91S58K7zw1jDMy9HVaSruYbhxks+Swf+L+ZqGuL66bhC9fYn5/oieMYFGCZcYplrY\ntsnK+5DFx79igA8yr+E6iE9defRQdvEc+/Uz/JKJbh/Gd8tZ5vBpAwCFdOR+SHrQBxnbFFG+YFMW\nghA/uFOxCJKkaA1jM3dwqnzBM6/AnEtg9m4wYEoIQ6wDV3Ypt9tpwIrb2uagVPq6IWIPQFUZeg5R\n9/7nMMLXUKa3YgAA+l5rFkJzBcF4pK5JZjP3ydBuH0LzI1cEx0DPo3A1lrVcm6Tx+xV4ZO6jsES5\nLIP5MlAG6wGAT2FS8zRg3tHlxeB0UsF+61HC4ml4wnMeI7CfOgCQbpWd4VVzSJvoiuYeh3xXT3ig\nHwqiq0odKxci8DYvCroe3+/G8wZwAu7zEQCAvLMfa+qBwWoInfL7rKEiRmsUPBRkrEUG7sMLj1jf\nRnh5gC290eKKF5f6RuVS/wFZ249RHQ5tuyIra5HTR8jjbYzQcnRcJ/gon0/2T2PoNU3FPmTJyV/R\nM2e4Sp0ObcdzoDmC4fmJf4+wvxkqmr6Yx3VtFeY4nrXIyfzfkdkzyOdElSHSGXmVO/DngPrfkOs7\nGMJF8EwL1pfOyX2P0l9fA5g2Q/ueOnre5Qq4DTpmCTJ/F158rmKK5BRfg4NjSeVplTncYH+/wk5t\ngb4Sr1H4cwUAhSFie5hlkM+YAtOdxPX8DEJuwOj04MRX0OeOUdIjZiBEp1AUbzACmRigDDa6UdDc\nf3WH01RFgooBeKxcSCNd1tgfhmjGJuYJ+M5yfKe/Es4TKBu5a9uM4Q8LAEooF9wimPkyoOY6J4t5\n/L6zCtjZot73nH1bxQkmTSNXhLwq35c7u7OcFG6yR+txL/ZGGQwFCQu6/yvrPcTPhzDvEpYUPblf\n24xSvoWQ3+e9exC2rz8DANCOZ01ARsyRgUA3ME/rId41Fr6azf/PZC+GI3fNAPR+V28FAKot4JPh\nPGcWoHUuz56QjQBgJHw/k/+fzTNHQadW8GIBHxlvgLHp6zPGAlz3IzPvOGhcwuMn9+9tMXR5PAyh\nGVS3B3D/ThlguWrrqdzQuyx/J4a6L0agZIC6HJXU+xfw3MvIiAYWK1j3PNZ4GVl6hnxtgf7p7Fk5\nn3eXUUHVi5Ghe3hSvkFPyGm+D3IhkexyYHkHP3zJXJ6iI9fg8u+ojPYy+OcBoOEJVxyrWFcHHx1Q\n1BIMeIn3fste7DSCCYtD3/Yq40PiB/7KXI5A2zH8XWUPgPppAwB1FysV05q4jDQUxWKE6KbhVl6k\n3CEVfHKeJS9+IgrmMEwrruzDMMQUNq8jyqoObtS8AdZURrmflrFpD1UE+CI2cCzGcBiGW05qNXlX\n0BNVCszWA2W/EiGUU+xphH2rEoQwAKA06xmB63E9z9qF8V8NPeUOsQtKfROo+S0C5OoB4JqhhroS\nWsP3t/OObUpRtjZSbTKh7W/Q+TAGYKgFAGh34mROExL7cUcFLG7A6H/1iQOA5rxnBmvZYhmLcAM3\nNYMiQ7xrJc+SPd8BjRYpgNHUpz5CHox/a/h9It/fgDLcy9jO/mcXAFgK8N/BWnbCa0t5droK9s3p\nE0ck1xe2IVk485SX8SW65iZ8sBzj0xXZKRLg0CRpdROh0zGMw/coa60TJ/A3xzEk3yiv6SKVNVA5\niCLn/ZLnLqf7Q8jOjxiZi+zhHBUw+BA9cI19WAwQa4/uyRvgukh7IXdg9L9Vp/n96oqxBbRfhH64\no66LZb5yJbtFXRlqr8FpeO8XbMR+5Wlu7lWkzQgGHGsEA/7GQeMw+z9K4gnY217qCuIC+ufbIMF/\nnx0AUMq/CGDAHPUgiNyHnAFFut15FfbILa+h7seXIARXQWX3EJINoMaZnGLHs+Hd2fQqAYoApXIq\nG4sSE3fVTZhfcjrXwBhLEJYJbEgHNiElAO3kbq4TjCT3/lfUKWMXm71dnQLCAIBiKgp4NApfnwYn\ng2J78DeSb7yNeXyDATzA/MTdVtLCtGkI8DieO0OdOMfAdHWNSN1DCNSfeU+mUgRNTTqyP62M7I+T\nAIGNCNhG7iw/dQ9ADwVmj7CvlxmHFTjraRYtCfGuLTz7IsbjJnx0ht8vhy7d3fKajYIw/ZGtVcjg\nGZ53m3deQRa3ZQMAWAd/nMN7dZM1nVNZJFNCnIrz4NXQowx81095404yl18x1ifgJ0ktbuIErzBa\nDvkZpFLVLqHgTa+oRJFfwQA/5N3rjGC9oiH0tayvP/K5iT18igw+wNitZX+/YP/uqaDDifBufSdA\neXVsRHUOFxOhndyr/1NdMa5ER5mBfE+Vy3+bOgjdAjBJjZfehu56B90k0HwGf1PPL4vEJxjwlcoo\nmAItarOvEuy4j/n9FDT477MEAAFiBMzT/w8qGGKJjnr1qdylhWabClJ7o+5WtiAwO/nvNar62ABO\nBlU8CC+u7C7KlS0nybsw6TEjH/UQ71sN0Udg0Gt7nQi496/EaXoI69rKZj9Vp4wVMO4OlF4sWQAV\nYJS2ys3fV92hTkLZzcDoSb7xXVCvuP1mqFoKRSynC7nP7sC8eqs7504AkdrG3eYp9vEdgG4HdOzH\newpZwKCu/zBPnThnsm8b4Yk3nzgAGKlA3zXm+9Byt9zcJVjI7V1/UWmwZ1QuvZykvoPHLqs87qEe\nQUkF1clRvFQHmPMzlNM9+PM68n2Jd34TJwD4lecdwADd4P9vq1PxS3X9p+/FqzkhekyowmJyQl6h\nvHHfcXA5j/6Zi9y28fM2uBxmJCBvhTrVfsf69qoCXUcxyl9Dw53w/GCAcPkYArircMgZwSlb+O8t\ncngdvj/N/j5DhrYgmxJ0WC5kerN20R9S0fGvlUGdxIFwuhHIdxm6r1UxAY8UcBijvIr74I+fmbsE\nmo/XtQYC7JMEA04yUhF/YJ/2oCMGARYkzmENsvckTPDfHwYAoETdTv+Sl70Jo9PbrH5l2YjaSvno\nYJxf1HXCaZhF7rYvsQl7EKRpTrRcZTmPAKfaKr1xqzoFvwOpPlb5qE9RtFcR1M0ohmF+rjlAjT5p\nrOfkdJ9xXJ0y4gUAObhqkKY/tdifZiixxax1uyoMdIO1n+Ddi5Tbr4ptXeoEVRHm0pHa0gBIu1Z3\nQrt3KiBxrRMtF1vdsddGF0UtFQ3HoUwHfkYAYCBCugUBF9m4CL3nKz5yi7B2e9c/VHrneYzYXlUE\n5kuUwhPjZCI0z2XhVZ2PvhveeM2cryggvIP3nOE9P8YJAP7Be26zp4fUdcNxZP+dERk/ixNuIydg\nAzAVYNxOFRaTO/LXGMfrGJelGJxOnOTC9skoCe9IuenNigeeqiCz7SoD6R40WYlhkLK/BWLQz0WR\nSe2Bksygn9FttwEeb1UQ72I8lR2Q53wh3lmM/ZD4nV0893t0+DUF/gcrQ35LnaDXGlkBX8Hfm1Qc\nyArW8giPxj3lvRwGH5cJUdfCLRhQgw+JK+irPBCS6RA4+O+PBAC8Tv93IORSDEo7H4UseaQ6HUZc\n4X8DGT/g+TfUKUfurq/CMKuV66quS/SlRMxLJandfP8u47py0V5lM0Q53ANpblTBOQ1tCkhV5euO\nUZJ7/5sup4wgACCMMErnRA0ADkHXWzC3ROSvxViPZb71vQr0GG6//CpfuzLCl64KHJ3kXTqoar7K\nCCnrkwNfm79rz+j8GQEAuQM+Cu+8A7zu54Q0FiXverccwANwHIFfCi8tVIDjBXeT4nWRAKy62qgY\n7tsMlY/+WJ1Y98PDs3jOIlVr4mWcAOCv8MgZDOIy1jKfPZU79D+rAjHL0C1tgp5SVQGudKOw2GMV\n/X5U5cr3cow69CGvTaWXiniB9rH/kjWzCxp8qYrYbFF5903DBDd7XEUMNGoTZOmzf8Pz8lflnl+j\nrh0C6QDLdUtNlV6nU+T09d8iVYDtGO/XqXe6LsB30Exqr+gA5FcGf2uvYpEQQMktGFAyC7Rh10GO\nd9WVUaDgvz8EAPA5/b9SaGiGl5E0cnblTmi1Coj5m6okeATFusuJloy8pRDYNeVW88q/LApBpQfA\nBpgnk03dqa4adsCUlzHa36so2qUqp7WCxZ1aQ1XlWwQDy0lD5rqE+7BeAQBAE55ZLMQ+2QDATZXx\n8BDGO4gynK9qKlQPUd8gH3vYEmAlQYJS4OgNQizZG+NZk+/pxom2o05VxZs+FwCwmH2+pgCkGJjJ\nCHFjn2CloO8ahdGQsqqHUEy/KKBnLV6l0mLNAK5vkL8z6s66H4owu9IApf77AA4E5klSUsqkQMz/\n5+4NmPnTwBJgLMFxT9U1mLjAWzohmnC56Jr6vHOyCrh7hPxdgjdeI5eZqkhWB7wVeeJ4f1kFeEwA\nIOl2/6EqFW5GD/WPFXyoIjmj1Un9IfUAdKS+lA2+oPT3Doz/JMPIP1ABeTONAMMXlhTD6kGLYBEM\nWMUlGPBnS3BhhkpbfGbJGEhHZ5T4IwOAVJD3cIybPv3fQ/kshwna+7jJ83oUd5Co1H1szFwYZCEM\ncgQB/gkBNl2d1cz3Oh92AZyoTjSLIepUCChNHqQIkdxFnuX9k3iOqegqqqpcs9WJ7KlK+ZNGEUMC\neACGqODD6n5KATd9ispZFQAgEeKZCOI11nPHidaQng0TN/MLsHIx/pPZqwOs5Wt4Q+qBTwkbVKXe\n9TkBgE3sp9R5uA1oFQMzCG9Jqs/VTph4A8m8WMgavuTkdQcenucCAAQoDua7maoYjijfpbhJ23yk\nQkCNeMZkaCl7/U5FhgeqLOpEO7d1NAJxJSbjayda4VOuwUTW8sepKys40T4B81TA39fot28AA6dU\nemBvwErxOA9pusmPvgL43ki3+wkeOWS5fgh79SEdHwdacvW1O1/n0L9UIHOiqrB3BP7TOldnDfyq\novWXKf4sF3LOXsGAkpmwBrrMNgByqOC/zx4AWE7/G9Tp/ytcJlsxniLIKT5FeRrwt+KSvwHDPMJQ\niWsqHeMxVEW3njNcQdtVJGgdmwCz4fU5vUue8BA8B30Rmm7MaZJRqMJ8j1Szy2eksUkxkHUgyi8V\nWt2EEjKHDQDI72ajvBvZYilwORbDoNRBCFuoaOCpMMwclPwaDN91dZd81LjvqhSj8c9UJ5tbCPJ6\n3GgDUYiVnJClaj8DACCnnMvIwRV4+CWu5o0omBFBDcxHAgClXdJixW27XymjJh+xEmBHi4L8Ht7S\n8lfbJ+hXskoGIUdbFTD73qj2lxEm+j1gFlAtDIN0fjuiqt5JjrzU+x/qxNPG9f3rh7bsqdQjuIq8\nPFbpdrdVERsdgDiEQ0xqyHfbmgNJvY4fMKw7lYF/aBjxkUahnxvGKXuFujb4nufp5j+Nwu6bTzDg\nWxWcOFN51740PASLVPxBuQDvNAHAGeyYCQDe00GfAgAwT/9STe57iHJEFZnoiBsrV0BlPI/n3VG5\nnftUFGYLjGs7IxhE7vBuIki+DUUwluUhUH0UUwvASE1ODK1VROsRlPlPEHwXGyB3qvlVjEFDI8bg\nBpvzCgR8yGUcQRHKHaH83IoGDSVTBTq2VQVGhvGdbijKPsxriAI2kkv7NYK6WTFPDbe9w/hX8jD+\nr9i/oyp1czCgq1osJ6vPAAD8Q1V1vMK/D5Qn6yAAS0rK1g6QqvQxAEAZeH2kUrBPVHT+XuO7HwsA\ntOdacK1SkD8gGzsCAoCSzvs9RdYqQP6zpdpff06DZROoM6VPxwC8mHuh668qw2kjfN0NAF8ojveV\nUgGI042KhMKLu42r299UCuJ6lbod2hOhiuXo5kCPkS8J2NMufn3Hnw4AM68IJEZgveIFnapnbf4T\nYs7llV2TYECxQ3dVhL9Obwwd/GfYUc3fooelWNpBo1haSY8Ytpvw8ltVDVHHjuVMFCN7nf4ljWO7\nOq0GuQspoiq/aQCgDe1sTub1PJTIz07AjmKkyVTgvWkYjLYoikrMSdoFDzcAwI8KxdoAgHmlIXWx\n3ymX0QOP8UZFRT/wcgcZAtdGpZ1N4e+XQtPxKge8AWsejTE64UT7AYhnYzrzr+XY69Nr49/Pw/gf\nU8Z/CMCtBqeTMkFBAKe4nGEBgMe1U3ZfAexl33dgXB4xxyvw83yVkpf6CXkARnAyEwBgfjddgcyP\nAQBsJ6TvgnoAnGjvjc4Bqv3NN6r9lbKMlDAphxYvZ/8AAKBzkJiGAB6HLhgXSXOUk/4DFfC3yKgD\n8K0K+FxiZAPkDQlAmqsrJd0cSAIOt6NvXnMoknz77i7gQVL9tD4N1PwnhG1zCwbUaYY6/iB08J8R\noCll1Vcqmfs3VZRNtxOuznekUJdZcfEv8PNZ9GDg+JhEnf4fsBmrYDzJ0c0TQDh0XX59BSBKQZRP\nY5hbImuXq3SQ7zkZaMNczxZk5kTL8vbmOROcaJnRNBhBOmWZxYKkW9RWDLwYyrzGSVUakQhivBxg\nXIHZfwEFys9dAYByCfVmPssQpr0o2F0I4XDoJh4U3QZZA4BtXgDAxfivRMjF+N9Rxn+WEy1BLEOq\nN9bwKnACUCsDH0njnKAAQP4+1fmwq+HHCgKcD/2vgs4fwUfmCavY7wwASrEfwwCNUmL1N6M6pjSJ\n+lgAoCueKl30SZ9yxGDUMA0zbnABxpKSut2J9hRxq/bX0mM0Qbbzf8IAQLoCDlEVDqUI0Wv+W6oA\nTjIqAf5mZCPMUvFAZUKCEKnmOd15vznQa/ScpJA+UlePo9FNNvDwDrtwXqWe3lR5+gNtRcVCzNkt\nGPChUWhI4mO+iSX4z/BM6fLtmSqrQHsWJF6oE7apgwq0Xq/qOPxd0VIAUVrYGhKxnv7fsqk7Vf5z\nM6/oZiMIsJYRBHgRwdDlGMdioHvCHDoG4KVCkpuUYqhpUQxmO14pnbuM9w9XxXOGqujZiyggW5vK\nqjqQy3AnLWROWwKMnUYMwFZ+vlHlPTd03u9FrgGAFNY4h3A8VHfPM1iPrGsmSvQ8DCdXAJsw6t3M\naFrSfNyM/1XD+MucJ1rGeJi6Pcrbq2FHM04zunmOHwDQf9vGvGv/iAAgw4mWgn2oTlj7+J6uuZD7\ndwQAxZ33SzfrE5tZiKUrcjg+mwFAB/TIHCMl7LnKFxewV9lCN1u1vxOq8JBZh2N4gNE/xsI8HwUA\nONFS6r2VgZA160A/uaIdbAlM/NmJNgNapeSpjhOw7bnj3RxI0rpf4pHQzcGk2I4bePhWBS3qK0vf\n5j8hjLJu9KODAW/hSZHiPzEF/xnp6JJ5M5ODl3gcflEZQ+s4GI/HqI+DLisBDTeY37fM1QREJT7G\n6V8H601AYdcIQYzKCPw4A3m9VkVTlkKoaQjReiMLQIporFBIsqIlGtjWjvcsCnOjykOdpbINjvF8\nKUgkfb2H29INFVjqplzyfsMtC2AKhna4csfldqHfGCfape9LVZPhCOtY6JFFIXu42i0I0In2PHcz\n/tJzfCPPWc9/m2OtQrbNbdkAKE0BnBkWerkBAP03k1XsSKnfAQAMgldFwb7BgJ0zUq6auIHljwQA\ndOCqKKMrRpGTraxlMgpoKd6NC8hpogDAEt4xHlmXOgr3lRE74LzfqrWshXfqeFT7e6MKCi0LMaxZ\nP58CAMAzV11lOiyFryWIzuS7fpbAxHvsxRt1XSX9Pdo4lm6VHvOxNQeSzJKsFt7/Ve2DrvVfxwM8\nZKUs/ncnWlpYN/9p7xe0HJCGbsGAUin2PjwUU/Cf4XHQvQhWOtHKrD8iezfhfamOuAp52AI/i979\n1fmwhHT3eAGRiVbcTv/iCtmFgnFV6gHTMERhXuJk8ZhTaiYGchvITCqEveVvdAer/rjKUyzBOFLL\n2WzHe4s1HeD5u1RVNXFBSenVDaDOXqC4Ii6BP9IJrpvP8KsD0A23ax1bQA6KtSnKXef7infmFkK0\nj7XtM+oovEJ5yx4OdoxmGrjja6A0JliM/9/U/aIg5bMoN3McU0CjvQnULPUaFrh4TEwAYP7erbPh\nxywFLApWG7G76iQ2DqVf0yVj5WMAAFFGnZxocxrJV/+F55yEPzcrV+gFfvcuTgAg2RPnMY4bUWSb\n4aXr8KkuVyuFuGwlqyV+Z6il2t9/MNfr7EnQEXNk9UcCAG45/y+MYk5LVHG2ZobOkGZIfzVSE6cC\nDhuFcHGbLcp16tz/re66T6ALxnHokPigVo69s+D/cj5s/vOBvorD1nkFA/6ZaxJb8F+9oB4Sw+Mg\nels8sqecaOMosTmX8eRKefqLzOk1+kRs5HaVwRHaU+WXy9qGDTFP/4+d98u7dgNF5Q/x/PwoQAlc\nWc47LsMkL1jwNZjohhNtD3wfpbCTuekiGrktQtKGv1mGMTwLc4l7/y7Pl3rkTyC0zpWfq9J1Knqs\nq5gTLZnrNmoHLARUzaNaXB5+39F5v5HSZWoPSD7rbfZN1iX14q+i0HWEei2jWpxO15ytTrWSuvIb\nwn0fpn0K3d4Y4zU0X4dx7BAQAGRaYiak3O0P7Jv+3clPBACkQy9pCCPdCy+x33NRYC1tAvsxAIA6\nsbUw3MKXlAF5AJ9cYt9vMBepYx8PABADdQIZP6/A423o9Yznm53qKpunUuf9Zl9rVFXD39T4yomW\n/fYblz9lAOCT8/+Lpc6AxJ5UQ/5Gow8z4akf0O1SnGiZEy2LXN0JUJGUGIxqqrqkjp7/zXm/Q+Ai\njFYLwFsRpWsEPFzDk/GbcSevDXDBBNg6r2BA4Z2Yg/8sersq3x+BLtqmDp1yTfIWukl5+jfoPcmO\nOIu8LmY+MdVw8Dv991Sn/9O8+J4TbTaywAlQ3tXHC9AYpDkR4u6GGNdh5scYlkco7CucJrex+HGO\nRylb7jolJWgC39Gd1G6xuU8YD/iZ1CeXPO6RCEOtIOk6nLBsI68LALjnhO8FIPd/vaDfcuh3mruh\n+4p+UnrzOr/fg/GfgtA1NYN+XIzmHcUHYUasACDMO2IBAPdU0FtYACDfNY1yJyfaEOawQbPjTrTs\nbA/bKSLku0wAIH8XBAAUMPLVBYRfRPaewDd3+dkB5i5Bu/diBAAyR4kEF6B3n3c+Qhmew3CuwKD0\ndAugtKRYnYmRT+8FWVccAECeHzMA4L7dLedfnm/WGWgNjVKQgz644Dcaul3mtg0QKw2Cygacm24O\nJPnz+tlXePYM5lAfWuWGxl2d9zsLmvIdqvlPnMGA+t0xB/+56Lm6GO1R6KONyNc5ZEvrbtMuHXai\nLcXHoUcaBiniFsYwtzRO/5lqSFGHDHXvUCBGwqeiIPpioBew+btwBR5FaR7l3dtBu3NQ9D0wGmU9\n3lEBA9cDgs9yor3U90FQ6Qh4GGHdwhpnIGSdJSUxTtraAICmbWAAoNxXzRGmCU60l/tuC/2k7PF6\nlEaGCnKqZPGe2IxmZhwjFgAQdoQBAOZ3wwAA87umUe6vXHz7LX+7CL5qZV6dxfCuQaqanx6eAEC5\nzpsoEL4MGTuoZOIASnuFCq7TawoDAPT8pNfASvjykOLV/aooVgb6oZnj3vDLBACZCRiJBgDm82MF\nAAWMIOCNLnu/Snlo6zCnHMh6mgIPO13Wv8aJNvAKlFvu2JsDmc+VYE4Jps5puOJHKu+EOaT5T8sw\nWQoxBgPa9JcE/wWOd/N4X31oO4x9XEZA9h5Ddx9zos2ytiCHM6FTdy/7Fw8AaIHQzkUZ6zEHRd4n\n3gIauEQqYqC7Q4xJTrSu+nIWvAylOZN3D3SirWjL+pyUc/E3kmc8AKQ3XeXOr2AsxUBMw7XSD9di\nnUREV7LeWoCRyRbaLtDCEeB5uVF+Qr/hPHeuQb/lqrrgJOjcA+Vc2eUuWgocSXezBQkYEqyZ6pGr\nL8YzlufP5/TxXqBYwLXMgjdsdRek3Km0rrZ9f5pKRZW2xm7vmqcUWek43tVY3ena/k63ei7kIhsC\nwnsjF7Mw1ppvZvK7oS5r0oYiR4i1TEWe5yg5XI5hmoaS64meqeiROVGBE/GoBPGp57oCpsVJxPd0\nj+ePc8tq8Lk+FQAw1ePZk51o2+myLtcHY110fEzrd6LNgSRzx4v3WxnzKg4/p3vws44DKZxAmyfB\ngEHnXS5BoKMOfNsX3p3ioruX8H6xSwOwZfW5ysuRSAAgEbWd2YyBxugPCmqK8sgd5/tyY6DroLi7\n8Y6hKPOR/DsYQnWGqWuEMcowWDXm3YFT+EAU9UiGVNLrhRJvjHuoSALpWwHF38dCW3l34MYcCuDU\nA0F3h0FM+g2Brt2gc11cdnk8nlsVBu3vMtewozuGOMWFD6oBEOJ5X1doUSTkWgaw59UttRAkZqWj\ni0wMBFxIH/k6PKuvy9+mw8d1LK75MO+qznsGuPxdf1XoJqeH0k6F1zvx7GFKJiSVtCN709eFZ5tZ\nrpH81tIbAzNAyaHIem/e1wA+ze0j2w3h7YEJHL3C5sQrz2NlTtr9PJ7f0ysjxOP50nukr8/cWzGP\nvJb4j0bIyoBErt+JdiTs7cP7dY3A1DwB+LkfNK3sJLjhTYh510kU+ACMVWIv2nEos+nuYby/F7ar\nCfqs+J+y44PrriZKwRwNMb6lnZC13QPEHpTnvQ0x8q1g9FYwYn2MRGknRKtcg8lKwkB1IWRL3tFa\nFf+ow8akJHKNCm1WRLHZ6FsPOuSKgZkqgGQbwcytFf2aq70rH7B8ZWEYraHLXMOOOl7KhDVUY/6x\nvqOWTaEGWEsj3l3Uw8jU8JhbQwxtQVyhVeBXr3mWiPNdRX3o1ZA1Fwpwr1ySZzU0eKc5vFqVdzZw\n4dkKNiPts5Z6/K6xksNWKje8khOwzjtGrU6C+NR3XQEPUlV8ZEdAeM6Qzy6ADmvg8+xUj5obpdG1\njRK5fq45U2Ph/YD8XMWJo2xydsw7ATEIxbEJtVm7aftaKP1ZCfuc+0/Z+cFQFbWMwk4cLSsDGuki\nKKQyjNIsulCiDDJCVJwrD3lPKZR3gWymbQ7oaKNvoQQwclGDfmX4/yJh946TeRGXuYYdBT7C+/LH\n+Gxf2ijaun0/lyHYhTz+Pl8i3qXkxe3vcofc66KGTJSEV3OxpsJhedZjLQX5XTFkXGQ9JZaIZmS6\naAJHvLKYy4eXC8ZpOArH82wfHotr/bHyfgB+zpXNujlmmU2gzS2p5EFksFhCcvyTn+Qn+Ul+kp/k\nJ/lJfpKf5Cf5SX6Sn+Qn+Ul+Pt0PbvMcSUpkD22TVEh+kp+kbkt+/sV1KPdyZQgUS9QoG0PZxALc\nfVQg8KMqASJVCZgow31JmDvO4gHnW445l4z37ifEO+W9pflOwexgKiKzi/OuitC2mgrySmUOReMJ\nNHFZdzlo6nf/nY85uNEpxStwyofmZb06Eno8swjfdXtu8Tj5oEQ895uxPp974BI+a0sJy4vwWelY\ndAKyXzpWfRKAFiVdAhZzsNbysfJeQL2WgixUsshfRdZXPKzeCalrvGhb5DN7R1kVv5X/I9hIcw+r\nGntYgfkUDpk+GtZWJHbdKLmaRB62TeBoTQRjSkAAUp6/l1aknUgX6koqRgfm2JDUkdIBjEpZ/j4t\nwHzTmHMLojJrI5jFQxYECfNOeW8r0gDrwVCl4ik6YextKmtpQhpZB+jZFfp2Jg2npaJtGSd8O1S3\ndaexpzXcorsRrmpEwrrRqTFCliMGmrcm0jdQ9DVGoRzfae2xbw09ClIF4YMm8FiuGPY2puejxGrA\nb2081tYoTJ1xZLg68hNKJxCEVQMeDK1PAtKiqa2uADzV2EdGXXnPh4eKqxTRph7y14H1NSHqvEKQ\nNOQYdI0Xbeu6ROl/iu9Ig5ZmpHxKIiPl2UMp9e61h51I6WuBzqgSBNwneN25Yl1kZSY/hIIDiRrD\nyAWu5pPPWwKmb0VO5CCKx2RQwGYyhRrGqXadXVRdgBSX50p5Y6kG6Dff0SoHegDfa4cirBwihS7M\nO+W9w1l3b2jWLGzNA4tBrQAzpjGfgaxvPPScDH0zKA4yzKBtTYBIjjjXPZp3dwCIFLV8vxz7P9CD\nRr3Zi+Ix0Hy4yr8uHWA9pRGwnnzX9sxRHqV9g/JB31hKjMb6fAxSXRTWQI/vjla15IsGnJP0EhkU\nVieoLqSxfDcMLZrq8qkod2mtOzos7/nsj8717snabPInum0Eed/doYWkBudLoK4Z4yEfndE5eT6D\nd4zmbyVXvieHmCbwR0oCjH8hDH9DjK/s4SgXHToG29EHXdcYu1EkwbZipGXdgW2UOQmpUteTikOr\nEzhmIXT13FLBMDD1YYwhqlLeSsrXbmJsoEzlUirbTUCBdeT7pV2AhZQkXRxgvquowrSEykxT2Ji+\nMEDtAC7fWN65kqqHUsVtnKp62MCv6qFlDsUQstYo8RGsZR4VptZSSlTTdrUTbZE8AUbvDBOnBvC0\neK17Jc8dporuFDC+X4X3TXSh0zIYv7Wl8EwQmi9BaD9ogOTixq7J347zeOZi3tncNOAB57TCVsI4\n4B6Hfj6gsAYyM4JKfCtcvrsUhd0ySMEaTkrVoNnkMDqB1LbqFPSZElafBKTFShRoW+3VAOi1UnXs\nQ/GeCy1Koit0tbdpyPcKF/lby3ukFfNwDENLtwZhMegarzEH8P9e9chP+B1aV8+jOqJUy+uI0a4Q\nqxdVHUrTMOgjecd8lz1cz5wWocN9K8omaN3TkPF+8FutoDU0bABgOjXBTyVg7EbpuwIATiP1UBqj\nYP711EU+RjOZi4zzPPcQtfRX8/xRKI76lnahtqYkXnM+6UTb3O5mY5dBFzl91PY6EcX4zuM0KtpP\nV6pVlr4HZQLuZwoM1wEjPhnm2gBdj9AI5Lyi7TnmcRDarmEvxsH8LUGX+WJc9zGEZSbAppXFLa0B\nwEaDRsdh+iAAwI3mO51oC2TPRieqY55uW20+7zDvCgIAbHNybWIUAwAI9HyAXCvWNZsa40dV+1EZ\nm9irdE7MKTEAgM1BdYIFAGwJo08C7v/qAABgObwamPdcPEcNVL33aare+17obcrfecVTu5HVRZws\nB2JEagZsIBWLrt4Ln/sZ50/pHaI3D6HXNrNPs5T3qoVbyXOfPdSH0qEY/qXGHp6hSY/s4Vnmk6lq\n98+AB6SnTEoC9u+k0SdgM3w7ned0gFcKxgMArtGOMNZx0w8AONHWth0QrgU0HzlBV7usrkivaZH4\nlpaIz+lYJt0BtxoNVoIYhocuc35OK9IndGW6gWE8gEGay2a2cywtiGN8p7z3KX9zm+6ARy2dD+v5\nuWI5+dfBczAc+q+jScgZJ9pe+QVtL9860da9zxRtjwMElqHM+wMCKsW47jsAj7UoeHHFlvUAABf4\n7tMYAYCm+SPVkU+3si7gcvqXbnkZgKHjxvMexggAHqo9zw4A4Pl81SFzMrQ4xp5L+9FLgJ0F8E97\nZDRvjADgUhCd4AIALgfVJwH2PywAeBKU9ywn/wasY7Sl49tNePGlkr+3TrRF+QN032mU+xqMyBD2\nsEKcusY2bsdgnD+FdzxXuvqm6pi3FWM9STU9qxzUE8Bc6qtD6TwAWabHHooOfYKus3WV7aibICVw\n3ec5uG1APoZwfZQaLwC4axlZDJrVP/o/nf/dp/iRy98FAQAlMQLS1GQLjJ+1sG8RvlvM5aoTbXX7\nFUS/DvJbCAFbBuiwJgT+h/O/e5Pf5fkyvmADn7LOVzDvCXUqGuB1ZxvDO69Brwcw0hvWeY6uWotQ\nTu0cS090I4K+Gkp7GMK2GYV2A8b5HvrJvt1you1Ks9b8Dto+ANXux4hMVp3Zysaw7rfQNhNlOgHP\nRgN1N20DAG/iBAD/gFffQeddygtgbWfNdYuc/ufxnas84z95ZjwA4B/ZDADcnl8L+o5BQe5nT94x\nZH+WAzq7EisQ9P7fDQBkPfvnGAHAN37fDUCLWAHAv4cBANzn1ubkPxq51T3fXznR3u42+XvM777j\nvdcBzRswZl3MRmE+6/4ROb4ZYMRinH/vd9yCho8xxK8BsxdUV8QpvK9FkGBW7vxrcYCSBlNb0f+3\nMPo/uuzhfeTuW+Zyh73fCojrBX/kjdNWXOfZz5iL2KhjeM+n8K66gbwALgBgv8s4iXD8G4J1xuNv\n/QBAZU7/Y7mfO4IgyIbLs7czdvE3FyH2CU4xEzkh1zFLWAZQkqfU87dz+tmvhPYbtRGHUQRjMLKV\nYlTM5jt3AGSOYmiy6PoLdD6LIp3uRPtou6VQSVOLgQCqTezXXWXYpe+3tF7dyzjA315DoH6C2a9h\nFFZitLvDWEVCrvvfYNTL8MVilGRnhKJINgKA/ycy/obAnvDyAnBHLt3BMvjb43z3rzzrcwUAbTgd\nzIXvxMPyE3xxTHlo+gQNlkwCgP9/7dJudxjAcRvyK4cmm/ztcaItg4/xu7sYmKtOtIX0COZdMQQP\nvESH7g44YjHOv+c79kDDY/DKA3T1c2h3AP6fqIJZi/nwcKohJ1vVofQ7nz08BJ9dh2+u8fMl8F0n\n5CNXHLZC26gzzOsn5OQmwGch82+ug129Fp2bO4PuIM35LmMpBjhLGf4TBHIC4+D2nakQv46+hyEH\nuTagYyoCfxHGfw2Bt6mAiukqYGk789hpnObKxaEkp/OeWbxzI4yVReA/M68LKLWpnF5r2WrIh3yn\nvHceP9sH874BCN12PuyHXdol/aoOezgR1+FRlMl3IOQb0E3upxbA5PN4/loESxhL0OUVfr4Qt3Ca\nqYgCrPt/YUCf4tnYxruHotiqZiMA+B+R8d+VF2A3vPkB36jT/2B1+r/Gd/9bZPzPzxgA9IV31yO3\nWQrzVwU0t2BgB6kYjZxJABAIAEgmQV/u/DdC/wfMX8vfVov8LUKPbsGQXORvVwNEe9iuAEOse3aA\nMZnroVhp+7HfMQedtAqbcIKT8XfYkKvKAI/k0FbFce+OWRSQ0Bse3MAzRRe+YQ+PuuzhEq5b96BD\nDzPnSdjAhqZBjtFWiI3aity+wB4/gVdXIvNtA6fwOu+3REy3jGE+AGCUy/f6IjQVLQarPpGLs1G0\nNyD0Y4RwhUq/6cnzxvL3y9j8sV5R3SGVZC9OPsN4x3aMX5YC+wEX6U6/zIaQ7+zpRNtQSvT7MWj8\nDxTQCX4+lmuAVBe3dSveuRAmvAZi/R431SGM/CwU4SDQuLShzOC7W2HgxxjtJ6DgjQrQ1Qvpbfk/\nI+M/8GyI92YjDJ2OIc4uAPADCvg7wwswEYNTm5O/7fR/gu98z1x++kwBgGQzLOdkdFO5KsUrswj6\ndiBToEDI+XxWAECq8CUIAFTkuSPRkweQue/hOz/5G8zPZvCuLQA1CcRs7nJdFWbdfX1GL+Sw4mfy\njn7QbRxGeKMy2L8iA+eg5Qy+09Bx7/qZyh6OYA6ZSk5Ehx522cN0DkcT1QFyLe8d4HYFEYOt6MU6\nhM8OATL/pjwla6FJ+zBxANISsR6BQnq0CAgA2li+Wx/XWAHLXUsDiDcXpHYLA/EYlLUCoyc9yVvg\nRpEe4kM48TZyc1XGoITr8Y4MBPAsSvIX5rcH5NmPtRVMwDvr8PeDQJT7Obn/hXefYy4TmFtl4325\nULxdlOGSq5q/o8ROgWinq3z8puxBI4SyG4y1EGV7VYEfcS8tYl0tQsZbiCGXO87b/H4NxkJczokG\nAD9Cy/Ps3ze46MQLMES8AIColiiV+fyNnP5vMZ97gIDPDQAMY007MMqvUGw3MVYr1BVPPSeGfuOf\nGQCoZoyYAQBBo7U5pU/l6u0cCvlv6LOTyN80i/w1JLamA/pwLM+ZBC+2cwvEjGHd9TxGHVu67yf8\njgbQrbOKedqG9+Q1fHMH/l7K/rZxMcR6D6egf+R0/Xf2UOvQQRYdKjVshqu6AIOUhzNvAmxFbd45\nCD19gLiHvzLX0+jUsaEAgGGYi6hRMiQAKGt8v5BL1TYvD4BcAezkpD+D/G0psNARRd2c++gyCXST\nVsXITsDonmM+PzK/XUoJJQoASHR2Oq6kfTDunzm5nofxMlwAQCHm0hdkugPj/Q3zlgCchexjGgql\nhNrvsghVNxX5fgJF+E8U4Ul+Pp49qBxw3d/hPTnOvL7CsF8H7Czjmd2zAQC8RSFsUqDosSV+pDbD\ndvoXBa4N2ucGAKar1MpHyhNzHD6fhiw29UqP/IMAgK4uI1YAUBzwOhCQtYf5/qh4XwDnUEP+Uvi3\nBB6wJshWd+bUmuvZIjHwgM1wtnEZjciZzxnnO3q5jC68o1SC1lEe3VUKue3E71Zgo7J4+zcVpyaB\nlF3hs1yWK5zGSgfvQd//wOn/C362AB3alueIDi2KHq/H/kp1x5b8XaEEyHBnhoCMJUT/i8fjPmtf\nDq+2CatT3NJaQgGAEB6H2qr40BaUxdcYvscYgAO4pNeoeAApktPFiZY5zZsAAreHkdJ5z1aU0Dvm\ndZF5TmPetRKE6hoq9/0i1nwPBn4FA68DlHQ0gw95XzNOs4twXd2Fjm+Yt8Qu9AQ0FfbIfR8CWNgP\nEPlVPWeLWwyEjxG+xBwOohy/4YR0CVC1EKZNNAD4hmucrQjwdeUFEIEeAv1b8t/69K//dqsySp8T\nAJD4koPKLa1jMeao1CHXNM8/CACY7DNiAQBl+PkIwOxh5ZZ9xUlSDFB3FfRaHcDVPMCoL9cWcRjO\nUR6jNwYwJQ7jPMNjjEW2qyUAZJgxHCWwAwPg5V0Y7B8AYNc4FM3kAFnPPLixh61c9lC8sBvhEQk4\nt+nQIgApiWkq61NwLKgMT1RDCrptwjY8xyafR55nQ4vGsXjyPgoAUFkAHTHoq3D7SxbAnxGeOyiR\nkxg2KZIjRWr6Mr+Kjr3JR1ACj2NkwCiruV+5q05LR/nbsbh/KicAdMgd4BA2dh2/f8rfSzyEa2CH\noYCWM0/ZIxGetZyyO3hkLxRCOMSTsBPj9wPjuoqB6BNCCX+rjPB61nNPxXtIAJoYokQCgO/wOmyD\ntid4p5zq1ykvQDf+e636Ox0zsI1n/b/tvee3VVW2t3vISM5JokRJkhEVJGeQnCUKIkkyYqCpSBDJ\nKqAkARVRxIAKhjKVoU5ZpXXqtPO+99P9dv+OeV/uffpZneGcc8211t6Uen5Pa6Ox2XutGUbovY8+\n+ujju9+BAWAzH9vl8RKC8EsE2xm3G2M2hm/25CG/TwPg2YylUAOgBW76uciNV5CN/ysmMOtupyDu\nZSIzLUMZjUBvUKTi3JZSNtMH7i4ikNrczntSyi4mTSPpY5XL2ACoymRkpAsot373E8uNB1Cak/BE\n1CmhDQeF+RhKGDNZZMTTQdnJWLAdXm9FuURnfsfBHXFB6r8lA6ARM9dJLivZq7zUn1hr/YkZ5DVn\nDLzMy27BqrakMk2KrOAnXHmKDvsiCu8rFIGfLU3muRuVaACsdmU99z9Eg36H8rqEAF/HemCfmEjS\nZgzeOVz3BG3zv50A823ULM920JEM2F0o7u9iYiAK2crjlfAjLt/DR7Tx+zyjra+VlwGQNLNfx/em\n8vM+/hbuGjAD4PvfgQHwF5dY6jJK/ytnyIVJnvqU6i78DRsAf6bvns9YLtHv/nfGvtcSw3oBBuUp\nJi8+WHQTMrRvlMsyN57JxsY8ZQNC/VcBwHne+yvG74k8JbUP5rnHDxjzFxPKG+VtAPD9tniETXac\n5f3/gXw5jJfxAXRFvRLaMFNq7DIYw9/QF18Lynl0xEd4ZV9Adq5jcjoKr3KDsnjA8jQAqjLoLRPg\nWoTGi7zoOy7Jw19QQl8jzM7jorbgJdsJUL3AwLQ3aWwrpxE870W5DHanEJjrGShmXVUtg5nZfrcP\n2DIgfoGg/tAFDy117vvQfdWcQeGt10+d9XosYyKTSkR/j8CSfs4ZAH8rIZvX94EgWIcBZ/vQv3NR\n0rZtpjwMgIeCtf1PnBfADmQxD0w4+3/od2YA/ES9fUC5ypLLT/Srs/S5x4JtZnX/gAbA36nvqxnL\nde6Z1QBohSfzwSBw+J/U9dGwn8QEQL+YUhKjuvO893/g8bmeUl4p0QDId49bZQC0dsHbO5wB8B/0\n/yPI7ykJBkDBbXgLDIC/UYcfBuVqlMuSewHjxqfGn8m7dCh0J88tNQBcAM2dWG8zsYhtG8wBBt9r\nCIBPEL4/I8wuRDdndusTWmZ5KvifKJjPKV9Qqd/S6c5Suc+4LYcjGLz1y2hmdtllAvsEgfeFyyK1\ni/ebFiWkd8QDMJA22EabXHMCzFv5iXtDg7iM5YHL24Rw4i6IApTwfPrSAQywryhv8rtNwSAuSwMg\nzOzng3vWuTiBb/mM9a/fmwHwOV6rI5QX+b/tS/88SDRj+6TbFus2/A0bABZU/GLGcpr2KcQDcC/9\n+gkM/M/d7PElvC2WrrxxjAFwOcEYOVWCAfDvCbLGl1INgCxehvJeAvD9bjHy2iYPPyNbDzkPwF2h\noes8AJnb8BYYAF8gA48G5UUmdWfRE+/RBi8z5lal5cb5TRkA7h5d6OATaGSbKT7GS+2ns76Da+Qf\nUS6/+2NJe+QzdN43cEefZOC/7ZTOCe79KANkOOtHTUtoVDNePg7KVRryLSe4n8ErMjvKZcyrGXO/\nxjT2DNrI7vdPF0Ro2wjvj4J81EEijO60wSoE7iUXzfwmuRFWEDQUJnfKqoTHMFAtzuIdjIzPGLh7\ngh0YZWkAhLn9Pw6WgU649jjOZxf+Dg0Af/31CK9dCI3PmBldi3KZJi3Fde8/+C6AfO72YoIAm7sl\nuG183rKlXg/yeNzLbDM0AHyK249dDFQpBsDntO/+PKUUAyBrnMGycjQAbkMWjXYTl9dd37Gly9X0\n8e7Rrw9VMi+qX0a1SVRsGyaMgRv9uBYT29r5AmoLGMMbXNlInT7r4qksQ+Fxt7tpGB7dyr9lD0Bl\nZrCdCHK5iwoejRVje2LXMSt8yQXmfem2yC0y5VZEBT9O2cHf36XzmPt/N7NAixZvUUKj/ol1m5eD\n8iJW6vNR7gTCFSj1ocy2G6R4Ufw2JMup8FeE7+sMiocRnj1ilFVlrOCBwRaT99mNYHVtkbC/2k5T\ngBIeyUBcTp0f5z52tsRJFICtw5WlAeBP93udgWNnBOzls9/wt7189oHfuQEwh7IRD8tb9O9/j3Ip\nrm0pIDHV8x9oG2BSoF2x2wAbISPtSFfbxWPbeH0GUUui5bftWlCXlfP0wVINAP/eq1PKKuT7gCLi\nqLLuNHggSsggWooBQJ+zJHZT0BNe/n1DP3oOefOrrLTBJGo69z/K0sE/gjZ8iGt0jVlGsHTm3Vhm\n6MF4qFtGY3gqZTr/X8l7WX/5M7Jsb7BVveZvNQagAkkheiN4JlNGun3+9+KSnoYC81vz/B7vYg7L\n8BU8D4X7DFbzdQTkh7zjkwi1vDmlC7jnZlc2MVNbhQCcHd18lnTDlPvdhtA2C9inVf4bQv4I97H9\npF1R+E0ZQG1ph7EIqh1ui8k/eP6Xo9yZ6oV4W+IMgLvpzKucsv8Yb8P7PP/lKHcwSlkZACPxhFjG\nRVtTO8E9PuB3x/jMg0FQZHkaAM0TSrO47GVR4Vku7QTA41EuDbB5wXyq50EIssoZxnB1ZERThGj7\nGCX+Le36FobWr3aR/AsSAYXb7EpJBFQLmTCed9vtjMu/oIwsidZMZFpH1mlt2dPS2/rYl7I0AObi\ncUgqQ1K2tpVFroE+tG/DKOZo3iLzADTBm9ITHRHu4PlPF+dju6BuvGebBO9nj5ithD+gB94h5mxD\nlDvZr7N7juZMYu+hf06hXu/j93XLKE9Nb/Tx4JiAxb8zaT3ARNB2PNT+rRoADaLc8aQLo9z5AYux\nGIdiCPR2s4pnUA52PPCZwAPQpoQKnkkDH8D1/R3lLX63MctaaYH3nEGZ7jrNCDp5DwRxnQx1GXew\nkiWI+CLKna2wmncYxXsMpGMN4d4LEYKWBvOHYJa8GiOtVwEK7/uEYKDBUS7z4N4od3Tsv3PPHwtY\nhy3k3pMZ5OYF+NoF/X0dzP4n3yIDYFBKGYjCa1Si8JjCe++iP1imOkv1/AxG8ATat3GePlcfRdaH\nZ+zPz2NRartdfX3nPFE2E/vvk9Gif00qYEvA07hEA8Aycd6PweiXmH5BTp6iflfyjPcjV++jvsbF\n7H4pawNgEIZKXGmfFNdUxD36pZQ+jP26ZXCP/tTJWOpnY5RLgf4tfe6SS4JmJ8Y2SYh/svNwlgQT\noP/iX79deQZ99W6eYxD/n84YWk9bT6eNO5aBEX83n+1L/wmz1f7td2MAMHNo7zI4babxXqDDr2Yw\nmWKcRcXvoYG/i36dJ//eqLAc00mzpKdcJPg/optzSvu10rJKP9yPOu7N+lRHPCP1ooyHsUS5o5Vt\nS+UuF2X/k9tRsBMjZxl1Nou2e5B328aAOY+C+Csz8mNuPXwYg6VaiQZAVwbNAtr/IAF4N4Tf//V/\nyv9TTgbAUO5puSc+IDbjZ+rJ8j0s4LPlbQDMzVNm8hwdfZ0X0c/8WPN5zn9EcByl/RfQxrEzQjfr\n7cw1p9CHZvAs86JcLvV3nRF6Jrr5aNv/TgoT/f4PA7IkWnaE9F6e37KIXuG6O5BtltnUzkyZeosM\nAMugF5YqJeSb8PeYkadMQSG28x6mIu8xk772EH16L8uU153MO4E8X+J2USVl5WuBDrOJ4EE3RkwO\nWlzYOvqxTRznRLmD9J5mGehpZ/Ddi76rUYKu8MtVc+lHe6LceTXfu1wtqdlqfwsGQHMU3wPBrOQi\nA24vCmcj1tQWKt7ctD84t0yx+enjhOQ0GtEixb+m8W2t1AvIpKC8YlIBN2RGVStpe2Ge+qyCAPVC\n/qBL/vIDHfg0FuIzDKitvNOTLv/B6zznTy5Rz3MuB0LfqLCDSZIMgCbELoxlgG7nO+b6/7/LyQCw\n3BNmUF5wOxEu8Duf76E8DYDtGcqaOGu+iH7Wg7peGuVOBLwa5U67tF01lu70blyslRLG74Aol4Pd\nEsps4Oc9LuDw5yiXpnQrsuKmZCp/AAOgOgaaGZdbUQKWU+DP9OsT1M3j1JV5PdfTVjvL2wAo40h1\nf4/NGcpKlkoKOQ446R5b+N1OjM1zyKufXO4WH781IC1+i2WArkwE/Rj5wAVCX8Fbtg9jbhvP8Rj/\nf55xd9kZfA9j+AwI43wKGMNhsOo2ZLKdOPkzffWkM7KH/yaDAIPMTYvduuQHWDIfooReYVZyhPue\noQG+4xlejUo7oS5OSA53a8QvOzf6V841bDm9ByRsyyvX4K+MSyqmUI9gBJhr/TrC9CzPcZxy0uU/\nsAN7LGPcXgTUbNz27cPZf5EGQGU8Hf2iXPplfwTnX8vJAOiAC20+ffeoSwJjAXHz+UyHcjIArD+9\nmqccTHLnFdHPWlJ3UxGK/mCgX6LcgSdP877jMNAaJSw5+UOzjnP/o4ybc1HuzIEvuI8ZVpO4bv0/\nigHgrtMLBbcMufYiS4ifI7c+dNvmDmOMH+Tn49SbBcT+HgyAL11ytnylmBwi+e7xCgbTZerrW2TH\nGZSxJVG6H51TI8+73o4em8qzPods/MB5yz5monqaNjtGe57m9x85g+9ltwMrKY172jbApO2rx/ib\nTYY/p1/Ztt4ZUcLBR2VlAPxSggFQLdi2sQPBcYGX/4qGvMaA8YlMvuH/pxEo66Lizqj/JWWNZbJz\no59zAvIjPv8UQmoMLvt6Jd6zrAyACk6hTkQIbUfInEW5m0vyK57lGuUz6vY72vUSz7mbDjUP4dy1\niLXCNAOgGvEUg/ieDbrTCOFfyskA6OV2ImyPcmlgLae5LfOUhwHwC+Ur6j2pXCnSAPglxdNks9R5\nUe5o4Hd4J/OqHaGu57ulh5op0f4Wl3OV8foxQvsvPMebzNC2OMPqpjSl5WgA/FKCAfBLgQZAJTwm\nA5Ahy6Ncds9zyK0vo1xm0/dZInmXnz+hT3yNrHkTBVKMAfDLLTAArB/HbWsOS7FJxPLd47rz3n3k\nPMi7kFvzGb/d0wKp3XPUoL8PQaetRR6dQCZeZ6x873YofVyeeNUAAFHYSURBVMK/X/D7T/nscbcv\n3yaMzQuo27QEVp/Ql76Kbk6Mt42lJEvsVbs8DID3XCl2CaA1HXIqA2UbM02bPbzDgLHK/QiB+DoD\n1Bp4btp6ZUIF++cPhaR3o2+JcofX2OcvUdGbeOes61lp9ywTA8AZV23obBPxsGyiE7+IIXAJgWPZ\n8D6hU11B6JzkHZ9ipjg3yh27XOjJi/bOiRnBWPbwg2692w71ntvfWqgBkHbvttT9JFy2dhjMAn5n\nR3jGGQB23WIMgPcKKMUYAKn9jC1rPVGiD2F8W/pt+57N1n0CqpbBllGrl2VuZ87HTiB+yLg5gwFq\nB/HEehVSDAB7pmIMAF8XhRoA72XtezE7ctpR35N5ly0Y0i+5pGYfBPV11b3nee65j6WCR5JmdKW8\nd4kGwHsFlmIMgCzj4zJK/zXabR8G0yr6/Qj6eyHB6fWZ6AxFHq1GFh7EI3OR+3v5+VGUS4l8yslP\na7vBoSFdYt2+i2fpHO+9J8qlxh8flUFq7yQD4FBMKcYAqIUr+W46xAIq2tbB9uMVOMZgeIl77WZQ\n+AbuHmXPyx/3/KGQ7EklLqcRD8R8ZyfrWRPCxBLF3PPfyhCEUBs8AWPcntEtzNb2Ydi87FxYL9Jp\nLQnPeoSXRSx3TxN8Gd87MSOYG3QjXFDg88H3CzEA8t27JoK6N4PTjoQdzHXa8ZnQAAivW4gBcKiI\nUogBkKVvV2SW6uNdnuM+4Xd3RLkTJDvZso/z4I3BW7InoT/tp79tRDBNpE+2jH59HGucARA+TyEG\nQFxdZDUA4r6byQDgeta3+hNzMY/n3sZ7vRDItmPIt8P8bSfPupYllslu21ntIvpYWRsAh4oshRgA\nWcfGfiaOz0S5ky8XEVs2hPvc2KJaoQi915Vr2EFtGxgTe2mrl2g73357+cwGvjPFtV29MqzbA8jH\nZ+lXq/B2jEVft4pKPQjIPWBvt4VoXUxZE+VSJDYp4Nq1UFS9sLYmM1iWc03LzLUVhfAoARUL+Kw1\ncJM81lwvF2wY9/xrGfwD6CzmnZiCAFyb8L0VGAqhAVDwPf+tjEFIt+DZBjPo5vA+q+mgVrdbMO4e\nxVBYhME3mufrlNF9luW9F7nglFAJNOX7Y1gzWxXTz+wwjsal3ptYlMa0dztKa35XLcqdjWCnBMZd\nc1WUO2CkfhHPlKWUaT9j3HVyM5yVKfde6gyAqi7gtCPG2iLaxfenrfSntfS3WfSlvoz3ailJhIai\n9JKeZxn9o0t0cxbKrHXxq3PSg0Q+q1NkXGzfSzHCWzKZsCPGLcNpKNu2uDwgq6NcuuwH6Ht9MY7q\nlSDfij4fvgz78Tpk+6+i00u4xxr671J0h9VZP4z3+iXIUNvmOoD+OwND9pEol11zq9NP6/nbYsac\nyc8OUcKxvCW891ruZbu5JjN27mIZuGpZziYtacUkl6wnLEOjhHPmM2QCbEwl9calPpp7TaciZ/Hv\nFDrP/VhN7aM8hzIQndshw/MPszUT550YyLMkfWeCcxVXKuWe/1ZO0MHaIYjuiXJZ+Ka6up3ltuiM\n47kG8Gy3Z80klfG9xyDQmiWsobZgQAznOf13J9H2v1ruKYN7V4ibJbgsY2MSrjkpyh28Ub3Ivpev\nlHk/czOcwbR50nfHYdjfHlMvfVx/mhb0p+l8fxT9rhttWzWl/zRBBozO8zwDYrb7FlIXXf2ebGbs\nnelbk1La+f60rZEJaWEborx7RbkMp5OC+prJ+JtKXY5ynqiOGMbVy0C+dc2SU6SEe2Qp4/E+tfZb\nnEu4xyT6xAjqtzd11iypzgp89xrIwDvRB8N5hykJ8nM8nxlIfd+eFnhY4nuPZ/zdx3u3x5itWNZK\npB4X74EiiSsds8wS88xYG9ExOnPNvgz2AQih3lRqO5ullfHzNwqEQkuMmqTvdEco1yqLe5ajEVAZ\nQ6Al9+zhsp9Z/fZDSHVFYDUr1JjL+N5d0yxUjIAmDIoeCXXWoDzunbJj5Xa+G3fNHtyzXgl9L18p\nl37mjMOuKd/thjuxekyfsuxnSf3pLsZyqyjDKYNcswXCNu15Wkcxp5xlrItOCXXRgD7XM089Nihi\nTFTh+q0C2RbWl+UB6cQ7NsqixEp57zLWAVn7cpuE7dPF3KMH/aUD9duwLBR/zLPVpr+3pw/2DtrP\n9FM3nqVF1oldCe/dlT5p712tPJVIVfZJJpXqZXivG1ZRXQZAE0pjBlHNuH3J5fX8eECSvpN62MOt\nrLMC66G2y4Dm67c+9Vu5HPtKzQKfM/x+tfK+d8q6btJ1q5bY9/KVcutnGFxp71Yrbf2UsVoHAeT7\nUyMEW/UyrutaaTOcEuuiWp7vVisj2ZZUX/Vp62q/RflcBv3Y+nKlMrxHbWR05VskP6vQB+vHyM8G\n/K3KLajb2vkSOAkhhBBC/LFIWrMtA+u2Pt6H6mV0XdvrXp17VFTrCSGEENkV6W24zVqwhmRR2234\nXcNich7j0mnCWkpP1nHuYs2sedxaY8ZntejyDqz7deGa7Swfdx7jpmJYMty34O/8C9qxMoE1tSi3\nBcFABT9/zHtXiDHuanK/mmW5Vsa1a3DdGhh6lcqonurgGrblmepF1kemUsq1y6EvVyjwPpV8KfC6\nFcryWUodj1nruJR2THjHaozHGvxbpchr5RuP1dx4rF5G16wSPHulsnxu/l89rW5cHdYoS1kQ9PHq\n5XX9rA9RhwCxpKNLG5dxPEANrtuZQKNBROMOY+fBkCh3vGdnjIEaGa9dDSXdh8hNO5TDToDrT0Bc\nzQKEthkTdmTjSCLIxxIBPJSgkfYxSSGqEPHbjvuGxQKDKgedoiF/i/tOpgAs9/wNCHpr6UqLrNdI\nuXZtrtOeoJ3uBMx04X2bYMzFvXO9lPZrFlNf7bhXPRf42NXdszPXbVCMwGTgmYHXkffpxj268Awt\notxpc77UyaBw6hH01z3KnXrWCwOyadJ6J56rVgn9IEtJHDs8d9q12/i+SR015T2SPt8wwSBPGgPt\n6Jt1gnduSb/yxdq3gpMjzRKex/pf5RiF0CjlHVqFfaiU8cgYaZlSx61435rUwx0pcqJexr5cy42h\nzvTlrvzb0W2LrZFRniaNRzvcrBX9uBv9u3OJY7xhMA79GGyeJRAvwz2auvrp6oIOW9BmNVxf71Ts\nc6Qo/XquvTvHXN/qtlJ5K/9GbjtE0tGltme1RhncrwEN2x9FOoW9tAvZa7mYn+fyt5Eo10zRui5t\nrh2Da/vj10S5I4lt+1WVDJ2oFR6E4TzPfPZpPsxe1eXsm56akBbydoyRoVwjLINRBC0RlFX4uRd/\ni/vOvXSUuhmNobvYtnWfK4No92IioKsyAPw2mrFsd5rAz0OdwRQ+/318t17MwGjF94YF3xnmDr+x\nrY/j3T1Hc92eXKNGAYOxcZQ7AncwW7bGcd3xGHvDXFrpsHSnnSun9Pk7eb4Jbius7W/uzfcrxSj/\nLrT38CLLAARdtRjFZGedD8/QN2twnX4pfXkI7dOogDEwzPXFRk4e2VGsI1yx9m2B8dIBORJ33aHU\na4vgWZoyHu5PeAd/j0puPN6VMh7vQYjXCe5Vk341KKWObSy3d2NpeNYxEzPebVwO4B1H05fH8+9I\n3qMvz9wsz+6dtPFoRxHfw5iZQBnDe3UNDcKMY7wX7zvSPftY/m7HaDdLGW9Z7tGP+hnj6mYEf+tC\n3fSLqcMxwXM0L8SrwphuwzgZxLXGcP1x/Dw8KvDo+GKVsT/tamaUfHTpA7zw7WVgbPhMTEtIgLCN\nTHXPUJ4iA9Q6PjOVhuiati0RodDNHZyzjcxKR6LckcQ+J3yjPK6jlnSCcSSxWetOqtpDhqhdZIla\nyHu1DizxrjzPQhJbhGU+1+/NjKUpwnIcySDivjOTQdcyT303d8bQXJItWZlFnRZ0shSustYMrlEu\nkcZKjK3VGEcP0m/mxzz/LAZ465jB0YOBtij4zmLuNY5EN0tJmrHGJVqZ6/aUt8u31BMYW8OcgfcQ\n115NIo+Huf+s6ObjO62M4RqNErxdnajrWVxrE0lG1lJPY/l+mAipJe08M6Ef5CtL8Hz1iRHELRB2\n01O+v4D67IVAHcj1kvryPGRJ+yAldNoYWML7DUPwduHnWfx9GWUp7TsGBX0HSmZqTF9Zyr1uOkwM\nBdkJQT8/5R3GWGpjl8cgbTzOQGDH5VUYQB9Zmmcs2ymqSZ+LHTPBuGzjxuV06mA5fXkVY/Qh2nUq\n9dCXyVDNBGWVNB6XuMQ4s7mujf/lPO9QjLSqBY7xSdT1MvfsD7u/j3RGc+UCn3uxy8+wEH1gdbOE\nv5mxMC2ow0eC5xjF2GqZxQigL91Jvx1PvS3mmv76S/jbePpGl1K246c9UEMqcjKCNOno0qVUeqdi\nlwJwZ3RlcFsu5idRzMfJL36Ocobf7ccYWM13hqbNfFGeA2icjaSVfJ0c3W9FuVPh5jGYWuWpG3+s\n7VaMiRM840WueSY4Gap10BHvYmA/iuHgy7NcdyH10h6DbDi/2xrznaej3NnrbfMYd51oN3v+J12J\nTb+aQWG2po4nMLjWu1Sa+ym7Xe7ubbynf4elvOMdgas1TKEZvvdqhMJmDMXnud8+PrOFv0/mGVsl\nudDcIUtmbC1wY2An136Bsod33BT9+gjPjXx3cJxwRgn0553WcO2jpBndxzPbUdQdgsN02tLOi3nf\nnQWWxHTe0c0n/z2Z0jft2Xq4swaeSLjfwyjPzi7FcL4x8LQ7/Mv2Xk/nd8+Q0vg5PruZsTuYa05C\ncD8Vc9119IOeNoPCGOuKYF2V8M6b3eFG7RiTw6inLTF9eQfj4Mbn28QYcPdRh3F1/Iwby4MwcLYn\n1G3smHHLfK2Ds0LWR7njwK0v7+Vaj7ssmnZGRrvQE5BhPK7lGhuplxcYjzsLSA8cN8ZXuhTLzzNO\nbAyupy3MaM5yhHncPdbQj3dzfUv3u85NltbxmV18xj/HBt59XJYc/eimHhhdszA8tvA8e4LrP00/\nXMG4GIqcrl+Wyr8CFuN9DKrHyH8cHl36Ag39AC/aqIh7VaPjDubl11GpJ1CiNw7Q+BMnXX3Ozx9z\nwM0JPmvpT+9FMFZOcP/fy/s8zvPfOHnpH5ywdI5Bt4RB3S4hU1xl/jYkyp2wZsbERzzf+xxudJqB\ntoC6bBnM/rpgKS6lYU9zIMoFDgjZG918nKoJttXu8Bz7/GGU0Exmby3yuJp6cq01tONpyr4iDYCm\nGIwTULSPMeBPceDQZerkDQy456Lc8bT2DoUYAC+67x3nfk9RD2foO5c5bOU1fv8Ez2YH1DRMccvb\nMcuLaOO93Oc8136Ha79JvcUd4Rnr/XFjrC3KwRTtK+7QkQuu/SfGnAsQGgDnXH3kKyfyGABmmEyh\nr+2mDsO+aeeuDybt9Gbq2d/rAO01h8+1s3ZlDNxJPS93hwxZOUmbmRE1BGP6Ccbv65Rz9J2HGE8D\nGAebMab8cz/HvSy9cA1nwJpCX0R7nHTfPUc9PEz/6UabTKSN9gZ9+YgbjwNjlhtCA+B0cK8kA+DV\noI7yGQCNopuPLN7OuLT6u0Q/fovnP4E8sFMyJ/H9LAdf+fG4DSNxP+PRxsoe6nAs9X9bgWN8J216\njme2657iubfQR0Zw/ZoFPvdjPOMJ6udtJnQno9xptFuQk68EdfgGz7HfTd5ST+kj2Lcbn5uHIfws\nE4EzvNvb7j3P8LdnXMrnIVGGo48LDeDqSiOtYNCci24+uvQjKmw7VvFgjIaKBd6rcXTzkbw7o9x5\nzN8gEM/xu5N00itR7pjgk1TYwyifu+LWrjEA7qGSt9PAN97hBwyBM+EMOsEAqMO67gSedzfP9Dnl\nAp3qBSzUrQzee2KEwO0M7lkIi8Oc+vRn3u0lvj+H7w/i56387cYJbF9SP8/RVuN4vjoJhl0d3E39\nsSA38bx2mltoALRzAV8VUgI3OzvvxDbe5UaHvY5RZCdnXUQxn6T/vM/7FmMAXOX9X+O7x3iHyxQ7\np/sLBulh6m4eg6ZdQiBYW/rzXJTIAdrYTgC7QH85ixC6Ht18dOe7/C3NALBzB0YgmP1xuL9wn8MI\nhAfo13XzGAAfJpRPue6Nci2DAVADj8P9rg4OUod/ph5ORLljsicyM3uOtvic538ZY3sx7uDufqbi\nJhpDUISPI1SvM77PUy/LXHCtNxRuHCH+HW3+AgbJpMBQOIm8usa1H/fyKsEtP51Z3CE3Hq/w/w30\nwX7UnRkaR53MusDE5GF3pkOdDAbAn/h+PgPgs4xjpjK/u5933oZhYuPyQ36+gPK6wuTqTWe4zeBd\nG2VQpFcZa6fpG/tRkDf639e817PuedtH+U9VtePiX0M2nXITrBttc+Nkvu9p3wt85tEodxxvs4zP\nbXJkP2P3Xe7xPu90lbrfQV87T3u/g6yx57jOO7+ARyL2VEc3+W1Pf53D5/fyjle45iXudR7Z+RHP\n9irjYDVGeP9iDn5KUsrNnLvcD4S/0pDf8u/5QPF0KyT60XXQoQzY7QiN9xnY7/D/5xi4TzgL8G0+\nc4VGNEV7b5z7HkOjL5W1FmvOZqdnaXg78ndQ3Awaa601A8KU51Ge9y8800GeZTWKdBFC4K4YK7ou\nwmEcdbiTQfIlwuAsgsBOaBvpvAVn+MyH1NE25wJtk+AKvN1Fmg9G+DzhvCGhAWAn5g3BY9AkZfZv\nrux1XON1nu9zfj5K594T5Y7ZtHYuxQD4d65zngF81C03HOedvuVZzmOw2amOPcIlI7cuPQ4Bvovr\nfoZSO+ZiO55moJ9DSHwa5Y4G3e3a5L6YXPb+MJxFCMyTtOc1BPLz9CPzANRJMQCOphTrU99GueOt\nN6QddhN4QZaipI7zfN+569gyx2OMy/d5/tNR7gTNydynRcLaZz+ndA8zpv/CPfYxw56AIbQO5XRD\n6P5I+ZB7b8aYHoU3YCdt/o1T4OudAm+cZ+Jj4/GrwIAwj8Qw13anotwZ9ifc54aEZzrcQgOgNuN9\nPGN6D98xL+UJ5/rfTd2fop2fxBs6GrleJ6Mi/ZZ7mCK9gpH8Ftd+Mm5JNM81/4bie5trHuH6B6mP\n95EDn/D/J2mXodRJpYz3+Bid82qUO3nwCH3oU/rjEdrqDfrcfvrjK67fXuNdn6INh4XPETP5XYVc\nOcNzXHVeDVuC2ufe9wPaz9ppJJOw20pV/lWx/kNX2HUa4TWU5pcYBYedpTigECsEYduNDrqSDvo6\ng+ATKnUHgng+g+VhKvYEFWWW27PRzUeZVk0IuBrmXC22xvIsynwRAq9bTBR6A4TDfVxjLkLvBHXj\nLdxlCO1x7qCIO2Lyq1d0Sy1z3cz+A2dQHOBZp7p4jBfcbOyNYKmgV8J2K3MFjkHYznUzz3M8vzcA\nlrgyn/foGBMxXskZcd6V/TEWsSmKbbTxwwj6nU5olmIA/IN+eQohthmluZZ+cgwF8XcGzotOUQyM\nmSHYaV1TqPdDzuNkBu8jvOuSYPb3KQP0CRfsOC6lTZrzDNPd0pcdsXuAOltIfYQBU22Y2T1IfSaV\nnQiVL5wB8wT1PJo+XSslDmJAlDsZ1BtD5jXbSZ/cy9j9ij75Ave3ALU7ovhTAU0GjKN/7Ob7f6a9\nDrtZ9xzq5BhtfonymVMuCxl7tkz2Ntd6PXDh/+q9U5Y+rwbtb0sI5gXci0w0b8R+2nMKk444A+tW\nGAA2ZqZi+BymD/zZeSlWuZ1LG51hu4rn759guCWNx19QgJfd0tteygvIuNlRzLHoKdf8mb5wnPfd\nRPta3Mhp6uQ7+k6hywxmAFxxS3ePcg/zAL4dLO8eoi/aaZLP0gftOfItd1RkAnA/fWA7fe0D7mNL\nTo+6QFc7yvss4/mtYBm+dzE7t+JmubbWvCro3Bf5/0vOtXjSWTq/ElQZtv1ZB93gOuhPdKADVO5U\nBstgOuVaBtk7CTOFbjGD26+5P+giP1e4Cl7IwL5JOLjGGkLnNcX4uHMx/sm5vpYE5YEUQdAgqO/Q\nCPKzibl0upfptGYkPeGCBWPrH8+Fzfo3Itx2UG+XnMGxj87syyqMtK7hOhPbmbo6Ab7HCXATzDuo\nB9uyU4owCwfuT/SDF1yQzkSntJ6n3/6AseEVxZAYN3B4n6P0dd++D0a5I1/X0E/fxRj1rv/7GZQt\nE+JSamG1D0O5rUJAbkNgL6Y/94lx01sE+ljGR1iW8ay2zPIx774TpfUAyv32PLs6OvCucxG8finA\nBOYT9NOr/O4l2tfWQLum7PuuFN18LPCTgdve1mXn0ofM+2VLJCYzXkehrcCg2hgYZiddu9/vYxHy\nBD/vQ9D+gEw6iFCe4ryAR5yr+AzK245Vjp2V3SIDoCFyZ7pb6rvqDKJdvOMi3mUmP1vE+xDa/7YC\nDID/5PleQxZscob/Kp7VlmrrZ7ymH+OrkMET3dKpjVH73H7nOQuP1M56j+kunsk8Sd+65Yhn3ERv\nZrCUmuU5agaext1O7tvy7xbafY4rW9x9PsJo8EZV81INgFa40cO15i/cOrnNQL9HuJqrMjZgJM/6\nf38qcAuK7WPcemZseAuqMwp6BZ3rIp+9wsD8VXRv4A7rwTOuTYimTVpvtfPQR2H9e+V40gUnno5R\nnttpxEEJ60AWfGTLII8770a4nriMa76GsvEeAnNrNk2oax/ZvYN7nKHT3RC0/4FB8bpbczrvBkSS\nAVAfgRnOmP9Ov3kxCIYaVI4GgD1nD66xhIH6mlu68uvKIxBwlTN4APzAt61McwPD9dOYwLVWaduA\n8Mx0QylN5rqzec9RCPDW4TXoN7dHuZPKrIykH1kcxtv0Twvce5S2uI9+d1sGIz1pKeArF/PyBv3n\nJHX0MIIvSxS0X3L0y2p/CmJzbLZtu2yep7zllPM6PFY+nuB9F5RnnsqmebY/j6D/7HAzu4+dQTIv\nMFg+dR6mLW4p8faE+9wKA8DGZugBMG/YK9TfU9SNebamcN8eKfWUNh6tLTZRT+OQ4eNdkGbrmPib\nQsa43z1ymPf5O4b4AQybUgyA8TExNt84Oe+XMqZQv0dQ3lmeI5SbB90yu8W0PJZQDtGOnwfy5r58\n27/zKeSaKNrRrKE9y4zmT26dbSsVEvf7xDX4lL2PAxB6W7BmPmE2+haDfaVz2XlX4V4+8xcq41CB\nBsDBIJr2cAEGwG6nIC/jHfmBBvTK89V8BoCrh77Ou/EC7/Y9yseE1zqsShPqJhxtttElSshiGGMA\nnMWIu4Ji/C+u+bZzrV7KYAA0dgGFFnV9lUEQGmZ33SIDoKvzdnjh+gPerN0YkaPD5aIYy3yXC4C9\njHLa4Wbqu7j+pzxHuCTWNKMnrD2GxwAMpb4EYbZIScZSgX5d383UZyOMfBzGW4wP21Y4nGtnzRiZ\ntBRgga8W/PW6C8KyPexto/ynJ9ZhbE5wXseLzqW727mobbZ91uUGORvMhpY6w+8r2nwvCm5CUpBs\nkAdhoJvZHUHGfBUsN4YeL3M/2316png+boUBEC6vWF/+lLHwEXVzknfcgzJZg+IeSbs0KNAAiDPI\nuzCuOtOfbivxmr8FA8CUbjEGQCMXS+bl5s8uuP2VhHLaLX+HW81blWIAWEDONCr2AJXyA0JkHzP9\nrc4N7dfgH2KmcGeUIZ0uldA3cNl9yHrMuyiP9QxES687h89asNDf3HLBWhR8jzAYMcEAuBKsNWY1\nAHYhdC669fqf3fZEK1kNgNtcEpLFKBiLu/BudFuT/DgwDGalzTacZ+c+Zkfb3ezJrvdX2vqg+5uV\nNAPAG3FbnRFn7bI/GAS3ygC4l3d9gvr7wnmW9qQYALYLYEjCLoC3aZtjzAZfczsojtFOD9FXu2XJ\n1OUMgLtiDIDmaQrU5V8YyExvFeuEp/HsXGGs2rr/WO7TpMBYHVuqWIDh8xL18U/cvl+6mAA/+89i\nAJkXbLjr/6dpM78U+LiLLznGczxGO3zM/Xc4T8FbGCin+f1il1Ojch6DxILnzAi8gALwOw42uln1\ntWA5zgLQqvwLDYBKwZblzS447z23Xv0ZMvANPIN78GzN5bt3xHigCh2P/53PPsOS8P8EAyDJ+/0P\n/r0QTCaTSuiNaFWs8vdbRmwLzSsIc+/+XxIEov3oFIePsG2S4Z5x+9HfctspTjnX/MMugMyiJT/D\nOLkYeAvujFFUSQbAzxkMgDBgw5LN7HWCyqJfQ+WZ1wBwAWF+58VBhN/37v18VPL5mK1GdfMst/Sm\nMy6hrjY5Qf7XIAhwpSuL3Xpm9TzLOGYAhIPADLNbZQB44WoGwPf5PADuXj1Rlj4PwGkEp88DYHt/\nD2GJr0QR343RVSGDEWxLAJMSlgBapSiSZi7/wkMouuMIoo/cNlmLxu+fNTuZ6/utolxmwLXUxQWU\n/oduO+179KfHXPBilyhbfnbLPjib+ralx6suwn+n87qZUfCoGys20/fu7g/deuqsLOukKM62wfbE\nEy46265nO2iuJ8jApin3KHcDwMUB+L68CQPxCP32DerJZNhVDITdyIGJfL9uqQZAATFh/1M8AHHx\nGd77/WzGstH17RbFGgB1nRvuEReM9m0QlDDbudhsGSDJ+q2cIQlQp2C97VUEyl9o1JNUpEWSHqQB\nLNjiS+cOXBq3rluqAeAUnUXRz+Fej7sYAFtffjZQng/TyAPyCATbgjQmWH75wq1hmqC7isX4mNv6\n96utRjG7O9pEuXMWpucxAGzdbiyf75sQDRzXkT8M9rKvZ5D0voUGwDAG79PU41dOuD7r+kr7mL5i\n2zMt0+NjXP8MBo5lT9uHoHyKZ1qG8r+XPlgzw5JbGAS4BU+KBQGOp96aJAjMbhgKC90+77ep13OM\nmXUuUVZHSockV2xM+/aMcpn+bIx+7Pb6v0If+hqFYssAlga3dZTn4JLo/88GepebDFhwqt9ZYYG/\nF1w0/goM4dd5niPUw3EMUe+5nJTmlk/YNjwlZunNPArPOUOoIC/oLTQAfFbL0fQzSzn9FHL+KM//\nMZ67D9xumZnIjMYyAMrUAKgXxBqZPvop8GgvyVDmuTwbdYs1AHxSms0uEOcHF+hnWcnmBMsA3xay\n/hVj+Q9wW6H2IrA/pMJtS4klkXkXi/uvKBm/D94S7rRMULClGACVeNYeLqFQkgGwxCnPsXSSTnHb\nrWLc9PdgZFkbmHV+kTr+lJmOBV5ORkE0zFDX1XmHvhkNgDuj3LHGLRJ2F9Rzg3GdM1J+cuuy1jbD\nqI8F5WwA3Of21toulu8DZRK7FzmYjc5yke9vuOUDy0G+CgW0iP4wi3qwkyXb51lrbhLkT9hFe1iq\n620859CYpCl2mIwlEdlAHbyOQrrIc1v62lFBsYO02kTJB6fUiHLngczHODlMffu8Cn4LoAUCPo2C\nNmHdKMNkoKPLdWETjC9d8KVt//Nt+GCwVfkVFNvpIJeGGXwds+xSYlmuc5TL1PmM205pcQlmkBQc\nB4UBEC5ThXLEnnlkCQaAHRp1P8bpXPqpRfyvpF0tK+fX1GO+ZFEyAEozANJ2T5ncfIz+PcblZJlE\nnzGP+FzavmfROwDcGnSYaObzmDW04TH70X8M9ljPzrcmnbC+OA9BthsheAGl9A6W/FkG2ptU1Ndu\nH7wpw14JQSslGQDOmm6R0QDwB5i0zWgM1YtyB1VY0I4Nyu9Zr7sWJLuwrZfVMrZ1wwINgNvSrh3l\n0rmOdeultp3FhLdlrFqCUtiEAfMaA6qsDICN3GMBM7HHMQ4/IFHIu1mC9KJcdrqFbj36c7ePfq9L\nzvE0CudxBKlZ7VMQ8ImR9hh8YUKmD9xuDAtcGx9ubcVgH0h9rHbLYtfdVrzHqe+4stQZ6kl9vSV1\nNJXxbkriC+ryCErPkgC9hyy47P42H0GaN1VplDvgaG6w39/O6jjnvGHWhn7nwAf0o6PIhY/c5MCy\nad5exKRottt+9b7rRzYBCndC3ZVvJxRLfoNcPpHjjO0f3f7uR5G5S92e95MFGM1VkD12aNQa7rWZ\nPjCH/hPGynzMu9myyYDQAyUDoGQDINz++oSLb/naBdRuRpYt4llW0Ya7Ketoo8HogRrFGACNqBQf\nhW6K/YMgecpESpiR7ouYqPRMmYlwt/Vwlu5qhNeuKHeIxF4aYrdrjPfcnuMH3T74auVhALjZYVYD\noB2z7koZ28EH7cwPEpH8g2WRd+hYttbYP982q1INgAxrxLZe6rcxfsSgsu1GlnDpOdbLX3OxAqUY\nAP/kOmfpJ08zOJ9lQF6kr1x3QWrLo5TMlcGOiadcohELGL0Y5XK2v8bfX0VovsD9V7pEKs3z7Mx4\nkPvYWPrZ7Wz5VZ+Mcoc52ezUtnV+4AId9zkhEVc2Upd9UqK8e2DYLXXJt666+BzbErmSej3rcmKc\np83tvIAB+ZQv9+wd3Zzx7x0Myatc+2IQ0T/R5Xt4i8/YtmVLymOJUjJvUXYGec9gWfQN3u8y8sPn\nQlmUNReKWzqbxlg+xDUto91p3vPpKHeYjmXP/DHjmGni4n5WcJ0TjAs70Gkj/3oPgN9ePCUuwYwM\ngNIMAJdBtV+Uy077PG36BcbgOfrFTpegyfLw2FkZO3leSwfctFDl73OfW4S4RdV69/+amLLVbV/4\nEaPBZ8HKfEAQldEdV9UDVO5yXs5OgXoGQXs1+nW60Uncr0nKGvu/wgCoUIQxZolIVlP35vHwiUaW\nRcGRpv8KAyBmG6NlhTuPMP4egfwGv7PDM47x/y9LNAD+0wnkSyih0yjmy1z/Otf32enuRQFXiDHC\nWsYsAVgK1auMjWtc13JAfOpmqy8jIBY7t3O1hL7kz3c4yvffd7tg/NbWusG2uUkuKZbl5bBMbBfp\nN3HlxTQDAK9P+2AnxKEol1XvLe65gZnlHOrpkNs1dDW6+byAMVFwFkCK2922Ifsslb8EkwzzRo6I\nWTL4Jcod8OUPCSooVSoz6DtiZmnXUBg/0U6HogKzoUa5lNNjXW6R0yj/v9KX3qAfn6N9Tzr5lzpm\nXODyUJcX4kVk3mXq6mV+d4x7WFyHZWA1GdMlJqhaBkDpBoBlpx3OtbZGuYPlrrmtx+dpL8vC+wF/\nf5N7bkcf3VNwECDCpFuw79m7nd/koQ4klJcR8P/hEmXYAUGWB7tiAcqpA8pkCJ1vIgPY0rpaUhZz\nkayPculG26Xsmf69GACWiGS4SzRirrn3UBJ+maVlgdcvxADoidBsmtaGCO6ObpvYFvqGuWw/ccLl\nXJQ7ma8sYgBsu6G5ZC86A/Ej/nYmuvmErlH0+boJ9XMX77/YRZ+/6pLeWLreE7S/Nza+DQLPJsZt\nS3XJQGyGuZw62Uc/t5ganwejphuzPTEM1rnEIFlLPgOgObOJB4J9//b9E87AGYUSW+a2r9rnLrmE\nMHYa4B15EiO1Drarngie/eUod0DWoJglg/eC5zTheF8xW6TcLM1m6gdRFHYPfx7K2CjjeSgssVjM\nzyyu/Tx99V3GyycI+4tRLg2uBUe+l8cAqOS2VlrW0gPIkotRLjvkVTc236AO7cje6RjCLTMqa6uT\nsjQAkq4ZGgD2uWIMgKR7hAaAfS7NAMj0HMHkqRdjfAn92Lw9b7klQZNndqjaSWTadvSjbbttXGgH\nt3zkM2L21/8NAf1uSnkfofdPjAafuW5cvqQbCQqwKZViUdjbUXw2A7GELLbdyNKN1s0TZf97MABs\nNv0Ancc8AL5uV7oEG/XKyQAYj4IZmWXfOMs4d7ntRptxNR9BqByjjndhIJRHEKApUAuke5l2fpbZ\n6kL6ZO+4ZZMolwt+MO1rFvlrDMYD/G6LW/t+3C03vI0n7L2MMSWVud/d1PVit+zzSpRLXXvTrpoE\nA6DQEmsA8Ezt3c6cJ2K+uwsFYUscd7sg3j0xn3/ObSnrkaYgo5sP7TKF669l3kiL9+ntIvVfCD5r\naXunRsUfV14zyh1ZbLtzwvfzu3HaZB3zBOh1pa7nR7mzGw7Rd4/Rz/fRF1ZhZPk6SRszFmA9ib61\nnu8/78aljZPDtN3jtNVMvLGdEhRXOB7DOikLAyDtmt4ACD9XiAGQdg9vAISfizMAMj9HjMexH/dc\n6NppH3oubKe9TIgfRdZOdAG9VQvp3NXcbNMScJzCnfmjW+/MV+xIVDtQwQKtLP1r8wIVVHcUj80m\nD6IEv3JRwBZlPAEh0DTPdX/zBgDtYQcx2Xr6cd7ZR4aad6Vd1viCPAZAqEjXYGSsdZnjuuQR3JXc\ndqMx1M9Kt8a4BQH3cJQ7krk8dgGswfiwez6K4LZT4tJy81dzLmg7dtaWMs461/NMrjeHtjDFYPnC\n33X71CenBNr5A6rm8Kx7XT6JdXFre64vT6A+1xVRVrl18fpBO9rMcVHKd2ejIDrQN4bTrqsTvmPH\ndeczAGq6oNKHYq6zJrr5cKrOUS798dqYzy8rJDlZSrCmpUdPq8vehRoZTHZ68g6z8SSsd0amHXyz\nmL6/Iub+ZiTeJG/wzLVFuYxikmeBZBvcPbZwz0eox8koti5JMRNRLmW2eYni6sUSYmVdSizkmj2j\n3DHUcZ/zJ9TWLPIelgciaQxZYOmkQp8jRu60Qr6NpJ2W0O4bXTttdu20GBluW7TbRIWeBIhQ7eXW\nm/eh0L93Gej2ZCiWwOeHIHPd4ijhFLkUi7gLndnyrO9DsH6OG9xymq+lAgbx8lX+AAZA42D9fy9u\nuW9cYNeaYoVNEGgV5gf/Ocqd876L2XtB+7mjXH76ngye8bTRLMo0BkN55gGYzPPaVqcpKIB7GITN\nUra9Vaf/jY1uTjdtZzLspk+uZGDbASebnKfmC9yF3i18Z9wMCGOsjwsC2sXYOeK2AA3HSKgRzNLb\n8U4TeOdCyyQXOVw9JrlQX+ot7rsTaN+utIsF8Q5FKCd95x6eu3IG1/hA54UKn9u2PTXhWXshCOPu\nO47ZUdEpUlEa3ZmpF1SXGZcCmka57JV2uJONmelcfwT1Ny7m/qNTckXY1t87qdPhtMU0Z8jO5J42\n6+2DEVgvj6e2A+89KaFexnPPVlnkYIHXvIP6SutvphsqFnmPuzCcksbQCPpFwc+RIDubuXYawTWn\nub5g7TSBdhyAvGpW0Mw/Zr0tPGXOlOJRhNuKPOVpt1Xqe6esUrfmxVj+HXiemQjE3ayJXYtyZ5Bb\nTvP5KNnOGdfcftMGAIl67oh+fTykRV2Hpy52LFTYuHroHt18lKntHf+eurjA7+L2czfIINAa8u7d\nUSQDKH1uUSKg/tyvP4LxToRQ3QxtYHvR7eAl639X6eOHqDMzfvehsC2Rylv0pS353MJBFsXNXOdF\n3IsPOe9Wk4R2bEef7llE6ZEk5KmH21FKcd/tTvs0CIJXO6Q8Tw+eN8tYrUGddU+4TkeUfwU8Fs2Q\nA3H37YacK+mcdO7XudC6LHDHQWvqvI8bM/24R0fqpFvM/e3MiMp5xn1z2qh7cI/+/L8b7dok44St\nHu/dI6WftClka1oB16yTp/93x/tRs4R7NKduk8ZQZ+rqjmKeI6WdWtDePQL5afKsO8/fPF9umXxR\nqLa2tRzha6fMfef219t2m9EJZZbbI/sB29WuBsl57otLuBK4QNqyljiVez7rIl7/yrWPowSXYQnf\nFWXfZfBbNwAaYSiFxwJfi25OMzo9a6Rxwn1sjdeigx9D8bxBMOe1ICjoiEtwkjnKlPvU4b2aUJrH\nGADXKMUaANcSgo6aoGDrFyiAWrpkTBtR8GdcAqorKHlb/rpE/3nfbdt53PXRnilu1Lou78My6uQJ\njOoHGA+to+Q0wJXp13WKLFUzGOVx36sd90wYDrVTvlO5gHaolHKtagmBqHGfrZU1CDljvpSi6rIA\nb0AtDGgbM43oJ9WI7K8Vc+9CdgFVoV79PRozvmoV0kauzeuktHmlIuoh0zXduxTc3wq4R42Uz91W\n6nNkeL6kdqpSamdrikUx3QXbXEbZfhbsbR2KGzIsPYN9uLZ8YAlgbM+1rcHVSglE7IfyW87ygY/o\ntUjuXdxrCkqwZQE7DJIMgPeyBm2lGAA+IrhYA6CN24q5zUWaH6cungnSjNYqoe39uQAPRbnDgV5M\nCApahVt9YCE5BxLa2RsAx4NSqAHgv1tw0FHKDMTS6y5wgVmHMVhewzB7021tPIW3zAIcl9LPBuB5\nqJii5FrzuYkutedk6umOYtethRAizQps7/a3Polw8wo3PD+7GVaJLx2iX5/g5a/hZ639E7KuVY5u\nPglse0I05U6uNYf1xw4FzuziDIDwPsUYAOE1CjYAsPzbRbn89VtjyhpcxYNKWc907d/GKZ6FLNds\nCgL27HzwB6jzTAe7ZDAA5rhAvbAsyWMATKWd4r7rt8zVKOE5m7n1PwvM2kB7P8P6/m4U/k7Gz2bu\nP8+tO7fNkEjpNtqiH+t+Ixgr7aT8hRDlYQDYOvBEly893D7zNIJvfNJWviBn+oaY6xwKtjK1TUi8\nki/qeC3PMtsFXjQo8J1rRbkjPlck3GdllDv9qk6KErN3XptwnQdZy29boHLsz/1nxZQpXLNLIdsq\nMyiePi7H9Ax3Px8U1Jc2ql/iPW3f+5iEd5zlZs4tYtzRFm0+I+G7U10+iMolPGdFjIBuBPiMw4id\nj4HyUJBS90GMMwuO64l36raM96vm1mc7MK6qS1IJIcrDAMiiDJfjbr0HRVEp5jp1mG2NRDiuKkYh\nZog6nhzlDtXpFhVwlnlgaLRlBpoUOT0RgZ92jnddnmF4yrOOZj2/cQHPV53n6+WCPnzpTWBIgzLs\nB1VZCuqA0uoXBOz5oKDqZXC/ilHuQKUBKe8ZO3Nm6aKrC/ILS1/qqG4Z1Y8FZnXjnvdhLI2Mcofq\njEDpD3SBbg2LWXfGG1ZFEkoIUZ4GQBZlOJa/d8yzb7cZymNoyrVSFWKGqGOLdG1TYqRtLd67e55I\n5Tp5rtPYxUAkPWvzIvboV8XV3SSmNCyvWSH3rct7+fvVLmUmnXCvCijWJgmlQVpAFc+U9N1Gpbj+\nU57X7tkKg6ijK+3pl82ow8qSMEKI34MXIE0Z2tapfEfYVkDwts9zrbwKMSXquA7RmBXK4L0r54nY\nrJLxOmkRwVq7/eOOm4rEUFippFoRQvwehVmaMixI4ebZCiGFKIQQQgghhBBCCGGu5WosLdTg3ypl\ncN0Kql0h/tCyozKyI29RbYlCOlYlotNrOKVUuQyvX5Xr1iQmoUZZRkETn2DXD0ulEgecZbmzbHPF\npOWtSOBYc4IPOxMv0ZV/OxKF3rjQ4DaeqTXXbVFK4qAyaIcaBMm15ZkK3cJZjyDRlq40+a0JNBcw\n2JjdFY1p33yxL1X4bOsSS7NSU97+xuVRNeRRWCrcgnb9VSnwGnVpn2JKw5RdSQ0JTO2coXRi7NT4\nNyFSlFt9BO4dgVLqwpaxlkRrVyni+jWdsOvItbsRQNiV37XkGSqW8B63EcRo1/elK8qodhHXreeC\nJ/uxPawXg6tpVgMJgWD5zgeyi2I0e87HswtjJNkB+9IOzTLm6G7AO9q2tYG0XfNbOfjd0c6dqKeh\nvE/3rFsk6Svd2I56nyt9aYdqJT5fY+rFlyZFGFw16W/d6BcDeecelrs8xQhsyfbHwWwpLLZYAqHq\nMYZ8g5j3bG67F/JMAtK+2zThb40KSY/LfWoyLurxbw3qpypGbCf6cVhaZzFwMc4aOeOsTp4DWurR\npu0SismpCnnu29SN87uLKL15x6oxRn43tliPyVBG8wxttFtFJM0a2xG5P4i97mMCpTSCvfK9wgNB\nMgjIFgzYfgi7kVx7Anvwx/G7exCcrYsJIHQnig3gmScEZbzb71+tgOs2wKC4j+tMJwHMA9RVbwyn\nSnmerQnXuZdnmUUSpBVk31tFUqJlpKOdSr33y3egCgKzHQphNolr7NjI/s6QuK0c+1E13rEjino4\n77CINMDDMCSrpMyImyCoOvL52dSFlUlcuzX9qnaBz1iD9u9LX/elH89Xu4C+3R5hPZb6nk3CovH0\n544JybTsPIBxvNfCEspknr1J0B9uJ7PhoJhyd1JujYzfHZDwt960X7UMXsDG9Nmu3KuX2z1kHqy+\n9OGxQRnj0iZXTWnrOOOse5LxgPK3MTospgzlbz3SdjhhdFiuFDtCutAygfdvEly7FbJoDidT5ivL\nuFbPssqVIf4Yit9nPjPlZsrDlNIjdKKlCPFJKJkeGU6iaoT1PhArdBrCbhnXXU15hN/NQSDejWAt\nVLjXZNDZmeKrg/KwO6WwfgEKoxPW9iyusYkUsGtJdjQ2XwIgd/73CK6zguvscEfw7iOr4k7Sz65D\neU5GmbRPOVehCspmlDtX4VF3nrgZEh15lupl2I9MmLd3GQYfQDmtJSvkI7TtnQnJfmxG3Ie6Hoxx\nuIbvP0mdzEcAD6GfdCokQyKKbSDPNzcoU6nn1vm8UM7YvJtsjQ9xVsE2d5KmJdRqG44TxkY/jIXN\ntFcx5QlXJ7cHRn1P+uacmHedRZ/oEno9Mn53Rszv59JmfdOSdrkTDfugUMfRHlNcLpL7MTJG0YdX\nBmV52lh2ht7ABONsUJyxh/FyH++4JKYspk5GY7Q0TnHR9+W+Gzh8q9CygHHQKrh2W+ptMSmq9+Yp\nG+jbvUvN6in+WAZAc5f7fA4DayvpgPc4pbSHjrYNQT6XAdAHgVohQeHZWeHTMCAeRYjv5BCa/ZTn\nuf4WBKkJ4jsKmbG6TIemOPYHZSPP0qcAD0YzZg3TuOZODoB5ibrZwkBNnN3iQejuMieu5+yAI5yj\n8Aany73NiXM3Dpo5wUE3j6NMpiK02iacihYaALt556ecITGFWXlfnrVxia70ym4tsjdCezJG0RqU\nk/WhfAZAA5TOOAyH+a4dD3Dwjim7aXxmustYWTnD81o2x9H0x+1BWc79e2Q4/rhWYGw+xcFBx+kf\nllJ7Aterl8cAuHEQ09kCy6kUA6Apym82fTR810fpD71ini3Ldx+J+f122n5w0rkVzmtyD5OJB5E7\n6xgX6zCyF1I3E9yhY75sov1v9OWGCcaZGXoPoQS3IQOWOxnz38aZS08+ggnJM4xTX57m3jbmO8Yt\nGwUGwCbkxSsFlKeS6jLGADiH3IgrR2UAiCQLtQfC0E4/e47T1s5w6tnblIuchvYSB6FsQqGM5Rp1\nU9xf8xDiOxDkr6Dg3uLgoMv8fBaFuAMB8ACKt0UJBsABd48XCzUAECRtUWx2eNIrHHr0EUfZ7kVA\nTaQuasesN3fgGnPd2QmnOGr2c47jfQcj4F13NO9F6nwHymQSz940owHwJs/7AopirTvkZygCoT3K\nqEoB9Wzrw+0wIIfwbAuoi+2843GeIdUAoI7ac525KJ2tvHNoACxESexwCrZXvuOh8TC0RujPoi8c\n5DCsV+l7W7j/YN6tap5lITukaD3nX7xN272L4N3CvQaGbZZgAHxYYMlqAGzDoPTvuj6jAZD03VX0\nq1ddeSrNAHBtYMd/r6Cv7KEtDtPWuxlrG7nPVurzEuVwoNQaxMifbs44e5L2OR7ImAn033qBe/0e\nFPcqFOwJZNZ55NTzjKWpyKjmGQ2ASxnLmSIMgGsx5UMZACJOeHmlNC84//zG+eZfcOa6zUjfQSF9\ngCGwH6E1AyHWKI/7aw+K6Ebn/gTl+S7XvaFMP+We7yAIn8DdNgoXZc0SDIB3eZdiDIBwRrATpf/n\n/1N+yXKcMLPsvvx9FQbUWerzC2b/LyNMn0cQ2lHD31AnLyIoFzKD7xgT8JVkAJghcYLrP85yyIPM\n1u9HCVgu+8p5lGh9Ztw9nZt+Hgr+Mdr6GO9lfSifAdCQNvF1dBThtoH+ZsrOjjA+imKYjzC8I08M\nhnkY7ByMZ/G+fMox2K9x35UYM73zLOlYH7djio8yPv7G9V6lruehUFrkMQCOFlkKMQCu84zFGADh\nd80AeIf3PZPBAKjn4h4eQhG/xDHLV5A97/L/k4ytF7jnjd/9ib78PPefwHivHTPm+iF/NnKdSyhF\nmwxs4f3u9gqcAMFOvENoBFxBdp3AqFjMJOfOmGcIDYDnCyyFGADHU4oMAPGrgdjYCdzVKIvXGCBf\novSPMfj2IoBPMPheYeAuR/jfFXYqlMRdCNKVeBbOIkBe59oHuP5hhMeNgfUt9z6AUp3GQG6cItRb\nMyDauij9LAaA/04b6qRyjAegHYNtEYPyJJb1NZTc89SheQDqBAZEO5TsgyiE43z/e4TSIZTaGpSk\nLQ+8ivL+mvvs4zMP8PwNY9zxHTBWluKqNEX8EeUN7r+Xe65yrvYhtFnbuEAhjKvWvON9KNK5btlo\nN4bMBd7vE2d4PIfSHYNBFxoATVjvnYVg3sv3TtNH9vDcz6IwXqPfmJt9NEK7akqMQjuEqXkYjjgP\nzKcon5fc2utQDKrbUpYTetLHV/PM51Ew1xkn27nfoAQDwAyItQjpYsp67nGTkXGLDYAvMxoAt/Oc\nszF6jvD9r50X7Ap951OMYJskfMFnvPIdHrfsFvP8xxmv/4WxcjKPcVYvjxHwFjJxPQbcDSOiZYwM\n7IWRvTwmhiFLmUXfuT3BAFiUcDx2WNbR1jIApPz/v1lcWwT+AgbCMQbXjwy4I8ws1tAR17r13Of4\n/TQ6Z5sYxVkFgWuRqpsYMEcR5o9xzdUo5T0Iz68ZqK+4gK/7EoRJI5T9fQwGX/IZAOHnhzA4WiTE\nSQxEEKxjlvgyQuUAAmahE0ZVY4ISx+Fy3I0B9A0C7iRCcymKZBy7C9YhXC/RJh9xv8cQWveGAscJ\n2EE86yPU4fPOeLtGXbzOO+xxcR3zmFHdG65rokDv4NrjaNMVKNLnUJznURDXee5X3dLDaoTxYPpL\nxRiB29NFxK+hXmzJ6DTPfNotQ1m8yAz6QNukwD2Mu97U8SN8/zWe9SztYMbpXu4/BeOzWYpR0YF1\n4AUotN14cGztdRPP1z8mktuM5Akos6UlFHNFN/2tGgAYqO2dgfoMdW+ev2PIiIPO5X6Ze77v+tQu\n2ifN/e49ABswsi9hUL8TLM/cHdfGKUbAy26d/mk8g2MY5zUTxsyYmF0MWcr9eBfqxsQl9Us5Qjws\nM5BPnZULQAZADTrVWIT4LmZt3zAbOk3HfojZ5lgExSIXsT+bztkpJSq9Pgp6DAryUbemt4BrT0DJ\nb2dAXccIeI3BtgQB284LdwyM9ijvuQjQsCQZAHGffdAN4loxM9/OPMcctya5DUG4mPfoE7POWx/F\nM4X3P8QM4m9ufc6UxAAXN7GU2e452uUrhKXVyfA4lzdrnya0JgdR+C+g6C5hUHxIu5tC3YqRMjX0\nusTMZja7YMhzCGgTrqeod9uFYMGH9/N+9RMCw8LnXodCeZ6ljI9QEjt51uUYS6Oo46YJ/fA2t6Vw\nAUbUS87dfAhD6HX6yQmMlkW0RZeUPt4YJT4GA8oMtwtc8xHnpq6TZwlgZ5ElyxLAVhTXx/S/QwUY\nAEnffYS2eQu5cYp+lmQAVKcux9LP9mKUvk2/3IF8WY/h+hz96AjlBT6z1smfpAA8HwOwjDo6SP85\nHMSP9Ew6aTTGCHiE+vCR+mswLOPif8xr1qXIErvdmrpsk3KEeFj6I/MbSwPKAKhHx3kAgXUQQfiT\nU5SbnXVs+/dHYHGOZ8bcNUOkdAuE8yiEzTTuOwthbDOfLQzOT1hfv4BwW+qUXcUEYbISxRhXQgMg\n6XOJwtAJ624uyn0WQmga72b70qvEKIj+Tsi/hCL7O8L0IG0wGUXSmrp9EGF6mnXP73Df70LxjUL4\nVU1oX9uOZ/vwF6OMdzDLehnB/RWK8Dz1s433GhjMJsP1zCMYaVd4vrfdso6t2y+N2X7YMEWR9uPz\nFl2+zwWXHXZrwue4v7Wb975Ujrm2zZamIKz3ouw/x6h6lvuZF+wiyuZR3ndgnLeFa7d0keYrMJxf\ndUsJ8+kzd2TYBmjLJ4WUtCDAMEjxMK70S9StraF3izF6s3z3IRcT8wn1tw0j+e5wZs7EoyvyY5Xb\nHWJlMwbdVN5nRbA0soY+NR3DP1X+uLaZjBGwHjmzwe00Mg9mpTzyshNepsmMD79Xf4ZbLqqWEEhc\nvciSFo9TJeUI8bA0Lib5mfhjGgCNnHtsE4L/huD7OVBKFtRWDyHakZlMtyyJgJjVtUMBjkFpLmNQ\nb0FwPY0QeQ4Xd7EGwPMohrC8jlfhT8wi4z5zJJ8B4IRie2d1D0Qp3omhE6eM/dr2Vmfk/A335n4E\n20Tq9nYE+Xzq5xQu0h9RTHvyrXmTjKc59WP5F2Yi9DZR57Ze/Q1ropeZ+WY1AF5C6V93xonfyrmC\n64xFyHbl3ZLW05u6etpEH/Tr/C+4oLq9eItOOU/VqLj6YAbWhZn8Yur0BAbhZa6/ya3hv0772IzU\n3LvdYtyw1fEMjeZzTzKWTmJUPEy79o7boZBgAFwpsKQZALVdPMxq6vBt3vE5Z0jG1VuW7y7EQ3Ma\nI/IIynVawtY8G7Oj8WI9EpQVKNi+zLjH8P+plEm040DqvWEGT2c7+tVorjGT5xuLkZIp6RPxHncw\n9sOsfgOQAQ2lXcTvJQCwP4Nhi3PvJSmlWk6x1EKxV85zjypY1ncziJciaJ9xM9CTCPkLCJZ3CAIs\n1gC4hCDy5UOu+QMz7/djSlYDoD7P0dMZAH14jmYJ+/+T6vrveCYOYBCZC9EyfC1wHoAvCBh8kzXm\n5UkGAOuOrV32tOnU4Qbq/hBrtRfdTowz/N5m7rN4v9AA6IPwXOe2dJ6i3T5xWzmP0nabUM4zed4B\nCOTbEgRsN4T+UhTLLhRjuA1wLX+3WfoMjIxWKbPA6Xz2Bd79c977WerTlgZeZs35bYyQjdTHPeFM\nMZjRPoIBcZLnXst730tsQpUMBsDBIkuSAVCNPjKKdrBdD7ZdbyHeibZhHo+M352DUfsi4/j5YDts\nnYQYlX5cd1xQxrrcH20YV3dhQPXmmp0KOd+CNmpJO/VhLPalr7Uq5JwMxlaDmHz9TTW7Fr9HD0Cc\nW/pdhIpXSnVQAO3c2lTbtGhS7tELYbDcrcGdQbheQemfQaicQIh8XoIBcDimvOzWp19J+MzhDEsA\nDREitt99JjPcqSjaPgiaKgmu1Gko1yM8zy/BrGkqn7uDterFzG7P4qb/Gm/Fs9TJCLwRlWI8Dn1c\nYJm5/Q8iwC9Tx1eo7yNc0yvrUeGMF6OvC8/mjYqnMR7Ca5/l90+75YDJGAEtEvrM7fx9qos1mZuQ\nCMjuvyhlG5Y3KpZRDyfdVjCb/c9ywYG78Yx85gyEFSj5nt7r5eJQhrH+v4HPr0U5DqXO6ia8b0Pn\nZl/F94otsxN2GrRyeQ8epT1sHX0a9Z0U5JjvuxOpmycwHrcmBcMGhkULd85IWNrgfahA7EZdDO/6\nyKFqRcq8mtR3Y2RTLZ2WKf6nGgANsKjD9T2vlDYi6PshCHqg/Cw6dTAKsWHCmpftMpiPW/koM8TP\nUPxHELY7WH/dVmAMQLXA/fpoQokLAoz73CNuHb5ujPDojECfzWctUY0FuY2jTpukuFJXuaCp73nX\n47z/fN5zCJ99BHf/G7jYr2MoPeHSg7YO7lXRbVlcyIx2P0rvbbfV7ZybpW/GQJsVuOubJhh14bLC\nMur0GfrRWbe17rILCHyCthzJLK5awmytI3UwGaXsd3MccAaAuXTHMaOLi+JuzazYkv4cwovyZjD7\nH8s957kZrX3OosXn8Zl23vuFQunhEl5ZYOIw6rFRyji04ETLpTCphDIcY6dejBHUlb/Pwihc5Nat\nOyfl2Mjw3UEsEz7I3+a5cdA0jwyqzvuHpaIktBDlawCYUpoQKKUf3P5li4Ie7dbj5rnDJeY4AVI3\nYa1vTLDL4CsMjSMu4nwR1y0oCNC5dwcwO3sgpqRtAww/OwnXe/tQOeHmG4BBtNZte7M8CWnbAKu6\nvflLMHhOMQv92kWLP+p2IyzHKLBI9R9wsx9kljk9YVtZmAhoFwbENdza54MtdCvc2Qv30CdapeXV\nZ+Z0O7O1u11sx3Jm0ztdgOB7bktg3lTAbpmlA4ZYT5cwZo0rs9yhM93pB1Xz1MWzGJxWdrnljnvc\ndryH3dkM/rMrU5IYWcrr+7nfvfT/RhnGogVs9iixdErJldEYRT6IMXt/lDslMt86etp372CCMMQd\nkHNXnCdMCPHbMQCSlNJ1lK9FQW/i7wvcGv5ut8Y5w52sVz2YMXdDoK52e4X/6rLCrcLlPoNZ5LYi\nDIDbmOV1R/D4kiURkP98TwRx3RhvRpgI6FUU6sd4M8JEQKErugVCcwYel/3MLr9k6eU0dfI01zcl\n+iZG01XuGe45rpVH6VkmQNvzvxvDayWu9fEYPXb6Yt0C+lBtBL0d1zsW74jPDfAi3oa3sxoAzoCs\nxzMN5DsTXbHZtbmFK8ZcoxJ9ZqibmfvyEHUwMsodEX2PO7Mi/PyDjJck70Uj+knHIuqyKvVZSqme\n5x516IeW+Kp5lP3Ew9jvRrkjn9vwezsqvJKkrBC/bSPAK6UNKMqLzEqvI7j3o3SexMVrkdmv8v+V\nzJ77BnvGw+CofcwC/+I8AI+hDO00vMPMVr/MagA4QV8bd6WVzKmA3XfqJKxZlkUq4NoovVEYEdud\ngr/uUvWexTVtCVC+xANwGuW9ltn/3QlJgOIMgGMu8ZIl+5mIV6cnwrt+sa5X6q4VdW5HHNsRpVsx\nFl8qxAAI+lFr+lJ3VzpmnF03codRjYopg/l7U9q/I3U7Iuazw4gPaZZyv0qa+Qohfi/LAF3dlpwn\nUJCXiDr/lJ/PooBecwedvIHS83t+mwUzGosgXob79Szr/7Yd7xhK0LZNnXWHZWQ2ABJc1GV5FkAF\nl3ZzofMAvM/s/fV8hwG5ZYS+fGYZRoDlt7+ER+ET6vcjFyR5jNn0o8xYh7HsUiujAbDdJV6yY5wt\n73+ZzNaoo3oYE5YmeALGxkr6yZ5CDQCuXRGPUi1XqhXwbI3oOx1jSlvvAnfLGx1iPtueAEvNboUQ\nfxgvQD8CrlYw07dEK++iiOxUuveZpZ5EcT2GcraT2MI9v62YEc5mln+Ame177jCgD4g9OOECAk/x\nmbI0AE5SCjYAnPIe4HK2P0dwmB3gsxUXcdpxwFVRkAN4tsUuin4f1ztGUOBLBKx5BT6beuieNPt1\nqVaHu6yNduCPnfx3R74Df0roT3ZQUFt3QuBEgvZW0ZajMWCq38J+XgnjKCwVUuox/GxlSQwhxB/J\nAKjOTNCieZe59duDLt/9y8zWnw/Su04gGC0uA149lwZ4EdfdjYFhiu5FlN+TKOuNKNRDlFINgNUk\njvFlQxEGgKWptV0AKzFqtrjjdWN3AQTXuQ0joC+z9Jm8n52HYDsLNrM88jAz98lu10XjDMZKHxSt\nrZf3wTBonHa8bRn2q8ruqOBeBI5NIE6gf3iwiRBCiH+NEVAT5WrBVnPxBjzqFJKlz1zFzHWG2/ve\nOmk2h4ehD9edj+Lc4E6o2oTiX8yWroX8f50rC1G87bLs22V7YAe+Mws3tC9zUL5dC0wCYnkABqPM\nZqDAH2DN2PIA5EuQVJUgqjvdevNEjBI7uGMmAZLjUJ6mwOtneM4q1HsXDKEOuK6r/Qv6VhXngu/O\nO7e8lbN/IYQQ6YK6Bi77nqzf2uE/M51CssQfwzEW7mS2WTWPAmjp3MHjA0U3g3XpEcwMR/D/ya6M\nzjezTlHWdxPZ7csg1qmbFVFP9TFEerB00p8ZbqekTIAp16rNenNHrtc3OLijN+/Qjpl7tSLatNa/\nQvEn9INaOoVMCCF+m0ZARdy2bVA8vVFEppD6uBllIVuIKrotUt0DRdcP46Aj1+yEMuzpiuXZr1zg\n+9Thmi1iSv0S6qkyke+NUMwNsga0pXgsLNOiP7ijAd4ZBZ0JIYS4JYZABRRPAxSRKaSGzFqrFHld\n264XKrp6NktFGdZGIVqpqVYRQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE\nEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC\nCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQggh\nhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQ\nQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEII\nIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE\nEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC\nCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQggh\nhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQ\nQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEII\nIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE\nEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC\nCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQggh\nhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQ\nQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEII\nIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE\nEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC\nCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQggh\nhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQ\nQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEII\nIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE\nEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC\nCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQggh\nhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQ\nQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEII\nIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE\nEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC\nCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQggh\nhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQ\nQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEII\nIYQQQgghhBBCCCGEEKJM+X8Bl4tInGh6U68AAAAASUVORK5CYII=\n");
NGL.Resources["img/radial.png"]=NGL.dataURItoImage("data:image/png;base64,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\n");
