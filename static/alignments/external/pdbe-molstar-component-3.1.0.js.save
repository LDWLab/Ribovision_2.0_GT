/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./lib/alphafold-transparency.js":
/*!***************************************!*\
  !*** ./lib/alphafold-transparency.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.clearStructureTransparency = exports.setStructureTransparency = exports.applyAFTransparency = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar transforms_1 = __webpack_require__(/*! Molstar/mol-plugin-state/transforms */ \"./node_modules/molstar/lib/mol-plugin-state/transforms.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar loci_1 = __webpack_require__(/*! Molstar/mol-model/loci */ \"./node_modules/molstar/lib/mol-model/loci.js\");\nvar transparency_1 = __webpack_require__(/*! Molstar/mol-theme/transparency */ \"./node_modules/molstar/lib/mol-theme/transparency.js\");\nvar builder_1 = __webpack_require__(/*! Molstar/mol-script/language/builder */ \"./node_modules/molstar/lib/mol-script/language/builder.js\");\nvar prop_1 = __webpack_require__(/*! Molstar/extensions/model-archive/quality-assessment/prop */ \"./node_modules/molstar/lib/extensions/model-archive/quality-assessment/prop.js\");\nvar compiler_1 = __webpack_require__(/*! Molstar/mol-script/runtime/query/compiler */ \"./node_modules/molstar/lib/mol-script/runtime/query/compiler.js\");\nvar structure_2 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar TransparencyManagerTag = 'transparency-controls';\nfunction getLociByPLDDT(score, contextData) {\n    var queryExp = builder_1.MolScriptBuilder.struct.modifier.union([\n        builder_1.MolScriptBuilder.struct.modifier.wholeResidues([\n            builder_1.MolScriptBuilder.struct.modifier.union([\n                builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                    'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.ammp('objectPrimitive'), 'atomistic']),\n                    'residue-test': builder_1.MolScriptBuilder.core.rel.lte([prop_1.QualityAssessment.symbols.pLDDT.symbol(), score]),\n                })\n            ])\n        ])\n    ]);\n    var query = (0, compiler_1.compile)(queryExp);\n    var sel = query(new structure_2.QueryContext(contextData));\n    return structure_2.StructureSelection.toLociWithSourceUnits(sel);\n}\nfunction applyAFTransparency(plugin, structure, transparency, pLDDT) {\n    if (pLDDT === void 0) { pLDDT = 70; }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return tslib_1.__generator(this, function (_a) {\n            return [2 /*return*/, plugin.dataTransaction(function (ctx) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                    var loci;\n                    var _a;\n                    return tslib_1.__generator(this, function (_b) {\n                        switch (_b.label) {\n                            case 0:\n                                loci = getLociByPLDDT(pLDDT, (_a = structure.cell.obj) === null || _a === void 0 ? void 0 : _a.data);\n                                return [4 /*yield*/, setStructureTransparency(plugin, structure.components, transparency, loci)];\n                            case 1:\n                                _b.sent();\n                                return [2 /*return*/];\n                        }\n                    });\n                }); }, { canUndo: 'Apply Transparency' })];\n        });\n    });\n}\nexports.applyAFTransparency = applyAFTransparency;\nfunction setStructureTransparency(plugin, components, value, loci, types) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, eachRepr(plugin, components, function (update, repr, transparencyCell) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                        var structure, layer, bundleLayers, filtered, filtered;\n                        return tslib_1.__generator(this, function (_a) {\n                            if (types && types.length > 0 && !types.includes(repr.params.values.type.name))\n                                return [2 /*return*/];\n                            structure = repr.obj.data.sourceData;\n                            if (loci_1.Loci.isEmpty(loci) || (0, loci_1.isEmptyLoci)(loci))\n                                return [2 /*return*/];\n                            layer = {\n                                bundle: structure_1.StructureElement.Bundle.fromLoci(loci),\n                                value: value,\n                            };\n                            if (transparencyCell) {\n                                bundleLayers = tslib_1.__spreadArray(tslib_1.__spreadArray([], transparencyCell.params.values.layers, true), [layer], false);\n                                filtered = getFilteredBundle(bundleLayers, structure);\n                                update.to(transparencyCell).update(transparency_1.Transparency.toBundle(filtered));\n                            }\n                            else {\n                                filtered = getFilteredBundle([layer], structure);\n                                update.to(repr.transform.ref)\n                                    .apply(transforms_1.StateTransforms.Representation.TransparencyStructureRepresentation3DFromBundle, transparency_1.Transparency.toBundle(filtered), { tags: TransparencyManagerTag });\n                            }\n                            return [2 /*return*/];\n                        });\n                    }); })];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.setStructureTransparency = setStructureTransparency;\nfunction clearStructureTransparency(plugin, components, types) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var _this = this;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, eachRepr(plugin, components, function (update, repr, transparencyCell) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                        return tslib_1.__generator(this, function (_a) {\n                            if (types && types.length > 0 && !types.includes(repr.params.values.type.name))\n                                return [2 /*return*/];\n                            if (transparencyCell) {\n                                update.delete(transparencyCell.transform.ref);\n                            }\n                            return [2 /*return*/];\n                        });\n                    }); })];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.clearStructureTransparency = clearStructureTransparency;\nfunction eachRepr(plugin, components, callback) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var state, update, _i, components_1, c, _a, _b, r, transparency;\n        return tslib_1.__generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    state = plugin.state.data;\n                    update = state.build();\n                    _i = 0, components_1 = components;\n                    _c.label = 1;\n                case 1:\n                    if (!(_i < components_1.length)) return [3 /*break*/, 6];\n                    c = components_1[_i];\n                    _a = 0, _b = c.representations;\n                    _c.label = 2;\n                case 2:\n                    if (!(_a < _b.length)) return [3 /*break*/, 5];\n                    r = _b[_a];\n                    transparency = state.select(mol_state_1.StateSelection.Generators.ofTransformer(transforms_1.StateTransforms.Representation.TransparencyStructureRepresentation3DFromBundle, r.cell.transform.ref).withTag(TransparencyManagerTag));\n                    return [4 /*yield*/, callback(update, r.cell, transparency[0])];\n                case 3:\n                    _c.sent();\n                    _c.label = 4;\n                case 4:\n                    _a++;\n                    return [3 /*break*/, 2];\n                case 5:\n                    _i++;\n                    return [3 /*break*/, 1];\n                case 6: return [2 /*return*/, update.commit({ doNotUpdateCurrent: true })];\n            }\n        });\n    });\n}\n/** filter transparency layers for given structure */\nfunction getFilteredBundle(layers, structure) {\n    var transparency = transparency_1.Transparency.ofBundle(layers, structure.root);\n    var merged = transparency_1.Transparency.merge(transparency);\n    return transparency_1.Transparency.filter(merged, structure);\n}\n//# sourceMappingURL=alphafold-transparency.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvYWxwaGFmb2xkLXRyYW5zcGFyZW5jeS5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxrQ0FBa0MsR0FBRyxnQ0FBZ0MsR0FBRywyQkFBMkI7QUFDbkcsY0FBYyxtQkFBTyxDQUFDLGdEQUFPO0FBQzdCLGtCQUFrQixtQkFBTyxDQUFDLHNGQUE2QjtBQUN2RCxtQkFBbUIsbUJBQU8sQ0FBQyxzR0FBcUM7QUFDaEUsa0JBQWtCLG1CQUFPLENBQUMsd0VBQW1CO0FBQzdDLGFBQWEsbUJBQU8sQ0FBQyw0RUFBd0I7QUFDN0MscUJBQXFCLG1CQUFPLENBQUMsNEZBQWdDO0FBQzdELGdCQUFnQixtQkFBTyxDQUFDLHNHQUFxQztBQUM3RCxhQUFhLG1CQUFPLENBQUMsZ0pBQTBEO0FBQy9FLGlCQUFpQixtQkFBTyxDQUFDLGtIQUEyQztBQUNwRSxrQkFBa0IsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGlCQUFpQixJQUFJLElBQUksK0JBQStCO0FBQ3hELFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNIQUFzSDtBQUN0SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBMQUEwTCw4QkFBOEI7QUFDeE47QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixxQkFBcUIsSUFBSTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNIQUFzSDtBQUN0SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixxQkFBcUIsSUFBSTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCwwQkFBMEI7QUFDeEY7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvYWxwaGFmb2xkLXRyYW5zcGFyZW5jeS5qcz81NjhmIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jbGVhclN0cnVjdHVyZVRyYW5zcGFyZW5jeSA9IGV4cG9ydHMuc2V0U3RydWN0dXJlVHJhbnNwYXJlbmN5ID0gZXhwb3J0cy5hcHBseUFGVHJhbnNwYXJlbmN5ID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIgc3RydWN0dXJlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlXCIpO1xudmFyIHRyYW5zZm9ybXNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tc3RhdGUvdHJhbnNmb3Jtc1wiKTtcbnZhciBtb2xfc3RhdGVfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1zdGF0ZVwiKTtcbnZhciBsb2NpXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvbG9jaVwiKTtcbnZhciB0cmFuc3BhcmVuY3lfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC10aGVtZS90cmFuc3BhcmVuY3lcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXNjcmlwdC9sYW5ndWFnZS9idWlsZGVyXCIpO1xudmFyIHByb3BfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL2V4dGVuc2lvbnMvbW9kZWwtYXJjaGl2ZS9xdWFsaXR5LWFzc2Vzc21lbnQvcHJvcFwiKTtcbnZhciBjb21waWxlcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXNjcmlwdC9ydW50aW1lL3F1ZXJ5L2NvbXBpbGVyXCIpO1xudmFyIHN0cnVjdHVyZV8yID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1vZGVsL3N0cnVjdHVyZVwiKTtcbnZhciBUcmFuc3BhcmVuY3lNYW5hZ2VyVGFnID0gJ3RyYW5zcGFyZW5jeS1jb250cm9scyc7XG5mdW5jdGlvbiBnZXRMb2NpQnlQTEREVChzY29yZSwgY29udGV4dERhdGEpIHtcbiAgICB2YXIgcXVlcnlFeHAgPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QubW9kaWZpZXIudW5pb24oW1xuICAgICAgICBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QubW9kaWZpZXIud2hvbGVSZXNpZHVlcyhbXG4gICAgICAgICAgICBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QubW9kaWZpZXIudW5pb24oW1xuICAgICAgICAgICAgICAgIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5nZW5lcmF0b3IuYXRvbUdyb3Vwcyh7XG4gICAgICAgICAgICAgICAgICAgICdjaGFpbi10ZXN0JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmFtbXAoJ29iamVjdFByaW1pdGl2ZScpLCAnYXRvbWlzdGljJ10pLFxuICAgICAgICAgICAgICAgICAgICAncmVzaWR1ZS10ZXN0JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwubHRlKFtwcm9wXzEuUXVhbGl0eUFzc2Vzc21lbnQuc3ltYm9scy5wTEREVC5zeW1ib2woKSwgc2NvcmVdKSxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgXSlcbiAgICAgICAgXSlcbiAgICBdKTtcbiAgICB2YXIgcXVlcnkgPSAoMCwgY29tcGlsZXJfMS5jb21waWxlKShxdWVyeUV4cCk7XG4gICAgdmFyIHNlbCA9IHF1ZXJ5KG5ldyBzdHJ1Y3R1cmVfMi5RdWVyeUNvbnRleHQoY29udGV4dERhdGEpKTtcbiAgICByZXR1cm4gc3RydWN0dXJlXzIuU3RydWN0dXJlU2VsZWN0aW9uLnRvTG9jaVdpdGhTb3VyY2VVbml0cyhzZWwpO1xufVxuZnVuY3Rpb24gYXBwbHlBRlRyYW5zcGFyZW5jeShwbHVnaW4sIHN0cnVjdHVyZSwgdHJhbnNwYXJlbmN5LCBwTEREVCkge1xuICAgIGlmIChwTEREVCA9PT0gdm9pZCAwKSB7IHBMRERUID0gNzA7IH1cbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcGx1Z2luLmRhdGFUcmFuc2FjdGlvbihmdW5jdGlvbiAoY3R4KSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2k7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NpID0gZ2V0TG9jaUJ5UExERFQocExERFQsIChfYSA9IHN0cnVjdHVyZS5jZWxsLm9iaikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBzZXRTdHJ1Y3R1cmVUcmFuc3BhcmVuY3kocGx1Z2luLCBzdHJ1Y3R1cmUuY29tcG9uZW50cywgdHJhbnNwYXJlbmN5LCBsb2NpKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7IH0sIHsgY2FuVW5kbzogJ0FwcGx5IFRyYW5zcGFyZW5jeScgfSldO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuYXBwbHlBRlRyYW5zcGFyZW5jeSA9IGFwcGx5QUZUcmFuc3BhcmVuY3k7XG5mdW5jdGlvbiBzZXRTdHJ1Y3R1cmVUcmFuc3BhcmVuY3kocGx1Z2luLCBjb21wb25lbnRzLCB2YWx1ZSwgbG9jaSwgdHlwZXMpIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBlYWNoUmVwcihwbHVnaW4sIGNvbXBvbmVudHMsIGZ1bmN0aW9uICh1cGRhdGUsIHJlcHIsIHRyYW5zcGFyZW5jeUNlbGwpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cnVjdHVyZSwgbGF5ZXIsIGJ1bmRsZUxheWVycywgZmlsdGVyZWQsIGZpbHRlcmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVzICYmIHR5cGVzLmxlbmd0aCA+IDAgJiYgIXR5cGVzLmluY2x1ZGVzKHJlcHIucGFyYW1zLnZhbHVlcy50eXBlLm5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0dXJlID0gcmVwci5vYmouZGF0YS5zb3VyY2VEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NpXzEuTG9jaS5pc0VtcHR5KGxvY2kpIHx8ICgwLCBsb2NpXzEuaXNFbXB0eUxvY2kpKGxvY2kpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXIgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZTogc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5CdW5kbGUuZnJvbUxvY2kobG9jaSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmFuc3BhcmVuY3lDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bmRsZUxheWVycyA9IHRzbGliXzEuX19zcHJlYWRBcnJheSh0c2xpYl8xLl9fc3ByZWFkQXJyYXkoW10sIHRyYW5zcGFyZW5jeUNlbGwucGFyYW1zLnZhbHVlcy5sYXllcnMsIHRydWUpLCBbbGF5ZXJdLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkID0gZ2V0RmlsdGVyZWRCdW5kbGUoYnVuZGxlTGF5ZXJzLCBzdHJ1Y3R1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUudG8odHJhbnNwYXJlbmN5Q2VsbCkudXBkYXRlKHRyYW5zcGFyZW5jeV8xLlRyYW5zcGFyZW5jeS50b0J1bmRsZShmaWx0ZXJlZCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWQgPSBnZXRGaWx0ZXJlZEJ1bmRsZShbbGF5ZXJdLCBzdHJ1Y3R1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUudG8ocmVwci50cmFuc2Zvcm0ucmVmKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGx5KHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuUmVwcmVzZW50YXRpb24uVHJhbnNwYXJlbmN5U3RydWN0dXJlUmVwcmVzZW50YXRpb24zREZyb21CdW5kbGUsIHRyYW5zcGFyZW5jeV8xLlRyYW5zcGFyZW5jeS50b0J1bmRsZShmaWx0ZXJlZCksIHsgdGFnczogVHJhbnNwYXJlbmN5TWFuYWdlclRhZyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pOyB9KV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLnNldFN0cnVjdHVyZVRyYW5zcGFyZW5jeSA9IHNldFN0cnVjdHVyZVRyYW5zcGFyZW5jeTtcbmZ1bmN0aW9uIGNsZWFyU3RydWN0dXJlVHJhbnNwYXJlbmN5KHBsdWdpbiwgY29tcG9uZW50cywgdHlwZXMpIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBlYWNoUmVwcihwbHVnaW4sIGNvbXBvbmVudHMsIGZ1bmN0aW9uICh1cGRhdGUsIHJlcHIsIHRyYW5zcGFyZW5jeUNlbGwpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVzICYmIHR5cGVzLmxlbmd0aCA+IDAgJiYgIXR5cGVzLmluY2x1ZGVzKHJlcHIucGFyYW1zLnZhbHVlcy50eXBlLm5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW5jeUNlbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlLmRlbGV0ZSh0cmFuc3BhcmVuY3lDZWxsLnRyYW5zZm9ybS5yZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7IH0pXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuY2xlYXJTdHJ1Y3R1cmVUcmFuc3BhcmVuY3kgPSBjbGVhclN0cnVjdHVyZVRyYW5zcGFyZW5jeTtcbmZ1bmN0aW9uIGVhY2hSZXByKHBsdWdpbiwgY29tcG9uZW50cywgY2FsbGJhY2spIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXRlLCB1cGRhdGUsIF9pLCBjb21wb25lbnRzXzEsIGMsIF9hLCBfYiwgciwgdHJhbnNwYXJlbmN5O1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gcGx1Z2luLnN0YXRlLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZSA9IHN0YXRlLmJ1aWxkKCk7XG4gICAgICAgICAgICAgICAgICAgIF9pID0gMCwgY29tcG9uZW50c18xID0gY29tcG9uZW50cztcbiAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBjb21wb25lbnRzXzEubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGMgPSBjb21wb25lbnRzXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICBfYSA9IDAsIF9iID0gYy5yZXByZXNlbnRhdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKF9hIDwgX2IubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIHIgPSBfYltfYV07XG4gICAgICAgICAgICAgICAgICAgIHRyYW5zcGFyZW5jeSA9IHN0YXRlLnNlbGVjdChtb2xfc3RhdGVfMS5TdGF0ZVNlbGVjdGlvbi5HZW5lcmF0b3JzLm9mVHJhbnNmb3JtZXIodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5SZXByZXNlbnRhdGlvbi5UcmFuc3BhcmVuY3lTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbjNERnJvbUJ1bmRsZSwgci5jZWxsLnRyYW5zZm9ybS5yZWYpLndpdGhUYWcoVHJhbnNwYXJlbmN5TWFuYWdlclRhZykpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjYWxsYmFjayh1cGRhdGUsIHIuY2VsbCwgdHJhbnNwYXJlbmN5WzBdKV07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIF9hKys7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgX2krKztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qLywgdXBkYXRlLmNvbW1pdCh7IGRvTm90VXBkYXRlQ3VycmVudDogdHJ1ZSB9KV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLyoqIGZpbHRlciB0cmFuc3BhcmVuY3kgbGF5ZXJzIGZvciBnaXZlbiBzdHJ1Y3R1cmUgKi9cbmZ1bmN0aW9uIGdldEZpbHRlcmVkQnVuZGxlKGxheWVycywgc3RydWN0dXJlKSB7XG4gICAgdmFyIHRyYW5zcGFyZW5jeSA9IHRyYW5zcGFyZW5jeV8xLlRyYW5zcGFyZW5jeS5vZkJ1bmRsZShsYXllcnMsIHN0cnVjdHVyZS5yb290KTtcbiAgICB2YXIgbWVyZ2VkID0gdHJhbnNwYXJlbmN5XzEuVHJhbnNwYXJlbmN5Lm1lcmdlKHRyYW5zcGFyZW5jeSk7XG4gICAgcmV0dXJuIHRyYW5zcGFyZW5jeV8xLlRyYW5zcGFyZW5jeS5maWx0ZXIobWVyZ2VkLCBzdHJ1Y3R1cmUpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWxwaGFmb2xkLXRyYW5zcGFyZW5jeS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/alphafold-transparency.js\n");
  
  /***/ }),
  
  /***/ "./lib/annotation.js":
  /*!***************************!*\
    !*** ./lib/annotation.js ***!
    \***************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\n/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.TwinConsData = exports.ShannonEntropy = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar custom_element_property_1 = __webpack_require__(/*! Molstar/mol-model-props/common/custom-element-property */ \"./node_modules/molstar/lib/mol-model-props/common/custom-element-property.js\");\nvar color_1 = __webpack_require__(/*! Molstar/mol-util/color */ \"./node_modules/molstar/lib/mol-util/color/index.js\");\n/*const ShannonEntropyPalette: Color[] = [\n    [255, 255, 129], // insufficient\n    [160, 37, 96], // 9\n    [240, 125, 171],\n    [250, 201, 222],\n    [252, 237, 244],\n    [255, 255, 255],\n    [234, 255, 255],\n    [215, 255, 255],\n    [140, 255, 255],\n    [16, 200, 209] // 1\n].reverse().map(([r, g, b]) => Color.fromRgb(r, g, b));*/\nvar ShannonEntropyPalette = [[13, 8, 135], [19, 7, 137], [27, 6, 141], [33, 6, 143], [38, 5, 146], [43, 5, 148], [47, 5, 150], [53, 4, 152], [56, 4, 154], [61, 4, 156], [65, 4, 157], [70, 3, 159], [74, 3, 160], [78, 2, 162], [82, 2, 163], [86, 2, 164], [91, 1, 165], [94, 1, 166], [99, 0, 167], [102, 0, 167], [107, 0, 168], [110, 0, 168], [114, 1, 168], [118, 1, 168], [122, 2, 168], [126, 3, 168], [129, 4, 167], [134, 6, 167], [136, 8, 166], [141, 11, 164], [144, 14, 163], [148, 16, 162], [151, 19, 160], [154, 22, 159], [158, 25, 157], [161, 28, 155], [165, 31, 153], [167, 33, 151], [171, 36, 148], [174, 39, 146], [177, 42, 144], [180, 45, 142], [182, 48, 139], [185, 51, 137], [188, 53, 135], [191, 57, 132], [193, 59, 130], [196, 62, 127], [198, 65, 125], [201, 68, 122], [203, 71, 120], [205, 74, 118], [208, 77, 116], [210, 79, 113], [212, 83, 111], [214, 85, 109], [217, 88, 106], [219, 91, 104], [221, 94, 102], [223, 97, 100], [225, 100, 98], [227, 103, 95], [228, 106, 93], [231, 110, 91], [232, 112, 89], [234, 116, 87], [236, 119, 84], [237, 122, 82], [239, 125, 80], [240, 128, 78], [242, 131, 76], [243, 135, 74], [245, 138, 71], [246, 141, 69], [247, 145, 67], [248, 148, 65], [249, 152, 62], [250, 156, 60], [251, 159, 58], [251, 163, 56], [252, 166, 54], [253, 171, 52], [253, 174, 50], [253, 178, 47], [253, 181, 46], [254, 186, 44], [253, 190, 42], [253, 194, 41], [253, 198, 39], [253, 202, 38], [252, 207, 37], [252, 210, 37], [251, 215, 36], [250, 218, 36], [248, 223, 37], [247, 227, 37], [246, 232, 38], [244, 236, 39], [243, 240, 39], [241, 245, 37]].map(function (_a) {\n    var r = _a[0], g = _a[1], b = _a[2];\n    return color_1.Color.fromRgb(r, g, b);\n});\nvar ShannonEntropyDefaultColor = (0, color_1.Color)(0x999999);\nvar TwinConsPalette = [\n    [8, 48, 107],\n    [8, 51, 112],\n    [8, 55, 118],\n    [8, 58, 122],\n    [8, 62, 127],\n    [8, 65, 133],\n    [8, 69, 138],\n    [8, 73, 143],\n    [8, 76, 148],\n    [8, 80, 154],\n    [10, 83, 158],\n    [12, 86, 160],\n    [15, 90, 163],\n    [18, 93, 165],\n    [20, 96, 168],\n    [23, 100, 171],\n    [25, 103, 174],\n    [28, 107, 176],\n    [31, 110, 179],\n    [34, 114, 181],\n    [37, 117, 183],\n    [41, 121, 185],\n    [44, 124, 187],\n    [48, 128, 189],\n    [51, 131, 190],\n    [55, 135, 192],\n    [58, 139, 194],\n    [62, 142, 196],\n    [65, 145, 198],\n    [70, 149, 199],\n    [74, 152, 201],\n    [78, 154, 203],\n    [83, 158, 205],\n    [87, 160, 206],\n    [92, 164, 208],\n    [96, 167, 210],\n    [101, 170, 211],\n    [105, 173, 213],\n    [109, 175, 214],\n    [115, 178, 216],\n    [121, 182, 217],\n    [126, 184, 218],\n    [132, 188, 219],\n    [137, 190, 220],\n    [143, 194, 222],\n    [148, 196, 223],\n    [153, 199, 224],\n    [159, 202, 225],\n    [162, 204, 227],\n    [167, 206, 228],\n    [171, 208, 230],\n    [176, 210, 231],\n    [180, 211, 233],\n    [184, 213, 234],\n    [189, 215, 236],\n    [193, 217, 237],\n    [197, 218, 239],\n    [200, 220, 240],\n    [202, 222, 241],\n    [205, 224, 241],\n    [208, 225, 242],\n    [210, 227, 243],\n    [213, 229, 244],\n    [215, 231, 245],\n    [218, 232, 246],\n    [220, 234, 247],\n    [223, 236, 247],\n    [226, 237, 248],\n    [228, 239, 249],\n    [231, 241, 250],\n    [234, 243, 251],\n    [237, 244, 252],\n    [239, 246, 252],\n    [242, 248, 253],\n    [245, 249, 254],\n    [255, 245, 240],\n    [255, 238, 231],\n    [254, 232, 221],\n    [254, 225, 211],\n    [253, 213, 196],\n    [253, 202, 181],\n    [252, 190, 165],\n    [252, 178, 150],\n    [252, 164, 135],\n    [252, 151, 119],\n    [252, 138, 106],\n    [251, 125, 93],\n    [251, 112, 80],\n    [249, 99, 69],\n    [245, 83, 59],\n    [241, 68, 50],\n    [235, 55, 42],\n    [223, 43, 37],\n    [211, 32, 32],\n    [200, 23, 28],\n    [188, 20, 26],\n    [176, 18, 23],\n    [162, 14, 21],\n    [142, 9, 18],\n    [122, 5, 16]\n].reverse().map(function (_a) {\n    var r = _a[0], g = _a[1], b = _a[2];\n    return color_1.Color.fromRgb(r, g, b);\n});\nvar TwinConsDefaultColor = (0, color_1.Color)(0x999999);\nvar data = [];\nvar check = function () {\n    setTimeout(function () {\n        if (!window.getAnnotationArray)\n            check();\n        else {\n            var getAnnotationArray = window.getAnnotationArray;\n            if (getAnnotationArray().length == 0) {\n                check();\n            }\n            else {\n                data = getAnnotationArray();\n            }\n        }\n    }, 1000);\n};\ncheck();\nexports.ShannonEntropy = custom_element_property_1.CustomElementProperty.create({\n    name: 'shannon-entropy-wrapper',\n    label: 'Shannon Entropy',\n    type: 'static',\n    getData: function (model, ctx) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var conservationMap, annotations, _i, annotations_1, e, _a, _b, r, map, residueCount, residueOffsets, chainIndex, rI, cI, key, ann, aI;\n            return tslib_1.__generator(this, function (_c) {\n                conservationMap = new Map();\n                annotations = data['SE'];\n                for (_i = 0, annotations_1 = annotations; _i < annotations_1.length; _i++) {\n                    e = annotations_1[_i];\n                    for (_a = 0, _b = e.ids; _a < _b.length; _a++) {\n                        r = _b[_a];\n                        conservationMap.set(r, e.annotation);\n                    }\n                }\n                map = new Map();\n                residueCount = model.atomicHierarchy.residues._rowCount;\n                residueOffsets = model.atomicHierarchy.residueAtomSegments.offsets;\n                chainIndex = model.atomicHierarchy.chainAtomSegments.index;\n                for (rI = 0; rI < residueCount; rI++) {\n                    cI = chainIndex[residueOffsets[rI]];\n                    key = \"\".concat(model.atomicHierarchy.chains.auth_asym_id.value(cI), \" \").concat(model.atomicHierarchy.residues.auth_seq_id.value(rI));\n                    if (!conservationMap.has(key))\n                        continue;\n                    ann = conservationMap.get(key);\n                    for (aI = residueOffsets[rI]; aI < residueOffsets[rI + 1]; aI++) {\n                        map.set(aI, ann);\n                    }\n                }\n                return [2 /*return*/, { value: map }];\n            });\n        });\n    },\n    coloring: {\n        getColor: function (e) {\n            if (e < 1 || e > 100)\n                return ShannonEntropyDefaultColor;\n            return ShannonEntropyPalette[e - 1];\n        },\n        defaultColor: ShannonEntropyDefaultColor\n    },\n    getLabel: function (e) {\n        if (e === 100)\n            return \"Evolutionary Conservation: Insufficient Data\";\n        return e ? \"Evolutionary Conservation: \".concat(e) : void 0;\n    },\n});\nexports.TwinConsData = custom_element_property_1.CustomElementProperty.create({\n    name: 'TwinCons-Data-wrapper',\n    label: 'Twin Cons',\n    type: 'static',\n    getData: function (model, ctx) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var conservationMap, annotations, _i, annotations_2, e, _a, _b, r, map, residueCount, residueOffsets, chainIndex, rI, cI, key, ann, aI;\n            return tslib_1.__generator(this, function (_c) {\n                conservationMap = new Map();\n                annotations = data['TWC'];\n                for (_i = 0, annotations_2 = annotations; _i < annotations_2.length; _i++) {\n                    e = annotations_2[_i];\n                    for (_a = 0, _b = e.ids; _a < _b.length; _a++) {\n                        r = _b[_a];\n                        conservationMap.set(r, e.annotation);\n                    }\n                }\n                map = new Map();\n                residueCount = model.atomicHierarchy.residues._rowCount;\n                residueOffsets = model.atomicHierarchy.residueAtomSegments.offsets;\n                chainIndex = model.atomicHierarchy.chainAtomSegments.index;\n                for (rI = 0; rI < residueCount; rI++) {\n                    cI = chainIndex[residueOffsets[rI]];\n                    key = \"\".concat(model.atomicHierarchy.chains.auth_asym_id.value(cI), \" \").concat(model.atomicHierarchy.residues.auth_seq_id.value(rI));\n                    if (!conservationMap.has(key))\n                        continue;\n                    ann = conservationMap.get(key);\n                    for (aI = residueOffsets[rI]; aI < residueOffsets[rI + 1]; aI++) {\n                        map.set(aI, ann);\n                    }\n                }\n                return [2 /*return*/, { value: map }];\n            });\n        });\n    },\n    coloring: {\n        getColor: function (e) {\n            if (e < 1 || e > 100)\n                return TwinConsDefaultColor;\n            return TwinConsPalette[e - 1];\n        },\n        defaultColor: TwinConsDefaultColor\n    },\n    getLabel: function (e) {\n        if (e === 100)\n            return \"Evolutionary Conservation: Insufficient Data\";\n        return e ? \"Evolutionary Conservation: \".concat(e) : void 0;\n    },\n});\n//# sourceMappingURL=annotation.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvYW5ub3RhdGlvbi5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxvQkFBb0IsR0FBRyxzQkFBc0I7QUFDN0MsY0FBYyxtQkFBTyxDQUFDLGdEQUFPO0FBQzdCLGdDQUFnQyxtQkFBTyxDQUFDLDRJQUF3RDtBQUNoRyxjQUFjLG1CQUFPLENBQUMsa0ZBQXdCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsMkJBQTJCO0FBQ3JGO0FBQ0EsNkNBQTZDLGdCQUFnQjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG1CQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELDZCQUE2QjtBQUMvRTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsWUFBWTtBQUNwRCxhQUFhO0FBQ2IsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRCxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELDJCQUEyQjtBQUNyRjtBQUNBLDZDQUE2QyxnQkFBZ0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixtQkFBbUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCw2QkFBNkI7QUFDL0U7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLFlBQVk7QUFDcEQsYUFBYTtBQUNiLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvYW5ub3RhdGlvbi5qcz9lMmQwIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTktMjAyMCBtb2wqIGNvbnRyaWJ1dG9ycywgbGljZW5zZWQgdW5kZXIgTUlULCBTZWUgTElDRU5TRSBmaWxlIGZvciBtb3JlIGluZm8uXG4gKlxuICogQGF1dGhvciBEYXZpZCBTZWhuYWwgPGRhdmlkLnNlaG5hbEBnbWFpbC5jb20+XG4gKiBAYXV0aG9yIEFsZXhhbmRlciBSb3NlIDxhbGV4YW5kZXIucm9zZUB3ZWlyZGJ5dGUuZGU+XG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuVHdpbkNvbnNEYXRhID0gZXhwb3J0cy5TaGFubm9uRW50cm9weSA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGN1c3RvbV9lbGVtZW50X3Byb3BlcnR5XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwtcHJvcHMvY29tbW9uL2N1c3RvbS1lbGVtZW50LXByb3BlcnR5XCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9jb2xvclwiKTtcbi8qY29uc3QgU2hhbm5vbkVudHJvcHlQYWxldHRlOiBDb2xvcltdID0gW1xuICAgIFsyNTUsIDI1NSwgMTI5XSwgLy8gaW5zdWZmaWNpZW50XG4gICAgWzE2MCwgMzcsIDk2XSwgLy8gOVxuICAgIFsyNDAsIDEyNSwgMTcxXSxcbiAgICBbMjUwLCAyMDEsIDIyMl0sXG4gICAgWzI1MiwgMjM3LCAyNDRdLFxuICAgIFsyNTUsIDI1NSwgMjU1XSxcbiAgICBbMjM0LCAyNTUsIDI1NV0sXG4gICAgWzIxNSwgMjU1LCAyNTVdLFxuICAgIFsxNDAsIDI1NSwgMjU1XSxcbiAgICBbMTYsIDIwMCwgMjA5XSAvLyAxXG5dLnJldmVyc2UoKS5tYXAoKFtyLCBnLCBiXSkgPT4gQ29sb3IuZnJvbVJnYihyLCBnLCBiKSk7Ki9cbnZhciBTaGFubm9uRW50cm9weVBhbGV0dGUgPSBbWzEzLCA4LCAxMzVdLCBbMTksIDcsIDEzN10sIFsyNywgNiwgMTQxXSwgWzMzLCA2LCAxNDNdLCBbMzgsIDUsIDE0Nl0sIFs0MywgNSwgMTQ4XSwgWzQ3LCA1LCAxNTBdLCBbNTMsIDQsIDE1Ml0sIFs1NiwgNCwgMTU0XSwgWzYxLCA0LCAxNTZdLCBbNjUsIDQsIDE1N10sIFs3MCwgMywgMTU5XSwgWzc0LCAzLCAxNjBdLCBbNzgsIDIsIDE2Ml0sIFs4MiwgMiwgMTYzXSwgWzg2LCAyLCAxNjRdLCBbOTEsIDEsIDE2NV0sIFs5NCwgMSwgMTY2XSwgWzk5LCAwLCAxNjddLCBbMTAyLCAwLCAxNjddLCBbMTA3LCAwLCAxNjhdLCBbMTEwLCAwLCAxNjhdLCBbMTE0LCAxLCAxNjhdLCBbMTE4LCAxLCAxNjhdLCBbMTIyLCAyLCAxNjhdLCBbMTI2LCAzLCAxNjhdLCBbMTI5LCA0LCAxNjddLCBbMTM0LCA2LCAxNjddLCBbMTM2LCA4LCAxNjZdLCBbMTQxLCAxMSwgMTY0XSwgWzE0NCwgMTQsIDE2M10sIFsxNDgsIDE2LCAxNjJdLCBbMTUxLCAxOSwgMTYwXSwgWzE1NCwgMjIsIDE1OV0sIFsxNTgsIDI1LCAxNTddLCBbMTYxLCAyOCwgMTU1XSwgWzE2NSwgMzEsIDE1M10sIFsxNjcsIDMzLCAxNTFdLCBbMTcxLCAzNiwgMTQ4XSwgWzE3NCwgMzksIDE0Nl0sIFsxNzcsIDQyLCAxNDRdLCBbMTgwLCA0NSwgMTQyXSwgWzE4MiwgNDgsIDEzOV0sIFsxODUsIDUxLCAxMzddLCBbMTg4LCA1MywgMTM1XSwgWzE5MSwgNTcsIDEzMl0sIFsxOTMsIDU5LCAxMzBdLCBbMTk2LCA2MiwgMTI3XSwgWzE5OCwgNjUsIDEyNV0sIFsyMDEsIDY4LCAxMjJdLCBbMjAzLCA3MSwgMTIwXSwgWzIwNSwgNzQsIDExOF0sIFsyMDgsIDc3LCAxMTZdLCBbMjEwLCA3OSwgMTEzXSwgWzIxMiwgODMsIDExMV0sIFsyMTQsIDg1LCAxMDldLCBbMjE3LCA4OCwgMTA2XSwgWzIxOSwgOTEsIDEwNF0sIFsyMjEsIDk0LCAxMDJdLCBbMjIzLCA5NywgMTAwXSwgWzIyNSwgMTAwLCA5OF0sIFsyMjcsIDEwMywgOTVdLCBbMjI4LCAxMDYsIDkzXSwgWzIzMSwgMTEwLCA5MV0sIFsyMzIsIDExMiwgODldLCBbMjM0LCAxMTYsIDg3XSwgWzIzNiwgMTE5LCA4NF0sIFsyMzcsIDEyMiwgODJdLCBbMjM5LCAxMjUsIDgwXSwgWzI0MCwgMTI4LCA3OF0sIFsyNDIsIDEzMSwgNzZdLCBbMjQzLCAxMzUsIDc0XSwgWzI0NSwgMTM4LCA3MV0sIFsyNDYsIDE0MSwgNjldLCBbMjQ3LCAxNDUsIDY3XSwgWzI0OCwgMTQ4LCA2NV0sIFsyNDksIDE1MiwgNjJdLCBbMjUwLCAxNTYsIDYwXSwgWzI1MSwgMTU5LCA1OF0sIFsyNTEsIDE2MywgNTZdLCBbMjUyLCAxNjYsIDU0XSwgWzI1MywgMTcxLCA1Ml0sIFsyNTMsIDE3NCwgNTBdLCBbMjUzLCAxNzgsIDQ3XSwgWzI1MywgMTgxLCA0Nl0sIFsyNTQsIDE4NiwgNDRdLCBbMjUzLCAxOTAsIDQyXSwgWzI1MywgMTk0LCA0MV0sIFsyNTMsIDE5OCwgMzldLCBbMjUzLCAyMDIsIDM4XSwgWzI1MiwgMjA3LCAzN10sIFsyNTIsIDIxMCwgMzddLCBbMjUxLCAyMTUsIDM2XSwgWzI1MCwgMjE4LCAzNl0sIFsyNDgsIDIyMywgMzddLCBbMjQ3LCAyMjcsIDM3XSwgWzI0NiwgMjMyLCAzOF0sIFsyNDQsIDIzNiwgMzldLCBbMjQzLCAyNDAsIDM5XSwgWzI0MSwgMjQ1LCAzN11dLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgciA9IF9hWzBdLCBnID0gX2FbMV0sIGIgPSBfYVsyXTtcbiAgICByZXR1cm4gY29sb3JfMS5Db2xvci5mcm9tUmdiKHIsIGcsIGIpO1xufSk7XG52YXIgU2hhbm5vbkVudHJvcHlEZWZhdWx0Q29sb3IgPSAoMCwgY29sb3JfMS5Db2xvcikoMHg5OTk5OTkpO1xudmFyIFR3aW5Db25zUGFsZXR0ZSA9IFtcbiAgICBbOCwgNDgsIDEwN10sXG4gICAgWzgsIDUxLCAxMTJdLFxuICAgIFs4LCA1NSwgMTE4XSxcbiAgICBbOCwgNTgsIDEyMl0sXG4gICAgWzgsIDYyLCAxMjddLFxuICAgIFs4LCA2NSwgMTMzXSxcbiAgICBbOCwgNjksIDEzOF0sXG4gICAgWzgsIDczLCAxNDNdLFxuICAgIFs4LCA3NiwgMTQ4XSxcbiAgICBbOCwgODAsIDE1NF0sXG4gICAgWzEwLCA4MywgMTU4XSxcbiAgICBbMTIsIDg2LCAxNjBdLFxuICAgIFsxNSwgOTAsIDE2M10sXG4gICAgWzE4LCA5MywgMTY1XSxcbiAgICBbMjAsIDk2LCAxNjhdLFxuICAgIFsyMywgMTAwLCAxNzFdLFxuICAgIFsyNSwgMTAzLCAxNzRdLFxuICAgIFsyOCwgMTA3LCAxNzZdLFxuICAgIFszMSwgMTEwLCAxNzldLFxuICAgIFszNCwgMTE0LCAxODFdLFxuICAgIFszNywgMTE3LCAxODNdLFxuICAgIFs0MSwgMTIxLCAxODVdLFxuICAgIFs0NCwgMTI0LCAxODddLFxuICAgIFs0OCwgMTI4LCAxODldLFxuICAgIFs1MSwgMTMxLCAxOTBdLFxuICAgIFs1NSwgMTM1LCAxOTJdLFxuICAgIFs1OCwgMTM5LCAxOTRdLFxuICAgIFs2MiwgMTQyLCAxOTZdLFxuICAgIFs2NSwgMTQ1LCAxOThdLFxuICAgIFs3MCwgMTQ5LCAxOTldLFxuICAgIFs3NCwgMTUyLCAyMDFdLFxuICAgIFs3OCwgMTU0LCAyMDNdLFxuICAgIFs4MywgMTU4LCAyMDVdLFxuICAgIFs4NywgMTYwLCAyMDZdLFxuICAgIFs5MiwgMTY0LCAyMDhdLFxuICAgIFs5NiwgMTY3LCAyMTBdLFxuICAgIFsxMDEsIDE3MCwgMjExXSxcbiAgICBbMTA1LCAxNzMsIDIxM10sXG4gICAgWzEwOSwgMTc1LCAyMTRdLFxuICAgIFsxMTUsIDE3OCwgMjE2XSxcbiAgICBbMTIxLCAxODIsIDIxN10sXG4gICAgWzEyNiwgMTg0LCAyMThdLFxuICAgIFsxMzIsIDE4OCwgMjE5XSxcbiAgICBbMTM3LCAxOTAsIDIyMF0sXG4gICAgWzE0MywgMTk0LCAyMjJdLFxuICAgIFsxNDgsIDE5NiwgMjIzXSxcbiAgICBbMTUzLCAxOTksIDIyNF0sXG4gICAgWzE1OSwgMjAyLCAyMjVdLFxuICAgIFsxNjIsIDIwNCwgMjI3XSxcbiAgICBbMTY3LCAyMDYsIDIyOF0sXG4gICAgWzE3MSwgMjA4LCAyMzBdLFxuICAgIFsxNzYsIDIxMCwgMjMxXSxcbiAgICBbMTgwLCAyMTEsIDIzM10sXG4gICAgWzE4NCwgMjEzLCAyMzRdLFxuICAgIFsxODksIDIxNSwgMjM2XSxcbiAgICBbMTkzLCAyMTcsIDIzN10sXG4gICAgWzE5NywgMjE4LCAyMzldLFxuICAgIFsyMDAsIDIyMCwgMjQwXSxcbiAgICBbMjAyLCAyMjIsIDI0MV0sXG4gICAgWzIwNSwgMjI0LCAyNDFdLFxuICAgIFsyMDgsIDIyNSwgMjQyXSxcbiAgICBbMjEwLCAyMjcsIDI0M10sXG4gICAgWzIxMywgMjI5LCAyNDRdLFxuICAgIFsyMTUsIDIzMSwgMjQ1XSxcbiAgICBbMjE4LCAyMzIsIDI0Nl0sXG4gICAgWzIyMCwgMjM0LCAyNDddLFxuICAgIFsyMjMsIDIzNiwgMjQ3XSxcbiAgICBbMjI2LCAyMzcsIDI0OF0sXG4gICAgWzIyOCwgMjM5LCAyNDldLFxuICAgIFsyMzEsIDI0MSwgMjUwXSxcbiAgICBbMjM0LCAyNDMsIDI1MV0sXG4gICAgWzIzNywgMjQ0LCAyNTJdLFxuICAgIFsyMzksIDI0NiwgMjUyXSxcbiAgICBbMjQyLCAyNDgsIDI1M10sXG4gICAgWzI0NSwgMjQ5LCAyNTRdLFxuICAgIFsyNTUsIDI0NSwgMjQwXSxcbiAgICBbMjU1LCAyMzgsIDIzMV0sXG4gICAgWzI1NCwgMjMyLCAyMjFdLFxuICAgIFsyNTQsIDIyNSwgMjExXSxcbiAgICBbMjUzLCAyMTMsIDE5Nl0sXG4gICAgWzI1MywgMjAyLCAxODFdLFxuICAgIFsyNTIsIDE5MCwgMTY1XSxcbiAgICBbMjUyLCAxNzgsIDE1MF0sXG4gICAgWzI1MiwgMTY0LCAxMzVdLFxuICAgIFsyNTIsIDE1MSwgMTE5XSxcbiAgICBbMjUyLCAxMzgsIDEwNl0sXG4gICAgWzI1MSwgMTI1LCA5M10sXG4gICAgWzI1MSwgMTEyLCA4MF0sXG4gICAgWzI0OSwgOTksIDY5XSxcbiAgICBbMjQ1LCA4MywgNTldLFxuICAgIFsyNDEsIDY4LCA1MF0sXG4gICAgWzIzNSwgNTUsIDQyXSxcbiAgICBbMjIzLCA0MywgMzddLFxuICAgIFsyMTEsIDMyLCAzMl0sXG4gICAgWzIwMCwgMjMsIDI4XSxcbiAgICBbMTg4LCAyMCwgMjZdLFxuICAgIFsxNzYsIDE4LCAyM10sXG4gICAgWzE2MiwgMTQsIDIxXSxcbiAgICBbMTQyLCA5LCAxOF0sXG4gICAgWzEyMiwgNSwgMTZdXG5dLnJldmVyc2UoKS5tYXAoZnVuY3Rpb24gKF9hKSB7XG4gICAgdmFyIHIgPSBfYVswXSwgZyA9IF9hWzFdLCBiID0gX2FbMl07XG4gICAgcmV0dXJuIGNvbG9yXzEuQ29sb3IuZnJvbVJnYihyLCBnLCBiKTtcbn0pO1xudmFyIFR3aW5Db25zRGVmYXVsdENvbG9yID0gKDAsIGNvbG9yXzEuQ29sb3IpKDB4OTk5OTk5KTtcbnZhciBkYXRhID0gW107XG52YXIgY2hlY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghd2luZG93LmdldEFubm90YXRpb25BcnJheSlcbiAgICAgICAgICAgIGNoZWNrKCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGdldEFubm90YXRpb25BcnJheSA9IHdpbmRvdy5nZXRBbm5vdGF0aW9uQXJyYXk7XG4gICAgICAgICAgICBpZiAoZ2V0QW5ub3RhdGlvbkFycmF5KCkubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICBjaGVjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IGdldEFubm90YXRpb25BcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgMTAwMCk7XG59O1xuY2hlY2soKTtcbmV4cG9ydHMuU2hhbm5vbkVudHJvcHkgPSBjdXN0b21fZWxlbWVudF9wcm9wZXJ0eV8xLkN1c3RvbUVsZW1lbnRQcm9wZXJ0eS5jcmVhdGUoe1xuICAgIG5hbWU6ICdzaGFubm9uLWVudHJvcHktd3JhcHBlcicsXG4gICAgbGFiZWw6ICdTaGFubm9uIEVudHJvcHknLFxuICAgIHR5cGU6ICdzdGF0aWMnLFxuICAgIGdldERhdGE6IGZ1bmN0aW9uIChtb2RlbCwgY3R4KSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNvbnNlcnZhdGlvbk1hcCwgYW5ub3RhdGlvbnMsIF9pLCBhbm5vdGF0aW9uc18xLCBlLCBfYSwgX2IsIHIsIG1hcCwgcmVzaWR1ZUNvdW50LCByZXNpZHVlT2Zmc2V0cywgY2hhaW5JbmRleCwgckksIGNJLCBrZXksIGFubiwgYUk7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBjb25zZXJ2YXRpb25NYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbnMgPSBkYXRhWydTRSddO1xuICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBhbm5vdGF0aW9uc18xID0gYW5ub3RhdGlvbnM7IF9pIDwgYW5ub3RhdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZSA9IGFubm90YXRpb25zXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKF9hID0gMCwgX2IgPSBlLmlkczsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBfYltfYV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zZXJ2YXRpb25NYXAuc2V0KHIsIGUuYW5ub3RhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWFwID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgICAgIHJlc2lkdWVDb3VudCA9IG1vZGVsLmF0b21pY0hpZXJhcmNoeS5yZXNpZHVlcy5fcm93Q291bnQ7XG4gICAgICAgICAgICAgICAgcmVzaWR1ZU9mZnNldHMgPSBtb2RlbC5hdG9taWNIaWVyYXJjaHkucmVzaWR1ZUF0b21TZWdtZW50cy5vZmZzZXRzO1xuICAgICAgICAgICAgICAgIGNoYWluSW5kZXggPSBtb2RlbC5hdG9taWNIaWVyYXJjaHkuY2hhaW5BdG9tU2VnbWVudHMuaW5kZXg7XG4gICAgICAgICAgICAgICAgZm9yIChySSA9IDA7IHJJIDwgcmVzaWR1ZUNvdW50OyBySSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNJID0gY2hhaW5JbmRleFtyZXNpZHVlT2Zmc2V0c1tySV1dO1xuICAgICAgICAgICAgICAgICAgICBrZXkgPSBcIlwiLmNvbmNhdChtb2RlbC5hdG9taWNIaWVyYXJjaHkuY2hhaW5zLmF1dGhfYXN5bV9pZC52YWx1ZShjSSksIFwiIFwiKS5jb25jYXQobW9kZWwuYXRvbWljSGllcmFyY2h5LnJlc2lkdWVzLmF1dGhfc2VxX2lkLnZhbHVlKHJJKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY29uc2VydmF0aW9uTWFwLmhhcyhrZXkpKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGFubiA9IGNvbnNlcnZhdGlvbk1hcC5nZXQoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChhSSA9IHJlc2lkdWVPZmZzZXRzW3JJXTsgYUkgPCByZXNpZHVlT2Zmc2V0c1tySSArIDFdOyBhSSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXAuc2V0KGFJLCBhbm4pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7IHZhbHVlOiBtYXAgfV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBjb2xvcmluZzoge1xuICAgICAgICBnZXRDb2xvcjogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlIDwgMSB8fCBlID4gMTAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBTaGFubm9uRW50cm9weURlZmF1bHRDb2xvcjtcbiAgICAgICAgICAgIHJldHVybiBTaGFubm9uRW50cm9weVBhbGV0dGVbZSAtIDFdO1xuICAgICAgICB9LFxuICAgICAgICBkZWZhdWx0Q29sb3I6IFNoYW5ub25FbnRyb3B5RGVmYXVsdENvbG9yXG4gICAgfSxcbiAgICBnZXRMYWJlbDogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGUgPT09IDEwMClcbiAgICAgICAgICAgIHJldHVybiBcIkV2b2x1dGlvbmFyeSBDb25zZXJ2YXRpb246IEluc3VmZmljaWVudCBEYXRhXCI7XG4gICAgICAgIHJldHVybiBlID8gXCJFdm9sdXRpb25hcnkgQ29uc2VydmF0aW9uOiBcIi5jb25jYXQoZSkgOiB2b2lkIDA7XG4gICAgfSxcbn0pO1xuZXhwb3J0cy5Ud2luQ29uc0RhdGEgPSBjdXN0b21fZWxlbWVudF9wcm9wZXJ0eV8xLkN1c3RvbUVsZW1lbnRQcm9wZXJ0eS5jcmVhdGUoe1xuICAgIG5hbWU6ICdUd2luQ29ucy1EYXRhLXdyYXBwZXInLFxuICAgIGxhYmVsOiAnVHdpbiBDb25zJyxcbiAgICB0eXBlOiAnc3RhdGljJyxcbiAgICBnZXREYXRhOiBmdW5jdGlvbiAobW9kZWwsIGN0eCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjb25zZXJ2YXRpb25NYXAsIGFubm90YXRpb25zLCBfaSwgYW5ub3RhdGlvbnNfMiwgZSwgX2EsIF9iLCByLCBtYXAsIHJlc2lkdWVDb3VudCwgcmVzaWR1ZU9mZnNldHMsIGNoYWluSW5kZXgsIHJJLCBjSSwga2V5LCBhbm4sIGFJO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgY29uc2VydmF0aW9uTWFwID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgICAgIGFubm90YXRpb25zID0gZGF0YVsnVFdDJ107XG4gICAgICAgICAgICAgICAgZm9yIChfaSA9IDAsIGFubm90YXRpb25zXzIgPSBhbm5vdGF0aW9uczsgX2kgPCBhbm5vdGF0aW9uc18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICBlID0gYW5ub3RhdGlvbnNfMltfaV07XG4gICAgICAgICAgICAgICAgICAgIGZvciAoX2EgPSAwLCBfYiA9IGUuaWRzOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgciA9IF9iW19hXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNlcnZhdGlvbk1hcC5zZXQociwgZS5hbm5vdGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICAgICAgcmVzaWR1ZUNvdW50ID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LnJlc2lkdWVzLl9yb3dDb3VudDtcbiAgICAgICAgICAgICAgICByZXNpZHVlT2Zmc2V0cyA9IG1vZGVsLmF0b21pY0hpZXJhcmNoeS5yZXNpZHVlQXRvbVNlZ21lbnRzLm9mZnNldHM7XG4gICAgICAgICAgICAgICAgY2hhaW5JbmRleCA9IG1vZGVsLmF0b21pY0hpZXJhcmNoeS5jaGFpbkF0b21TZWdtZW50cy5pbmRleDtcbiAgICAgICAgICAgICAgICBmb3IgKHJJID0gMDsgckkgPCByZXNpZHVlQ291bnQ7IHJJKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY0kgPSBjaGFpbkluZGV4W3Jlc2lkdWVPZmZzZXRzW3JJXV07XG4gICAgICAgICAgICAgICAgICAgIGtleSA9IFwiXCIuY29uY2F0KG1vZGVsLmF0b21pY0hpZXJhcmNoeS5jaGFpbnMuYXV0aF9hc3ltX2lkLnZhbHVlKGNJKSwgXCIgXCIpLmNvbmNhdChtb2RlbC5hdG9taWNIaWVyYXJjaHkucmVzaWR1ZXMuYXV0aF9zZXFfaWQudmFsdWUockkpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25zZXJ2YXRpb25NYXAuaGFzKGtleSkpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgYW5uID0gY29uc2VydmF0aW9uTWFwLmdldChrZXkpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGFJID0gcmVzaWR1ZU9mZnNldHNbckldOyBhSSA8IHJlc2lkdWVPZmZzZXRzW3JJICsgMV07IGFJKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcC5zZXQoYUksIGFubik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHsgdmFsdWU6IG1hcCB9XTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGNvbG9yaW5nOiB7XG4gICAgICAgIGdldENvbG9yOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUgPCAxIHx8IGUgPiAxMDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIFR3aW5Db25zRGVmYXVsdENvbG9yO1xuICAgICAgICAgICAgcmV0dXJuIFR3aW5Db25zUGFsZXR0ZVtlIC0gMV07XG4gICAgICAgIH0sXG4gICAgICAgIGRlZmF1bHRDb2xvcjogVHdpbkNvbnNEZWZhdWx0Q29sb3JcbiAgICB9LFxuICAgIGdldExhYmVsOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoZSA9PT0gMTAwKVxuICAgICAgICAgICAgcmV0dXJuIFwiRXZvbHV0aW9uYXJ5IENvbnNlcnZhdGlvbjogSW5zdWZmaWNpZW50IERhdGFcIjtcbiAgICAgICAgcmV0dXJuIGUgPyBcIkV2b2x1dGlvbmFyeSBDb25zZXJ2YXRpb246IFwiLmNvbmNhdChlKSA6IHZvaWQgMDtcbiAgICB9LFxufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbm5vdGF0aW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/annotation.js\n");
  
  /***/ }),
  
  /***/ "./lib/custom-events.js":
  /*!******************************!*\
    !*** ./lib/custom-events.js ***!
    \******************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.CustomEvents = void 0;\nvar loci_details_1 = __webpack_require__(/*! ./loci-details */ \"./lib/loci-details.js\");\nvar operators_1 = __webpack_require__(/*! rxjs/operators */ \"./node_modules/rxjs/dist/cjs/operators/index.js\");\nvar CustomEvents;\n(function (CustomEvents) {\n    function create(eventTypeArr) {\n        var eventObj = {};\n        for (var ei = 0, el = eventTypeArr.length; ei < el; ei++) {\n            var eventType = eventTypeArr[ei];\n            var event_1 = void 0;\n            if (typeof MouseEvent == 'function') {\n                // current standard\n                event_1 = new MouseEvent(eventType, { 'view': window, 'bubbles': true, 'cancelable': true });\n            }\n            else if (typeof document.createEvent == 'function') {\n                // older standard\n                event_1 = document.createEvent('MouseEvents');\n                event_1.initEvent(eventType, true /* bubbles */, true /* cancelable */);\n            }\n            eventObj[eventType] = event_1;\n        }\n        ;\n        return eventObj;\n    }\n    function dispatchCustomEvent(event, eventData, targetElement) {\n        if (typeof eventData !== 'undefined') {\n            eventData['residueNumber'] = eventData.seq_id;\n            event['eventData'] = eventData;\n            event.eventData.residueNumber = eventData.seq_id;\n            targetElement.dispatchEvent(event);\n        }\n    }\n    function add(plugin, targetElement) {\n        var pdbevents = create(['PDB.molstar.click', 'PDB.molstar.mouseover', 'PDB.molstar.mouseout']);\n        plugin.behaviors.interaction.click.subscribe(function (e) {\n            if (e.button === 1 && e.current && e.current.loci.kind !== 'empty-loci') {\n                var evData = (0, loci_details_1.lociDetails)(e.current.loci);\n                if (evData)\n                    dispatchCustomEvent(pdbevents['PDB.molstar.click'], evData, targetElement);\n            }\n        });\n        plugin.behaviors.interaction.hover.pipe((0, operators_1.debounceTime)(100)).subscribe(function (e) {\n            if (e.current && e.current.loci && e.current.loci.kind !== 'empty-loci') {\n                var evData = (0, loci_details_1.lociDetails)(e.current.loci);\n                if (evData)\n                    dispatchCustomEvent(pdbevents['PDB.molstar.mouseover'], evData, targetElement);\n            }\n            if (e.current && e.current.loci && e.current.loci.kind === 'empty-loci') {\n                dispatchCustomEvent(pdbevents['PDB.molstar.mouseout'], {}, targetElement);\n            }\n        });\n    }\n    CustomEvents.add = add;\n})(CustomEvents = exports.CustomEvents || (exports.CustomEvents = {}));\n//# sourceMappingURL=custom-events.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvY3VzdG9tLWV2ZW50cy5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxvQkFBb0I7QUFDcEIscUJBQXFCLG1CQUFPLENBQUMsNkNBQWdCO0FBQzdDLGtCQUFrQixtQkFBTyxDQUFDLHVFQUFnQjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxTQUFTO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELHFEQUFxRDtBQUMzRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5RUFBeUU7QUFDekU7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUMsMENBQTBDLG9CQUFvQixLQUFLO0FBQ3BFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL2N1c3RvbS1ldmVudHMuanM/YzZhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQ3VzdG9tRXZlbnRzID0gdm9pZCAwO1xudmFyIGxvY2lfZGV0YWlsc18xID0gcmVxdWlyZShcIi4vbG9jaS1kZXRhaWxzXCIpO1xudmFyIG9wZXJhdG9yc18xID0gcmVxdWlyZShcInJ4anMvb3BlcmF0b3JzXCIpO1xudmFyIEN1c3RvbUV2ZW50cztcbihmdW5jdGlvbiAoQ3VzdG9tRXZlbnRzKSB7XG4gICAgZnVuY3Rpb24gY3JlYXRlKGV2ZW50VHlwZUFycikge1xuICAgICAgICB2YXIgZXZlbnRPYmogPSB7fTtcbiAgICAgICAgZm9yICh2YXIgZWkgPSAwLCBlbCA9IGV2ZW50VHlwZUFyci5sZW5ndGg7IGVpIDwgZWw7IGVpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudFR5cGUgPSBldmVudFR5cGVBcnJbZWldO1xuICAgICAgICAgICAgdmFyIGV2ZW50XzEgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAodHlwZW9mIE1vdXNlRXZlbnQgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICBldmVudF8xID0gbmV3IE1vdXNlRXZlbnQoZXZlbnRUeXBlLCB7ICd2aWV3Jzogd2luZG93LCAnYnViYmxlcyc6IHRydWUsICdjYW5jZWxhYmxlJzogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFdmVudCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgLy8gb2xkZXIgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICBldmVudF8xID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ01vdXNlRXZlbnRzJyk7XG4gICAgICAgICAgICAgICAgZXZlbnRfMS5pbml0RXZlbnQoZXZlbnRUeXBlLCB0cnVlIC8qIGJ1YmJsZXMgKi8sIHRydWUgLyogY2FuY2VsYWJsZSAqLyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBldmVudE9ialtldmVudFR5cGVdID0gZXZlbnRfMTtcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIHJldHVybiBldmVudE9iajtcbiAgICB9XG4gICAgZnVuY3Rpb24gZGlzcGF0Y2hDdXN0b21FdmVudChldmVudCwgZXZlbnREYXRhLCB0YXJnZXRFbGVtZW50KSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnREYXRhICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgZXZlbnREYXRhWydyZXNpZHVlTnVtYmVyJ10gPSBldmVudERhdGEuc2VxX2lkO1xuICAgICAgICAgICAgZXZlbnRbJ2V2ZW50RGF0YSddID0gZXZlbnREYXRhO1xuICAgICAgICAgICAgZXZlbnQuZXZlbnREYXRhLnJlc2lkdWVOdW1iZXIgPSBldmVudERhdGEuc2VxX2lkO1xuICAgICAgICAgICAgdGFyZ2V0RWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBhZGQocGx1Z2luLCB0YXJnZXRFbGVtZW50KSB7XG4gICAgICAgIHZhciBwZGJldmVudHMgPSBjcmVhdGUoWydQREIubW9sc3Rhci5jbGljaycsICdQREIubW9sc3Rhci5tb3VzZW92ZXInLCAnUERCLm1vbHN0YXIubW91c2VvdXQnXSk7XG4gICAgICAgIHBsdWdpbi5iZWhhdmlvcnMuaW50ZXJhY3Rpb24uY2xpY2suc3Vic2NyaWJlKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoZS5idXR0b24gPT09IDEgJiYgZS5jdXJyZW50ICYmIGUuY3VycmVudC5sb2NpLmtpbmQgIT09ICdlbXB0eS1sb2NpJykge1xuICAgICAgICAgICAgICAgIHZhciBldkRhdGEgPSAoMCwgbG9jaV9kZXRhaWxzXzEubG9jaURldGFpbHMpKGUuY3VycmVudC5sb2NpKTtcbiAgICAgICAgICAgICAgICBpZiAoZXZEYXRhKVxuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaEN1c3RvbUV2ZW50KHBkYmV2ZW50c1snUERCLm1vbHN0YXIuY2xpY2snXSwgZXZEYXRhLCB0YXJnZXRFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHBsdWdpbi5iZWhhdmlvcnMuaW50ZXJhY3Rpb24uaG92ZXIucGlwZSgoMCwgb3BlcmF0b3JzXzEuZGVib3VuY2VUaW1lKSgxMDApKS5zdWJzY3JpYmUoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLmN1cnJlbnQgJiYgZS5jdXJyZW50LmxvY2kgJiYgZS5jdXJyZW50LmxvY2kua2luZCAhPT0gJ2VtcHR5LWxvY2knKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV2RGF0YSA9ICgwLCBsb2NpX2RldGFpbHNfMS5sb2NpRGV0YWlscykoZS5jdXJyZW50LmxvY2kpO1xuICAgICAgICAgICAgICAgIGlmIChldkRhdGEpXG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoQ3VzdG9tRXZlbnQocGRiZXZlbnRzWydQREIubW9sc3Rhci5tb3VzZW92ZXInXSwgZXZEYXRhLCB0YXJnZXRFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmN1cnJlbnQgJiYgZS5jdXJyZW50LmxvY2kgJiYgZS5jdXJyZW50LmxvY2kua2luZCA9PT0gJ2VtcHR5LWxvY2knKSB7XG4gICAgICAgICAgICAgICAgZGlzcGF0Y2hDdXN0b21FdmVudChwZGJldmVudHNbJ1BEQi5tb2xzdGFyLm1vdXNlb3V0J10sIHt9LCB0YXJnZXRFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIEN1c3RvbUV2ZW50cy5hZGQgPSBhZGQ7XG59KShDdXN0b21FdmVudHMgPSBleHBvcnRzLkN1c3RvbUV2ZW50cyB8fCAoZXhwb3J0cy5DdXN0b21FdmVudHMgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3VzdG9tLWV2ZW50cy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/custom-events.js\n");
  
  /***/ }),
  
  /***/ "./lib/domain-annotations/behavior.js":
  /*!********************************************!*\
    !*** ./lib/domain-annotations/behavior.js ***!
    \********************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.PDBeDomainAnnotations = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar prop_1 = __webpack_require__(/*! ./prop */ \"./lib/domain-annotations/prop.js\");\nvar color_1 = __webpack_require__(/*! ./color */ \"./lib/domain-annotations/color.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar behavior_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior */ \"./node_modules/molstar/lib/mol-plugin/behavior.js\");\nexports.PDBeDomainAnnotations = behavior_1.PluginBehavior.create({\n    name: 'pdbe-domain-annotations-prop',\n    category: 'custom-props',\n    display: {\n        name: 'Domain annotations',\n        description: 'Data for domain annotations, obtained via PDBe.'\n    },\n    ctor: /** @class */ (function (_super) {\n        tslib_1.__extends(class_1, _super);\n        function class_1() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.provider = prop_1.DomainAnnotationsProvider;\n            _this.labelDomainAnnotations = {\n                label: function (loci) { return void 0; }\n            };\n            return _this;\n        }\n        class_1.prototype.register = function () {\n            this.ctx.customModelProperties.register(this.provider, this.params.autoAttach);\n            this.ctx.managers.lociLabels.addProvider(this.labelDomainAnnotations);\n            this.ctx.representation.structure.themes.colorThemeRegistry.add(color_1.DomainAnnotationsColorThemeProvider);\n        };\n        class_1.prototype.update = function (p) {\n            var updated = this.params.autoAttach !== p.autoAttach;\n            this.params.autoAttach = p.autoAttach;\n            this.params.showTooltip = p.showTooltip;\n            this.ctx.customModelProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n            return updated;\n        };\n        class_1.prototype.unregister = function () {\n            this.ctx.customModelProperties.unregister(prop_1.DomainAnnotationsProvider.descriptor.name);\n            this.ctx.managers.lociLabels.removeProvider(this.labelDomainAnnotations);\n            this.ctx.representation.structure.themes.colorThemeRegistry.remove(color_1.DomainAnnotationsColorThemeProvider);\n        };\n        return class_1;\n    }(behavior_1.PluginBehavior.Handler)),\n    params: function () { return ({\n        autoAttach: param_definition_1.ParamDefinition.Boolean(false),\n        showTooltip: param_definition_1.ParamDefinition.Boolean(true)\n    }); }\n});\n//# sourceMappingURL=behavior.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvZG9tYWluLWFubm90YXRpb25zL2JlaGF2aW9yLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELDZCQUE2QjtBQUM3QixjQUFjLG1CQUFPLENBQUMsZ0RBQU87QUFDN0IsYUFBYSxtQkFBTyxDQUFDLGdEQUFRO0FBQzdCLGNBQWMsbUJBQU8sQ0FBQyxrREFBUztBQUMvQix5QkFBeUIsbUJBQU8sQ0FBQyxrR0FBbUM7QUFDcEUsaUJBQWlCLG1CQUFPLENBQUMsc0ZBQTZCO0FBQ3RELDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL2RvbWFpbi1hbm5vdGF0aW9ucy9iZWhhdmlvci5qcz83NjhiIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5QREJlRG9tYWluQW5ub3RhdGlvbnMgPSB2b2lkIDA7XG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoXCJ0c2xpYlwiKTtcbnZhciBwcm9wXzEgPSByZXF1aXJlKFwiLi9wcm9wXCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi9jb2xvclwiKTtcbnZhciBwYXJhbV9kZWZpbml0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9wYXJhbS1kZWZpbml0aW9uXCIpO1xudmFyIGJlaGF2aW9yXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2JlaGF2aW9yXCIpO1xuZXhwb3J0cy5QREJlRG9tYWluQW5ub3RhdGlvbnMgPSBiZWhhdmlvcl8xLlBsdWdpbkJlaGF2aW9yLmNyZWF0ZSh7XG4gICAgbmFtZTogJ3BkYmUtZG9tYWluLWFubm90YXRpb25zLXByb3AnLFxuICAgIGNhdGVnb3J5OiAnY3VzdG9tLXByb3BzJyxcbiAgICBkaXNwbGF5OiB7XG4gICAgICAgIG5hbWU6ICdEb21haW4gYW5ub3RhdGlvbnMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0RhdGEgZm9yIGRvbWFpbiBhbm5vdGF0aW9ucywgb2J0YWluZWQgdmlhIFBEQmUuJ1xuICAgIH0sXG4gICAgY3RvcjogLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICB0c2xpYl8xLl9fZXh0ZW5kcyhjbGFzc18xLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBjbGFzc18xKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5wcm92aWRlciA9IHByb3BfMS5Eb21haW5Bbm5vdGF0aW9uc1Byb3ZpZGVyO1xuICAgICAgICAgICAgX3RoaXMubGFiZWxEb21haW5Bbm5vdGF0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBsYWJlbDogZnVuY3Rpb24gKGxvY2kpIHsgcmV0dXJuIHZvaWQgMDsgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBjbGFzc18xLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuY3R4LmN1c3RvbU1vZGVsUHJvcGVydGllcy5yZWdpc3Rlcih0aGlzLnByb3ZpZGVyLCB0aGlzLnBhcmFtcy5hdXRvQXR0YWNoKTtcbiAgICAgICAgICAgIHRoaXMuY3R4Lm1hbmFnZXJzLmxvY2lMYWJlbHMuYWRkUHJvdmlkZXIodGhpcy5sYWJlbERvbWFpbkFubm90YXRpb25zKTtcbiAgICAgICAgICAgIHRoaXMuY3R4LnJlcHJlc2VudGF0aW9uLnN0cnVjdHVyZS50aGVtZXMuY29sb3JUaGVtZVJlZ2lzdHJ5LmFkZChjb2xvcl8xLkRvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZVByb3ZpZGVyKTtcbiAgICAgICAgfTtcbiAgICAgICAgY2xhc3NfMS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIHZhciB1cGRhdGVkID0gdGhpcy5wYXJhbXMuYXV0b0F0dGFjaCAhPT0gcC5hdXRvQXR0YWNoO1xuICAgICAgICAgICAgdGhpcy5wYXJhbXMuYXV0b0F0dGFjaCA9IHAuYXV0b0F0dGFjaDtcbiAgICAgICAgICAgIHRoaXMucGFyYW1zLnNob3dUb29sdGlwID0gcC5zaG93VG9vbHRpcDtcbiAgICAgICAgICAgIHRoaXMuY3R4LmN1c3RvbU1vZGVsUHJvcGVydGllcy5zZXREZWZhdWx0QXV0b0F0dGFjaCh0aGlzLnByb3ZpZGVyLmRlc2NyaXB0b3IubmFtZSwgdGhpcy5wYXJhbXMuYXV0b0F0dGFjaCk7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlZDtcbiAgICAgICAgfTtcbiAgICAgICAgY2xhc3NfMS5wcm90b3R5cGUudW5yZWdpc3RlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuY3R4LmN1c3RvbU1vZGVsUHJvcGVydGllcy51bnJlZ2lzdGVyKHByb3BfMS5Eb21haW5Bbm5vdGF0aW9uc1Byb3ZpZGVyLmRlc2NyaXB0b3IubmFtZSk7XG4gICAgICAgICAgICB0aGlzLmN0eC5tYW5hZ2Vycy5sb2NpTGFiZWxzLnJlbW92ZVByb3ZpZGVyKHRoaXMubGFiZWxEb21haW5Bbm5vdGF0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLmN0eC5yZXByZXNlbnRhdGlvbi5zdHJ1Y3R1cmUudGhlbWVzLmNvbG9yVGhlbWVSZWdpc3RyeS5yZW1vdmUoY29sb3JfMS5Eb21haW5Bbm5vdGF0aW9uc0NvbG9yVGhlbWVQcm92aWRlcik7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBjbGFzc18xO1xuICAgIH0oYmVoYXZpb3JfMS5QbHVnaW5CZWhhdmlvci5IYW5kbGVyKSksXG4gICAgcGFyYW1zOiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBhdXRvQXR0YWNoOiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLkJvb2xlYW4oZmFsc2UpLFxuICAgICAgICBzaG93VG9vbHRpcDogcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5Cb29sZWFuKHRydWUpXG4gICAgfSk7IH1cbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmVoYXZpb3IuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/domain-annotations/behavior.js\n");
  
  /***/ }),
  
  /***/ "./lib/domain-annotations/color.js":
  /*!*****************************************!*\
    !*** ./lib/domain-annotations/color.js ***!
    \*****************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.DomainAnnotationsColorThemeProvider = exports.DomainAnnotationsColorTheme = exports.DomainAnnotationsColorThemeParams = void 0;\nvar prop_1 = __webpack_require__(/*! ./prop */ \"./lib/domain-annotations/prop.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar color_1 = __webpack_require__(/*! Molstar/mol-util/color */ \"./node_modules/molstar/lib/mol-util/color/index.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar DomainColors = [\n    color_1.Color.fromRgb(170, 170, 170),\n    color_1.Color.fromRgb(255, 112, 3)\n];\nexports.DomainAnnotationsColorThemeParams = {\n    type: param_definition_1.ParamDefinition.MappedStatic('', {\n        '': param_definition_1.ParamDefinition.EmptyGroup()\n    })\n};\nfunction DomainAnnotationsColorTheme(ctx, props) {\n    var color;\n    if (ctx.structure && !ctx.structure.isEmpty && ctx.structure.models[0].customProperties.has(prop_1.DomainAnnotationsProvider.descriptor)) {\n        var getDomains_1 = prop_1.DomainAnnotations.getDomains;\n        var issue_1 = props.type.params.kind;\n        color = function (location) {\n            if (structure_1.StructureElement.Location.is(location) && getDomains_1(location).indexOf(issue_1) >= 0) {\n                return DomainColors[1];\n            }\n            return DomainColors[0];\n        };\n    }\n    else {\n        color = function () { return DomainColors[0]; };\n    }\n    return {\n        factory: DomainAnnotationsColorTheme,\n        granularity: 'group',\n        color: color,\n        props: props,\n        description: 'Highlights Sequnece and Structure Domain Annotations. Data obtained via PDBe.',\n    };\n}\nexports.DomainAnnotationsColorTheme = DomainAnnotationsColorTheme;\nexports.DomainAnnotationsColorThemeProvider = {\n    name: 'pdbe-domain-annotations',\n    label: 'Domain annotations',\n    category: \"Miscellaneous\" /* ColorTheme.Category.Misc */,\n    factory: DomainAnnotationsColorTheme,\n    getParams: function (ctx) {\n        var domainNames = prop_1.DomainAnnotations.getDomainNames(ctx.structure);\n        var domainTypes = prop_1.DomainAnnotations.getDomainTypes(ctx.structure);\n        var optionObj = {};\n        domainTypes.forEach(function (tp, index) {\n            if (domainNames[index].length > 0) {\n                optionObj[tp] = param_definition_1.ParamDefinition.Group({\n                    kind: param_definition_1.ParamDefinition.Select(domainNames[index][0], param_definition_1.ParamDefinition.arrayToOptions(domainNames[index]))\n                }, { isFlat: true });\n            }\n        });\n        if (Object.keys(optionObj).length > 0) {\n            return {\n                type: param_definition_1.ParamDefinition.MappedStatic(optionObj[0], optionObj)\n            };\n        }\n        else {\n            return {\n                type: param_definition_1.ParamDefinition.MappedStatic('', {\n                    '': param_definition_1.ParamDefinition.EmptyGroup()\n                })\n            };\n        }\n    },\n    defaultValues: param_definition_1.ParamDefinition.getDefaultValues(exports.DomainAnnotationsColorThemeParams),\n    isApplicable: function (ctx) { var _a; return prop_1.DomainAnnotations.isApplicable((_a = ctx.structure) === null || _a === void 0 ? void 0 : _a.models[0]); },\n    ensureCustomProperties: {\n        attach: function (ctx, data) {\n            return data.structure ? prop_1.DomainAnnotationsProvider.attach(ctx, data.structure.models[0], void 0, true) : Promise.resolve();\n        },\n        detach: function (data) { return data.structure && data.structure.models[0].customProperties.reference(prop_1.DomainAnnotationsProvider.descriptor, false); }\n    }\n};\n//# sourceMappingURL=color.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvZG9tYWluLWFubm90YXRpb25zL2NvbG9yLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELDJDQUEyQyxHQUFHLG1DQUFtQyxHQUFHLHlDQUF5QztBQUM3SCxhQUFhLG1CQUFPLENBQUMsZ0RBQVE7QUFDN0Isa0JBQWtCLG1CQUFPLENBQUMsc0ZBQTZCO0FBQ3ZELGNBQWMsbUJBQU8sQ0FBQyxrRkFBd0I7QUFDOUMseUJBQXlCLG1CQUFPLENBQUMsa0dBQW1DO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixJQUFJLGNBQWM7QUFDbkM7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxtQ0FBbUMsUUFBUSx1SEFBdUg7QUFDbEs7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULGtDQUFrQztBQUNsQztBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvZG9tYWluLWFubm90YXRpb25zL2NvbG9yLmpzPzU3NDEiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkRvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZVByb3ZpZGVyID0gZXhwb3J0cy5Eb21haW5Bbm5vdGF0aW9uc0NvbG9yVGhlbWUgPSBleHBvcnRzLkRvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZVBhcmFtcyA9IHZvaWQgMDtcbnZhciBwcm9wXzEgPSByZXF1aXJlKFwiLi9wcm9wXCIpO1xudmFyIHN0cnVjdHVyZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1vZGVsL3N0cnVjdHVyZVwiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvY29sb3JcIik7XG52YXIgcGFyYW1fZGVmaW5pdGlvbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvcGFyYW0tZGVmaW5pdGlvblwiKTtcbnZhciBEb21haW5Db2xvcnMgPSBbXG4gICAgY29sb3JfMS5Db2xvci5mcm9tUmdiKDE3MCwgMTcwLCAxNzApLFxuICAgIGNvbG9yXzEuQ29sb3IuZnJvbVJnYigyNTUsIDExMiwgMylcbl07XG5leHBvcnRzLkRvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZVBhcmFtcyA9IHtcbiAgICB0eXBlOiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLk1hcHBlZFN0YXRpYygnJywge1xuICAgICAgICAnJzogcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5FbXB0eUdyb3VwKClcbiAgICB9KVxufTtcbmZ1bmN0aW9uIERvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZShjdHgsIHByb3BzKSB7XG4gICAgdmFyIGNvbG9yO1xuICAgIGlmIChjdHguc3RydWN0dXJlICYmICFjdHguc3RydWN0dXJlLmlzRW1wdHkgJiYgY3R4LnN0cnVjdHVyZS5tb2RlbHNbMF0uY3VzdG9tUHJvcGVydGllcy5oYXMocHJvcF8xLkRvbWFpbkFubm90YXRpb25zUHJvdmlkZXIuZGVzY3JpcHRvcikpIHtcbiAgICAgICAgdmFyIGdldERvbWFpbnNfMSA9IHByb3BfMS5Eb21haW5Bbm5vdGF0aW9ucy5nZXREb21haW5zO1xuICAgICAgICB2YXIgaXNzdWVfMSA9IHByb3BzLnR5cGUucGFyYW1zLmtpbmQ7XG4gICAgICAgIGNvbG9yID0gZnVuY3Rpb24gKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICBpZiAoc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5Mb2NhdGlvbi5pcyhsb2NhdGlvbikgJiYgZ2V0RG9tYWluc18xKGxvY2F0aW9uKS5pbmRleE9mKGlzc3VlXzEpID49IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRG9tYWluQ29sb3JzWzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIERvbWFpbkNvbG9yc1swXTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbG9yID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gRG9tYWluQ29sb3JzWzBdOyB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBmYWN0b3J5OiBEb21haW5Bbm5vdGF0aW9uc0NvbG9yVGhlbWUsXG4gICAgICAgIGdyYW51bGFyaXR5OiAnZ3JvdXAnLFxuICAgICAgICBjb2xvcjogY29sb3IsXG4gICAgICAgIHByb3BzOiBwcm9wcyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdIaWdobGlnaHRzIFNlcXVuZWNlIGFuZCBTdHJ1Y3R1cmUgRG9tYWluIEFubm90YXRpb25zLiBEYXRhIG9idGFpbmVkIHZpYSBQREJlLicsXG4gICAgfTtcbn1cbmV4cG9ydHMuRG9tYWluQW5ub3RhdGlvbnNDb2xvclRoZW1lID0gRG9tYWluQW5ub3RhdGlvbnNDb2xvclRoZW1lO1xuZXhwb3J0cy5Eb21haW5Bbm5vdGF0aW9uc0NvbG9yVGhlbWVQcm92aWRlciA9IHtcbiAgICBuYW1lOiAncGRiZS1kb21haW4tYW5ub3RhdGlvbnMnLFxuICAgIGxhYmVsOiAnRG9tYWluIGFubm90YXRpb25zJyxcbiAgICBjYXRlZ29yeTogXCJNaXNjZWxsYW5lb3VzXCIgLyogQ29sb3JUaGVtZS5DYXRlZ29yeS5NaXNjICovLFxuICAgIGZhY3Rvcnk6IERvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZSxcbiAgICBnZXRQYXJhbXM6IGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgICAgdmFyIGRvbWFpbk5hbWVzID0gcHJvcF8xLkRvbWFpbkFubm90YXRpb25zLmdldERvbWFpbk5hbWVzKGN0eC5zdHJ1Y3R1cmUpO1xuICAgICAgICB2YXIgZG9tYWluVHlwZXMgPSBwcm9wXzEuRG9tYWluQW5ub3RhdGlvbnMuZ2V0RG9tYWluVHlwZXMoY3R4LnN0cnVjdHVyZSk7XG4gICAgICAgIHZhciBvcHRpb25PYmogPSB7fTtcbiAgICAgICAgZG9tYWluVHlwZXMuZm9yRWFjaChmdW5jdGlvbiAodHAsIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoZG9tYWluTmFtZXNbaW5kZXhdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBvcHRpb25PYmpbdHBdID0gcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5Hcm91cCh7XG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uU2VsZWN0KGRvbWFpbk5hbWVzW2luZGV4XVswXSwgcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5hcnJheVRvT3B0aW9ucyhkb21haW5OYW1lc1tpbmRleF0pKVxuICAgICAgICAgICAgICAgIH0sIHsgaXNGbGF0OiB0cnVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKG9wdGlvbk9iaikubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLk1hcHBlZFN0YXRpYyhvcHRpb25PYmpbMF0sIG9wdGlvbk9iailcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uTWFwcGVkU3RhdGljKCcnLCB7XG4gICAgICAgICAgICAgICAgICAgICcnOiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLkVtcHR5R3JvdXAoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSxcbiAgICBkZWZhdWx0VmFsdWVzOiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLmdldERlZmF1bHRWYWx1ZXMoZXhwb3J0cy5Eb21haW5Bbm5vdGF0aW9uc0NvbG9yVGhlbWVQYXJhbXMpLFxuICAgIGlzQXBwbGljYWJsZTogZnVuY3Rpb24gKGN0eCkgeyB2YXIgX2E7IHJldHVybiBwcm9wXzEuRG9tYWluQW5ub3RhdGlvbnMuaXNBcHBsaWNhYmxlKChfYSA9IGN0eC5zdHJ1Y3R1cmUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tb2RlbHNbMF0pOyB9LFxuICAgIGVuc3VyZUN1c3RvbVByb3BlcnRpZXM6IHtcbiAgICAgICAgYXR0YWNoOiBmdW5jdGlvbiAoY3R4LCBkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5zdHJ1Y3R1cmUgPyBwcm9wXzEuRG9tYWluQW5ub3RhdGlvbnNQcm92aWRlci5hdHRhY2goY3R4LCBkYXRhLnN0cnVjdHVyZS5tb2RlbHNbMF0sIHZvaWQgMCwgdHJ1ZSkgOiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGV0YWNoOiBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gZGF0YS5zdHJ1Y3R1cmUgJiYgZGF0YS5zdHJ1Y3R1cmUubW9kZWxzWzBdLmN1c3RvbVByb3BlcnRpZXMucmVmZXJlbmNlKHByb3BfMS5Eb21haW5Bbm5vdGF0aW9uc1Byb3ZpZGVyLmRlc2NyaXB0b3IsIGZhbHNlKTsgfVxuICAgIH1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xvci5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/domain-annotations/color.js\n");
  
  /***/ }),
  
  /***/ "./lib/domain-annotations/prop.js":
  /*!****************************************!*\
    !*** ./lib/domain-annotations/prop.js ***!
    \****************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.DomainAnnotationsProvider = exports.DomainAnnotationsParams = exports.DomainAnnotations = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar wrapper_1 = __webpack_require__(/*! Molstar/mol-model-props/common/wrapper */ \"./node_modules/molstar/lib/mol-model-props/common/wrapper.js\");\nvar custom_model_property_1 = __webpack_require__(/*! Molstar/mol-model-props/common/custom-model-property */ \"./node_modules/molstar/lib/mol-model-props/common/custom-model-property.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar array_1 = __webpack_require__(/*! Molstar/mol-util/array */ \"./node_modules/molstar/lib/mol-util/array.js\");\nvar assets_1 = __webpack_require__(/*! Molstar/mol-util/assets */ \"./node_modules/molstar/lib/mol-util/assets.js\");\nvar custom_property_1 = __webpack_require__(/*! Molstar/mol-model/custom-property */ \"./node_modules/molstar/lib/mol-model/custom-property.js\");\nvar DomainAnnotations;\n(function (DomainAnnotations) {\n    DomainAnnotations.DefaultServerUrl = 'https://www.ebi.ac.uk/pdbe/api/mappings';\n    function getEntryUrl(pdbId, serverUrl) {\n        return \"\".concat(serverUrl, \"/\").concat(pdbId.toLowerCase());\n    }\n    DomainAnnotations.getEntryUrl = getEntryUrl;\n    function isApplicable(model) {\n        return !!model && structure_1.Model.hasPdbId(model);\n    }\n    DomainAnnotations.isApplicable = isApplicable;\n    function fromJson(model, data) {\n        var info = wrapper_1.PropertyWrapper.createInfo();\n        var domainMap = createdomainMapFromJson(model, data);\n        return { info: info, data: domainMap };\n    }\n    DomainAnnotations.fromJson = fromJson;\n    function fromServer(ctx, model, props) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var url, json, data;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        url = assets_1.Asset.getUrlAsset(ctx.assetManager, getEntryUrl(model.entryId, props.serverUrl));\n                        return [4 /*yield*/, ctx.assetManager.resolve(url, 'json').runInContext(ctx.runtime)];\n                    case 1:\n                        json = _a.sent();\n                        data = json.data[model.entryId.toLowerCase()];\n                        if (!data)\n                            throw new Error('missing data');\n                        return [2 /*return*/, { value: fromJson(model, data), assets: [json] }];\n                }\n            });\n        });\n    }\n    DomainAnnotations.fromServer = fromServer;\n    var _emptyArray = [];\n    function getDomains(e) {\n        if (!structure_1.Unit.isAtomic(e.unit))\n            return _emptyArray;\n        var prop = exports.DomainAnnotationsProvider.get(e.unit.model).value;\n        if (!prop || !prop.data)\n            return _emptyArray;\n        var rI = e.unit.residueIndex[e.element];\n        return prop.data.domains.has(rI) ? prop.data.domains.get(rI) : _emptyArray;\n    }\n    DomainAnnotations.getDomains = getDomains;\n    function getDomainTypes(structure) {\n        if (!structure)\n            return _emptyArray;\n        var prop = exports.DomainAnnotationsProvider.get(structure.models[0]).value;\n        if (!prop || !prop.data)\n            return _emptyArray;\n        return prop.data.domainTypes;\n    }\n    DomainAnnotations.getDomainTypes = getDomainTypes;\n    function getDomainNames(structure) {\n        if (!structure)\n            return _emptyArray;\n        var prop = exports.DomainAnnotationsProvider.get(structure.models[0]).value;\n        if (!prop || !prop.data)\n            return _emptyArray;\n        return prop.data.domainNames;\n    }\n    DomainAnnotations.getDomainNames = getDomainNames;\n})(DomainAnnotations || (DomainAnnotations = {}));\nexports.DomainAnnotations = DomainAnnotations;\nexports.DomainAnnotationsParams = {\n    serverUrl: param_definition_1.ParamDefinition.Text(DomainAnnotations.DefaultServerUrl, { description: 'JSON API Server URL' })\n};\nexports.DomainAnnotationsProvider = custom_model_property_1.CustomModelProperty.createProvider({\n    label: 'Domain annotations',\n    descriptor: (0, custom_property_1.CustomPropertyDescriptor)({\n        name: 'domain_annotations'\n    }),\n    type: 'static',\n    defaultParams: exports.DomainAnnotationsParams,\n    getParams: function (data) { return exports.DomainAnnotationsParams; },\n    isApplicable: function (data) { return DomainAnnotations.isApplicable(data); },\n    obtain: function (ctx, data, props) { return tslib_1.__awaiter(void 0, void 0, void 0, function () {\n        var p;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    p = tslib_1.__assign(tslib_1.__assign({}, param_definition_1.ParamDefinition.getDefaultValues(exports.DomainAnnotationsParams)), props);\n                    return [4 /*yield*/, DomainAnnotations.fromServer(ctx, data, p)];\n                case 1: return [2 /*return*/, _a.sent()];\n            }\n        });\n    }); }\n});\nfunction findChainLabel(map, label_entity_id, label_asym_id) {\n    var entityIndex = map.entities.getEntityIndex;\n    var eI = entityIndex(label_entity_id);\n    if (eI < 0 || !map.entity_index_label_asym_id.has(eI))\n        return -1;\n    var cm = map.entity_index_label_asym_id.get(eI);\n    if (!cm)\n        return -1;\n    return cm.has(label_asym_id) ? cm.get(label_asym_id) : -1;\n}\nfunction findResidue(modelData, map, label_entity_id, label_asym_id, label_seq_id) {\n    var cI = findChainLabel(map, label_entity_id, label_asym_id);\n    if (cI < 0)\n        return -1;\n    var rm = map.chain_index_auth_seq_id.get(cI);\n    return rm.has(label_seq_id) ? rm.get(label_seq_id) : -1;\n}\nfunction createdomainMapFromJson(modelData, data) {\n    var domainTypes = [];\n    var domainNames = [];\n    var ret = new Map();\n    var defaultDomains = ['Pfam', 'InterPro', 'CATH', 'SCOP'];\n    for (var _i = 0, _a = Object.keys(data); _i < _a.length; _i++) {\n        var db_name = _a[_i];\n        if (defaultDomains.indexOf(db_name) === -1)\n            continue;\n        var tempDomains = [];\n        domainTypes.push(db_name);\n        var db = data[db_name];\n        for (var _b = 0, _c = Object.keys(db); _b < _c.length; _b++) {\n            var db_code = _c[_b];\n            var domain = db[db_code];\n            for (var _d = 0, _e = domain.mappings; _d < _e.length; _d++) {\n                var map = _e[_d];\n                (0, array_1.arraySetAdd)(tempDomains, domain.identifier);\n                var indexData = modelData.atomicHierarchy.index;\n                var indexMap = indexData.map;\n                for (var i = map.start.residue_number; i <= map.end.residue_number; i++) {\n                    var seq_id = i;\n                    var idx = findResidue(modelData, indexMap, map.entity_id + '', map.chain_id, seq_id);\n                    var addVal = [domain.identifier];\n                    var prevVal = ret.get(idx);\n                    if (prevVal) {\n                        prevVal.push(domain.identifier);\n                        addVal = prevVal;\n                    }\n                    ret.set(idx, addVal);\n                }\n            }\n        }\n        domainNames.push(tempDomains);\n    }\n    return {\n        domains: structure_1.IndexedCustomProperty.fromResidueMap(ret),\n        domainNames: domainNames,\n        domainTypes: domainTypes\n    };\n}\n//# sourceMappingURL=prop.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvZG9tYWluLWFubm90YXRpb25zL3Byb3AuanMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsaUNBQWlDLEdBQUcsK0JBQStCLEdBQUcseUJBQXlCO0FBQy9GLGNBQWMsbUJBQU8sQ0FBQyxnREFBTztBQUM3QixrQkFBa0IsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDdkQsZ0JBQWdCLG1CQUFPLENBQUMsNEdBQXdDO0FBQ2hFLDhCQUE4QixtQkFBTyxDQUFDLHdJQUFzRDtBQUM1Rix5QkFBeUIsbUJBQU8sQ0FBQyxrR0FBbUM7QUFDcEUsY0FBYyxtQkFBTyxDQUFDLDRFQUF3QjtBQUM5QyxlQUFlLG1CQUFPLENBQUMsOEVBQXlCO0FBQ2hELHdCQUF3QixtQkFBTyxDQUFDLGtHQUFtQztBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCw4Q0FBOEM7QUFDOUY7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw4Q0FBOEM7QUFDL0MseUJBQXlCO0FBQ3pCLCtCQUErQjtBQUMvQiw2RkFBNkYsb0NBQW9DO0FBQ2pJO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsaUNBQWlDLHlDQUF5QztBQUMxRSxvQ0FBb0MsOENBQThDO0FBQ2xGLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxnQkFBZ0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLGdCQUFnQjtBQUMvRDtBQUNBO0FBQ0EsbURBQW1ELGdCQUFnQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCw2QkFBNkI7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL2RvbWFpbi1hbm5vdGF0aW9ucy9wcm9wLmpzPzY5YTciXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkRvbWFpbkFubm90YXRpb25zUHJvdmlkZXIgPSBleHBvcnRzLkRvbWFpbkFubm90YXRpb25zUGFyYW1zID0gZXhwb3J0cy5Eb21haW5Bbm5vdGF0aW9ucyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIHN0cnVjdHVyZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1vZGVsL3N0cnVjdHVyZVwiKTtcbnZhciB3cmFwcGVyXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwtcHJvcHMvY29tbW9uL3dyYXBwZXJcIik7XG52YXIgY3VzdG9tX21vZGVsX3Byb3BlcnR5XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwtcHJvcHMvY29tbW9uL2N1c3RvbS1tb2RlbC1wcm9wZXJ0eVwiKTtcbnZhciBwYXJhbV9kZWZpbml0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9wYXJhbS1kZWZpbml0aW9uXCIpO1xudmFyIGFycmF5XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9hcnJheVwiKTtcbnZhciBhc3NldHNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC11dGlsL2Fzc2V0c1wiKTtcbnZhciBjdXN0b21fcHJvcGVydHlfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1tb2RlbC9jdXN0b20tcHJvcGVydHlcIik7XG52YXIgRG9tYWluQW5ub3RhdGlvbnM7XG4oZnVuY3Rpb24gKERvbWFpbkFubm90YXRpb25zKSB7XG4gICAgRG9tYWluQW5ub3RhdGlvbnMuRGVmYXVsdFNlcnZlclVybCA9ICdodHRwczovL3d3dy5lYmkuYWMudWsvcGRiZS9hcGkvbWFwcGluZ3MnO1xuICAgIGZ1bmN0aW9uIGdldEVudHJ5VXJsKHBkYklkLCBzZXJ2ZXJVcmwpIHtcbiAgICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KHNlcnZlclVybCwgXCIvXCIpLmNvbmNhdChwZGJJZC50b0xvd2VyQ2FzZSgpKTtcbiAgICB9XG4gICAgRG9tYWluQW5ub3RhdGlvbnMuZ2V0RW50cnlVcmwgPSBnZXRFbnRyeVVybDtcbiAgICBmdW5jdGlvbiBpc0FwcGxpY2FibGUobW9kZWwpIHtcbiAgICAgICAgcmV0dXJuICEhbW9kZWwgJiYgc3RydWN0dXJlXzEuTW9kZWwuaGFzUGRiSWQobW9kZWwpO1xuICAgIH1cbiAgICBEb21haW5Bbm5vdGF0aW9ucy5pc0FwcGxpY2FibGUgPSBpc0FwcGxpY2FibGU7XG4gICAgZnVuY3Rpb24gZnJvbUpzb24obW9kZWwsIGRhdGEpIHtcbiAgICAgICAgdmFyIGluZm8gPSB3cmFwcGVyXzEuUHJvcGVydHlXcmFwcGVyLmNyZWF0ZUluZm8oKTtcbiAgICAgICAgdmFyIGRvbWFpbk1hcCA9IGNyZWF0ZWRvbWFpbk1hcEZyb21Kc29uKG1vZGVsLCBkYXRhKTtcbiAgICAgICAgcmV0dXJuIHsgaW5mbzogaW5mbywgZGF0YTogZG9tYWluTWFwIH07XG4gICAgfVxuICAgIERvbWFpbkFubm90YXRpb25zLmZyb21Kc29uID0gZnJvbUpzb247XG4gICAgZnVuY3Rpb24gZnJvbVNlcnZlcihjdHgsIG1vZGVsLCBwcm9wcykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB1cmwsIGpzb24sIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IGFzc2V0c18xLkFzc2V0LmdldFVybEFzc2V0KGN0eC5hc3NldE1hbmFnZXIsIGdldEVudHJ5VXJsKG1vZGVsLmVudHJ5SWQsIHByb3BzLnNlcnZlclVybCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY3R4LmFzc2V0TWFuYWdlci5yZXNvbHZlKHVybCwgJ2pzb24nKS5ydW5JbkNvbnRleHQoY3R4LnJ1bnRpbWUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAganNvbiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBqc29uLmRhdGFbbW9kZWwuZW50cnlJZC50b0xvd2VyQ2FzZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21pc3NpbmcgZGF0YScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHsgdmFsdWU6IGZyb21Kc29uKG1vZGVsLCBkYXRhKSwgYXNzZXRzOiBbanNvbl0gfV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBEb21haW5Bbm5vdGF0aW9ucy5mcm9tU2VydmVyID0gZnJvbVNlcnZlcjtcbiAgICB2YXIgX2VtcHR5QXJyYXkgPSBbXTtcbiAgICBmdW5jdGlvbiBnZXREb21haW5zKGUpIHtcbiAgICAgICAgaWYgKCFzdHJ1Y3R1cmVfMS5Vbml0LmlzQXRvbWljKGUudW5pdCkpXG4gICAgICAgICAgICByZXR1cm4gX2VtcHR5QXJyYXk7XG4gICAgICAgIHZhciBwcm9wID0gZXhwb3J0cy5Eb21haW5Bbm5vdGF0aW9uc1Byb3ZpZGVyLmdldChlLnVuaXQubW9kZWwpLnZhbHVlO1xuICAgICAgICBpZiAoIXByb3AgfHwgIXByb3AuZGF0YSlcbiAgICAgICAgICAgIHJldHVybiBfZW1wdHlBcnJheTtcbiAgICAgICAgdmFyIHJJID0gZS51bml0LnJlc2lkdWVJbmRleFtlLmVsZW1lbnRdO1xuICAgICAgICByZXR1cm4gcHJvcC5kYXRhLmRvbWFpbnMuaGFzKHJJKSA/IHByb3AuZGF0YS5kb21haW5zLmdldChySSkgOiBfZW1wdHlBcnJheTtcbiAgICB9XG4gICAgRG9tYWluQW5ub3RhdGlvbnMuZ2V0RG9tYWlucyA9IGdldERvbWFpbnM7XG4gICAgZnVuY3Rpb24gZ2V0RG9tYWluVHlwZXMoc3RydWN0dXJlKSB7XG4gICAgICAgIGlmICghc3RydWN0dXJlKVxuICAgICAgICAgICAgcmV0dXJuIF9lbXB0eUFycmF5O1xuICAgICAgICB2YXIgcHJvcCA9IGV4cG9ydHMuRG9tYWluQW5ub3RhdGlvbnNQcm92aWRlci5nZXQoc3RydWN0dXJlLm1vZGVsc1swXSkudmFsdWU7XG4gICAgICAgIGlmICghcHJvcCB8fCAhcHJvcC5kYXRhKVxuICAgICAgICAgICAgcmV0dXJuIF9lbXB0eUFycmF5O1xuICAgICAgICByZXR1cm4gcHJvcC5kYXRhLmRvbWFpblR5cGVzO1xuICAgIH1cbiAgICBEb21haW5Bbm5vdGF0aW9ucy5nZXREb21haW5UeXBlcyA9IGdldERvbWFpblR5cGVzO1xuICAgIGZ1bmN0aW9uIGdldERvbWFpbk5hbWVzKHN0cnVjdHVyZSkge1xuICAgICAgICBpZiAoIXN0cnVjdHVyZSlcbiAgICAgICAgICAgIHJldHVybiBfZW1wdHlBcnJheTtcbiAgICAgICAgdmFyIHByb3AgPSBleHBvcnRzLkRvbWFpbkFubm90YXRpb25zUHJvdmlkZXIuZ2V0KHN0cnVjdHVyZS5tb2RlbHNbMF0pLnZhbHVlO1xuICAgICAgICBpZiAoIXByb3AgfHwgIXByb3AuZGF0YSlcbiAgICAgICAgICAgIHJldHVybiBfZW1wdHlBcnJheTtcbiAgICAgICAgcmV0dXJuIHByb3AuZGF0YS5kb21haW5OYW1lcztcbiAgICB9XG4gICAgRG9tYWluQW5ub3RhdGlvbnMuZ2V0RG9tYWluTmFtZXMgPSBnZXREb21haW5OYW1lcztcbn0pKERvbWFpbkFubm90YXRpb25zIHx8IChEb21haW5Bbm5vdGF0aW9ucyA9IHt9KSk7XG5leHBvcnRzLkRvbWFpbkFubm90YXRpb25zID0gRG9tYWluQW5ub3RhdGlvbnM7XG5leHBvcnRzLkRvbWFpbkFubm90YXRpb25zUGFyYW1zID0ge1xuICAgIHNlcnZlclVybDogcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5UZXh0KERvbWFpbkFubm90YXRpb25zLkRlZmF1bHRTZXJ2ZXJVcmwsIHsgZGVzY3JpcHRpb246ICdKU09OIEFQSSBTZXJ2ZXIgVVJMJyB9KVxufTtcbmV4cG9ydHMuRG9tYWluQW5ub3RhdGlvbnNQcm92aWRlciA9IGN1c3RvbV9tb2RlbF9wcm9wZXJ0eV8xLkN1c3RvbU1vZGVsUHJvcGVydHkuY3JlYXRlUHJvdmlkZXIoe1xuICAgIGxhYmVsOiAnRG9tYWluIGFubm90YXRpb25zJyxcbiAgICBkZXNjcmlwdG9yOiAoMCwgY3VzdG9tX3Byb3BlcnR5XzEuQ3VzdG9tUHJvcGVydHlEZXNjcmlwdG9yKSh7XG4gICAgICAgIG5hbWU6ICdkb21haW5fYW5ub3RhdGlvbnMnXG4gICAgfSksXG4gICAgdHlwZTogJ3N0YXRpYycsXG4gICAgZGVmYXVsdFBhcmFtczogZXhwb3J0cy5Eb21haW5Bbm5vdGF0aW9uc1BhcmFtcyxcbiAgICBnZXRQYXJhbXM6IGZ1bmN0aW9uIChkYXRhKSB7IHJldHVybiBleHBvcnRzLkRvbWFpbkFubm90YXRpb25zUGFyYW1zOyB9LFxuICAgIGlzQXBwbGljYWJsZTogZnVuY3Rpb24gKGRhdGEpIHsgcmV0dXJuIERvbWFpbkFubm90YXRpb25zLmlzQXBwbGljYWJsZShkYXRhKTsgfSxcbiAgICBvYnRhaW46IGZ1bmN0aW9uIChjdHgsIGRhdGEsIHByb3BzKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHAgPSB0c2xpYl8xLl9fYXNzaWduKHRzbGliXzEuX19hc3NpZ24oe30sIHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uZ2V0RGVmYXVsdFZhbHVlcyhleHBvcnRzLkRvbWFpbkFubm90YXRpb25zUGFyYW1zKSksIHByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgRG9tYWluQW5ub3RhdGlvbnMuZnJvbVNlcnZlcihjdHgsIGRhdGEsIHApXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTsgfVxufSk7XG5mdW5jdGlvbiBmaW5kQ2hhaW5MYWJlbChtYXAsIGxhYmVsX2VudGl0eV9pZCwgbGFiZWxfYXN5bV9pZCkge1xuICAgIHZhciBlbnRpdHlJbmRleCA9IG1hcC5lbnRpdGllcy5nZXRFbnRpdHlJbmRleDtcbiAgICB2YXIgZUkgPSBlbnRpdHlJbmRleChsYWJlbF9lbnRpdHlfaWQpO1xuICAgIGlmIChlSSA8IDAgfHwgIW1hcC5lbnRpdHlfaW5kZXhfbGFiZWxfYXN5bV9pZC5oYXMoZUkpKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgdmFyIGNtID0gbWFwLmVudGl0eV9pbmRleF9sYWJlbF9hc3ltX2lkLmdldChlSSk7XG4gICAgaWYgKCFjbSlcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIHJldHVybiBjbS5oYXMobGFiZWxfYXN5bV9pZCkgPyBjbS5nZXQobGFiZWxfYXN5bV9pZCkgOiAtMTtcbn1cbmZ1bmN0aW9uIGZpbmRSZXNpZHVlKG1vZGVsRGF0YSwgbWFwLCBsYWJlbF9lbnRpdHlfaWQsIGxhYmVsX2FzeW1faWQsIGxhYmVsX3NlcV9pZCkge1xuICAgIHZhciBjSSA9IGZpbmRDaGFpbkxhYmVsKG1hcCwgbGFiZWxfZW50aXR5X2lkLCBsYWJlbF9hc3ltX2lkKTtcbiAgICBpZiAoY0kgPCAwKVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgdmFyIHJtID0gbWFwLmNoYWluX2luZGV4X2F1dGhfc2VxX2lkLmdldChjSSk7XG4gICAgcmV0dXJuIHJtLmhhcyhsYWJlbF9zZXFfaWQpID8gcm0uZ2V0KGxhYmVsX3NlcV9pZCkgOiAtMTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZWRvbWFpbk1hcEZyb21Kc29uKG1vZGVsRGF0YSwgZGF0YSkge1xuICAgIHZhciBkb21haW5UeXBlcyA9IFtdO1xuICAgIHZhciBkb21haW5OYW1lcyA9IFtdO1xuICAgIHZhciByZXQgPSBuZXcgTWFwKCk7XG4gICAgdmFyIGRlZmF1bHREb21haW5zID0gWydQZmFtJywgJ0ludGVyUHJvJywgJ0NBVEgnLCAnU0NPUCddO1xuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBPYmplY3Qua2V5cyhkYXRhKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGRiX25hbWUgPSBfYVtfaV07XG4gICAgICAgIGlmIChkZWZhdWx0RG9tYWlucy5pbmRleE9mKGRiX25hbWUpID09PSAtMSlcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB2YXIgdGVtcERvbWFpbnMgPSBbXTtcbiAgICAgICAgZG9tYWluVHlwZXMucHVzaChkYl9uYW1lKTtcbiAgICAgICAgdmFyIGRiID0gZGF0YVtkYl9uYW1lXTtcbiAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IE9iamVjdC5rZXlzKGRiKTsgX2IgPCBfYy5sZW5ndGg7IF9iKyspIHtcbiAgICAgICAgICAgIHZhciBkYl9jb2RlID0gX2NbX2JdO1xuICAgICAgICAgICAgdmFyIGRvbWFpbiA9IGRiW2RiX2NvZGVdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2QgPSAwLCBfZSA9IGRvbWFpbi5tYXBwaW5nczsgX2QgPCBfZS5sZW5ndGg7IF9kKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbWFwID0gX2VbX2RdO1xuICAgICAgICAgICAgICAgICgwLCBhcnJheV8xLmFycmF5U2V0QWRkKSh0ZW1wRG9tYWlucywgZG9tYWluLmlkZW50aWZpZXIpO1xuICAgICAgICAgICAgICAgIHZhciBpbmRleERhdGEgPSBtb2RlbERhdGEuYXRvbWljSGllcmFyY2h5LmluZGV4O1xuICAgICAgICAgICAgICAgIHZhciBpbmRleE1hcCA9IGluZGV4RGF0YS5tYXA7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IG1hcC5zdGFydC5yZXNpZHVlX251bWJlcjsgaSA8PSBtYXAuZW5kLnJlc2lkdWVfbnVtYmVyOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlcV9pZCA9IGk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBmaW5kUmVzaWR1ZShtb2RlbERhdGEsIGluZGV4TWFwLCBtYXAuZW50aXR5X2lkICsgJycsIG1hcC5jaGFpbl9pZCwgc2VxX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFkZFZhbCA9IFtkb21haW4uaWRlbnRpZmllcl07XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2VmFsID0gcmV0LmdldChpZHgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJldlZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldlZhbC5wdXNoKGRvbWFpbi5pZGVudGlmaWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFZhbCA9IHByZXZWYWw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0LnNldChpZHgsIGFkZFZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGRvbWFpbk5hbWVzLnB1c2godGVtcERvbWFpbnMpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBkb21haW5zOiBzdHJ1Y3R1cmVfMS5JbmRleGVkQ3VzdG9tUHJvcGVydHkuZnJvbVJlc2lkdWVNYXAocmV0KSxcbiAgICAgICAgZG9tYWluTmFtZXM6IGRvbWFpbk5hbWVzLFxuICAgICAgICBkb21haW5UeXBlczogZG9tYWluVHlwZXNcbiAgICB9O1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvcC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/domain-annotations/prop.js\n");
  
  /***/ }),
  
  /***/ "./lib/helpers.js":
  /*!************************!*\
    !*** ./lib/helpers.js ***!
    \************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ModelInfo = exports.ModelInfo2 = exports.QueryHelper = exports.LigandView = exports.StateElements = exports.AlphafoldView = exports.PDBeVolumes = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar builder_1 = __webpack_require__(/*! Molstar/mol-script/language/builder */ \"./node_modules/molstar/lib/mol-script/language/builder.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar transformers_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior/dynamic/volume-streaming/transformers */ \"./node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/transformers.js\");\n// import { VolumeStreaming } from '../../mol-plugin/behavior/dynamic/volume-streaming/behavior';\nvar compiler_1 = __webpack_require__(/*! Molstar/mol-script/runtime/query/compiler */ \"./node_modules/molstar/lib/mol-script/runtime/query/compiler.js\");\nvar structure_2 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar sifts_mapping_1 = __webpack_require__(/*! Molstar/mol-model-props/sequence/sifts-mapping */ \"./node_modules/molstar/lib/mol-model-props/sequence/sifts-mapping.js\");\nvar query_1 = __webpack_require__(/*! Molstar/mol-model/structure/query/query */ \"./node_modules/molstar/lib/mol-model/structure/query/query.js\");\nvar prop_1 = __webpack_require__(/*! Molstar/extensions/model-archive/quality-assessment/prop */ \"./node_modules/molstar/lib/extensions/model-archive/quality-assessment/prop.js\");\nvar symmetry_1 = __webpack_require__(/*! Molstar/mol-model-formats/structure/property/symmetry */ \"./node_modules/molstar/lib/mol-model-formats/structure/property/symmetry.js\");\nvar PDBeVolumes;\n(function (PDBeVolumes) {\n    function mapParams(defaultParams, mapParams, ref) {\n        var pdbeParams = tslib_1.__assign({}, defaultParams);\n        pdbeParams.options.behaviorRef = 'volume-streaming' + '' + Math.floor(Math.random() * Math.floor(100));\n        pdbeParams.options.emContourProvider = 'pdbe';\n        pdbeParams.options.serverUrl = 'https://www.ebi.ac.uk/pdbe/volume-server';\n        pdbeParams.options.channelParams['em'] = {\n            opacity: (mapParams && mapParams.em && mapParams.em.opacity) ? mapParams.em.opacity : 0.49,\n            wireframe: (mapParams && mapParams.em && mapParams.em.wireframe) ? mapParams.em.wireframe : false\n        };\n        pdbeParams.options.channelParams['2fo-fc'] = {\n            opacity: (mapParams && mapParams['2fo-fc'] && mapParams['2fo-fc'].opacity) ? mapParams['2fo-fc'].opacity : 0.49,\n            wireframe: (mapParams && mapParams['2fo-fc'] && mapParams['2fo-fc'].wireframe) ? mapParams['2fo-fc'].wireframe : false\n        };\n        pdbeParams.options.channelParams['fo-fc(+ve)'] = {\n            opacity: (mapParams && mapParams['fo-fc(+ve)'] && mapParams['fo-fc(+ve)'].opacity) ? mapParams['fo-fc(+ve)'].opacity : 0.3,\n            wireframe: (mapParams && mapParams['fo-fc(+ve)'] && mapParams['fo-fc(+ve)'].wireframe) ? mapParams['fo-fc(+ve)'].wireframe : true\n        };\n        pdbeParams.options.channelParams['fo-fc(-ve)'] = {\n            opacity: (mapParams && mapParams['fo-fc(-ve)'] && mapParams['fo-fc(-ve)'].opacity) ? mapParams['fo-fc(-ve)'].opacity : 0.3,\n            wireframe: (mapParams && mapParams['fo-fc(-ve)'] && mapParams['fo-fc(-ve)'].wireframe) ? mapParams['fo-fc(-ve)'].wireframe : true\n        };\n        return pdbeParams;\n    }\n    PDBeVolumes.mapParams = mapParams;\n    function displayUsibilityMessage(plugin) {\n        commands_1.PluginCommands.Toast.Show(plugin, {\n            title: 'Volume',\n            message: 'Streaming enabled, click on a residue or an atom to view the data.',\n            key: 'toast-1',\n            timeoutMs: 7000\n        });\n    }\n    PDBeVolumes.displayUsibilityMessage = displayUsibilityMessage;\n    function toggle(plugin) {\n        var state = plugin.state.data;\n        var streamingState = state.select(mol_state_1.StateSelection.Generators.ofTransformer(transformers_1.CreateVolumeStreamingInfo))[0];\n        if (streamingState) {\n            commands_1.PluginCommands.State.ToggleVisibility(plugin, { state: state, ref: streamingState.transform.ref });\n            return;\n        }\n    }\n    PDBeVolumes.toggle = toggle;\n})(PDBeVolumes = exports.PDBeVolumes || (exports.PDBeVolumes = {}));\nvar AlphafoldView;\n(function (AlphafoldView) {\n    function getLociByPLDDT(score, contextData) {\n        var queryExp = builder_1.MolScriptBuilder.struct.modifier.union([\n            builder_1.MolScriptBuilder.struct.modifier.wholeResidues([\n                builder_1.MolScriptBuilder.struct.modifier.union([\n                    builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                        'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.ammp('objectPrimitive'), 'atomistic']),\n                        'residue-test': builder_1.MolScriptBuilder.core.rel.gr([prop_1.QualityAssessment.symbols.pLDDT.symbol(), score]),\n                    })\n                ])\n            ])\n        ]);\n        var query = (0, compiler_1.compile)(queryExp);\n        var sel = query(new structure_1.QueryContext(contextData));\n        return structure_1.StructureSelection.toLociWithSourceUnits(sel);\n    }\n    AlphafoldView.getLociByPLDDT = getLociByPLDDT;\n})(AlphafoldView = exports.AlphafoldView || (exports.AlphafoldView = {}));\nvar StateElements;\n(function (StateElements) {\n    StateElements[\"Model\"] = \"model\";\n    StateElements[\"ModelProps\"] = \"model-props\";\n    StateElements[\"Assembly\"] = \"assembly\";\n    StateElements[\"VolumeStreaming\"] = \"volume-streaming\";\n    StateElements[\"Sequence\"] = \"sequence\";\n    StateElements[\"SequenceVisual\"] = \"sequence-visual\";\n    StateElements[\"Het\"] = \"het\";\n    StateElements[\"HetVisual\"] = \"het-visual\";\n    StateElements[\"Het3DSNFG\"] = \"het-3dsnfg\";\n    StateElements[\"Water\"] = \"water\";\n    StateElements[\"WaterVisual\"] = \"water-visual\";\n    StateElements[\"HetGroupFocus\"] = \"het-group-focus\";\n    StateElements[\"HetGroupFocusGroup\"] = \"het-group-focus-group\";\n})(StateElements = exports.StateElements || (exports.StateElements = {}));\nvar LigandView;\n(function (LigandView) {\n    function query(ligandViewParams) {\n        var atomGroupsParams = {\n            'group-by': builder_1.MolScriptBuilder.core.str.concat([builder_1.MolScriptBuilder.struct.atomProperty.core.operatorName(), builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.residueKey()])\n        };\n        // Residue Param\n        var residueParam;\n        if (ligandViewParams.auth_seq_id) {\n            residueParam = builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_seq_id(), ligandViewParams.auth_seq_id]);\n        }\n        else if (ligandViewParams.label_comp_id) {\n            residueParam = builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.label_comp_id(), ligandViewParams.label_comp_id]);\n        }\n        if (residueParam)\n            atomGroupsParams['residue-test'] = residueParam;\n        // Chain Param\n        if (ligandViewParams.auth_asym_id) {\n            atomGroupsParams['chain-test'] = builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_asym_id(), ligandViewParams.auth_asym_id]);\n        }\n        else if (ligandViewParams.struct_asym_id) {\n            atomGroupsParams['chain-test'] = builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.label_asym_id(), ligandViewParams.struct_asym_id]);\n        }\n        // Construct core query\n        var core = ligandViewParams.show_all ?\n            builder_1.MolScriptBuilder.struct.generator.atomGroups(atomGroupsParams) :\n            builder_1.MolScriptBuilder.struct.filter.first([\n                builder_1.MolScriptBuilder.struct.generator.atomGroups(atomGroupsParams)\n            ]);\n        // Construct surroundings query\n        var surroundings = builder_1.MolScriptBuilder.struct.modifier.includeSurroundings({ 0: core, radius: 5, 'as-whole-residues': true });\n        return {\n            core: core,\n            surroundings: surroundings\n        };\n    }\n    LigandView.query = query;\n    function branchedQuery(params) {\n        var entityObjArray = [];\n        params.atom_site.forEach(function (param) {\n            var qEntities = {\n                'group-by': builder_1.MolScriptBuilder.core.str.concat([builder_1.MolScriptBuilder.struct.atomProperty.core.operatorName(), builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.residueKey()]),\n                'residue-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_seq_id(), param.auth_seq_id])\n            };\n            entityObjArray.push(qEntities);\n        });\n        var atmGroupsQueries = [];\n        entityObjArray.forEach(function (entityObj) {\n            atmGroupsQueries.push(builder_1.MolScriptBuilder.struct.generator.atomGroups(entityObj));\n        });\n        var core = builder_1.MolScriptBuilder.struct.modifier.union([\n            atmGroupsQueries.length === 1\n                ? atmGroupsQueries[0]\n                // Need to union before merge for fast performance\n                : builder_1.MolScriptBuilder.struct.combinator.merge(atmGroupsQueries.map(function (q) { return builder_1.MolScriptBuilder.struct.modifier.union([q]); }))\n        ]);\n        // Construct surroundings query\n        var surroundings = builder_1.MolScriptBuilder.struct.modifier.includeSurroundings({ 0: core, radius: 5, 'as-whole-residues': true });\n        return {\n            core: core,\n            surroundings: surroundings\n        };\n    }\n    LigandView.branchedQuery = branchedQuery;\n})(LigandView = exports.LigandView || (exports.LigandView = {}));\nvar QueryHelper;\n(function (QueryHelper) {\n    function getQueryObject(params, contextData) {\n        var selections = [];\n        var siftMappings;\n        var currentAccession;\n        params.forEach(function (param) {\n            var selection = {};\n            // entity\n            if (param.entity_id)\n                selection['entityTest'] = function (l) { return structure_1.StructureProperties.entity.id(l.element) === param.entity_id; };\n            // chain\n            if (param.struct_asym_id) {\n                selection['chainTest'] = function (l) { return structure_1.StructureProperties.chain.label_asym_id(l.element) === param.struct_asym_id; };\n            }\n            else if (param.auth_asym_id) {\n                selection['chainTest'] = function (l) { return structure_1.StructureProperties.chain.auth_asym_id(l.element) === param.auth_asym_id; };\n            }\n            // residues\n            if (param.label_comp_id) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.atom.label_comp_id(l.element) === param.label_comp_id; };\n            }\n            else if (param.uniprot_accession && param.uniprot_residue_number) {\n                selection['residueTest'] = function (l) {\n                    if (!siftMappings || currentAccession !== param.uniprot_accession) {\n                        siftMappings = sifts_mapping_1.SIFTSMapping.Provider.get(contextData.models[0]).value;\n                        currentAccession = param.uniprot_accession;\n                    }\n                    var rI = structure_1.StructureProperties.residue.key(l.element);\n                    return param.uniprot_accession === siftMappings.accession[rI] && param.uniprot_residue_number === +siftMappings.num[rI];\n                };\n            }\n            else if (param.uniprot_accession && param.start_uniprot_residue_number && param.end_uniprot_residue_number) {\n                selection['residueTest'] = function (l) {\n                    if (!siftMappings || currentAccession !== param.uniprot_accession) {\n                        siftMappings = sifts_mapping_1.SIFTSMapping.Provider.get(contextData.models[0]).value;\n                        currentAccession = param.uniprot_accession;\n                    }\n                    var rI = structure_1.StructureProperties.residue.key(l.element);\n                    return param.uniprot_accession === siftMappings.accession[rI] && (param.start_uniprot_residue_number <= +siftMappings.num[rI] && param.end_uniprot_residue_number >= +siftMappings.num[rI]);\n                };\n            }\n            else if (param.residue_number) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.residue.label_seq_id(l.element) === param.residue_number; };\n            }\n            else if ((param.start_residue_number && param.end_residue_number) && (param.end_residue_number > param.start_residue_number)) {\n                selection['residueTest'] = function (l) {\n                    var labelSeqId = structure_1.StructureProperties.residue.label_seq_id(l.element);\n                    return labelSeqId >= param.start_residue_number && labelSeqId <= param.end_residue_number;\n                };\n            }\n            else if ((param.start_residue_number && param.end_residue_number) && (param.end_residue_number === param.start_residue_number)) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.residue.label_seq_id(l.element) === param.start_residue_number; };\n            }\n            else if (param.auth_seq_id) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.residue.auth_seq_id(l.element) === param.auth_seq_id; };\n            }\n            else if (param.auth_residue_number && !param.auth_ins_code_id) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.residue.auth_seq_id(l.element) === param.auth_residue_number; };\n            }\n            else if (param.auth_residue_number && param.auth_ins_code_id) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.residue.auth_seq_id(l.element) === param.auth_residue_number; };\n            }\n            else if ((param.start_auth_residue_number && param.end_auth_residue_number) && (param.end_auth_residue_number > param.start_auth_residue_number)) {\n                selection['residueTest'] = function (l) {\n                    var authSeqId = structure_1.StructureProperties.residue.auth_seq_id(l.element);\n                    return authSeqId >= param.start_auth_residue_number && authSeqId <= param.end_auth_residue_number;\n                };\n            }\n            else if ((param.start_auth_residue_number && param.end_auth_residue_number) && (param.end_auth_residue_number === param.start_auth_residue_number)) {\n                selection['residueTest'] = function (l) { return structure_1.StructureProperties.residue.auth_seq_id(l.element) === param.start_auth_residue_number; };\n            }\n            // atoms\n            if (param.atoms) {\n                selection['atomTest'] = function (l) { return param.atoms.includes(structure_1.StructureProperties.atom.label_atom_id(l.element)); };\n            }\n            if (param.atom_id) {\n                selection['atomTest'] = function (l) { return param.atom_id.includes(structure_1.StructureProperties.atom.id(l.element)); };\n            }\n            selections.push(selection);\n        });\n        var atmGroupsQueries = [];\n        selections.forEach(function (selection) {\n            atmGroupsQueries.push(structure_2.Queries.generators.atoms(selection));\n        });\n        return structure_2.Queries.combinators.merge(atmGroupsQueries);\n    }\n    QueryHelper.getQueryObject = getQueryObject;\n    function getInteractivityLoci(params, contextData) {\n        var sel = query_1.StructureQuery.run(QueryHelper.getQueryObject(params, contextData), contextData);\n        return structure_1.StructureSelection.toLociWithSourceUnits(sel);\n    }\n    QueryHelper.getInteractivityLoci = getInteractivityLoci;\n    function getHetLoci(queryExp, contextData) {\n        var query = (0, compiler_1.compile)(queryExp);\n        var sel = query(new structure_1.QueryContext(contextData));\n        return structure_1.StructureSelection.toLociWithSourceUnits(sel);\n    }\n    QueryHelper.getHetLoci = getHetLoci;\n})(QueryHelper = exports.QueryHelper || (exports.QueryHelper = {}));\nvar ModelInfo2;\n(function (ModelInfo2) {\n    function getPreferredAssembly(ctx, model) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var id, src, json, data, assemblies, _i, assemblies_1, asm, e_1;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (model.entryId.length <= 3)\n                            return [2 /*return*/, void 0];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        id = model.entryId.toLowerCase();\n                        return [4 /*yield*/, ctx.runTask(ctx.fetch({ url: \"https://www.ebi.ac.uk/pdbe/api/pdb/entry/summary/\".concat(id) }))];\n                    case 2:\n                        src = _a.sent();\n                        json = JSON.parse(src);\n                        data = json && json[id];\n                        assemblies = data[0] && data[0].assemblies;\n                        if (!assemblies || !assemblies.length)\n                            return [2 /*return*/, void 0];\n                        for (_i = 0, assemblies_1 = assemblies; _i < assemblies_1.length; _i++) {\n                            asm = assemblies_1[_i];\n                            if (asm.preferred) {\n                                return [2 /*return*/, asm.assembly_id];\n                            }\n                        }\n                        return [2 /*return*/, void 0];\n                    case 3:\n                        e_1 = _a.sent();\n                        console.warn('getPreferredAssembly', e_1);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    }\n    function get(ctx, model, checkPreferred) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var residueCount, residueOffsets, chainIndex, pref, hetResidues, hetMap, rI, cI, eI, entityType, comp_id, lig, preferredAssemblyId, symmetry;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        residueCount = model.atomicHierarchy.residues._rowCount;\n                        residueOffsets = model.atomicHierarchy.residueAtomSegments.offsets;\n                        chainIndex = model.atomicHierarchy.chainAtomSegments.index;\n                        pref = checkPreferred\n                            ? getPreferredAssembly(ctx, model)\n                            : void 0;\n                        hetResidues = [];\n                        hetMap = new Map();\n                        for (rI = 0; rI < residueCount; rI++) {\n                            cI = chainIndex[residueOffsets[rI]];\n                            eI = model.atomicHierarchy.index.getEntityFromChain(cI);\n                            entityType = model.entities.data.type.value(eI);\n                            if (entityType !== 'non-polymer' && entityType !== 'branched')\n                                continue;\n                            comp_id = model.atomicHierarchy.atoms.label_comp_id.value(residueOffsets[rI]);\n                            lig = hetMap.get(comp_id);\n                            if (!lig) {\n                                lig = { name: comp_id, indices: [] };\n                                hetResidues.push(lig);\n                                hetMap.set(comp_id, lig);\n                            }\n                            lig.indices.push(rI);\n                        }\n                        return [4 /*yield*/, pref];\n                    case 1:\n                        preferredAssemblyId = _a.sent();\n                        symmetry = symmetry_1.ModelSymmetry.Provider.get(model);\n                        return [2 /*return*/, {\n                                hetResidues: hetResidues,\n                                assemblies: symmetry ? symmetry.assemblies.map(function (a) { return ({ id: a.id, details: a.details, isPreferred: a.id === preferredAssemblyId }); }) : [],\n                                preferredAssemblyId: preferredAssemblyId\n                            }];\n                }\n            });\n        });\n    }\n    ModelInfo2.get = get;\n})(ModelInfo2 = exports.ModelInfo2 || (exports.ModelInfo2 = {}));\nvar ModelInfo;\n(function (ModelInfo) {\n    function get(model, structures) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var residueCount, residueOffsets, chainIndex, hetNames, carbEntityCount, rI, cI, eI, entityType, comp_id;\n            return tslib_1.__generator(this, function (_a) {\n                residueCount = model.atomicHierarchy.residues._rowCount;\n                residueOffsets = model.atomicHierarchy.residueAtomSegments.offsets;\n                chainIndex = model.atomicHierarchy.chainAtomSegments.index;\n                hetNames = [];\n                carbEntityCount = 0;\n                for (rI = 0; rI < residueCount; rI++) {\n                    cI = chainIndex[residueOffsets[rI]];\n                    eI = model.atomicHierarchy.index.getEntityFromChain(cI);\n                    entityType = model.entities.data.type.value(eI);\n                    if (entityType !== 'non-polymer' && entityType !== 'branched')\n                        continue;\n                    comp_id = model.atomicHierarchy.atoms.label_comp_id.value(residueOffsets[rI]);\n                    if (entityType === 'branched') {\n                        carbEntityCount++;\n                    }\n                    else {\n                        if (hetNames.indexOf(comp_id) === -1)\n                            hetNames.push(comp_id);\n                    }\n                }\n                return [2 /*return*/, {\n                        hetNames: hetNames,\n                        carbEntityCount: carbEntityCount\n                    }];\n            });\n        });\n    }\n    ModelInfo.get = get;\n})(ModelInfo = exports.ModelInfo || (exports.ModelInfo = {}));\n//# sourceMappingURL=helpers.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0EsNkJBQTZCLG1CQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUMsb0NBQW9DLGlCQUFpQixLQUFLO0FBQzNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL2hlbHBlcnMuanM/MTU2NiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuTW9kZWxJbmZvID0gZXhwb3J0cy5Nb2RlbEluZm8yID0gZXhwb3J0cy5RdWVyeUhlbHBlciA9IGV4cG9ydHMuTGlnYW5kVmlldyA9IGV4cG9ydHMuU3RhdGVFbGVtZW50cyA9IGV4cG9ydHMuQWxwaGFmb2xkVmlldyA9IGV4cG9ydHMuUERCZVZvbHVtZXMgPSB2b2lkIDA7XG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoXCJ0c2xpYlwiKTtcbnZhciBjb21tYW5kc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9jb21tYW5kc1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtc2NyaXB0L2xhbmd1YWdlL2J1aWxkZXJcIik7XG52YXIgbW9sX3N0YXRlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtc3RhdGVcIik7XG52YXIgc3RydWN0dXJlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlXCIpO1xudmFyIHRyYW5zZm9ybWVyc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9iZWhhdmlvci9keW5hbWljL3ZvbHVtZS1zdHJlYW1pbmcvdHJhbnNmb3JtZXJzXCIpO1xuLy8gaW1wb3J0IHsgVm9sdW1lU3RyZWFtaW5nIH0gZnJvbSAnLi4vLi4vbW9sLXBsdWdpbi9iZWhhdmlvci9keW5hbWljL3ZvbHVtZS1zdHJlYW1pbmcvYmVoYXZpb3InO1xudmFyIGNvbXBpbGVyXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtc2NyaXB0L3J1bnRpbWUvcXVlcnkvY29tcGlsZXJcIik7XG52YXIgc3RydWN0dXJlXzIgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlXCIpO1xudmFyIHNpZnRzX21hcHBpbmdfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1tb2RlbC1wcm9wcy9zZXF1ZW5jZS9zaWZ0cy1tYXBwaW5nXCIpO1xudmFyIHF1ZXJ5XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlL3F1ZXJ5L3F1ZXJ5XCIpO1xudmFyIHByb3BfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL2V4dGVuc2lvbnMvbW9kZWwtYXJjaGl2ZS9xdWFsaXR5LWFzc2Vzc21lbnQvcHJvcFwiKTtcbnZhciBzeW1tZXRyeV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1vZGVsLWZvcm1hdHMvc3RydWN0dXJlL3Byb3BlcnR5L3N5bW1ldHJ5XCIpO1xudmFyIFBEQmVWb2x1bWVzO1xuKGZ1bmN0aW9uIChQREJlVm9sdW1lcykge1xuICAgIGZ1bmN0aW9uIG1hcFBhcmFtcyhkZWZhdWx0UGFyYW1zLCBtYXBQYXJhbXMsIHJlZikge1xuICAgICAgICB2YXIgcGRiZVBhcmFtcyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlZmF1bHRQYXJhbXMpO1xuICAgICAgICBwZGJlUGFyYW1zLm9wdGlvbnMuYmVoYXZpb3JSZWYgPSAndm9sdW1lLXN0cmVhbWluZycgKyAnJyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIE1hdGguZmxvb3IoMTAwKSk7XG4gICAgICAgIHBkYmVQYXJhbXMub3B0aW9ucy5lbUNvbnRvdXJQcm92aWRlciA9ICdwZGJlJztcbiAgICAgICAgcGRiZVBhcmFtcy5vcHRpb25zLnNlcnZlclVybCA9ICdodHRwczovL3d3dy5lYmkuYWMudWsvcGRiZS92b2x1bWUtc2VydmVyJztcbiAgICAgICAgcGRiZVBhcmFtcy5vcHRpb25zLmNoYW5uZWxQYXJhbXNbJ2VtJ10gPSB7XG4gICAgICAgICAgICBvcGFjaXR5OiAobWFwUGFyYW1zICYmIG1hcFBhcmFtcy5lbSAmJiBtYXBQYXJhbXMuZW0ub3BhY2l0eSkgPyBtYXBQYXJhbXMuZW0ub3BhY2l0eSA6IDAuNDksXG4gICAgICAgICAgICB3aXJlZnJhbWU6IChtYXBQYXJhbXMgJiYgbWFwUGFyYW1zLmVtICYmIG1hcFBhcmFtcy5lbS53aXJlZnJhbWUpID8gbWFwUGFyYW1zLmVtLndpcmVmcmFtZSA6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHBkYmVQYXJhbXMub3B0aW9ucy5jaGFubmVsUGFyYW1zWycyZm8tZmMnXSA9IHtcbiAgICAgICAgICAgIG9wYWNpdHk6IChtYXBQYXJhbXMgJiYgbWFwUGFyYW1zWycyZm8tZmMnXSAmJiBtYXBQYXJhbXNbJzJmby1mYyddLm9wYWNpdHkpID8gbWFwUGFyYW1zWycyZm8tZmMnXS5vcGFjaXR5IDogMC40OSxcbiAgICAgICAgICAgIHdpcmVmcmFtZTogKG1hcFBhcmFtcyAmJiBtYXBQYXJhbXNbJzJmby1mYyddICYmIG1hcFBhcmFtc1snMmZvLWZjJ10ud2lyZWZyYW1lKSA/IG1hcFBhcmFtc1snMmZvLWZjJ10ud2lyZWZyYW1lIDogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgcGRiZVBhcmFtcy5vcHRpb25zLmNoYW5uZWxQYXJhbXNbJ2ZvLWZjKCt2ZSknXSA9IHtcbiAgICAgICAgICAgIG9wYWNpdHk6IChtYXBQYXJhbXMgJiYgbWFwUGFyYW1zWydmby1mYygrdmUpJ10gJiYgbWFwUGFyYW1zWydmby1mYygrdmUpJ10ub3BhY2l0eSkgPyBtYXBQYXJhbXNbJ2ZvLWZjKCt2ZSknXS5vcGFjaXR5IDogMC4zLFxuICAgICAgICAgICAgd2lyZWZyYW1lOiAobWFwUGFyYW1zICYmIG1hcFBhcmFtc1snZm8tZmMoK3ZlKSddICYmIG1hcFBhcmFtc1snZm8tZmMoK3ZlKSddLndpcmVmcmFtZSkgPyBtYXBQYXJhbXNbJ2ZvLWZjKCt2ZSknXS53aXJlZnJhbWUgOiB0cnVlXG4gICAgICAgIH07XG4gICAgICAgIHBkYmVQYXJhbXMub3B0aW9ucy5jaGFubmVsUGFyYW1zWydmby1mYygtdmUpJ10gPSB7XG4gICAgICAgICAgICBvcGFjaXR5OiAobWFwUGFyYW1zICYmIG1hcFBhcmFtc1snZm8tZmMoLXZlKSddICYmIG1hcFBhcmFtc1snZm8tZmMoLXZlKSddLm9wYWNpdHkpID8gbWFwUGFyYW1zWydmby1mYygtdmUpJ10ub3BhY2l0eSA6IDAuMyxcbiAgICAgICAgICAgIHdpcmVmcmFtZTogKG1hcFBhcmFtcyAmJiBtYXBQYXJhbXNbJ2ZvLWZjKC12ZSknXSAmJiBtYXBQYXJhbXNbJ2ZvLWZjKC12ZSknXS53aXJlZnJhbWUpID8gbWFwUGFyYW1zWydmby1mYygtdmUpJ10ud2lyZWZyYW1lIDogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcGRiZVBhcmFtcztcbiAgICB9XG4gICAgUERCZVZvbHVtZXMubWFwUGFyYW1zID0gbWFwUGFyYW1zO1xuICAgIGZ1bmN0aW9uIGRpc3BsYXlVc2liaWxpdHlNZXNzYWdlKHBsdWdpbikge1xuICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlRvYXN0LlNob3cocGx1Z2luLCB7XG4gICAgICAgICAgICB0aXRsZTogJ1ZvbHVtZScsXG4gICAgICAgICAgICBtZXNzYWdlOiAnU3RyZWFtaW5nIGVuYWJsZWQsIGNsaWNrIG9uIGEgcmVzaWR1ZSBvciBhbiBhdG9tIHRvIHZpZXcgdGhlIGRhdGEuJyxcbiAgICAgICAgICAgIGtleTogJ3RvYXN0LTEnLFxuICAgICAgICAgICAgdGltZW91dE1zOiA3MDAwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBQREJlVm9sdW1lcy5kaXNwbGF5VXNpYmlsaXR5TWVzc2FnZSA9IGRpc3BsYXlVc2liaWxpdHlNZXNzYWdlO1xuICAgIGZ1bmN0aW9uIHRvZ2dsZShwbHVnaW4pIHtcbiAgICAgICAgdmFyIHN0YXRlID0gcGx1Z2luLnN0YXRlLmRhdGE7XG4gICAgICAgIHZhciBzdHJlYW1pbmdTdGF0ZSA9IHN0YXRlLnNlbGVjdChtb2xfc3RhdGVfMS5TdGF0ZVNlbGVjdGlvbi5HZW5lcmF0b3JzLm9mVHJhbnNmb3JtZXIodHJhbnNmb3JtZXJzXzEuQ3JlYXRlVm9sdW1lU3RyZWFtaW5nSW5mbykpWzBdO1xuICAgICAgICBpZiAoc3RyZWFtaW5nU3RhdGUpIHtcbiAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuVG9nZ2xlVmlzaWJpbGl0eShwbHVnaW4sIHsgc3RhdGU6IHN0YXRlLCByZWY6IHN0cmVhbWluZ1N0YXRlLnRyYW5zZm9ybS5yZWYgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgUERCZVZvbHVtZXMudG9nZ2xlID0gdG9nZ2xlO1xufSkoUERCZVZvbHVtZXMgPSBleHBvcnRzLlBEQmVWb2x1bWVzIHx8IChleHBvcnRzLlBEQmVWb2x1bWVzID0ge30pKTtcbnZhciBBbHBoYWZvbGRWaWV3O1xuKGZ1bmN0aW9uIChBbHBoYWZvbGRWaWV3KSB7XG4gICAgZnVuY3Rpb24gZ2V0TG9jaUJ5UExERFQoc2NvcmUsIGNvbnRleHREYXRhKSB7XG4gICAgICAgIHZhciBxdWVyeUV4cCA9IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5tb2RpZmllci51bmlvbihbXG4gICAgICAgICAgICBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QubW9kaWZpZXIud2hvbGVSZXNpZHVlcyhbXG4gICAgICAgICAgICAgICAgYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0Lm1vZGlmaWVyLnVuaW9uKFtcbiAgICAgICAgICAgICAgICAgICAgYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmdlbmVyYXRvci5hdG9tR3JvdXBzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdjaGFpbi10ZXN0JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmFtbXAoJ29iamVjdFByaW1pdGl2ZScpLCAnYXRvbWlzdGljJ10pLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc2lkdWUtdGVzdCc6IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmNvcmUucmVsLmdyKFtwcm9wXzEuUXVhbGl0eUFzc2Vzc21lbnQuc3ltYm9scy5wTEREVC5zeW1ib2woKSwgc2NvcmVdKSxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgXSlcbiAgICAgICAgXSk7XG4gICAgICAgIHZhciBxdWVyeSA9ICgwLCBjb21waWxlcl8xLmNvbXBpbGUpKHF1ZXJ5RXhwKTtcbiAgICAgICAgdmFyIHNlbCA9IHF1ZXJ5KG5ldyBzdHJ1Y3R1cmVfMS5RdWVyeUNvbnRleHQoY29udGV4dERhdGEpKTtcbiAgICAgICAgcmV0dXJuIHN0cnVjdHVyZV8xLlN0cnVjdHVyZVNlbGVjdGlvbi50b0xvY2lXaXRoU291cmNlVW5pdHMoc2VsKTtcbiAgICB9XG4gICAgQWxwaGFmb2xkVmlldy5nZXRMb2NpQnlQTEREVCA9IGdldExvY2lCeVBMRERUO1xufSkoQWxwaGFmb2xkVmlldyA9IGV4cG9ydHMuQWxwaGFmb2xkVmlldyB8fCAoZXhwb3J0cy5BbHBoYWZvbGRWaWV3ID0ge30pKTtcbnZhciBTdGF0ZUVsZW1lbnRzO1xuKGZ1bmN0aW9uIChTdGF0ZUVsZW1lbnRzKSB7XG4gICAgU3RhdGVFbGVtZW50c1tcIk1vZGVsXCJdID0gXCJtb2RlbFwiO1xuICAgIFN0YXRlRWxlbWVudHNbXCJNb2RlbFByb3BzXCJdID0gXCJtb2RlbC1wcm9wc1wiO1xuICAgIFN0YXRlRWxlbWVudHNbXCJBc3NlbWJseVwiXSA9IFwiYXNzZW1ibHlcIjtcbiAgICBTdGF0ZUVsZW1lbnRzW1wiVm9sdW1lU3RyZWFtaW5nXCJdID0gXCJ2b2x1bWUtc3RyZWFtaW5nXCI7XG4gICAgU3RhdGVFbGVtZW50c1tcIlNlcXVlbmNlXCJdID0gXCJzZXF1ZW5jZVwiO1xuICAgIFN0YXRlRWxlbWVudHNbXCJTZXF1ZW5jZVZpc3VhbFwiXSA9IFwic2VxdWVuY2UtdmlzdWFsXCI7XG4gICAgU3RhdGVFbGVtZW50c1tcIkhldFwiXSA9IFwiaGV0XCI7XG4gICAgU3RhdGVFbGVtZW50c1tcIkhldFZpc3VhbFwiXSA9IFwiaGV0LXZpc3VhbFwiO1xuICAgIFN0YXRlRWxlbWVudHNbXCJIZXQzRFNORkdcIl0gPSBcImhldC0zZHNuZmdcIjtcbiAgICBTdGF0ZUVsZW1lbnRzW1wiV2F0ZXJcIl0gPSBcIndhdGVyXCI7XG4gICAgU3RhdGVFbGVtZW50c1tcIldhdGVyVmlzdWFsXCJdID0gXCJ3YXRlci12aXN1YWxcIjtcbiAgICBTdGF0ZUVsZW1lbnRzW1wiSGV0R3JvdXBGb2N1c1wiXSA9IFwiaGV0LWdyb3VwLWZvY3VzXCI7XG4gICAgU3RhdGVFbGVtZW50c1tcIkhldEdyb3VwRm9jdXNHcm91cFwiXSA9IFwiaGV0LWdyb3VwLWZvY3VzLWdyb3VwXCI7XG59KShTdGF0ZUVsZW1lbnRzID0gZXhwb3J0cy5TdGF0ZUVsZW1lbnRzIHx8IChleHBvcnRzLlN0YXRlRWxlbWVudHMgPSB7fSkpO1xudmFyIExpZ2FuZFZpZXc7XG4oZnVuY3Rpb24gKExpZ2FuZFZpZXcpIHtcbiAgICBmdW5jdGlvbiBxdWVyeShsaWdhbmRWaWV3UGFyYW1zKSB7XG4gICAgICAgIHZhciBhdG9tR3JvdXBzUGFyYW1zID0ge1xuICAgICAgICAgICAgJ2dyb3VwLWJ5JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5zdHIuY29uY2F0KFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5LmNvcmUub3BlcmF0b3JOYW1lKCksIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIucmVzaWR1ZUtleSgpXSlcbiAgICAgICAgfTtcbiAgICAgICAgLy8gUmVzaWR1ZSBQYXJhbVxuICAgICAgICB2YXIgcmVzaWR1ZVBhcmFtO1xuICAgICAgICBpZiAobGlnYW5kVmlld1BhcmFtcy5hdXRoX3NlcV9pZCkge1xuICAgICAgICAgICAgcmVzaWR1ZVBhcmFtID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIuYXV0aF9zZXFfaWQoKSwgbGlnYW5kVmlld1BhcmFtcy5hdXRoX3NlcV9pZF0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxpZ2FuZFZpZXdQYXJhbXMubGFiZWxfY29tcF9pZCkge1xuICAgICAgICAgICAgcmVzaWR1ZVBhcmFtID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIubGFiZWxfY29tcF9pZCgpLCBsaWdhbmRWaWV3UGFyYW1zLmxhYmVsX2NvbXBfaWRdKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzaWR1ZVBhcmFtKVxuICAgICAgICAgICAgYXRvbUdyb3Vwc1BhcmFtc1sncmVzaWR1ZS10ZXN0J10gPSByZXNpZHVlUGFyYW07XG4gICAgICAgIC8vIENoYWluIFBhcmFtXG4gICAgICAgIGlmIChsaWdhbmRWaWV3UGFyYW1zLmF1dGhfYXN5bV9pZCkge1xuICAgICAgICAgICAgYXRvbUdyb3Vwc1BhcmFtc1snY2hhaW4tdGVzdCddID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIuYXV0aF9hc3ltX2lkKCksIGxpZ2FuZFZpZXdQYXJhbXMuYXV0aF9hc3ltX2lkXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobGlnYW5kVmlld1BhcmFtcy5zdHJ1Y3RfYXN5bV9pZCkge1xuICAgICAgICAgICAgYXRvbUdyb3Vwc1BhcmFtc1snY2hhaW4tdGVzdCddID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIubGFiZWxfYXN5bV9pZCgpLCBsaWdhbmRWaWV3UGFyYW1zLnN0cnVjdF9hc3ltX2lkXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ29uc3RydWN0IGNvcmUgcXVlcnlcbiAgICAgICAgdmFyIGNvcmUgPSBsaWdhbmRWaWV3UGFyYW1zLnNob3dfYWxsID9cbiAgICAgICAgICAgIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5nZW5lcmF0b3IuYXRvbUdyb3VwcyhhdG9tR3JvdXBzUGFyYW1zKSA6XG4gICAgICAgICAgICBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZmlsdGVyLmZpcnN0KFtcbiAgICAgICAgICAgICAgICBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZ2VuZXJhdG9yLmF0b21Hcm91cHMoYXRvbUdyb3Vwc1BhcmFtcylcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAvLyBDb25zdHJ1Y3Qgc3Vycm91bmRpbmdzIHF1ZXJ5XG4gICAgICAgIHZhciBzdXJyb3VuZGluZ3MgPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QubW9kaWZpZXIuaW5jbHVkZVN1cnJvdW5kaW5ncyh7IDA6IGNvcmUsIHJhZGl1czogNSwgJ2FzLXdob2xlLXJlc2lkdWVzJzogdHJ1ZSB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvcmU6IGNvcmUsXG4gICAgICAgICAgICBzdXJyb3VuZGluZ3M6IHN1cnJvdW5kaW5nc1xuICAgICAgICB9O1xuICAgIH1cbiAgICBMaWdhbmRWaWV3LnF1ZXJ5ID0gcXVlcnk7XG4gICAgZnVuY3Rpb24gYnJhbmNoZWRRdWVyeShwYXJhbXMpIHtcbiAgICAgICAgdmFyIGVudGl0eU9iakFycmF5ID0gW107XG4gICAgICAgIHBhcmFtcy5hdG9tX3NpdGUuZm9yRWFjaChmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIHZhciBxRW50aXRpZXMgPSB7XG4gICAgICAgICAgICAgICAgJ2dyb3VwLWJ5JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5zdHIuY29uY2F0KFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5LmNvcmUub3BlcmF0b3JOYW1lKCksIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIucmVzaWR1ZUtleSgpXSksXG4gICAgICAgICAgICAgICAgJ3Jlc2lkdWUtdGVzdCc6IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmNvcmUucmVsLmVxKFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5Lm1hY3JvbW9sZWN1bGFyLmF1dGhfc2VxX2lkKCksIHBhcmFtLmF1dGhfc2VxX2lkXSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlbnRpdHlPYmpBcnJheS5wdXNoKHFFbnRpdGllcyk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgYXRtR3JvdXBzUXVlcmllcyA9IFtdO1xuICAgICAgICBlbnRpdHlPYmpBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChlbnRpdHlPYmopIHtcbiAgICAgICAgICAgIGF0bUdyb3Vwc1F1ZXJpZXMucHVzaChidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZ2VuZXJhdG9yLmF0b21Hcm91cHMoZW50aXR5T2JqKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgY29yZSA9IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5tb2RpZmllci51bmlvbihbXG4gICAgICAgICAgICBhdG1Hcm91cHNRdWVyaWVzLmxlbmd0aCA9PT0gMVxuICAgICAgICAgICAgICAgID8gYXRtR3JvdXBzUXVlcmllc1swXVxuICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gdW5pb24gYmVmb3JlIG1lcmdlIGZvciBmYXN0IHBlcmZvcm1hbmNlXG4gICAgICAgICAgICAgICAgOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuY29tYmluYXRvci5tZXJnZShhdG1Hcm91cHNRdWVyaWVzLm1hcChmdW5jdGlvbiAocSkgeyByZXR1cm4gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0Lm1vZGlmaWVyLnVuaW9uKFtxXSk7IH0pKVxuICAgICAgICBdKTtcbiAgICAgICAgLy8gQ29uc3RydWN0IHN1cnJvdW5kaW5ncyBxdWVyeVxuICAgICAgICB2YXIgc3Vycm91bmRpbmdzID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0Lm1vZGlmaWVyLmluY2x1ZGVTdXJyb3VuZGluZ3MoeyAwOiBjb3JlLCByYWRpdXM6IDUsICdhcy13aG9sZS1yZXNpZHVlcyc6IHRydWUgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb3JlOiBjb3JlLFxuICAgICAgICAgICAgc3Vycm91bmRpbmdzOiBzdXJyb3VuZGluZ3NcbiAgICAgICAgfTtcbiAgICB9XG4gICAgTGlnYW5kVmlldy5icmFuY2hlZFF1ZXJ5ID0gYnJhbmNoZWRRdWVyeTtcbn0pKExpZ2FuZFZpZXcgPSBleHBvcnRzLkxpZ2FuZFZpZXcgfHwgKGV4cG9ydHMuTGlnYW5kVmlldyA9IHt9KSk7XG52YXIgUXVlcnlIZWxwZXI7XG4oZnVuY3Rpb24gKFF1ZXJ5SGVscGVyKSB7XG4gICAgZnVuY3Rpb24gZ2V0UXVlcnlPYmplY3QocGFyYW1zLCBjb250ZXh0RGF0YSkge1xuICAgICAgICB2YXIgc2VsZWN0aW9ucyA9IFtdO1xuICAgICAgICB2YXIgc2lmdE1hcHBpbmdzO1xuICAgICAgICB2YXIgY3VycmVudEFjY2Vzc2lvbjtcbiAgICAgICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0aW9uID0ge307XG4gICAgICAgICAgICAvLyBlbnRpdHlcbiAgICAgICAgICAgIGlmIChwYXJhbS5lbnRpdHlfaWQpXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydlbnRpdHlUZXN0J10gPSBmdW5jdGlvbiAobCkgeyByZXR1cm4gc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5lbnRpdHkuaWQobC5lbGVtZW50KSA9PT0gcGFyYW0uZW50aXR5X2lkOyB9O1xuICAgICAgICAgICAgLy8gY2hhaW5cbiAgICAgICAgICAgIGlmIChwYXJhbS5zdHJ1Y3RfYXN5bV9pZCkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvblsnY2hhaW5UZXN0J10gPSBmdW5jdGlvbiAobCkgeyByZXR1cm4gc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5jaGFpbi5sYWJlbF9hc3ltX2lkKGwuZWxlbWVudCkgPT09IHBhcmFtLnN0cnVjdF9hc3ltX2lkOyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyYW0uYXV0aF9hc3ltX2lkKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydjaGFpblRlc3QnXSA9IGZ1bmN0aW9uIChsKSB7IHJldHVybiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLmNoYWluLmF1dGhfYXN5bV9pZChsLmVsZW1lbnQpID09PSBwYXJhbS5hdXRoX2FzeW1faWQ7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyByZXNpZHVlc1xuICAgICAgICAgICAgaWYgKHBhcmFtLmxhYmVsX2NvbXBfaWQpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb25bJ3Jlc2lkdWVUZXN0J10gPSBmdW5jdGlvbiAobCkgeyByZXR1cm4gc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5hdG9tLmxhYmVsX2NvbXBfaWQobC5lbGVtZW50KSA9PT0gcGFyYW0ubGFiZWxfY29tcF9pZDsgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtLnVuaXByb3RfYWNjZXNzaW9uICYmIHBhcmFtLnVuaXByb3RfcmVzaWR1ZV9udW1iZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb25bJ3Jlc2lkdWVUZXN0J10gPSBmdW5jdGlvbiAobCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNpZnRNYXBwaW5ncyB8fCBjdXJyZW50QWNjZXNzaW9uICE9PSBwYXJhbS51bmlwcm90X2FjY2Vzc2lvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2lmdE1hcHBpbmdzID0gc2lmdHNfbWFwcGluZ18xLlNJRlRTTWFwcGluZy5Qcm92aWRlci5nZXQoY29udGV4dERhdGEubW9kZWxzWzBdKS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBY2Nlc3Npb24gPSBwYXJhbS51bmlwcm90X2FjY2Vzc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgckkgPSBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLnJlc2lkdWUua2V5KGwuZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJhbS51bmlwcm90X2FjY2Vzc2lvbiA9PT0gc2lmdE1hcHBpbmdzLmFjY2Vzc2lvbltySV0gJiYgcGFyYW0udW5pcHJvdF9yZXNpZHVlX251bWJlciA9PT0gK3NpZnRNYXBwaW5ncy5udW1bckldO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJhbS51bmlwcm90X2FjY2Vzc2lvbiAmJiBwYXJhbS5zdGFydF91bmlwcm90X3Jlc2lkdWVfbnVtYmVyICYmIHBhcmFtLmVuZF91bmlwcm90X3Jlc2lkdWVfbnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydyZXNpZHVlVGVzdCddID0gZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzaWZ0TWFwcGluZ3MgfHwgY3VycmVudEFjY2Vzc2lvbiAhPT0gcGFyYW0udW5pcHJvdF9hY2Nlc3Npb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZnRNYXBwaW5ncyA9IHNpZnRzX21hcHBpbmdfMS5TSUZUU01hcHBpbmcuUHJvdmlkZXIuZ2V0KGNvbnRleHREYXRhLm1vZGVsc1swXSkudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50QWNjZXNzaW9uID0gcGFyYW0udW5pcHJvdF9hY2Nlc3Npb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJJID0gc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5yZXNpZHVlLmtleShsLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW0udW5pcHJvdF9hY2Nlc3Npb24gPT09IHNpZnRNYXBwaW5ncy5hY2Nlc3Npb25bckldICYmIChwYXJhbS5zdGFydF91bmlwcm90X3Jlc2lkdWVfbnVtYmVyIDw9ICtzaWZ0TWFwcGluZ3MubnVtW3JJXSAmJiBwYXJhbS5lbmRfdW5pcHJvdF9yZXNpZHVlX251bWJlciA+PSArc2lmdE1hcHBpbmdzLm51bVtySV0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJhbS5yZXNpZHVlX251bWJlcikge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvblsncmVzaWR1ZVRlc3QnXSA9IGZ1bmN0aW9uIChsKSB7IHJldHVybiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLnJlc2lkdWUubGFiZWxfc2VxX2lkKGwuZWxlbWVudCkgPT09IHBhcmFtLnJlc2lkdWVfbnVtYmVyOyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKHBhcmFtLnN0YXJ0X3Jlc2lkdWVfbnVtYmVyICYmIHBhcmFtLmVuZF9yZXNpZHVlX251bWJlcikgJiYgKHBhcmFtLmVuZF9yZXNpZHVlX251bWJlciA+IHBhcmFtLnN0YXJ0X3Jlc2lkdWVfbnVtYmVyKSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvblsncmVzaWR1ZVRlc3QnXSA9IGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbFNlcUlkID0gc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5yZXNpZHVlLmxhYmVsX3NlcV9pZChsLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGFiZWxTZXFJZCA+PSBwYXJhbS5zdGFydF9yZXNpZHVlX251bWJlciAmJiBsYWJlbFNlcUlkIDw9IHBhcmFtLmVuZF9yZXNpZHVlX251bWJlcjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKHBhcmFtLnN0YXJ0X3Jlc2lkdWVfbnVtYmVyICYmIHBhcmFtLmVuZF9yZXNpZHVlX251bWJlcikgJiYgKHBhcmFtLmVuZF9yZXNpZHVlX251bWJlciA9PT0gcGFyYW0uc3RhcnRfcmVzaWR1ZV9udW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydyZXNpZHVlVGVzdCddID0gZnVuY3Rpb24gKGwpIHsgcmV0dXJuIHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMucmVzaWR1ZS5sYWJlbF9zZXFfaWQobC5lbGVtZW50KSA9PT0gcGFyYW0uc3RhcnRfcmVzaWR1ZV9udW1iZXI7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJhbS5hdXRoX3NlcV9pZCkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvblsncmVzaWR1ZVRlc3QnXSA9IGZ1bmN0aW9uIChsKSB7IHJldHVybiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLnJlc2lkdWUuYXV0aF9zZXFfaWQobC5lbGVtZW50KSA9PT0gcGFyYW0uYXV0aF9zZXFfaWQ7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJhbS5hdXRoX3Jlc2lkdWVfbnVtYmVyICYmICFwYXJhbS5hdXRoX2luc19jb2RlX2lkKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydyZXNpZHVlVGVzdCddID0gZnVuY3Rpb24gKGwpIHsgcmV0dXJuIHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMucmVzaWR1ZS5hdXRoX3NlcV9pZChsLmVsZW1lbnQpID09PSBwYXJhbS5hdXRoX3Jlc2lkdWVfbnVtYmVyOyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyYW0uYXV0aF9yZXNpZHVlX251bWJlciAmJiBwYXJhbS5hdXRoX2luc19jb2RlX2lkKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydyZXNpZHVlVGVzdCddID0gZnVuY3Rpb24gKGwpIHsgcmV0dXJuIHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMucmVzaWR1ZS5hdXRoX3NlcV9pZChsLmVsZW1lbnQpID09PSBwYXJhbS5hdXRoX3Jlc2lkdWVfbnVtYmVyOyB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKHBhcmFtLnN0YXJ0X2F1dGhfcmVzaWR1ZV9udW1iZXIgJiYgcGFyYW0uZW5kX2F1dGhfcmVzaWR1ZV9udW1iZXIpICYmIChwYXJhbS5lbmRfYXV0aF9yZXNpZHVlX251bWJlciA+IHBhcmFtLnN0YXJ0X2F1dGhfcmVzaWR1ZV9udW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uWydyZXNpZHVlVGVzdCddID0gZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF1dGhTZXFJZCA9IHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMucmVzaWR1ZS5hdXRoX3NlcV9pZChsLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXV0aFNlcUlkID49IHBhcmFtLnN0YXJ0X2F1dGhfcmVzaWR1ZV9udW1iZXIgJiYgYXV0aFNlcUlkIDw9IHBhcmFtLmVuZF9hdXRoX3Jlc2lkdWVfbnVtYmVyO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgocGFyYW0uc3RhcnRfYXV0aF9yZXNpZHVlX251bWJlciAmJiBwYXJhbS5lbmRfYXV0aF9yZXNpZHVlX251bWJlcikgJiYgKHBhcmFtLmVuZF9hdXRoX3Jlc2lkdWVfbnVtYmVyID09PSBwYXJhbS5zdGFydF9hdXRoX3Jlc2lkdWVfbnVtYmVyKSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvblsncmVzaWR1ZVRlc3QnXSA9IGZ1bmN0aW9uIChsKSB7IHJldHVybiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLnJlc2lkdWUuYXV0aF9zZXFfaWQobC5lbGVtZW50KSA9PT0gcGFyYW0uc3RhcnRfYXV0aF9yZXNpZHVlX251bWJlcjsgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGF0b21zXG4gICAgICAgICAgICBpZiAocGFyYW0uYXRvbXMpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3Rpb25bJ2F0b21UZXN0J10gPSBmdW5jdGlvbiAobCkgeyByZXR1cm4gcGFyYW0uYXRvbXMuaW5jbHVkZXMoc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5hdG9tLmxhYmVsX2F0b21faWQobC5lbGVtZW50KSk7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGFyYW0uYXRvbV9pZCkge1xuICAgICAgICAgICAgICAgIHNlbGVjdGlvblsnYXRvbVRlc3QnXSA9IGZ1bmN0aW9uIChsKSB7IHJldHVybiBwYXJhbS5hdG9tX2lkLmluY2x1ZGVzKHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMuYXRvbS5pZChsLmVsZW1lbnQpKTsgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGVjdGlvbnMucHVzaChzZWxlY3Rpb24pO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGF0bUdyb3Vwc1F1ZXJpZXMgPSBbXTtcbiAgICAgICAgc2VsZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGF0bUdyb3Vwc1F1ZXJpZXMucHVzaChzdHJ1Y3R1cmVfMi5RdWVyaWVzLmdlbmVyYXRvcnMuYXRvbXMoc2VsZWN0aW9uKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gc3RydWN0dXJlXzIuUXVlcmllcy5jb21iaW5hdG9ycy5tZXJnZShhdG1Hcm91cHNRdWVyaWVzKTtcbiAgICB9XG4gICAgUXVlcnlIZWxwZXIuZ2V0UXVlcnlPYmplY3QgPSBnZXRRdWVyeU9iamVjdDtcbiAgICBmdW5jdGlvbiBnZXRJbnRlcmFjdGl2aXR5TG9jaShwYXJhbXMsIGNvbnRleHREYXRhKSB7XG4gICAgICAgIHZhciBzZWwgPSBxdWVyeV8xLlN0cnVjdHVyZVF1ZXJ5LnJ1bihRdWVyeUhlbHBlci5nZXRRdWVyeU9iamVjdChwYXJhbXMsIGNvbnRleHREYXRhKSwgY29udGV4dERhdGEpO1xuICAgICAgICByZXR1cm4gc3RydWN0dXJlXzEuU3RydWN0dXJlU2VsZWN0aW9uLnRvTG9jaVdpdGhTb3VyY2VVbml0cyhzZWwpO1xuICAgIH1cbiAgICBRdWVyeUhlbHBlci5nZXRJbnRlcmFjdGl2aXR5TG9jaSA9IGdldEludGVyYWN0aXZpdHlMb2NpO1xuICAgIGZ1bmN0aW9uIGdldEhldExvY2kocXVlcnlFeHAsIGNvbnRleHREYXRhKSB7XG4gICAgICAgIHZhciBxdWVyeSA9ICgwLCBjb21waWxlcl8xLmNvbXBpbGUpKHF1ZXJ5RXhwKTtcbiAgICAgICAgdmFyIHNlbCA9IHF1ZXJ5KG5ldyBzdHJ1Y3R1cmVfMS5RdWVyeUNvbnRleHQoY29udGV4dERhdGEpKTtcbiAgICAgICAgcmV0dXJuIHN0cnVjdHVyZV8xLlN0cnVjdHVyZVNlbGVjdGlvbi50b0xvY2lXaXRoU291cmNlVW5pdHMoc2VsKTtcbiAgICB9XG4gICAgUXVlcnlIZWxwZXIuZ2V0SGV0TG9jaSA9IGdldEhldExvY2k7XG59KShRdWVyeUhlbHBlciA9IGV4cG9ydHMuUXVlcnlIZWxwZXIgfHwgKGV4cG9ydHMuUXVlcnlIZWxwZXIgPSB7fSkpO1xudmFyIE1vZGVsSW5mbzI7XG4oZnVuY3Rpb24gKE1vZGVsSW5mbzIpIHtcbiAgICBmdW5jdGlvbiBnZXRQcmVmZXJyZWRBc3NlbWJseShjdHgsIG1vZGVsKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlkLCBzcmMsIGpzb24sIGRhdGEsIGFzc2VtYmxpZXMsIF9pLCBhc3NlbWJsaWVzXzEsIGFzbSwgZV8xO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuZW50cnlJZC5sZW5ndGggPD0gMylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdm9pZCAwXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gbW9kZWwuZW50cnlJZC50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY3R4LnJ1blRhc2soY3R4LmZldGNoKHsgdXJsOiBcImh0dHBzOi8vd3d3LmViaS5hYy51ay9wZGJlL2FwaS9wZGIvZW50cnkvc3VtbWFyeS9cIi5jb25jYXQoaWQpIH0pKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGpzb24gPSBKU09OLnBhcnNlKHNyYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0ganNvbiAmJiBqc29uW2lkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VtYmxpZXMgPSBkYXRhWzBdICYmIGRhdGFbMF0uYXNzZW1ibGllcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYXNzZW1ibGllcyB8fCAhYXNzZW1ibGllcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHZvaWQgMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgYXNzZW1ibGllc18xID0gYXNzZW1ibGllczsgX2kgPCBhc3NlbWJsaWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNtID0gYXNzZW1ibGllc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNtLnByZWZlcnJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgYXNtLmFzc2VtYmx5X2lkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdm9pZCAwXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdnZXRQcmVmZXJyZWRBc3NlbWJseScsIGVfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXQoY3R4LCBtb2RlbCwgY2hlY2tQcmVmZXJyZWQpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzaWR1ZUNvdW50LCByZXNpZHVlT2Zmc2V0cywgY2hhaW5JbmRleCwgcHJlZiwgaGV0UmVzaWR1ZXMsIGhldE1hcCwgckksIGNJLCBlSSwgZW50aXR5VHlwZSwgY29tcF9pZCwgbGlnLCBwcmVmZXJyZWRBc3NlbWJseUlkLCBzeW1tZXRyeTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzaWR1ZUNvdW50ID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LnJlc2lkdWVzLl9yb3dDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2lkdWVPZmZzZXRzID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LnJlc2lkdWVBdG9tU2VnbWVudHMub2Zmc2V0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluSW5kZXggPSBtb2RlbC5hdG9taWNIaWVyYXJjaHkuY2hhaW5BdG9tU2VnbWVudHMuaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVmID0gY2hlY2tQcmVmZXJyZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGdldFByZWZlcnJlZEFzc2VtYmx5KGN0eCwgbW9kZWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZXRSZXNpZHVlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGV0TWFwID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChySSA9IDA7IHJJIDwgcmVzaWR1ZUNvdW50OyBySSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY0kgPSBjaGFpbkluZGV4W3Jlc2lkdWVPZmZzZXRzW3JJXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZUkgPSBtb2RlbC5hdG9taWNIaWVyYXJjaHkuaW5kZXguZ2V0RW50aXR5RnJvbUNoYWluKGNJKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHlUeXBlID0gbW9kZWwuZW50aXRpZXMuZGF0YS50eXBlLnZhbHVlKGVJKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW50aXR5VHlwZSAhPT0gJ25vbi1wb2x5bWVyJyAmJiBlbnRpdHlUeXBlICE9PSAnYnJhbmNoZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wX2lkID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LmF0b21zLmxhYmVsX2NvbXBfaWQudmFsdWUocmVzaWR1ZU9mZnNldHNbckldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWcgPSBoZXRNYXAuZ2V0KGNvbXBfaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZyA9IHsgbmFtZTogY29tcF9pZCwgaW5kaWNlczogW10gfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0UmVzaWR1ZXMucHVzaChsaWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXRNYXAuc2V0KGNvbXBfaWQsIGxpZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZy5pbmRpY2VzLnB1c2gockkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcHJlZl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWZlcnJlZEFzc2VtYmx5SWQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeW1tZXRyeSA9IHN5bW1ldHJ5XzEuTW9kZWxTeW1tZXRyeS5Qcm92aWRlci5nZXQobW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0UmVzaWR1ZXM6IGhldFJlc2lkdWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NlbWJsaWVzOiBzeW1tZXRyeSA/IHN5bW1ldHJ5LmFzc2VtYmxpZXMubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiAoeyBpZDogYS5pZCwgZGV0YWlsczogYS5kZXRhaWxzLCBpc1ByZWZlcnJlZDogYS5pZCA9PT0gcHJlZmVycmVkQXNzZW1ibHlJZCB9KTsgfSkgOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZmVycmVkQXNzZW1ibHlJZDogcHJlZmVycmVkQXNzZW1ibHlJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgTW9kZWxJbmZvMi5nZXQgPSBnZXQ7XG59KShNb2RlbEluZm8yID0gZXhwb3J0cy5Nb2RlbEluZm8yIHx8IChleHBvcnRzLk1vZGVsSW5mbzIgPSB7fSkpO1xudmFyIE1vZGVsSW5mbztcbihmdW5jdGlvbiAoTW9kZWxJbmZvKSB7XG4gICAgZnVuY3Rpb24gZ2V0KG1vZGVsLCBzdHJ1Y3R1cmVzKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc2lkdWVDb3VudCwgcmVzaWR1ZU9mZnNldHMsIGNoYWluSW5kZXgsIGhldE5hbWVzLCBjYXJiRW50aXR5Q291bnQsIHJJLCBjSSwgZUksIGVudGl0eVR5cGUsIGNvbXBfaWQ7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICByZXNpZHVlQ291bnQgPSBtb2RlbC5hdG9taWNIaWVyYXJjaHkucmVzaWR1ZXMuX3Jvd0NvdW50O1xuICAgICAgICAgICAgICAgIHJlc2lkdWVPZmZzZXRzID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LnJlc2lkdWVBdG9tU2VnbWVudHMub2Zmc2V0cztcbiAgICAgICAgICAgICAgICBjaGFpbkluZGV4ID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LmNoYWluQXRvbVNlZ21lbnRzLmluZGV4O1xuICAgICAgICAgICAgICAgIGhldE5hbWVzID0gW107XG4gICAgICAgICAgICAgICAgY2FyYkVudGl0eUNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKHJJID0gMDsgckkgPCByZXNpZHVlQ291bnQ7IHJJKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY0kgPSBjaGFpbkluZGV4W3Jlc2lkdWVPZmZzZXRzW3JJXV07XG4gICAgICAgICAgICAgICAgICAgIGVJID0gbW9kZWwuYXRvbWljSGllcmFyY2h5LmluZGV4LmdldEVudGl0eUZyb21DaGFpbihjSSk7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eVR5cGUgPSBtb2RlbC5lbnRpdGllcy5kYXRhLnR5cGUudmFsdWUoZUkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW50aXR5VHlwZSAhPT0gJ25vbi1wb2x5bWVyJyAmJiBlbnRpdHlUeXBlICE9PSAnYnJhbmNoZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBfaWQgPSBtb2RlbC5hdG9taWNIaWVyYXJjaHkuYXRvbXMubGFiZWxfY29tcF9pZC52YWx1ZShyZXNpZHVlT2Zmc2V0c1tySV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW50aXR5VHlwZSA9PT0gJ2JyYW5jaGVkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FyYkVudGl0eUNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGV0TmFtZXMuaW5kZXhPZihjb21wX2lkKSA9PT0gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0TmFtZXMucHVzaChjb21wX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGV0TmFtZXM6IGhldE5hbWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FyYkVudGl0eUNvdW50OiBjYXJiRW50aXR5Q291bnRcbiAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIE1vZGVsSW5mby5nZXQgPSBnZXQ7XG59KShNb2RlbEluZm8gPSBleHBvcnRzLk1vZGVsSW5mbyB8fCAoZXhwb3J0cy5Nb2RlbEluZm8gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aGVscGVycy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/helpers.js\n");
  
  /***/ }),
  
  /***/ "./lib/index.js":
  /*!**********************!*\
    !*** ./lib/index.js ***!
    \**********************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar spec_1 = __webpack_require__(/*! ./spec */ \"./lib/spec.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar loci_1 = __webpack_require__(/*! Molstar/mol-model/loci */ \"./node_modules/molstar/lib/mol-model/loci.js\");\nvar rx_event_helper_1 = __webpack_require__(/*! Molstar/mol-util/rx-event-helper */ \"./node_modules/molstar/lib/mol-util/rx-event-helper.js\");\nvar helpers_1 = __webpack_require__(/*! ./helpers */ \"./lib/helpers.js\");\nvar pdbe_structure_controls_1 = __webpack_require__(/*! ./ui/pdbe-structure-controls */ \"./lib/ui/pdbe-structure-controls.js\");\nvar pdbe_viewport_controls_1 = __webpack_require__(/*! ./ui/pdbe-viewport-controls */ \"./lib/ui/pdbe-viewport-controls.js\");\nvar mol_state_2 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar structure_focus_representation_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior/dynamic/selection/structure-focus-representation */ \"./node_modules/molstar/lib/mol-plugin/behavior/dynamic/selection/structure-focus-representation.js\");\nvar spec_2 = __webpack_require__(/*! Molstar/mol-plugin/spec */ \"./node_modules/molstar/lib/mol-plugin/spec.js\");\nvar transformers_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior/dynamic/volume-streaming/transformers */ \"./node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/transformers.js\");\nvar structure_representation_params_1 = __webpack_require__(/*! Molstar/mol-plugin-state/helpers/structure-representation-params */ \"./node_modules/molstar/lib/mol-plugin-state/helpers/structure-representation-params.js\");\nvar subscribe_events_1 = __webpack_require__(/*! ./subscribe-events */ \"./lib/subscribe-events.js\");\nvar pdbe_left_panel_1 = __webpack_require__(/*! ./ui/pdbe-left-panel */ \"./lib/ui/pdbe-left-panel.js\");\nvar superposition_1 = __webpack_require__(/*! ./superposition */ \"./lib/superposition.js\");\nvar custom_events_1 = __webpack_require__(/*! ./custom-events */ \"./lib/custom-events.js\");\nvar assets_1 = __webpack_require__(/*! Molstar/mol-util/assets */ \"./node_modules/molstar/lib/mol-util/assets.js\");\nvar config_1 = __webpack_require__(/*! Molstar/mol-plugin/config */ \"./node_modules/molstar/lib/mol-plugin/config.js\");\nvar color_1 = __webpack_require__(/*! Molstar/mol-util/color/color */ \"./node_modules/molstar/lib/mol-util/color/color.js\");\nvar component_1 = __webpack_require__(/*! Molstar/mol-plugin-state/manager/structure/component */ \"./node_modules/molstar/lib/mol-plugin-state/manager/structure/component.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar behavior_1 = __webpack_require__(/*! ./domain-annotations/behavior */ \"./lib/domain-annotations/behavior.js\");\nvar pdbe_1 = __webpack_require__(/*! Molstar/extensions/pdbe */ \"./node_modules/molstar/lib/extensions/pdbe/index.js\");\nvar behavior_2 = __webpack_require__(/*! Molstar/extensions/model-archive/quality-assessment/behavior */ \"./node_modules/molstar/lib/extensions/model-archive/quality-assessment/behavior.js\");\nvar structure_overpaint_1 = __webpack_require__(/*! Molstar/mol-plugin-state/helpers/structure-overpaint */ \"./node_modules/molstar/lib/mol-plugin-state/helpers/structure-overpaint.js\");\nvar superposition_focus_representation_1 = __webpack_require__(/*! ./superposition-focus-representation */ \"./lib/superposition-focus-representation.js\");\nvar superposition_viewport_1 = __webpack_require__(/*! ./ui/superposition-viewport */ \"./lib/ui/superposition-viewport.js\");\nvar representation_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior/dynamic/representation */ \"./node_modules/molstar/lib/mol-plugin/behavior/dynamic/representation.js\");\nvar camera_1 = __webpack_require__(/*! molstar/lib/mol-plugin/behavior/dynamic/camera */ \"./node_modules/molstar/lib/mol-plugin/behavior/dynamic/camera.js\");\nvar mp4_export_1 = __webpack_require__(/*! Molstar/extensions/mp4-export */ \"./node_modules/molstar/lib/extensions/mp4-export/index.js\");\nvar geo_export_1 = __webpack_require__(/*! Molstar/extensions/geo-export */ \"./node_modules/molstar/lib/extensions/geo-export/index.js\");\nvar element_symbol_1 = __webpack_require__(/*! Molstar/mol-theme/color/element-symbol */ \"./node_modules/molstar/lib/mol-theme/color/element-symbol.js\");\nvar model_index_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/model-index */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/model-index.js\");\nvar camera_spin_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/camera-spin */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/camera-spin.js\");\nvar state_snapshots_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/state-snapshots */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/state-snapshots.js\");\nvar state_interpolation_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/state-interpolation */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/state-interpolation.js\");\nvar spin_structure_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/spin-structure */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/spin-structure.js\");\nvar camera_rock_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/camera-rock */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/camera-rock.js\");\nvar assembly_unwind_1 = __webpack_require__(/*! Molstar/mol-plugin-state/animation/built-in/assembly-unwind */ \"./node_modules/molstar/lib/mol-plugin-state/animation/built-in/assembly-unwind.js\");\n//import { ModelInfo2, StateElements } from './helpers';\nvar annotation_1 = __webpack_require__(/*! ./annotation */ \"./lib/annotation.js\");\nvar annotation_2 = __webpack_require__(/*! ./annotation */ \"./lib/annotation.js\");\n//import { ModelInfo2, StateElements, RepresentationStyle } from './helpers';\nvar helpers_2 = __webpack_require__(/*! ./helpers */ \"./lib/helpers.js\");\n//import { StateElements } from './helpers';\n//import { StateElements, RepresentationStyle } from './helpers';\nvar transforms_1 = __webpack_require__(/*! Molstar/mol-plugin-state/transforms */ \"./node_modules/molstar/lib/mol-plugin-state/transforms.js\");\n__webpack_require__(/*! Molstar/mol-plugin-ui/skin/dark.scss */ \"./node_modules/molstar/lib/mol-plugin-ui/skin/dark.scss\");\nvar PDBeMolstarPlugin = /** @class */ (function () {\n    function PDBeMolstarPlugin() {\n        var _this = this;\n        this._ev = rx_event_helper_1.RxEventHelper.create();\n        this.events = {\n            loadComplete: this._ev(),\n            modelInfo: this._ev()\n        };\n        this.assemblyRef = '';\n        this.isHighlightColorUpdated = false;\n        this.isSelectedColorUpdated = false;\n        this.applyVisualParams = function () {\n            var TagRefs = {\n                'structure-component-static-polymer': 'polymer',\n                'structure-component-static-ligand': 'het',\n                'structure-component-static-branched': 'carbs',\n                'structure-component-static-water': 'water',\n                'structure-component-static-coarse': 'coarse',\n                'non-standard': 'nonStandard'\n            };\n            var componentGroups = _this.plugin.managers.structure.hierarchy.currentComponentGroups;\n            componentGroups.forEach(function (compGrp) {\n                var _a;\n                var compGrpIndex = compGrp.length - 1;\n                var key = compGrp[compGrpIndex].key;\n                var rm = false;\n                if (key && _this.initParams.hideStructure) {\n                    var structType = TagRefs[key];\n                    if (structType && ((_a = _this.initParams.hideStructure) === null || _a === void 0 ? void 0 : _a.indexOf(structType)) > -1)\n                        rm = true;\n                }\n                if (rm) {\n                    _this.plugin.managers.structure.hierarchy.remove([compGrp[compGrpIndex]]);\n                }\n                if (!rm && _this.initParams.visualStyle) {\n                    if (compGrp[compGrpIndex] && compGrp[compGrpIndex].representations) {\n                        compGrp[compGrpIndex].representations.forEach(function (rep) {\n                            var currentParams = (0, structure_representation_params_1.createStructureRepresentationParams)(_this.plugin, void 0, { type: _this.initParams.visualStyle });\n                            _this.plugin.managers.structure.component.updateRepresentations([compGrp[compGrpIndex]], rep, currentParams);\n                        });\n                    }\n                }\n            });\n        };\n        this.canvas = {\n            toggleControls: function (isVisible) {\n                if (typeof isVisible === 'undefined')\n                    isVisible = !_this.plugin.layout.state.showControls;\n                commands_1.PluginCommands.Layout.Update(_this.plugin, { state: { showControls: isVisible } });\n            },\n            toggleExpanded: function (isExpanded) {\n                if (typeof isExpanded === 'undefined')\n                    isExpanded = !_this.plugin.layout.state.isExpanded;\n                commands_1.PluginCommands.Layout.Update(_this.plugin, { state: { isExpanded: isExpanded } });\n            },\n            setBgColor: function (color) {\n                if (!color)\n                    return;\n                _this.canvas.applySettings({ color: color });\n            },\n            applySettings: function (settings) {\n                if (!settings)\n                    return;\n                var rendererParams = {};\n                if (settings.color)\n                    rendererParams['backgroundColor'] = color_1.Color.fromRgb(settings.color.r, settings.color.g, settings.color.b);\n                if (settings.lighting)\n                    rendererParams['style'] = { name: settings.lighting };\n                var renderer = _this.plugin.canvas3d.props.renderer;\n                commands_1.PluginCommands.Canvas3D.SetSettings(_this.plugin, { settings: { renderer: tslib_1.__assign(tslib_1.__assign({}, renderer), rendererParams) } });\n            }\n        };\n        this.coloring = {\n            shannonEntropy: function (params) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var state, tree, colorTheme;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!params || !params.keepStyle) {\n                                // await this.updateStyle({ sequence: { kind: 'spacefill' } }, true);\n                            }\n                            state = this.state;\n                            tree = state.build();\n                            colorTheme = { name: annotation_1.ShannonEntropy.propertyProvider.descriptor.name, params: this.plugin.representation.structure.themes.colorThemeRegistry.get(annotation_1.ShannonEntropy.propertyProvider.descriptor.name).defaultValues };\n                            if (!params || !!params.sequence) {\n                                tree.to(helpers_2.StateElements.SequenceVisual).update(transforms_1.StateTransforms.Representation.StructureRepresentation3D, function (old) { return (tslib_1.__assign(tslib_1.__assign({}, old), { colorTheme: colorTheme })); });\n                            }\n                            if (params && !!params.het) {\n                                tree.to(helpers_2.StateElements.HetVisual).update(transforms_1.StateTransforms.Representation.StructureRepresentation3D, function (old) { return (tslib_1.__assign(tslib_1.__assign({}, old), { colorTheme: colorTheme })); });\n                            }\n                            return [4 /*yield*/, commands_1.PluginCommands.State.Update(this.plugin, { state: state, tree: tree })];\n                        case 1:\n                            _a.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); },\n            twinCons: function (params) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var state, tree, colorTheme;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!params || !params.keepStyle) {\n                                // await this.updateStyle({ sequence: { kind: 'spacefill' } }, true);\n                            }\n                            state = this.state;\n                            tree = state.build();\n                            colorTheme = { name: annotation_2.TwinConsData.propertyProvider.descriptor.name, params: this.plugin.representation.structure.themes.colorThemeRegistry.get(annotation_2.TwinConsData.propertyProvider.descriptor.name).defaultValues };\n                            if (!params || !!params.sequence) {\n                                tree.to(helpers_2.StateElements.SequenceVisual).update(transforms_1.StateTransforms.Representation.StructureRepresentation3D, function (old) { return (tslib_1.__assign(tslib_1.__assign({}, old), { colorTheme: colorTheme })); });\n                            }\n                            if (params && !!params.het) {\n                                tree.to(helpers_2.StateElements.HetVisual).update(transforms_1.StateTransforms.Representation.StructureRepresentation3D, function (old) { return (tslib_1.__assign(tslib_1.__assign({}, old), { colorTheme: colorTheme })); });\n                            }\n                            return [4 /*yield*/, commands_1.PluginCommands.State.Update(this.plugin, { state: state, tree: tree })];\n                        case 1:\n                            _a.sent();\n                            return [2 /*return*/];\n                    }\n                });\n            }); }\n        };\n        this.visual = {\n            highlighting: function (params) {\n                var loci = _this.getLociForParams(params.data, params.structureNumber);\n                params.color = { r: 65, g: 96, b: 91 };\n                if (loci_1.Loci.isEmpty(loci))\n                    return;\n                if (params.color) {\n                    _this.visual.setColor({ highlight: params.color });\n                }\n                _this.plugin.managers.interactivity.lociHighlights.highlightOnly({ loci: loci });\n                if (params.focus)\n                    _this.plugin.managers.camera.focusLoci(loci);\n            },\n            clearHighlighting: function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                return tslib_1.__generator(this, function (_a) {\n                    this.plugin.managers.interactivity.lociHighlights.highlightOnly({ loci: loci_1.EmptyLoci });\n                    if (this.isHighlightColorUpdated)\n                        this.visual.reset({ highlightColor: true });\n                    return [2 /*return*/];\n                });\n            }); },\n            colorByChain: function (data) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var structureData, i, _a, structureData_1, structureData_1_1, s, color, e_1_1;\n                var _b, e_1, _c, _d;\n                return tslib_1.__generator(this, function (_e) {\n                    switch (_e.label) {\n                        case 0:\n                            structureData = this.plugin.managers.structure.hierarchy.current.structures;\n                            i = 0;\n                            _e.label = 1;\n                        case 1:\n                            _e.trys.push([1, 10, 11, 16]);\n                            _a = true, structureData_1 = tslib_1.__asyncValues(structureData);\n                            _e.label = 2;\n                        case 2: return [4 /*yield*/, structureData_1.next()];\n                        case 3:\n                            if (!(structureData_1_1 = _e.sent(), _b = structureData_1_1.done, !_b)) return [3 /*break*/, 9];\n                            _d = structureData_1_1.value;\n                            _a = false;\n                            _e.label = 4;\n                        case 4:\n                            _e.trys.push([4, , 7, 8]);\n                            s = _d;\n                            if (!(i > 0)) return [3 /*break*/, 6];\n                            color = data[i - 1];\n                            //await this.plugin.managers.structure.component.updateRepresentationsTheme(s.components, { color: 'uniform', colorParams: { value: this.normalizeColor(params.nonSelectedColor) } });\n                            return [4 /*yield*/, this.plugin.managers.structure.component.updateRepresentationsTheme(s.components, { color: 'uniform', colorParams: { value: this.normalizeColor(color) } })];\n                        case 5:\n                            //await this.plugin.managers.structure.component.updateRepresentationsTheme(s.components, { color: 'uniform', colorParams: { value: this.normalizeColor(params.nonSelectedColor) } });\n                            _e.sent();\n                            _e.label = 6;\n                        case 6:\n                            i += 1;\n                            return [3 /*break*/, 8];\n                        case 7:\n                            _a = true;\n                            return [7 /*endfinally*/];\n                        case 8: return [3 /*break*/, 2];\n                        case 9: return [3 /*break*/, 16];\n                        case 10:\n                            e_1_1 = _e.sent();\n                            e_1 = { error: e_1_1 };\n                            return [3 /*break*/, 16];\n                        case 11:\n                            _e.trys.push([11, , 14, 15]);\n                            if (!(!_a && !_b && (_c = structureData_1.return))) return [3 /*break*/, 13];\n                            return [4 /*yield*/, _c.call(structureData_1)];\n                        case 12:\n                            _e.sent();\n                            _e.label = 13;\n                        case 13: return [3 /*break*/, 15];\n                        case 14:\n                            if (e_1) throw e_1.error;\n                            return [7 /*endfinally*/];\n                        case 15: return [7 /*endfinally*/];\n                        case 16: return [2 /*return*/];\n                    }\n                });\n            }); },\n            select: function (params) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var structureData, _a, structureData_2, structureData_2_1, s, e_2_1, _b, _c, _d, param, loci, themeParams, colorValue, repr, defaultParams, defaultValues, values, structures, updatedStructureData, comps, lastCompsIndex, recentRepComp, uniformColor, e_3_1;\n                var _e, e_2, _f, _g, _h, e_3, _j, _k;\n                return tslib_1.__generator(this, function (_l) {\n                    switch (_l.label) {\n                        case 0:\n                            if (!this.selectedParams) return [3 /*break*/, 2];\n                            return [4 /*yield*/, this.visual.clearSelection(params.structureNumber)];\n                        case 1:\n                            _l.sent();\n                            _l.label = 2;\n                        case 2:\n                            structureData = this.plugin.managers.structure.hierarchy.current.structures;\n                            if (params.structureNumber) {\n                                structureData = [this.plugin.managers.structure.hierarchy.current.structures[params.structureNumber - 1]];\n                            }\n                            if (!params.nonSelectedColor) return [3 /*break*/, 17];\n                            _l.label = 3;\n                        case 3:\n                            _l.trys.push([3, 11, 12, 17]);\n                            _a = true, structureData_2 = tslib_1.__asyncValues(structureData);\n                            _l.label = 4;\n                        case 4: return [4 /*yield*/, structureData_2.next()];\n                        case 5:\n                            if (!(structureData_2_1 = _l.sent(), _e = structureData_2_1.done, !_e)) return [3 /*break*/, 10];\n                            _g = structureData_2_1.value;\n                            _a = false;\n                            _l.label = 6;\n                        case 6:\n                            _l.trys.push([6, , 8, 9]);\n                            s = _g;\n                            return [4 /*yield*/, this.plugin.managers.structure.component.updateRepresentationsTheme(s.components, { color: 'uniform', colorParams: { value: this.normalizeColor(params.nonSelectedColor) } })];\n                        case 7:\n                            _l.sent();\n                            return [3 /*break*/, 9];\n                        case 8:\n                            _a = true;\n                            return [7 /*endfinally*/];\n                        case 9: return [3 /*break*/, 4];\n                        case 10: return [3 /*break*/, 17];\n                        case 11:\n                            e_2_1 = _l.sent();\n                            e_2 = { error: e_2_1 };\n                            return [3 /*break*/, 17];\n                        case 12:\n                            _l.trys.push([12, , 15, 16]);\n                            if (!(!_a && !_e && (_f = structureData_2.return))) return [3 /*break*/, 14];\n                            return [4 /*yield*/, _f.call(structureData_2)];\n                        case 13:\n                            _l.sent();\n                            _l.label = 14;\n                        case 14: return [3 /*break*/, 16];\n                        case 15:\n                            if (e_2) throw e_2.error;\n                            return [7 /*endfinally*/];\n                        case 16: return [7 /*endfinally*/];\n                        case 17:\n                            _l.trys.push([17, 27, 28, 33]);\n                            _b = true, _c = tslib_1.__asyncValues(params.data);\n                            _l.label = 18;\n                        case 18: return [4 /*yield*/, _c.next()];\n                        case 19:\n                            if (!(_d = _l.sent(), _h = _d.done, !_h)) return [3 /*break*/, 26];\n                            _k = _d.value;\n                            _b = false;\n                            _l.label = 20;\n                        case 20:\n                            _l.trys.push([20, , 24, 25]);\n                            param = _k;\n                            loci = this.getLociForParams([param], params.structureNumber);\n                            if (loci_1.Loci.isEmpty(loci))\n                                return [2 /*return*/];\n                            // set default selection color to minimise change display\n                            this.visual.setColor({ select: param.color ? param.color : { r: 255, g: 255, b: 255 } });\n                            // apply selection\n                            this.plugin.managers.interactivity.lociSelects.selectOnly({ loci: loci });\n                            themeParams = component_1.StructureComponentManager.getThemeParams(this.plugin, this.plugin.managers.structure.component.pivotStructure);\n                            colorValue = param_definition_1.ParamDefinition.getDefaultValues(themeParams);\n                            colorValue.action.params = { color: param.color ? this.normalizeColor(param.color) : color_1.Color.fromRgb(255, 255, 255), opacity: 1 };\n                            return [4 /*yield*/, this.plugin.managers.structure.component.applyTheme(colorValue, structureData)];\n                        case 21:\n                            _l.sent();\n                            if (!(param.sideChain || param.representation)) return [3 /*break*/, 23];\n                            repr = 'ball-and-stick';\n                            if (param.representation)\n                                repr = param.representation;\n                            defaultParams = component_1.StructureComponentManager.getAddParams(this.plugin, { allowNone: false, hideSelection: true, checkExisting: true });\n                            defaultValues = param_definition_1.ParamDefinition.getDefaultValues(defaultParams);\n                            defaultValues.options = { label: 'selection-by-script', checkExisting: params.structureNumber ? false : true };\n                            values = tslib_1.__assign(tslib_1.__assign({}, defaultValues), { representation: repr });\n                            structures = this.plugin.managers.structure.hierarchy.getStructuresWithSelection();\n                            return [4 /*yield*/, this.plugin.managers.structure.component.add(values, structures)];\n                        case 22:\n                            _l.sent();\n                            // Apply uniform theme\n                            if (param.representationColor) {\n                                updatedStructureData = this.plugin.managers.structure.hierarchy.current.structures;\n                                if (params.structureNumber) {\n                                    updatedStructureData = [this.plugin.managers.structure.hierarchy.current.structures[params.structureNumber - 1]];\n                                }\n                                comps = updatedStructureData[0].components;\n                                lastCompsIndex = comps.length - 1;\n                                recentRepComp = [comps[lastCompsIndex]];\n                                uniformColor = param.representationColor ? this.normalizeColor(param.representationColor) : color_1.Color.fromRgb(255, 255, 255);\n                                this.plugin.managers.structure.component.updateRepresentationsTheme(recentRepComp, { color: 'uniform', colorParams: { value: uniformColor } });\n                            }\n                            params.addedRepr = true;\n                            _l.label = 23;\n                        case 23:\n                            // focus loci\n                            if (param.focus)\n                                this.plugin.managers.camera.focusLoci(loci);\n                            // remove selection\n                            this.plugin.managers.interactivity.lociSelects.deselect({ loci: loci });\n                            return [3 /*break*/, 25];\n                        case 24:\n                            _b = true;\n                            return [7 /*endfinally*/];\n                        case 25: return [3 /*break*/, 18];\n                        case 26: return [3 /*break*/, 33];\n                        case 27:\n                            e_3_1 = _l.sent();\n                            e_3 = { error: e_3_1 };\n                            return [3 /*break*/, 33];\n                        case 28:\n                            _l.trys.push([28, , 31, 32]);\n                            if (!(!_b && !_h && (_j = _c.return))) return [3 /*break*/, 30];\n                            return [4 /*yield*/, _j.call(_c)];\n                        case 29:\n                            _l.sent();\n                            _l.label = 30;\n                        case 30: return [3 /*break*/, 32];\n                        case 31:\n                            if (e_3) throw e_3.error;\n                            return [7 /*endfinally*/];\n                        case 32: return [7 /*endfinally*/];\n                        case 33:\n                            // reset selection color\n                            this.visual.reset({ selectColor: true });\n                            // save selection params to optimise clear\n                            this.selectedParams = params;\n                            return [2 /*return*/];\n                    }\n                });\n            }); },\n            clearSelection: function (structureNumber) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var structIndex, selReprCells, _i, _a, c, _b, selReprCells_1, selReprCells_1_1, selReprCell, e_4_1;\n                var _c, e_4, _d, _e;\n                return tslib_1.__generator(this, function (_f) {\n                    switch (_f.label) {\n                        case 0:\n                            structIndex = structureNumber ? structureNumber - 1 : 0;\n                            this.plugin.managers.interactivity.lociSelects.deselectAll();\n                            // reset theme to default\n                            if (this.selectedParams && this.selectedParams.nonSelectedColor) {\n                                this.visual.reset({ theme: true });\n                            }\n                            // remove overpaints\n                            return [4 /*yield*/, (0, structure_overpaint_1.clearStructureOverpaint)(this.plugin, this.plugin.managers.structure.hierarchy.current.structures[structIndex].components)];\n                        case 1:\n                            // remove overpaints\n                            _f.sent();\n                            if (!(this.selectedParams && this.selectedParams.addedRepr)) return [3 /*break*/, 17];\n                            selReprCells = [];\n                            for (_i = 0, _a = this.plugin.managers.structure.hierarchy.current.structures[structIndex].components; _i < _a.length; _i++) {\n                                c = _a[_i];\n                                if (c.cell && c.cell.params && c.cell.params.values && c.cell.params.values.label === 'selection-by-script')\n                                    selReprCells.push(c.cell);\n                            }\n                            if (!(selReprCells.length > 0)) return [3 /*break*/, 17];\n                            _f.label = 2;\n                        case 2:\n                            _f.trys.push([2, 10, 11, 16]);\n                            _b = true, selReprCells_1 = tslib_1.__asyncValues(selReprCells);\n                            _f.label = 3;\n                        case 3: return [4 /*yield*/, selReprCells_1.next()];\n                        case 4:\n                            if (!(selReprCells_1_1 = _f.sent(), _c = selReprCells_1_1.done, !_c)) return [3 /*break*/, 9];\n                            _e = selReprCells_1_1.value;\n                            _b = false;\n                            _f.label = 5;\n                        case 5:\n                            _f.trys.push([5, , 7, 8]);\n                            selReprCell = _e;\n                            return [4 /*yield*/, commands_1.PluginCommands.State.RemoveObject(this.plugin, { state: selReprCell.parent, ref: selReprCell.transform.ref })];\n                        case 6:\n                            _f.sent();\n                            return [3 /*break*/, 8];\n                        case 7:\n                            _b = true;\n                            return [7 /*endfinally*/];\n                        case 8: return [3 /*break*/, 3];\n                        case 9: return [3 /*break*/, 16];\n                        case 10:\n                            e_4_1 = _f.sent();\n                            e_4 = { error: e_4_1 };\n                            return [3 /*break*/, 16];\n                        case 11:\n                            _f.trys.push([11, , 14, 15]);\n                            if (!(!_b && !_c && (_d = selReprCells_1.return))) return [3 /*break*/, 13];\n                            return [4 /*yield*/, _d.call(selReprCells_1)];\n                        case 12:\n                            _f.sent();\n                            _f.label = 13;\n                        case 13: return [3 /*break*/, 15];\n                        case 14:\n                            if (e_4) throw e_4.error;\n                            return [7 /*endfinally*/];\n                        case 15: return [7 /*endfinally*/];\n                        case 16:\n                            ;\n                            _f.label = 17;\n                        case 17:\n                            this.selectedParams = undefined;\n                            return [2 /*return*/];\n                    }\n                });\n            }); },\n            update: function (options, fullLoad) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var param, param, settings, dataSource;\n                return tslib_1.__generator(this, function (_a) {\n                    if (!options)\n                        return [2 /*return*/];\n                    for (param in this.initParams) {\n                        if (options[param])\n                            this.initParams[param] = options[param];\n                    }\n                    this.initParams = tslib_1.__assign({}, spec_1.DefaultParams);\n                    for (param in spec_1.DefaultParams) {\n                        if (typeof options[param] !== 'undefined')\n                            this.initParams[param] = options[param];\n                    }\n                    if (!this.initParams.moleculeId && !this.initParams.customData)\n                        return [2 /*return*/, false];\n                    if (this.initParams.customData && this.initParams.customData.url && !this.initParams.customData.format)\n                        return [2 /*return*/, false];\n                    this.plugin.customState.initParams = this.initParams;\n                    // Set background colour\n                    if (this.initParams.bgColor || this.initParams.lighting) {\n                        settings = {};\n                        if (this.initParams.bgColor)\n                            settings.color = this.initParams.bgColor;\n                        if (this.initParams.lighting)\n                            settings.lighting = this.initParams.lighting;\n                        this.canvas.applySettings(settings);\n                    }\n                    dataSource = this.getMoleculeSrcUrl();\n                    if (dataSource) {\n                        this.load({ url: dataSource.url, format: dataSource.format, assemblyId: this.initParams.assemblyId, isBinary: dataSource.isBinary }, fullLoad);\n                    }\n                    return [2 /*return*/];\n                });\n            }); },\n            visibility: function (data) {\n                if (!data)\n                    return;\n                var refMap = {\n                    polymer: 'structure-component-static-polymer',\n                    het: 'structure-component-static-ligand',\n                    water: 'structure-component-static-water',\n                    carbs: 'structure-component-static-branched',\n                    maps: 'volume-streaming-info'\n                };\n                for (var visual in data) {\n                    var tagName = refMap[visual];\n                    var componentRef = mol_state_2.StateSelection.findTagInSubtree(_this.plugin.state.data.tree, mol_state_1.StateTransform.RootRef, tagName);\n                    if (componentRef) {\n                        var compVisual = _this.plugin.state.data.select(componentRef)[0];\n                        if (compVisual && compVisual.obj) {\n                            var currentlyVisible = (compVisual.state && compVisual.state.isHidden) ? false : true;\n                            if (data[visual] !== currentlyVisible) {\n                                commands_1.PluginCommands.State.ToggleVisibility(_this.plugin, { state: _this.state, ref: componentRef });\n                            }\n                        }\n                    }\n                }\n            },\n            toggleSpin: function (isSpinning, resetCamera) {\n                if (!_this.plugin.canvas3d)\n                    return;\n                var trackball = _this.plugin.canvas3d.props.trackball;\n                var toggleSpinParam = trackball.animate.name === 'spin' ? { name: 'off', params: {} } : { name: 'spin', params: { speed: 1 } };\n                if (typeof isSpinning !== 'undefined') {\n                    toggleSpinParam = { name: 'off', params: {} };\n                    if (isSpinning)\n                        toggleSpinParam = { name: 'spin', params: { speed: 1 } };\n                }\n                commands_1.PluginCommands.Canvas3D.SetSettings(_this.plugin, { settings: { trackball: tslib_1.__assign(tslib_1.__assign({}, trackball), { animate: toggleSpinParam }) } });\n                if (resetCamera)\n                    commands_1.PluginCommands.Camera.Reset(_this.plugin, {});\n            },\n            focus: function (params, structureNumber) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var loci;\n                return tslib_1.__generator(this, function (_a) {\n                    loci = this.getLociForParams(params, structureNumber);\n                    this.plugin.managers.camera.focusLoci(loci);\n                    return [2 /*return*/];\n                });\n            }); },\n            setColor: function (param) {\n                if (!_this.plugin.canvas3d)\n                    return;\n                var renderer = _this.plugin.canvas3d.props.renderer;\n                var rParam = {};\n                if (param.highlight)\n                    rParam['highlightColor'] = _this.normalizeColor(param.highlight);\n                if (param.select)\n                    rParam['selectColor'] = _this.normalizeColor(param.select);\n                commands_1.PluginCommands.Canvas3D.SetSettings(_this.plugin, { settings: { renderer: tslib_1.__assign(tslib_1.__assign({}, renderer), rParam) } });\n                if (rParam.highlightColor)\n                    _this.isHighlightColorUpdated = true;\n            },\n            reset: function (params) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var defaultTheme_1, componentGroups, renderer, rParam;\n                var _this = this;\n                return tslib_1.__generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            if (!params.camera) return [3 /*break*/, 2];\n                            return [4 /*yield*/, commands_1.PluginCommands.Camera.Reset(this.plugin, { durationMs: 250 })];\n                        case 1:\n                            _a.sent();\n                            _a.label = 2;\n                        case 2:\n                            if (params.theme) {\n                                defaultTheme_1 = { color: this.initParams.alphafoldView ? 'plddt-confidence' : 'default' };\n                                componentGroups = this.plugin.managers.structure.hierarchy.currentComponentGroups;\n                                componentGroups.forEach(function (compGrp) {\n                                    _this.plugin.managers.structure.component.updateRepresentationsTheme(compGrp, defaultTheme_1);\n                                });\n                            }\n                            if (params.highlightColor || params.selectColor) {\n                                if (!this.plugin.canvas3d)\n                                    return [2 /*return*/];\n                                renderer = this.plugin.canvas3d.props.renderer;\n                                rParam = {};\n                                if (params.highlightColor)\n                                    rParam['highlightColor'] = this.defaultRendererProps.highlightColor;\n                                if (params.selectColor)\n                                    rParam['selectColor'] = this.defaultRendererProps.selectColor;\n                                commands_1.PluginCommands.Canvas3D.SetSettings(this.plugin, { settings: { renderer: tslib_1.__assign(tslib_1.__assign({}, renderer), rParam) } });\n                                if (rParam.highlightColor)\n                                    this.isHighlightColorUpdated = false;\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); }\n        };\n    }\n    PDBeMolstarPlugin.prototype.visual1 = function (_style, partial) {\n        //const structure = this.getObj<PluginStateObject.Molecule.Structure>(StateElements.Assembly);\n        var structure = this.getObj(this.assemblyRef);\n        if (!structure)\n            return;\n        var style = _style || {};\n        var update = this.state.build();\n        if (!partial || (partial && style.sequence)) {\n            var root = update.to(helpers_2.StateElements.Sequence);\n            if (style.sequence && style.sequence.hide) {\n                root.delete(helpers_2.StateElements.SequenceVisual);\n            }\n            else {\n                root.applyOrUpdate(helpers_2.StateElements.SequenceVisual, transforms_1.StateTransforms.Representation.StructureRepresentation3D, (0, structure_representation_params_1.createStructureRepresentationParams)(this.plugin, structure, {\n                    type: (style.sequence && style.sequence.kind) || 'cartoon',\n                    color: (style.sequence && style.sequence.coloring) || 'unit-index'\n                }));\n            }\n        }\n        if (!partial || (partial && style.hetGroups)) {\n            var root = update.to(helpers_2.StateElements.Het);\n            if (style.hetGroups && style.hetGroups.hide) {\n                root.delete(helpers_2.StateElements.HetVisual);\n            }\n            else {\n                if (style.hetGroups && style.hetGroups.hide) {\n                    root.delete(helpers_2.StateElements.HetVisual);\n                }\n                else {\n                    root.applyOrUpdate(helpers_2.StateElements.HetVisual, transforms_1.StateTransforms.Representation.StructureRepresentation3D, (0, structure_representation_params_1.createStructureRepresentationParams)(this.plugin, structure, {\n                        type: (style.hetGroups && style.hetGroups.kind) || 'ball-and-stick',\n                        color: style.hetGroups && style.hetGroups.coloring\n                    }));\n                }\n            }\n        }\n        if (!partial || (partial && style.snfg3d)) {\n            var root = update.to(helpers_2.StateElements.Het);\n            if (style.hetGroups && style.hetGroups.hide) {\n                root.delete(helpers_2.StateElements.HetVisual);\n            }\n            else {\n                if (style.snfg3d && style.snfg3d.hide) {\n                    root.delete(helpers_2.StateElements.Het3DSNFG);\n                }\n                else {\n                    root.applyOrUpdate(helpers_2.StateElements.Het3DSNFG, transforms_1.StateTransforms.Representation.StructureRepresentation3D, (0, structure_representation_params_1.createStructureRepresentationParams)(this.plugin, structure, { type: 'carbohydrate' }));\n                }\n            }\n        }\n        if (!partial || (partial && style.water)) {\n            var root = update.to(helpers_2.StateElements.Water);\n            if (style.water && style.water.hide) {\n                root.delete(helpers_2.StateElements.WaterVisual);\n            }\n            else {\n                root.applyOrUpdate(helpers_2.StateElements.WaterVisual, transforms_1.StateTransforms.Representation.StructureRepresentation3D, (0, structure_representation_params_1.createStructureRepresentationParams)(this.plugin, structure, {\n                    type: (style.water && style.water.kind) || 'ball-and-stick',\n                    typeParams: { alpha: 0.51 },\n                    color: style.water && style.water.coloring\n                }));\n            }\n        }\n        return update;\n    };\n    PDBeMolstarPlugin.prototype.render = function (target, options) {\n        var _a;\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var param, defaultPDBeSpec, pdbePluginSpec, _b, settings, dataSource;\n            return tslib_1.__generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (!options)\n                            return [2 /*return*/];\n                        this.initParams = tslib_1.__assign({}, spec_1.DefaultParams);\n                        for (param in spec_1.DefaultParams) {\n                            if (typeof options[param] !== 'undefined')\n                                this.initParams[param] = options[param];\n                        }\n                        if (!this.initParams.moleculeId && !this.initParams.customData)\n                            return [2 /*return*/, false];\n                        if (this.initParams.customData && this.initParams.customData.url && !this.initParams.customData.format)\n                            return [2 /*return*/, false];\n                        defaultPDBeSpec = (0, spec_1.DefaultPluginUISpec)();\n                        pdbePluginSpec = {\n                            actions: tslib_1.__spreadArray([], defaultPDBeSpec.actions || [], true),\n                            behaviors: tslib_1.__spreadArray([], defaultPDBeSpec.behaviors, true),\n                            animations: tslib_1.__spreadArray([], defaultPDBeSpec.animations || [], true),\n                            customParamEditors: defaultPDBeSpec.customParamEditors,\n                            config: defaultPDBeSpec.config\n                        };\n                        if (!this.initParams.ligandView && !this.initParams.superposition && this.initParams.selectInteraction) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(structure_focus_representation_1.StructureFocusRepresentation));\n                        }\n                        if (this.initParams.superposition) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(superposition_focus_representation_1.SuperpositionFocusRepresentation), spec_2.PluginSpec.Behavior(behavior_2.MAQualityAssessment, { autoAttach: true, showTooltip: true }));\n                        }\n                        // Add custom properties\n                        if (this.initParams.domainAnnotation) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(behavior_1.PDBeDomainAnnotations, { autoAttach: true, showTooltip: false }));\n                        }\n                        if (this.initParams.validationAnnotation) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(pdbe_1.PDBeStructureQualityReport, { autoAttach: true, showTooltip: false }));\n                        }\n                        pdbePluginSpec.layout = {\n                            initial: {\n                                isExpanded: this.initParams.landscape ? false : this.initParams.expanded,\n                                showControls: !this.initParams.hideControls\n                            }\n                        };\n                        pdbePluginSpec.components = {\n                            controls: {\n                                left: pdbe_left_panel_1.LeftPanelControls,\n                                // right: DefaultStructureTools,\n                                top: 'none',\n                                bottom: 'none'\n                            },\n                            viewport: {\n                                controls: pdbe_viewport_controls_1.PDBeViewportControls,\n                                view: this.initParams.superposition ? superposition_viewport_1.SuperpostionViewport : void 0\n                            },\n                            remoteState: 'none',\n                            structureTools: this.initParams.superposition ? pdbe_structure_controls_1.PDBeSuperpositionStructureTools : this.initParams.ligandView ? pdbe_structure_controls_1.PDBeLigandViewStructureTools : pdbe_structure_controls_1.PDBeStructureTools\n                        };\n                        if (this.initParams.alphafoldView) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(behavior_2.MAQualityAssessment, { autoAttach: true, showTooltip: true }));\n                            pdbePluginSpec.components.controls = {\n                                left: 'none',\n                                right: 'none',\n                                // top: 'none',\n                                bottom: 'none'\n                            };\n                        }\n                        if (this.initParams.sequencePanel) {\n                            if ((_a = pdbePluginSpec.components.controls) === null || _a === void 0 ? void 0 : _a.top)\n                                delete pdbePluginSpec.components.controls.top;\n                        }\n                        pdbePluginSpec.config = [\n                            [\n                                config_1.PluginConfig.Structure.DefaultRepresentationPresetParams,\n                                {\n                                    theme: {\n                                        globalName: (this.initParams.alphafoldView) ? 'plddt-confidence' : undefined,\n                                        carbonColor: { name: 'element-symbol', params: {} },\n                                        focus: {\n                                            name: 'element-symbol',\n                                            params: { carbonColor: { name: 'element-symbol', params: {} } }\n                                        }\n                                    }\n                                }\n                            ]\n                        ];\n                        element_symbol_1.ElementSymbolColorThemeParams.carbonColor.defaultValue = { name: 'element-symbol', params: {} };\n                        // Add animation props\n                        if (!this.initParams.ligandView && !this.initParams.superposition) {\n                            pdbePluginSpec['animations'] = [model_index_1.AnimateModelIndex, camera_spin_1.AnimateCameraSpin, camera_rock_1.AnimateCameraRock, state_snapshots_1.AnimateStateSnapshots, assembly_unwind_1.AnimateAssemblyUnwind, spin_structure_1.AnimateStructureSpin, state_interpolation_1.AnimateStateInterpolation];\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(mp4_export_1.Mp4Export));\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(geo_export_1.GeometryExport));\n                        }\n                        if (this.initParams.hideCanvasControls) {\n                            if (this.initParams.hideCanvasControls.indexOf('expand') > -1)\n                                pdbePluginSpec.config.push([config_1.PluginConfig.Viewport.ShowExpand, false]);\n                            if (this.initParams.hideCanvasControls.indexOf('selection') > -1)\n                                pdbePluginSpec.config.push([config_1.PluginConfig.Viewport.ShowSelectionMode, false]);\n                            if (this.initParams.hideCanvasControls.indexOf('animation') > -1)\n                                pdbePluginSpec.config.push([config_1.PluginConfig.Viewport.ShowAnimation, false]);\n                        }\n                        ;\n                        if (this.initParams.landscape && pdbePluginSpec.layout && pdbePluginSpec.layout.initial)\n                            pdbePluginSpec.layout.initial['controlsDisplay'] = 'landscape';\n                        // override default event bindings\n                        if (this.initParams.selectBindings) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(representation_1.SelectLoci, { bindings: this.initParams.selectBindings }));\n                        }\n                        if (this.initParams.focusBindings) {\n                            pdbePluginSpec.behaviors.push(spec_2.PluginSpec.Behavior(camera_1.FocusLoci, { bindings: this.initParams.focusBindings }));\n                        }\n                        this.targetElement = typeof target === 'string' ? document.getElementById(target) : target;\n                        // Create/ Initialise Plugin\n                        _b = this;\n                        return [4 /*yield*/, (0, spec_1.createPluginUI)(this.targetElement, pdbePluginSpec)];\n                    case 1:\n                        // Create/ Initialise Plugin\n                        _b.plugin = _c.sent();\n                        this.plugin.customState.initParams = tslib_1.__assign({}, this.initParams);\n                        this.plugin.customState.events = {\n                            segmentUpdate: this._ev(),\n                            superpositionInit: this._ev(),\n                            isBusy: this._ev()\n                        };\n                        // Set background colour\n                        if (this.initParams.bgColor || this.initParams.lighting) {\n                            settings = {};\n                            if (this.initParams.bgColor)\n                                settings.color = this.initParams.bgColor;\n                            if (this.initParams.lighting)\n                                settings.lighting = this.initParams.lighting;\n                            this.canvas.applySettings(settings);\n                        }\n                        // Set selection granularity\n                        if (this.initParams.granularity) {\n                            this.plugin.managers.interactivity.setProps({ granularity: this.initParams.granularity });\n                        }\n                        // Set default highlight and selection colors\n                        if (this.initParams.highlightColor || this.initParams.selectColor) {\n                            this.visual.setColor({ highlight: this.initParams.highlightColor, select: this.initParams.selectColor });\n                        }\n                        this.plugin.representation.structure.themes.colorThemeRegistry.add(annotation_1.ShannonEntropy.colorThemeProvider);\n                        this.plugin.managers.lociLabels.addProvider(annotation_1.ShannonEntropy.labelProvider);\n                        this.plugin.customModelProperties.register(annotation_1.ShannonEntropy.propertyProvider, true);\n                        this.plugin.representation.structure.themes.colorThemeRegistry.add(annotation_2.TwinConsData.colorThemeProvider);\n                        this.plugin.managers.lociLabels.addProvider(annotation_2.TwinConsData.labelProvider);\n                        this.plugin.customModelProperties.register(annotation_2.TwinConsData.propertyProvider, true);\n                        // Save renderer defaults\n                        this.defaultRendererProps = tslib_1.__assign({}, this.plugin.canvas3d.props.renderer);\n                        if (this.initParams.superposition) {\n                            // Set left panel tab\n                            this.plugin.behaviors.layout.leftPanelTabName.next('segments');\n                            // Initialise superposition\n                            (0, superposition_1.initSuperposition)(this.plugin);\n                        }\n                        else {\n                            // Collapse left panel and set left panel tab to none\n                            commands_1.PluginCommands.Layout.Update(this.plugin, { state: { regionState: tslib_1.__assign(tslib_1.__assign({}, this.plugin.layout.state.regionState), { left: 'collapsed' }) } });\n                            this.plugin.behaviors.layout.leftPanelTabName.next('none');\n                            dataSource = this.getMoleculeSrcUrl();\n                            if (dataSource) {\n                                this.load({ url: dataSource.url, format: dataSource.format, assemblyId: this.initParams.assemblyId, isBinary: dataSource.isBinary });\n                            }\n                            // Binding to other PDB Component events\n                            if (this.initParams.subscribeEvents) {\n                                (0, subscribe_events_1.subscribeToComponentEvents)(this);\n                            }\n                            // Event handling\n                            custom_events_1.CustomEvents.add(this.plugin, this.targetElement);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PDBeMolstarPlugin.prototype.getMoleculeSrcUrl = function () {\n        var supportedFormats = ['mmcif', 'pdb', 'sdf'];\n        var id = this.initParams.moleculeId;\n        if (!id && !this.initParams.customData) {\n            throw new Error(\"Mandatory parameters missing!\");\n        }\n        var query = 'full';\n        var sep = '?';\n        if (this.initParams.ligandView) {\n            var queryParams = ['data_source=pdb-h'];\n            if (!this.initParams.ligandView.label_comp_id_list) {\n                if (this.initParams.ligandView.label_comp_id) {\n                    queryParams.push('label_comp_id=' + this.initParams.ligandView.label_comp_id);\n                }\n                else if (this.initParams.ligandView.auth_seq_id) {\n                    queryParams.push('auth_seq_id=' + this.initParams.ligandView.auth_seq_id);\n                }\n                if (this.initParams.ligandView.auth_asym_id)\n                    queryParams.push('auth_asym_id=' + this.initParams.ligandView.auth_asym_id);\n            }\n            query = 'residueSurroundings?' + queryParams.join('&');\n            sep = '&';\n        }\n        var url = \"\".concat(this.initParams.pdbeUrl, \"model-server/v1/\").concat(id, \"/\").concat(query).concat(sep, \"encoding=\").concat(this.initParams.encoding).concat(this.initParams.lowPrecisionCoords ? '&lowPrecisionCoords=1' : '');\n        var isBinary = this.initParams.encoding === 'bcif' ? true : false;\n        var format = 'mmcif';\n        if (this.initParams.customData) {\n            if (!this.initParams.customData.url || !this.initParams.customData.format) {\n                throw new Error(\"Provide all custom data parameters\");\n            }\n            url = this.initParams.customData.url;\n            format = this.initParams.customData.format;\n            if (format === 'cif' || format === 'bcif')\n                format = 'mmcif';\n            // Validate supported format\n            if (supportedFormats.indexOf(format) === -1) {\n                throw new Error(\"\".concat(format, \" not supported.\"));\n            }\n            isBinary = this.initParams.customData.binary ? this.initParams.customData.binary : false;\n        }\n        return {\n            url: url,\n            format: format,\n            isBinary: isBinary\n        };\n    };\n    Object.defineProperty(PDBeMolstarPlugin.prototype, \"state\", {\n        get: function () {\n            return this.plugin.state.data;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    PDBeMolstarPlugin.prototype.createLigandStructure = function (isBranched) {\n        var _a, e_5, _b, _c;\n        var _d;\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var _e, _f, _g, comp, e_5_1, structure, ligandQuery, ligandVis, ligandSurr, ligRef, cell, ligLoci;\n            var _this = this;\n            return tslib_1.__generator(this, function (_h) {\n                switch (_h.label) {\n                    case 0:\n                        if (this.assemblyRef === '')\n                            return [2 /*return*/];\n                        _h.label = 1;\n                    case 1:\n                        _h.trys.push([1, 9, 10, 15]);\n                        _e = true, _f = tslib_1.__asyncValues(this.plugin.managers.structure.hierarchy.currentComponentGroups);\n                        _h.label = 2;\n                    case 2: return [4 /*yield*/, _f.next()];\n                    case 3:\n                        if (!(_g = _h.sent(), _a = _g.done, !_a)) return [3 /*break*/, 8];\n                        _c = _g.value;\n                        _e = false;\n                        _h.label = 4;\n                    case 4:\n                        _h.trys.push([4, , 6, 7]);\n                        comp = _c;\n                        return [4 /*yield*/, commands_1.PluginCommands.State.RemoveObject(this.plugin, { state: comp[0].cell.parent, ref: comp[0].cell.transform.ref, removeParentGhosts: true })];\n                    case 5:\n                        _h.sent();\n                        return [3 /*break*/, 7];\n                    case 6:\n                        _e = true;\n                        return [7 /*endfinally*/];\n                    case 7: return [3 /*break*/, 2];\n                    case 8: return [3 /*break*/, 15];\n                    case 9:\n                        e_5_1 = _h.sent();\n                        e_5 = { error: e_5_1 };\n                        return [3 /*break*/, 15];\n                    case 10:\n                        _h.trys.push([10, , 13, 14]);\n                        if (!(!_e && !_a && (_b = _f.return))) return [3 /*break*/, 12];\n                        return [4 /*yield*/, _b.call(_f)];\n                    case 11:\n                        _h.sent();\n                        _h.label = 12;\n                    case 12: return [3 /*break*/, 14];\n                    case 13:\n                        if (e_5) throw e_5.error;\n                        return [7 /*endfinally*/];\n                    case 14: return [7 /*endfinally*/];\n                    case 15:\n                        structure = this.state.select(this.assemblyRef)[0];\n                        if (isBranched) {\n                            ligandQuery = helpers_1.LigandView.branchedQuery((_d = this.initParams.ligandView) === null || _d === void 0 ? void 0 : _d.label_comp_id_list);\n                        }\n                        else {\n                            ligandQuery = helpers_1.LigandView.query(this.initParams.ligandView);\n                        }\n                        return [4 /*yield*/, this.plugin.builders.structure.tryCreateComponentFromExpression(structure, ligandQuery.core, 'pivot', { label: 'Ligand' })];\n                    case 16:\n                        ligandVis = _h.sent();\n                        if (!ligandVis) return [3 /*break*/, 18];\n                        return [4 /*yield*/, this.plugin.builders.structure.representation.addRepresentation(ligandVis, { type: 'ball-and-stick', color: 'element-symbol', colorParams: { carbonColor: { name: 'element-symbol', params: {} } }, size: 'uniform', sizeParams: { value: 2.5 } }, { tag: 'ligand-vis' })];\n                    case 17:\n                        _h.sent();\n                        _h.label = 18;\n                    case 18: return [4 /*yield*/, this.plugin.builders.structure.tryCreateComponentFromExpression(structure, ligandQuery.surroundings, 'rest', { label: 'Surroundings' })];\n                    case 19:\n                        ligandSurr = _h.sent();\n                        if (!ligandSurr) return [3 /*break*/, 21];\n                        return [4 /*yield*/, this.plugin.builders.structure.representation.addRepresentation(ligandSurr, { type: 'ball-and-stick', color: 'element-symbol', colorParams: { carbonColor: { name: 'element-symbol', params: {} } }, size: 'uniform', sizeParams: { value: 0.8 } })];\n                    case 20:\n                        _h.sent();\n                        _h.label = 21;\n                    case 21:\n                        ligRef = mol_state_2.StateSelection.findTagInSubtree(this.plugin.state.data.tree, mol_state_1.StateTransform.RootRef, 'ligand-vis');\n                        if (!ligRef)\n                            return [2 /*return*/];\n                        cell = this.plugin.state.data.cells.get(ligRef);\n                        if (cell) {\n                            ligLoci = cell.obj.data.repr.getLoci();\n                            this.plugin.managers.structure.focus.setFromLoci(ligLoci);\n                            setTimeout(function () {\n                                var _a;\n                                // focus-add is not handled in camera behavior, doing it here\n                                var current = (_a = _this.plugin.managers.structure.focus.current) === null || _a === void 0 ? void 0 : _a.loci;\n                                if (current)\n                                    _this.plugin.managers.camera.focusLoci(current);\n                            }, 500);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    //private loadedParams: LoadParams = { url: '', format: 'mmcif', isBinary: false, assemblyId: '' };\n    PDBeMolstarPlugin.prototype.load = function (_a, fullLoad) {\n        var url = _a.url, _b = _a.format, format = _b === void 0 ? 'mmcif' : _b, _c = _a.isBinary, isBinary = _c === void 0 ? false : _c, _d = _a.assemblyId, assemblyId = _d === void 0 ? '' : _d, representationStyle = _a.representationStyle;\n        if (fullLoad === void 0) { fullLoad = true; }\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var isHetView, downloadOptions, isBranchedView, data, trajectory, model, pivotIndex, pivot, asm, defaultMapParams, pdbeMapParams, loadType, state, modelTree, info, asmId, structureTree, tree, info, asmId, props_1;\n            return tslib_1.__generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0:\n                        if (fullLoad)\n                            this.clear();\n                        isHetView = this.initParams.ligandView ? true : false;\n                        downloadOptions = void 0;\n                        isBranchedView = false;\n                        if (this.initParams.ligandView && this.initParams.ligandView.label_comp_id_list) {\n                            isBranchedView = true;\n                            downloadOptions = { body: JSON.stringify(this.initParams.ligandView.label_comp_id_list), headers: [['Content-type', 'application/json']] };\n                        }\n                        return [4 /*yield*/, this.plugin.builders.data.download({ url: assets_1.Asset.Url(url, downloadOptions), isBinary: isBinary }, { state: { isGhost: true } })];\n                    case 1:\n                        data = _e.sent();\n                        return [4 /*yield*/, this.plugin.builders.structure.parseTrajectory(data, format)];\n                    case 2:\n                        trajectory = _e.sent();\n                        if (!!isHetView) return [3 /*break*/, 4];\n                        return [4 /*yield*/, this.plugin.builders.structure.hierarchy.applyPreset(trajectory, this.initParams.defaultPreset, {\n                                structure: assemblyId ? (assemblyId === 'preferred') ? void 0 : { name: 'assembly', params: { id: assemblyId } } : { name: 'model', params: {} },\n                                showUnitcell: false,\n                                representationPreset: 'auto'\n                            })];\n                    case 3:\n                        _e.sent();\n                        if (this.initParams.hideStructure || this.initParams.visualStyle) {\n                            this.applyVisualParams();\n                        }\n                        return [3 /*break*/, 7];\n                    case 4: return [4 /*yield*/, this.plugin.builders.structure.createModel(trajectory)];\n                    case 5:\n                        model = _e.sent();\n                        return [4 /*yield*/, this.plugin.builders.structure.createStructure(model, { name: 'model', params: {} })];\n                    case 6:\n                        _e.sent();\n                        _e.label = 7;\n                    case 7:\n                        // show selection if param is set\n                        if (this.initParams.selection) {\n                            this.visual.select(this.initParams.selection);\n                        }\n                        pivotIndex = this.plugin.managers.structure.hierarchy.selection.structures.length - 1;\n                        pivot = this.plugin.managers.structure.hierarchy.selection.structures[pivotIndex];\n                        if (pivot && pivot.cell.parent)\n                            this.assemblyRef = pivot.cell.transform.ref;\n                        if (!this.initParams.loadMaps) return [3 /*break*/, 9];\n                        if (this.assemblyRef === '')\n                            return [2 /*return*/];\n                        asm = this.state.select(this.assemblyRef)[0].obj;\n                        defaultMapParams = transformers_1.InitVolumeStreaming.createDefaultParams(asm, this.plugin);\n                        pdbeMapParams = helpers_1.PDBeVolumes.mapParams(defaultMapParams, this.initParams.mapSettings, '');\n                        if (!pdbeMapParams) return [3 /*break*/, 9];\n                        return [4 /*yield*/, this.plugin.runTask(this.state.applyAction(transformers_1.InitVolumeStreaming, pdbeMapParams, this.assemblyRef))];\n                    case 8:\n                        _e.sent();\n                        if (pdbeMapParams.method !== 'em' && !this.initParams.ligandView)\n                            helpers_1.PDBeVolumes.displayUsibilityMessage(this.plugin);\n                        _e.label = 9;\n                    case 9:\n                        if (!isHetView) return [3 /*break*/, 11];\n                        return [4 /*yield*/, this.createLigandStructure(isBranchedView)];\n                    case 10:\n                        _e.sent();\n                        _e.label = 11;\n                    case 11:\n                        loadType = 'full';\n                        state = this.plugin.state.data;\n                        /*\n                        if (this.loadedParams.url !== url || this.loadedParams.format !== format) {\n                            loadType = 'full';\n                        } else if (this.loadedParams.url === url) {\n                            //if (state.select(StateElements.Assembly).length > 0) loadType = 'update';\n                            if (state.select(this.assemblyRef).length > 0) loadType = 'update';\n                        }*/\n                        if (fullLoad) {\n                            loadType = 'full';\n                        }\n                        else {\n                            loadType = 'update';\n                        }\n                        if (!(loadType === 'full')) return [3 /*break*/, 16];\n                        return [4 /*yield*/, commands_1.PluginCommands.State.RemoveObject(this.plugin, { state: state, ref: state.tree.root.ref })];\n                    case 12:\n                        _e.sent();\n                        modelTree = this.model(this.download(state.build().toRoot(), url, isBinary), format);\n                        return [4 /*yield*/, this.applyState(modelTree)];\n                    case 13:\n                        _e.sent();\n                        return [4 /*yield*/, this.doInfo(true)];\n                    case 14:\n                        info = _e.sent();\n                        asmId = (assemblyId === 'preferred' && info && info.preferredAssemblyId) || assemblyId;\n                        structureTree = this.structure(asmId);\n                        return [4 /*yield*/, this.applyState(structureTree)];\n                    case 15:\n                        _e.sent();\n                        return [3 /*break*/, 19];\n                    case 16:\n                        tree = state.build();\n                        return [4 /*yield*/, this.doInfo(true)];\n                    case 17:\n                        info = _e.sent();\n                        asmId = (assemblyId === 'preferred' && info && info.preferredAssemblyId) || assemblyId;\n                        props_1 = {\n                            type: assemblyId ? {\n                                name: 'assembly',\n                                params: { id: asmId }\n                            } : {\n                                name: 'model',\n                                params: {}\n                            }\n                        };\n                        //tree.to(StateElements.Assembly).update(StateTransforms.Model.StructureFromModel, p => ({ ...p, ...props }));\n                        tree.to(this.assemblyRef).update(transforms_1.StateTransforms.Model.StructureFromModel, function (p) { return (tslib_1.__assign(tslib_1.__assign({}, p), props_1)); });\n                        return [4 /*yield*/, this.applyState(tree)];\n                    case 18:\n                        _e.sent();\n                        _e.label = 19;\n                    case 19:\n                        ;\n                        return [4 /*yield*/, this.updateStyle(representationStyle)];\n                    case 20:\n                        _e.sent();\n                        this.events.loadComplete.next(true);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PDBeMolstarPlugin.prototype.model = function (b, format) {\n        var parsed = format === 'mmcif'\n            ? b.apply(transforms_1.StateTransforms.Data.ParseCif).apply(transforms_1.StateTransforms.Model.TrajectoryFromMmCif)\n            : b.apply(transforms_1.StateTransforms.Model.TrajectoryFromPDB);\n        return parsed.apply(transforms_1.StateTransforms.Model.ModelFromTrajectory, { modelIndex: 0 }, { ref: helpers_2.StateElements.Model });\n    };\n    PDBeMolstarPlugin.prototype.download = function (b, url, isBinary) {\n        return b.apply(transforms_1.StateTransforms.Data.Download, { url: assets_1.Asset.Url(url), isBinary: isBinary });\n    };\n    PDBeMolstarPlugin.prototype.structure = function (assemblyId) {\n        var model = this.state.build().to(helpers_2.StateElements.Model);\n        var props = {\n            type: assemblyId ? {\n                name: 'assembly',\n                params: { id: assemblyId }\n            } : {\n                name: 'model',\n                params: {}\n            }\n        };\n        var s = model\n            //    .apply(StateTransforms.Model.StructureFromModel, props, { ref: StateElements.Assembly });\n            .apply(transforms_1.StateTransforms.Model.StructureFromModel, props, { ref: this.assemblyRef });\n        s.apply(transforms_1.StateTransforms.Model.StructureComplexElement, { type: 'atomic-sequence' }, { ref: helpers_2.StateElements.Sequence });\n        s.apply(transforms_1.StateTransforms.Model.StructureComplexElement, { type: 'atomic-het' }, { ref: helpers_2.StateElements.Het });\n        s.apply(transforms_1.StateTransforms.Model.StructureComplexElement, { type: 'water' }, { ref: helpers_2.StateElements.Water });\n        return s;\n    };\n    PDBeMolstarPlugin.prototype.updateStyle = function (style, partial) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var tree;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        tree = this.visual1(style, partial);\n                        if (!tree)\n                            return [2 /*return*/];\n                        return [4 /*yield*/, commands_1.PluginCommands.State.Update(this.plugin, { state: this.plugin.state.data, tree: tree })];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PDBeMolstarPlugin.prototype.doInfo = function (checkPreferredAssembly) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var model, info;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        model = this.getObj('model');\n                        if (!model)\n                            return [2 /*return*/];\n                        return [4 /*yield*/, helpers_2.ModelInfo2.get(this.plugin, model, checkPreferredAssembly)];\n                    case 1:\n                        info = _a.sent();\n                        this.events.modelInfo.next(info);\n                        return [2 /*return*/, info];\n                }\n            });\n        });\n    };\n    PDBeMolstarPlugin.prototype.applyState = function (tree) {\n        return commands_1.PluginCommands.State.Update(this.plugin, { state: this.plugin.state.data, tree: tree });\n    };\n    PDBeMolstarPlugin.prototype.getObj = function (ref) {\n        var state = this.state;\n        var cell = state.select(ref)[0];\n        if (!cell || !cell.obj)\n            return void 0;\n        return cell.obj.data;\n    };\n    PDBeMolstarPlugin.prototype.getLociForParams = function (params, structureNumber) {\n        var assemblyRef = this.assemblyRef;\n        if (structureNumber) {\n            assemblyRef = this.plugin.managers.structure.hierarchy.current.structures[structureNumber - 1].cell.transform.ref;\n        }\n        if (assemblyRef === '')\n            return loci_1.EmptyLoci;\n        //if (this.plugin.state.data.select(assemblyRef).length == 0) return EmptyLoci;\n        var data = this.plugin.state.data.select(assemblyRef)[0].obj.data;\n        if (!data)\n            return loci_1.EmptyLoci;\n        return helpers_1.QueryHelper.getInteractivityLoci(params, data);\n    };\n    PDBeMolstarPlugin.prototype.getLociByPLDDT = function (score, structureNumber) {\n        var assemblyRef = this.assemblyRef;\n        if (structureNumber) {\n            assemblyRef = this.plugin.managers.structure.hierarchy.current.structures[structureNumber - 1].cell.transform.ref;\n        }\n        if (assemblyRef === '')\n            return loci_1.EmptyLoci;\n        var data = this.plugin.state.data.select(assemblyRef)[0].obj.data;\n        if (!data)\n            return loci_1.EmptyLoci;\n        return helpers_1.AlphafoldView.getLociByPLDDT(score, data);\n    };\n    PDBeMolstarPlugin.prototype.normalizeColor = function (colorVal, defaultColor) {\n        var color = color_1.Color.fromRgb(170, 170, 170);\n        try {\n            if (typeof colorVal.r !== 'undefined') {\n                color = color_1.Color.fromRgb(colorVal.r, colorVal.g, colorVal.b);\n            }\n            else if (colorVal[0] === '#') {\n                color = (0, color_1.Color)(Number(\"0x\".concat(colorVal.substr(1))));\n            }\n            else {\n                color = (0, color_1.Color)(colorVal);\n            }\n        }\n        catch (e) {\n            if (defaultColor)\n                color = defaultColor;\n        }\n        return color;\n    };\n    PDBeMolstarPlugin.prototype.clear = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            return tslib_1.__generator(this, function (_a) {\n                this.plugin.clear();\n                this.assemblyRef = '';\n                this.selectedParams = void 0;\n                this.isHighlightColorUpdated = false;\n                this.isSelectedColorUpdated = false;\n                return [2 /*return*/];\n            });\n        });\n    };\n    return PDBeMolstarPlugin;\n}());\nwindow.PDBeMolstarPlugin = PDBeMolstarPlugin;\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjtBQUMxRyw4RUFBOEUseUJBQXlCLElBQUksdUNBQXVDO0FBQ2xKLDhFQUE4RSxvQkFBb0IsSUFBSSxrQ0FBa0M7QUFDeEksOEVBQThFLGVBQWUsSUFBSSxvQ0FBb0M7QUFDckk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1HQUFtRywyQ0FBMkM7QUFDOUk7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EscUVBQXFFLDJDQUEyQztBQUNoSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL2luZGV4LmpzPzliMGEiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoXCJ0c2xpYlwiKTtcbnZhciBzcGVjXzEgPSByZXF1aXJlKFwiLi9zcGVjXCIpO1xudmFyIGNvbW1hbmRzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2NvbW1hbmRzXCIpO1xudmFyIG1vbF9zdGF0ZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXN0YXRlXCIpO1xudmFyIGxvY2lfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1tb2RlbC9sb2NpXCIpO1xudmFyIHJ4X2V2ZW50X2hlbHBlcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvcngtZXZlbnQtaGVscGVyXCIpO1xudmFyIGhlbHBlcnNfMSA9IHJlcXVpcmUoXCIuL2hlbHBlcnNcIik7XG52YXIgcGRiZV9zdHJ1Y3R1cmVfY29udHJvbHNfMSA9IHJlcXVpcmUoXCIuL3VpL3BkYmUtc3RydWN0dXJlLWNvbnRyb2xzXCIpO1xudmFyIHBkYmVfdmlld3BvcnRfY29udHJvbHNfMSA9IHJlcXVpcmUoXCIuL3VpL3BkYmUtdmlld3BvcnQtY29udHJvbHNcIik7XG52YXIgbW9sX3N0YXRlXzIgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtc3RhdGVcIik7XG52YXIgc3RydWN0dXJlX2ZvY3VzX3JlcHJlc2VudGF0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2JlaGF2aW9yL2R5bmFtaWMvc2VsZWN0aW9uL3N0cnVjdHVyZS1mb2N1cy1yZXByZXNlbnRhdGlvblwiKTtcbnZhciBzcGVjXzIgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL3NwZWNcIik7XG52YXIgdHJhbnNmb3JtZXJzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2JlaGF2aW9yL2R5bmFtaWMvdm9sdW1lLXN0cmVhbWluZy90cmFuc2Zvcm1lcnNcIik7XG52YXIgc3RydWN0dXJlX3JlcHJlc2VudGF0aW9uX3BhcmFtc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi1zdGF0ZS9oZWxwZXJzL3N0cnVjdHVyZS1yZXByZXNlbnRhdGlvbi1wYXJhbXNcIik7XG52YXIgc3Vic2NyaWJlX2V2ZW50c18xID0gcmVxdWlyZShcIi4vc3Vic2NyaWJlLWV2ZW50c1wiKTtcbnZhciBwZGJlX2xlZnRfcGFuZWxfMSA9IHJlcXVpcmUoXCIuL3VpL3BkYmUtbGVmdC1wYW5lbFwiKTtcbnZhciBzdXBlcnBvc2l0aW9uXzEgPSByZXF1aXJlKFwiLi9zdXBlcnBvc2l0aW9uXCIpO1xudmFyIGN1c3RvbV9ldmVudHNfMSA9IHJlcXVpcmUoXCIuL2N1c3RvbS1ldmVudHNcIik7XG52YXIgYXNzZXRzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9hc3NldHNcIik7XG52YXIgY29uZmlnXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2NvbmZpZ1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvY29sb3IvY29sb3JcIik7XG52YXIgY29tcG9uZW50XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL21hbmFnZXIvc3RydWN0dXJlL2NvbXBvbmVudFwiKTtcbnZhciBwYXJhbV9kZWZpbml0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9wYXJhbS1kZWZpbml0aW9uXCIpO1xudmFyIGJlaGF2aW9yXzEgPSByZXF1aXJlKFwiLi9kb21haW4tYW5ub3RhdGlvbnMvYmVoYXZpb3JcIik7XG52YXIgcGRiZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvZXh0ZW5zaW9ucy9wZGJlXCIpO1xudmFyIGJlaGF2aW9yXzIgPSByZXF1aXJlKFwiTW9sc3Rhci9leHRlbnNpb25zL21vZGVsLWFyY2hpdmUvcXVhbGl0eS1hc3Nlc3NtZW50L2JlaGF2aW9yXCIpO1xudmFyIHN0cnVjdHVyZV9vdmVycGFpbnRfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tc3RhdGUvaGVscGVycy9zdHJ1Y3R1cmUtb3ZlcnBhaW50XCIpO1xudmFyIHN1cGVycG9zaXRpb25fZm9jdXNfcmVwcmVzZW50YXRpb25fMSA9IHJlcXVpcmUoXCIuL3N1cGVycG9zaXRpb24tZm9jdXMtcmVwcmVzZW50YXRpb25cIik7XG52YXIgc3VwZXJwb3NpdGlvbl92aWV3cG9ydF8xID0gcmVxdWlyZShcIi4vdWkvc3VwZXJwb3NpdGlvbi12aWV3cG9ydFwiKTtcbnZhciByZXByZXNlbnRhdGlvbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9iZWhhdmlvci9keW5hbWljL3JlcHJlc2VudGF0aW9uXCIpO1xudmFyIGNhbWVyYV8xID0gcmVxdWlyZShcIm1vbHN0YXIvbGliL21vbC1wbHVnaW4vYmVoYXZpb3IvZHluYW1pYy9jYW1lcmFcIik7XG52YXIgbXA0X2V4cG9ydF8xID0gcmVxdWlyZShcIk1vbHN0YXIvZXh0ZW5zaW9ucy9tcDQtZXhwb3J0XCIpO1xudmFyIGdlb19leHBvcnRfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL2V4dGVuc2lvbnMvZ2VvLWV4cG9ydFwiKTtcbnZhciBlbGVtZW50X3N5bWJvbF8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXRoZW1lL2NvbG9yL2VsZW1lbnQtc3ltYm9sXCIpO1xudmFyIG1vZGVsX2luZGV4XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL2FuaW1hdGlvbi9idWlsdC1pbi9tb2RlbC1pbmRleFwiKTtcbnZhciBjYW1lcmFfc3Bpbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi1zdGF0ZS9hbmltYXRpb24vYnVpbHQtaW4vY2FtZXJhLXNwaW5cIik7XG52YXIgc3RhdGVfc25hcHNob3RzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL2FuaW1hdGlvbi9idWlsdC1pbi9zdGF0ZS1zbmFwc2hvdHNcIik7XG52YXIgc3RhdGVfaW50ZXJwb2xhdGlvbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi1zdGF0ZS9hbmltYXRpb24vYnVpbHQtaW4vc3RhdGUtaW50ZXJwb2xhdGlvblwiKTtcbnZhciBzcGluX3N0cnVjdHVyZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi1zdGF0ZS9hbmltYXRpb24vYnVpbHQtaW4vc3Bpbi1zdHJ1Y3R1cmVcIik7XG52YXIgY2FtZXJhX3JvY2tfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tc3RhdGUvYW5pbWF0aW9uL2J1aWx0LWluL2NhbWVyYS1yb2NrXCIpO1xudmFyIGFzc2VtYmx5X3Vud2luZF8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi1zdGF0ZS9hbmltYXRpb24vYnVpbHQtaW4vYXNzZW1ibHktdW53aW5kXCIpO1xuLy9pbXBvcnQgeyBNb2RlbEluZm8yLCBTdGF0ZUVsZW1lbnRzIH0gZnJvbSAnLi9oZWxwZXJzJztcbnZhciBhbm5vdGF0aW9uXzEgPSByZXF1aXJlKFwiLi9hbm5vdGF0aW9uXCIpO1xudmFyIGFubm90YXRpb25fMiA9IHJlcXVpcmUoXCIuL2Fubm90YXRpb25cIik7XG4vL2ltcG9ydCB7IE1vZGVsSW5mbzIsIFN0YXRlRWxlbWVudHMsIFJlcHJlc2VudGF0aW9uU3R5bGUgfSBmcm9tICcuL2hlbHBlcnMnO1xudmFyIGhlbHBlcnNfMiA9IHJlcXVpcmUoXCIuL2hlbHBlcnNcIik7XG4vL2ltcG9ydCB7IFN0YXRlRWxlbWVudHMgfSBmcm9tICcuL2hlbHBlcnMnO1xuLy9pbXBvcnQgeyBTdGF0ZUVsZW1lbnRzLCBSZXByZXNlbnRhdGlvblN0eWxlIH0gZnJvbSAnLi9oZWxwZXJzJztcbnZhciB0cmFuc2Zvcm1zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL3RyYW5zZm9ybXNcIik7XG5yZXF1aXJlKCdNb2xzdGFyL21vbC1wbHVnaW4tdWkvc2tpbi9kYXJrLnNjc3MnKTtcbnZhciBQREJlTW9sc3RhclBsdWdpbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQREJlTW9sc3RhclBsdWdpbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fZXYgPSByeF9ldmVudF9oZWxwZXJfMS5SeEV2ZW50SGVscGVyLmNyZWF0ZSgpO1xuICAgICAgICB0aGlzLmV2ZW50cyA9IHtcbiAgICAgICAgICAgIGxvYWRDb21wbGV0ZTogdGhpcy5fZXYoKSxcbiAgICAgICAgICAgIG1vZGVsSW5mbzogdGhpcy5fZXYoKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmFzc2VtYmx5UmVmID0gJyc7XG4gICAgICAgIHRoaXMuaXNIaWdobGlnaHRDb2xvclVwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc1NlbGVjdGVkQ29sb3JVcGRhdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYXBwbHlWaXN1YWxQYXJhbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgVGFnUmVmcyA9IHtcbiAgICAgICAgICAgICAgICAnc3RydWN0dXJlLWNvbXBvbmVudC1zdGF0aWMtcG9seW1lcic6ICdwb2x5bWVyJyxcbiAgICAgICAgICAgICAgICAnc3RydWN0dXJlLWNvbXBvbmVudC1zdGF0aWMtbGlnYW5kJzogJ2hldCcsXG4gICAgICAgICAgICAgICAgJ3N0cnVjdHVyZS1jb21wb25lbnQtc3RhdGljLWJyYW5jaGVkJzogJ2NhcmJzJyxcbiAgICAgICAgICAgICAgICAnc3RydWN0dXJlLWNvbXBvbmVudC1zdGF0aWMtd2F0ZXInOiAnd2F0ZXInLFxuICAgICAgICAgICAgICAgICdzdHJ1Y3R1cmUtY29tcG9uZW50LXN0YXRpYy1jb2Fyc2UnOiAnY29hcnNlJyxcbiAgICAgICAgICAgICAgICAnbm9uLXN0YW5kYXJkJzogJ25vblN0YW5kYXJkJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjb21wb25lbnRHcm91cHMgPSBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50Q29tcG9uZW50R3JvdXBzO1xuICAgICAgICAgICAgY29tcG9uZW50R3JvdXBzLmZvckVhY2goZnVuY3Rpb24gKGNvbXBHcnApIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgdmFyIGNvbXBHcnBJbmRleCA9IGNvbXBHcnAubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gY29tcEdycFtjb21wR3JwSW5kZXhdLmtleTtcbiAgICAgICAgICAgICAgICB2YXIgcm0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ICYmIF90aGlzLmluaXRQYXJhbXMuaGlkZVN0cnVjdHVyZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RydWN0VHlwZSA9IFRhZ1JlZnNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cnVjdFR5cGUgJiYgKChfYSA9IF90aGlzLmluaXRQYXJhbXMuaGlkZVN0cnVjdHVyZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluZGV4T2Yoc3RydWN0VHlwZSkpID4gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICBybSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChybSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5yZW1vdmUoW2NvbXBHcnBbY29tcEdycEluZGV4XV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXJtICYmIF90aGlzLmluaXRQYXJhbXMudmlzdWFsU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBHcnBbY29tcEdycEluZGV4XSAmJiBjb21wR3JwW2NvbXBHcnBJbmRleF0ucmVwcmVzZW50YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wR3JwW2NvbXBHcnBJbmRleF0ucmVwcmVzZW50YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKHJlcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UGFyYW1zID0gKDAsIHN0cnVjdHVyZV9yZXByZXNlbnRhdGlvbl9wYXJhbXNfMS5jcmVhdGVTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvblBhcmFtcykoX3RoaXMucGx1Z2luLCB2b2lkIDAsIHsgdHlwZTogX3RoaXMuaW5pdFBhcmFtcy52aXN1YWxTdHlsZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmNvbXBvbmVudC51cGRhdGVSZXByZXNlbnRhdGlvbnMoW2NvbXBHcnBbY29tcEdycEluZGV4XV0sIHJlcCwgY3VycmVudFBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNhbnZhcyA9IHtcbiAgICAgICAgICAgIHRvZ2dsZUNvbnRyb2xzOiBmdW5jdGlvbiAoaXNWaXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpc1Zpc2libGUgPT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgICAgICAgICBpc1Zpc2libGUgPSAhX3RoaXMucGx1Z2luLmxheW91dC5zdGF0ZS5zaG93Q29udHJvbHM7XG4gICAgICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5MYXlvdXQuVXBkYXRlKF90aGlzLnBsdWdpbiwgeyBzdGF0ZTogeyBzaG93Q29udHJvbHM6IGlzVmlzaWJsZSB9IH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvZ2dsZUV4cGFuZGVkOiBmdW5jdGlvbiAoaXNFeHBhbmRlZCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXNFeHBhbmRlZCA9PT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICAgICAgICAgIGlzRXhwYW5kZWQgPSAhX3RoaXMucGx1Z2luLmxheW91dC5zdGF0ZS5pc0V4cGFuZGVkO1xuICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuTGF5b3V0LlVwZGF0ZShfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IHsgaXNFeHBhbmRlZDogaXNFeHBhbmRlZCB9IH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldEJnQ29sb3I6IGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgICAgIGlmICghY29sb3IpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBfdGhpcy5jYW52YXMuYXBwbHlTZXR0aW5ncyh7IGNvbG9yOiBjb2xvciB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhcHBseVNldHRpbmdzOiBmdW5jdGlvbiAoc2V0dGluZ3MpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXNldHRpbmdzKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgdmFyIHJlbmRlcmVyUGFyYW1zID0ge307XG4gICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmNvbG9yKVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJlclBhcmFtc1snYmFja2dyb3VuZENvbG9yJ10gPSBjb2xvcl8xLkNvbG9yLmZyb21SZ2Ioc2V0dGluZ3MuY29sb3Iuciwgc2V0dGluZ3MuY29sb3IuZywgc2V0dGluZ3MuY29sb3IuYik7XG4gICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmxpZ2h0aW5nKVxuICAgICAgICAgICAgICAgICAgICByZW5kZXJlclBhcmFtc1snc3R5bGUnXSA9IHsgbmFtZTogc2V0dGluZ3MubGlnaHRpbmcgfTtcbiAgICAgICAgICAgICAgICB2YXIgcmVuZGVyZXIgPSBfdGhpcy5wbHVnaW4uY2FudmFzM2QucHJvcHMucmVuZGVyZXI7XG4gICAgICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5DYW52YXMzRC5TZXRTZXR0aW5ncyhfdGhpcy5wbHVnaW4sIHsgc2V0dGluZ3M6IHsgcmVuZGVyZXI6IHRzbGliXzEuX19hc3NpZ24odHNsaWJfMS5fX2Fzc2lnbih7fSwgcmVuZGVyZXIpLCByZW5kZXJlclBhcmFtcykgfSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jb2xvcmluZyA9IHtcbiAgICAgICAgICAgIHNoYW5ub25FbnRyb3B5OiBmdW5jdGlvbiAocGFyYW1zKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUsIHRyZWUsIGNvbG9yVGhlbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmFtcyB8fCAhcGFyYW1zLmtlZXBTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhd2FpdCB0aGlzLnVwZGF0ZVN0eWxlKHsgc2VxdWVuY2U6IHsga2luZDogJ3NwYWNlZmlsbCcgfSB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzLnN0YXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyZWUgPSBzdGF0ZS5idWlsZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yVGhlbWUgPSB7IG5hbWU6IGFubm90YXRpb25fMS5TaGFubm9uRW50cm9weS5wcm9wZXJ0eVByb3ZpZGVyLmRlc2NyaXB0b3IubmFtZSwgcGFyYW1zOiB0aGlzLnBsdWdpbi5yZXByZXNlbnRhdGlvbi5zdHJ1Y3R1cmUudGhlbWVzLmNvbG9yVGhlbWVSZWdpc3RyeS5nZXQoYW5ub3RhdGlvbl8xLlNoYW5ub25FbnRyb3B5LnByb3BlcnR5UHJvdmlkZXIuZGVzY3JpcHRvci5uYW1lKS5kZWZhdWx0VmFsdWVzIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJhbXMgfHwgISFwYXJhbXMuc2VxdWVuY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJlZS50byhoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5TZXF1ZW5jZVZpc3VhbCkudXBkYXRlKHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuUmVwcmVzZW50YXRpb24uU3RydWN0dXJlUmVwcmVzZW50YXRpb24zRCwgZnVuY3Rpb24gKG9sZCkgeyByZXR1cm4gKHRzbGliXzEuX19hc3NpZ24odHNsaWJfMS5fX2Fzc2lnbih7fSwgb2xkKSwgeyBjb2xvclRoZW1lOiBjb2xvclRoZW1lIH0pKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMgJiYgISFwYXJhbXMuaGV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyZWUudG8oaGVscGVyc18yLlN0YXRlRWxlbWVudHMuSGV0VmlzdWFsKS51cGRhdGUodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5SZXByZXNlbnRhdGlvbi5TdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbjNELCBmdW5jdGlvbiAob2xkKSB7IHJldHVybiAodHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCBvbGQpLCB7IGNvbG9yVGhlbWU6IGNvbG9yVGhlbWUgfSkpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5TdGF0ZS5VcGRhdGUodGhpcy5wbHVnaW4sIHsgc3RhdGU6IHN0YXRlLCB0cmVlOiB0cmVlIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIHR3aW5Db25zOiBmdW5jdGlvbiAocGFyYW1zKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUsIHRyZWUsIGNvbG9yVGhlbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmFtcyB8fCAhcGFyYW1zLmtlZXBTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhd2FpdCB0aGlzLnVwZGF0ZVN0eWxlKHsgc2VxdWVuY2U6IHsga2luZDogJ3NwYWNlZmlsbCcgfSB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSB0aGlzLnN0YXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyZWUgPSBzdGF0ZS5idWlsZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yVGhlbWUgPSB7IG5hbWU6IGFubm90YXRpb25fMi5Ud2luQ29uc0RhdGEucHJvcGVydHlQcm92aWRlci5kZXNjcmlwdG9yLm5hbWUsIHBhcmFtczogdGhpcy5wbHVnaW4ucmVwcmVzZW50YXRpb24uc3RydWN0dXJlLnRoZW1lcy5jb2xvclRoZW1lUmVnaXN0cnkuZ2V0KGFubm90YXRpb25fMi5Ud2luQ29uc0RhdGEucHJvcGVydHlQcm92aWRlci5kZXNjcmlwdG9yLm5hbWUpLmRlZmF1bHRWYWx1ZXMgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmFtcyB8fCAhIXBhcmFtcy5zZXF1ZW5jZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmVlLnRvKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLlNlcXVlbmNlVmlzdWFsKS51cGRhdGUodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5SZXByZXNlbnRhdGlvbi5TdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbjNELCBmdW5jdGlvbiAob2xkKSB7IHJldHVybiAodHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCBvbGQpLCB7IGNvbG9yVGhlbWU6IGNvbG9yVGhlbWUgfSkpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcyAmJiAhIXBhcmFtcy5oZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJlZS50byhoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5IZXRWaXN1YWwpLnVwZGF0ZSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLlJlcHJlc2VudGF0aW9uLlN0cnVjdHVyZVJlcHJlc2VudGF0aW9uM0QsIGZ1bmN0aW9uIChvbGQpIHsgcmV0dXJuICh0c2xpYl8xLl9fYXNzaWduKHRzbGliXzEuX19hc3NpZ24oe30sIG9sZCksIHsgY29sb3JUaGVtZTogY29sb3JUaGVtZSB9KSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlVwZGF0ZSh0aGlzLnBsdWdpbiwgeyBzdGF0ZTogc3RhdGUsIHRyZWU6IHRyZWUgfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pOyB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudmlzdWFsID0ge1xuICAgICAgICAgICAgaGlnaGxpZ2h0aW5nOiBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvY2kgPSBfdGhpcy5nZXRMb2NpRm9yUGFyYW1zKHBhcmFtcy5kYXRhLCBwYXJhbXMuc3RydWN0dXJlTnVtYmVyKTtcbiAgICAgICAgICAgICAgICBwYXJhbXMuY29sb3IgPSB7IHI6IDY1LCBnOiA5NiwgYjogOTEgfTtcbiAgICAgICAgICAgICAgICBpZiAobG9jaV8xLkxvY2kuaXNFbXB0eShsb2NpKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlzdWFsLnNldENvbG9yKHsgaGlnaGxpZ2h0OiBwYXJhbXMuY29sb3IgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnBsdWdpbi5tYW5hZ2Vycy5pbnRlcmFjdGl2aXR5LmxvY2lIaWdobGlnaHRzLmhpZ2hsaWdodE9ubHkoeyBsb2NpOiBsb2NpIH0pO1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuZm9jdXMpXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBsdWdpbi5tYW5hZ2Vycy5jYW1lcmEuZm9jdXNMb2NpKGxvY2kpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNsZWFySGlnaGxpZ2h0aW5nOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ubWFuYWdlcnMuaW50ZXJhY3Rpdml0eS5sb2NpSGlnaGxpZ2h0cy5oaWdobGlnaHRPbmx5KHsgbG9jaTogbG9jaV8xLkVtcHR5TG9jaSB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNIaWdobGlnaHRDb2xvclVwZGF0ZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc3VhbC5yZXNldCh7IGhpZ2hsaWdodENvbG9yOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIGNvbG9yQnlDaGFpbjogZnVuY3Rpb24gKGRhdGEpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdHJ1Y3R1cmVEYXRhLCBpLCBfYSwgc3RydWN0dXJlRGF0YV8xLCBzdHJ1Y3R1cmVEYXRhXzFfMSwgcywgY29sb3IsIGVfMV8xO1xuICAgICAgICAgICAgICAgIHZhciBfYiwgZV8xLCBfYywgX2Q7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2UubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmVEYXRhID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnN0cnVjdHVyZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lLnRyeXMucHVzaChbMSwgMTAsIDExLCAxNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdHJ1ZSwgc3RydWN0dXJlRGF0YV8xID0gdHNsaWJfMS5fX2FzeW5jVmFsdWVzKHN0cnVjdHVyZURhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgc3RydWN0dXJlRGF0YV8xLm5leHQoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoc3RydWN0dXJlRGF0YV8xXzEgPSBfZS5zZW50KCksIF9iID0gc3RydWN0dXJlRGF0YV8xXzEuZG9uZSwgIV9iKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSBzdHJ1Y3R1cmVEYXRhXzFfMS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZS50cnlzLnB1c2goWzQsICwgNywgOF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBfZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gZGF0YVtpIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hd2FpdCB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuY29tcG9uZW50LnVwZGF0ZVJlcHJlc2VudGF0aW9uc1RoZW1lKHMuY29tcG9uZW50cywgeyBjb2xvcjogJ3VuaWZvcm0nLCBjb2xvclBhcmFtczogeyB2YWx1ZTogdGhpcy5ub3JtYWxpemVDb2xvcihwYXJhbXMubm9uU2VsZWN0ZWRDb2xvcikgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuY29tcG9uZW50LnVwZGF0ZVJlcHJlc2VudGF0aW9uc1RoZW1lKHMuY29tcG9uZW50cywgeyBjb2xvcjogJ3VuaWZvcm0nLCBjb2xvclBhcmFtczogeyB2YWx1ZTogdGhpcy5ub3JtYWxpemVDb2xvcihjb2xvcikgfSB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hd2FpdCB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuY29tcG9uZW50LnVwZGF0ZVJlcHJlc2VudGF0aW9uc1RoZW1lKHMuY29tcG9uZW50cywgeyBjb2xvcjogJ3VuaWZvcm0nLCBjb2xvclBhcmFtczogeyB2YWx1ZTogdGhpcy5ub3JtYWxpemVDb2xvcihwYXJhbXMubm9uU2VsZWN0ZWRDb2xvcikgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA2O1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMyAvKmJyZWFrKi8sIDE2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZV8xXzEgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0geyBlcnJvcjogZV8xXzEgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxNl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lLnRyeXMucHVzaChbMTEsICwgMTQsIDE1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIV9hICYmICFfYiAmJiAoX2MgPSBzdHJ1Y3R1cmVEYXRhXzEucmV0dXJuKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDEzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBfYy5jYWxsKHN0cnVjdHVyZURhdGFfMSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSAxMztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6IHJldHVybiBbMyAvKmJyZWFrKi8sIDE1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE1OiByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIHNlbGVjdDogZnVuY3Rpb24gKHBhcmFtcykgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0cnVjdHVyZURhdGEsIF9hLCBzdHJ1Y3R1cmVEYXRhXzIsIHN0cnVjdHVyZURhdGFfMl8xLCBzLCBlXzJfMSwgX2IsIF9jLCBfZCwgcGFyYW0sIGxvY2ksIHRoZW1lUGFyYW1zLCBjb2xvclZhbHVlLCByZXByLCBkZWZhdWx0UGFyYW1zLCBkZWZhdWx0VmFsdWVzLCB2YWx1ZXMsIHN0cnVjdHVyZXMsIHVwZGF0ZWRTdHJ1Y3R1cmVEYXRhLCBjb21wcywgbGFzdENvbXBzSW5kZXgsIHJlY2VudFJlcENvbXAsIHVuaWZvcm1Db2xvciwgZV8zXzE7XG4gICAgICAgICAgICAgICAgdmFyIF9lLCBlXzIsIF9mLCBfZywgX2gsIGVfMywgX2osIF9rO1xuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfbCkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9sLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkUGFyYW1zKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnZpc3VhbC5jbGVhclNlbGVjdGlvbihwYXJhbXMuc3RydWN0dXJlTnVtYmVyKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2wuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmVEYXRhID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnN0cnVjdHVyZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5zdHJ1Y3R1cmVOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0dXJlRGF0YSA9IFt0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQuc3RydWN0dXJlc1twYXJhbXMuc3RydWN0dXJlTnVtYmVyIC0gMV1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmFtcy5ub25TZWxlY3RlZENvbG9yKSByZXR1cm4gWzMgLypicmVhayovLCAxN107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2wubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLnRyeXMucHVzaChbMywgMTEsIDEyLCAxN10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdHJ1ZSwgc3RydWN0dXJlRGF0YV8yID0gdHNsaWJfMS5fX2FzeW5jVmFsdWVzKHN0cnVjdHVyZURhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFs0IC8qeWllbGQqLywgc3RydWN0dXJlRGF0YV8yLm5leHQoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoc3RydWN0dXJlRGF0YV8yXzEgPSBfbC5zZW50KCksIF9lID0gc3RydWN0dXJlRGF0YV8yXzEuZG9uZSwgIV9lKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9nID0gc3RydWN0dXJlRGF0YV8yXzEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbC5sYWJlbCA9IDY7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2wudHJ5cy5wdXNoKFs2LCAsIDgsIDldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gX2c7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmNvbXBvbmVudC51cGRhdGVSZXByZXNlbnRhdGlvbnNUaGVtZShzLmNvbXBvbmVudHMsIHsgY29sb3I6ICd1bmlmb3JtJywgY29sb3JQYXJhbXM6IHsgdmFsdWU6IHRoaXMubm9ybWFsaXplQ29sb3IocGFyYW1zLm5vblNlbGVjdGVkQ29sb3IpIH0gfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOTogcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOiByZXR1cm4gWzMgLypicmVhayovLCAxN107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMl8xID0gX2wuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMiA9IHsgZXJyb3I6IGVfMl8xIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTddO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbC50cnlzLnB1c2goWzEyLCAsIDE1LCAxNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFfYSAmJiAhX2UgJiYgKF9mID0gc3RydWN0dXJlRGF0YV8yLnJldHVybikpKSByZXR1cm4gWzMgLypicmVhayovLCAxNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgX2YuY2FsbChzdHJ1Y3R1cmVEYXRhXzIpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2wuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLmxhYmVsID0gMTQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OiByZXR1cm4gWzMgLypicmVhayovLCAxNl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjogcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2wudHJ5cy5wdXNoKFsxNywgMjcsIDI4LCAzM10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdHJ1ZSwgX2MgPSB0c2xpYl8xLl9fYXN5bmNWYWx1ZXMocGFyYW1zLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLmxhYmVsID0gMTg7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE4OiByZXR1cm4gWzQgLyp5aWVsZCovLCBfYy5uZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfZCA9IF9sLnNlbnQoKSwgX2ggPSBfZC5kb25lLCAhX2gpKSByZXR1cm4gWzMgLypicmVhayovLCAyNl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2sgPSBfZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLmxhYmVsID0gMjA7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLnRyeXMucHVzaChbMjAsICwgMjQsIDI1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0gPSBfaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NpID0gdGhpcy5nZXRMb2NpRm9yUGFyYW1zKFtwYXJhbV0sIHBhcmFtcy5zdHJ1Y3R1cmVOdW1iZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2NpXzEuTG9jaS5pc0VtcHR5KGxvY2kpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGRlZmF1bHQgc2VsZWN0aW9uIGNvbG9yIHRvIG1pbmltaXNlIGNoYW5nZSBkaXNwbGF5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aXN1YWwuc2V0Q29sb3IoeyBzZWxlY3Q6IHBhcmFtLmNvbG9yID8gcGFyYW0uY29sb3IgOiB7IHI6IDI1NSwgZzogMjU1LCBiOiAyNTUgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhcHBseSBzZWxlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5pbnRlcmFjdGl2aXR5LmxvY2lTZWxlY3RzLnNlbGVjdE9ubHkoeyBsb2NpOiBsb2NpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lUGFyYW1zID0gY29tcG9uZW50XzEuU3RydWN0dXJlQ29tcG9uZW50TWFuYWdlci5nZXRUaGVtZVBhcmFtcyh0aGlzLnBsdWdpbiwgdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmNvbXBvbmVudC5waXZvdFN0cnVjdHVyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JWYWx1ZSA9IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uZ2V0RGVmYXVsdFZhbHVlcyh0aGVtZVBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JWYWx1ZS5hY3Rpb24ucGFyYW1zID0geyBjb2xvcjogcGFyYW0uY29sb3IgPyB0aGlzLm5vcm1hbGl6ZUNvbG9yKHBhcmFtLmNvbG9yKSA6IGNvbG9yXzEuQ29sb3IuZnJvbVJnYigyNTUsIDI1NSwgMjU1KSwgb3BhY2l0eTogMSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5jb21wb25lbnQuYXBwbHlUaGVtZShjb2xvclZhbHVlLCBzdHJ1Y3R1cmVEYXRhKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShwYXJhbS5zaWRlQ2hhaW4gfHwgcGFyYW0ucmVwcmVzZW50YXRpb24pKSByZXR1cm4gWzMgLypicmVhayovLCAyM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwciA9ICdiYWxsLWFuZC1zdGljayc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtLnJlcHJlc2VudGF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXByID0gcGFyYW0ucmVwcmVzZW50YXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFBhcmFtcyA9IGNvbXBvbmVudF8xLlN0cnVjdHVyZUNvbXBvbmVudE1hbmFnZXIuZ2V0QWRkUGFyYW1zKHRoaXMucGx1Z2luLCB7IGFsbG93Tm9uZTogZmFsc2UsIGhpZGVTZWxlY3Rpb246IHRydWUsIGNoZWNrRXhpc3Rpbmc6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlcyA9IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uZ2V0RGVmYXVsdFZhbHVlcyhkZWZhdWx0UGFyYW1zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWVzLm9wdGlvbnMgPSB7IGxhYmVsOiAnc2VsZWN0aW9uLWJ5LXNjcmlwdCcsIGNoZWNrRXhpc3Rpbmc6IHBhcmFtcy5zdHJ1Y3R1cmVOdW1iZXIgPyBmYWxzZSA6IHRydWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB0c2xpYl8xLl9fYXNzaWduKHRzbGliXzEuX19hc3NpZ24oe30sIGRlZmF1bHRWYWx1ZXMpLCB7IHJlcHJlc2VudGF0aW9uOiByZXByIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZXMgPSB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmdldFN0cnVjdHVyZXNXaXRoU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmNvbXBvbmVudC5hZGQodmFsdWVzLCBzdHJ1Y3R1cmVzKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDIyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSB1bmlmb3JtIHRoZW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtLnJlcHJlc2VudGF0aW9uQ29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFN0cnVjdHVyZURhdGEgPSB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQuc3RydWN0dXJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5zdHJ1Y3R1cmVOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRTdHJ1Y3R1cmVEYXRhID0gW3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudC5zdHJ1Y3R1cmVzW3BhcmFtcy5zdHJ1Y3R1cmVOdW1iZXIgLSAxXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcHMgPSB1cGRhdGVkU3RydWN0dXJlRGF0YVswXS5jb21wb25lbnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0Q29tcHNJbmRleCA9IGNvbXBzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2VudFJlcENvbXAgPSBbY29tcHNbbGFzdENvbXBzSW5kZXhdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pZm9ybUNvbG9yID0gcGFyYW0ucmVwcmVzZW50YXRpb25Db2xvciA/IHRoaXMubm9ybWFsaXplQ29sb3IocGFyYW0ucmVwcmVzZW50YXRpb25Db2xvcikgOiBjb2xvcl8xLkNvbG9yLmZyb21SZ2IoMjU1LCAyNTUsIDI1NSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5jb21wb25lbnQudXBkYXRlUmVwcmVzZW50YXRpb25zVGhlbWUocmVjZW50UmVwQ29tcCwgeyBjb2xvcjogJ3VuaWZvcm0nLCBjb2xvclBhcmFtczogeyB2YWx1ZTogdW5pZm9ybUNvbG9yIH0gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy5hZGRlZFJlcHIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLmxhYmVsID0gMjM7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDIzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvY3VzIGxvY2lcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW0uZm9jdXMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLm1hbmFnZXJzLmNhbWVyYS5mb2N1c0xvY2kobG9jaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLm1hbmFnZXJzLmludGVyYWN0aXZpdHkubG9jaVNlbGVjdHMuZGVzZWxlY3QoeyBsb2NpOiBsb2NpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDI1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI1OiByZXR1cm4gWzMgLypicmVhayovLCAxOF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI2OiByZXR1cm4gWzMgLypicmVhayovLCAzM107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfM18xID0gX2wuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMyA9IHsgZXJyb3I6IGVfM18xIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMzNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbC50cnlzLnB1c2goWzI4LCAsIDMxLCAzMl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFfYiAmJiAhX2ggJiYgKF9qID0gX2MucmV0dXJuKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDMwXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBfai5jYWxsKF9jKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbC5sYWJlbCA9IDMwO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMDogcmV0dXJuIFszIC8qYnJlYWsqLywgMzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZV8zKSB0aHJvdyBlXzMuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzI6IHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlc2V0IHNlbGVjdGlvbiBjb2xvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlzdWFsLnJlc2V0KHsgc2VsZWN0Q29sb3I6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBzZWxlY3Rpb24gcGFyYW1zIHRvIG9wdGltaXNlIGNsZWFyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFBhcmFtcyA9IHBhcmFtcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pOyB9LFxuICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb246IGZ1bmN0aW9uIChzdHJ1Y3R1cmVOdW1iZXIpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdHJ1Y3RJbmRleCwgc2VsUmVwckNlbGxzLCBfaSwgX2EsIGMsIF9iLCBzZWxSZXByQ2VsbHNfMSwgc2VsUmVwckNlbGxzXzFfMSwgc2VsUmVwckNlbGwsIGVfNF8xO1xuICAgICAgICAgICAgICAgIHZhciBfYywgZV80LCBfZCwgX2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9mKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2YubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3RJbmRleCA9IHN0cnVjdHVyZU51bWJlciA/IHN0cnVjdHVyZU51bWJlciAtIDEgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLm1hbmFnZXJzLmludGVyYWN0aXZpdHkubG9jaVNlbGVjdHMuZGVzZWxlY3RBbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXNldCB0aGVtZSB0byBkZWZhdWx0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRQYXJhbXMgJiYgdGhpcy5zZWxlY3RlZFBhcmFtcy5ub25TZWxlY3RlZENvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlzdWFsLnJlc2V0KHsgdGhlbWU6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvdmVycGFpbnRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIHN0cnVjdHVyZV9vdmVycGFpbnRfMS5jbGVhclN0cnVjdHVyZU92ZXJwYWludCkodGhpcy5wbHVnaW4sIHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudC5zdHJ1Y3R1cmVzW3N0cnVjdEluZGV4XS5jb21wb25lbnRzKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG92ZXJwYWludHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zZWxlY3RlZFBhcmFtcyAmJiB0aGlzLnNlbGVjdGVkUGFyYW1zLmFkZGVkUmVwcikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDE3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxSZXByQ2VsbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgX2EgPSB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQuc3RydWN0dXJlc1tzdHJ1Y3RJbmRleF0uY29tcG9uZW50czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMuY2VsbCAmJiBjLmNlbGwucGFyYW1zICYmIGMuY2VsbC5wYXJhbXMudmFsdWVzICYmIGMuY2VsbC5wYXJhbXMudmFsdWVzLmxhYmVsID09PSAnc2VsZWN0aW9uLWJ5LXNjcmlwdCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxSZXByQ2VsbHMucHVzaChjLmNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShzZWxSZXByQ2VsbHMubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDE3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZi5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2YudHJ5cy5wdXNoKFsyLCAxMCwgMTEsIDE2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0cnVlLCBzZWxSZXByQ2VsbHNfMSA9IHRzbGliXzEuX19hc3luY1ZhbHVlcyhzZWxSZXByQ2VsbHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgc2VsUmVwckNlbGxzXzEubmV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShzZWxSZXByQ2VsbHNfMV8xID0gX2Yuc2VudCgpLCBfYyA9IHNlbFJlcHJDZWxsc18xXzEuZG9uZSwgIV9jKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2UgPSBzZWxSZXByQ2VsbHNfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2YubGFiZWwgPSA1O1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLnRyeXMucHVzaChbNSwgLCA3LCA4XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsUmVwckNlbGwgPSBfZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlJlbW92ZU9iamVjdCh0aGlzLnBsdWdpbiwgeyBzdGF0ZTogc2VsUmVwckNlbGwucGFyZW50LCByZWY6IHNlbFJlcHJDZWxsLnRyYW5zZm9ybS5yZWYgfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMyAvKmJyZWFrKi8sIDE2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZV80XzEgPSBfZi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZV80ID0geyBlcnJvcjogZV80XzEgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxNl07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLnRyeXMucHVzaChbMTEsICwgMTQsIDE1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIV9iICYmICFfYyAmJiAoX2QgPSBzZWxSZXByQ2VsbHNfMS5yZXR1cm4pKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIF9kLmNhbGwoc2VsUmVwckNlbGxzXzEpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Yuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLmxhYmVsID0gMTM7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOiByZXR1cm4gWzMgLypicmVhayovLCAxNV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNTogcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9mLmxhYmVsID0gMTc7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQYXJhbXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKG9wdGlvbnMsIGZ1bGxMb2FkKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW0sIHBhcmFtLCBzZXR0aW5ncywgZGF0YVNvdXJjZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpb25zKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHBhcmFtIGluIHRoaXMuaW5pdFBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnNbcGFyYW1dKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBhcmFtc1twYXJhbV0gPSBvcHRpb25zW3BhcmFtXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQYXJhbXMgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBzcGVjXzEuRGVmYXVsdFBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAocGFyYW0gaW4gc3BlY18xLkRlZmF1bHRQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc1twYXJhbV0gIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFBhcmFtc1twYXJhbV0gPSBvcHRpb25zW3BhcmFtXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW5pdFBhcmFtcy5tb2xlY3VsZUlkICYmICF0aGlzLmluaXRQYXJhbXMuY3VzdG9tRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBmYWxzZV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuY3VzdG9tRGF0YSAmJiB0aGlzLmluaXRQYXJhbXMuY3VzdG9tRGF0YS51cmwgJiYgIXRoaXMuaW5pdFBhcmFtcy5jdXN0b21EYXRhLmZvcm1hdClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBmYWxzZV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLmluaXRQYXJhbXMgPSB0aGlzLmluaXRQYXJhbXM7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNldCBiYWNrZ3JvdW5kIGNvbG91clxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmJnQ29sb3IgfHwgdGhpcy5pbml0UGFyYW1zLmxpZ2h0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdFBhcmFtcy5iZ0NvbG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLmNvbG9yID0gdGhpcy5pbml0UGFyYW1zLmJnQ29sb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmxpZ2h0aW5nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLmxpZ2h0aW5nID0gdGhpcy5pbml0UGFyYW1zLmxpZ2h0aW5nO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW52YXMuYXBwbHlTZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZSA9IHRoaXMuZ2V0TW9sZWN1bGVTcmNVcmwoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZCh7IHVybDogZGF0YVNvdXJjZS51cmwsIGZvcm1hdDogZGF0YVNvdXJjZS5mb3JtYXQsIGFzc2VtYmx5SWQ6IHRoaXMuaW5pdFBhcmFtcy5hc3NlbWJseUlkLCBpc0JpbmFyeTogZGF0YVNvdXJjZS5pc0JpbmFyeSB9LCBmdWxsTG9hZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7IH0sXG4gICAgICAgICAgICB2aXNpYmlsaXR5OiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmICghZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHZhciByZWZNYXAgPSB7XG4gICAgICAgICAgICAgICAgICAgIHBvbHltZXI6ICdzdHJ1Y3R1cmUtY29tcG9uZW50LXN0YXRpYy1wb2x5bWVyJyxcbiAgICAgICAgICAgICAgICAgICAgaGV0OiAnc3RydWN0dXJlLWNvbXBvbmVudC1zdGF0aWMtbGlnYW5kJyxcbiAgICAgICAgICAgICAgICAgICAgd2F0ZXI6ICdzdHJ1Y3R1cmUtY29tcG9uZW50LXN0YXRpYy13YXRlcicsXG4gICAgICAgICAgICAgICAgICAgIGNhcmJzOiAnc3RydWN0dXJlLWNvbXBvbmVudC1zdGF0aWMtYnJhbmNoZWQnLFxuICAgICAgICAgICAgICAgICAgICBtYXBzOiAndm9sdW1lLXN0cmVhbWluZy1pbmZvJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdmlzdWFsIGluIGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhZ05hbWUgPSByZWZNYXBbdmlzdWFsXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudFJlZiA9IG1vbF9zdGF0ZV8yLlN0YXRlU2VsZWN0aW9uLmZpbmRUYWdJblN1YnRyZWUoX3RoaXMucGx1Z2luLnN0YXRlLmRhdGEudHJlZSwgbW9sX3N0YXRlXzEuU3RhdGVUcmFuc2Zvcm0uUm9vdFJlZiwgdGFnTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRSZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wVmlzdWFsID0gX3RoaXMucGx1Z2luLnN0YXRlLmRhdGEuc2VsZWN0KGNvbXBvbmVudFJlZilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcFZpc3VhbCAmJiBjb21wVmlzdWFsLm9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50bHlWaXNpYmxlID0gKGNvbXBWaXN1YWwuc3RhdGUgJiYgY29tcFZpc3VhbC5zdGF0ZS5pc0hpZGRlbikgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbdmlzdWFsXSAhPT0gY3VycmVudGx5VmlzaWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlRvZ2dsZVZpc2liaWxpdHkoX3RoaXMucGx1Z2luLCB7IHN0YXRlOiBfdGhpcy5zdGF0ZSwgcmVmOiBjb21wb25lbnRSZWYgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRvZ2dsZVNwaW46IGZ1bmN0aW9uIChpc1NwaW5uaW5nLCByZXNldENhbWVyYSkge1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMucGx1Z2luLmNhbnZhczNkKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgdmFyIHRyYWNrYmFsbCA9IF90aGlzLnBsdWdpbi5jYW52YXMzZC5wcm9wcy50cmFja2JhbGw7XG4gICAgICAgICAgICAgICAgdmFyIHRvZ2dsZVNwaW5QYXJhbSA9IHRyYWNrYmFsbC5hbmltYXRlLm5hbWUgPT09ICdzcGluJyA/IHsgbmFtZTogJ29mZicsIHBhcmFtczoge30gfSA6IHsgbmFtZTogJ3NwaW4nLCBwYXJhbXM6IHsgc3BlZWQ6IDEgfSB9O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXNTcGlubmluZyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlU3BpblBhcmFtID0geyBuYW1lOiAnb2ZmJywgcGFyYW1zOiB7fSB9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNTcGlubmluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvZ2dsZVNwaW5QYXJhbSA9IHsgbmFtZTogJ3NwaW4nLCBwYXJhbXM6IHsgc3BlZWQ6IDEgfSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkNhbnZhczNELlNldFNldHRpbmdzKF90aGlzLnBsdWdpbiwgeyBzZXR0aW5nczogeyB0cmFja2JhbGw6IHRzbGliXzEuX19hc3NpZ24odHNsaWJfMS5fX2Fzc2lnbih7fSwgdHJhY2tiYWxsKSwgeyBhbmltYXRlOiB0b2dnbGVTcGluUGFyYW0gfSkgfSB9KTtcbiAgICAgICAgICAgICAgICBpZiAocmVzZXRDYW1lcmEpXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuQ2FtZXJhLlJlc2V0KF90aGlzLnBsdWdpbiwge30pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZvY3VzOiBmdW5jdGlvbiAocGFyYW1zLCBzdHJ1Y3R1cmVOdW1iZXIpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBsb2NpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICBsb2NpID0gdGhpcy5nZXRMb2NpRm9yUGFyYW1zKHBhcmFtcywgc3RydWN0dXJlTnVtYmVyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ubWFuYWdlcnMuY2FtZXJhLmZvY3VzTG9jaShsb2NpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7IH0sXG4gICAgICAgICAgICBzZXRDb2xvcjogZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5wbHVnaW4uY2FudmFzM2QpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB2YXIgcmVuZGVyZXIgPSBfdGhpcy5wbHVnaW4uY2FudmFzM2QucHJvcHMucmVuZGVyZXI7XG4gICAgICAgICAgICAgICAgdmFyIHJQYXJhbSA9IHt9O1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbS5oaWdobGlnaHQpXG4gICAgICAgICAgICAgICAgICAgIHJQYXJhbVsnaGlnaGxpZ2h0Q29sb3InXSA9IF90aGlzLm5vcm1hbGl6ZUNvbG9yKHBhcmFtLmhpZ2hsaWdodCk7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtLnNlbGVjdClcbiAgICAgICAgICAgICAgICAgICAgclBhcmFtWydzZWxlY3RDb2xvciddID0gX3RoaXMubm9ybWFsaXplQ29sb3IocGFyYW0uc2VsZWN0KTtcbiAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkNhbnZhczNELlNldFNldHRpbmdzKF90aGlzLnBsdWdpbiwgeyBzZXR0aW5nczogeyByZW5kZXJlcjogdHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCByZW5kZXJlciksIHJQYXJhbSkgfSB9KTtcbiAgICAgICAgICAgICAgICBpZiAoclBhcmFtLmhpZ2hsaWdodENvbG9yKVxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc0hpZ2hsaWdodENvbG9yVXBkYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVzZXQ6IGZ1bmN0aW9uIChwYXJhbXMpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0VGhlbWVfMSwgY29tcG9uZW50R3JvdXBzLCByZW5kZXJlciwgclBhcmFtO1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmFtcy5jYW1lcmEpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuQ2FtZXJhLlJlc2V0KHRoaXMucGx1Z2luLCB7IGR1cmF0aW9uTXM6IDI1MCB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLnRoZW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRUaGVtZV8xID0geyBjb2xvcjogdGhpcy5pbml0UGFyYW1zLmFscGhhZm9sZFZpZXcgPyAncGxkZHQtY29uZmlkZW5jZScgOiAnZGVmYXVsdCcgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50R3JvdXBzID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50Q29tcG9uZW50R3JvdXBzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRHcm91cHMuZm9yRWFjaChmdW5jdGlvbiAoY29tcEdycCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5jb21wb25lbnQudXBkYXRlUmVwcmVzZW50YXRpb25zVGhlbWUoY29tcEdycCwgZGVmYXVsdFRoZW1lXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5oaWdobGlnaHRDb2xvciB8fCBwYXJhbXMuc2VsZWN0Q29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5jYW52YXMzZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXIgPSB0aGlzLnBsdWdpbi5jYW52YXMzZC5wcm9wcy5yZW5kZXJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgclBhcmFtID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuaGlnaGxpZ2h0Q29sb3IpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByUGFyYW1bJ2hpZ2hsaWdodENvbG9yJ10gPSB0aGlzLmRlZmF1bHRSZW5kZXJlclByb3BzLmhpZ2hsaWdodENvbG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLnNlbGVjdENvbG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgclBhcmFtWydzZWxlY3RDb2xvciddID0gdGhpcy5kZWZhdWx0UmVuZGVyZXJQcm9wcy5zZWxlY3RDb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5DYW52YXMzRC5TZXRTZXR0aW5ncyh0aGlzLnBsdWdpbiwgeyBzZXR0aW5nczogeyByZW5kZXJlcjogdHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCByZW5kZXJlciksIHJQYXJhbSkgfSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJQYXJhbS5oaWdobGlnaHRDb2xvcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNIaWdobGlnaHRDb2xvclVwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICBQREJlTW9sc3RhclBsdWdpbi5wcm90b3R5cGUudmlzdWFsMSA9IGZ1bmN0aW9uIChfc3R5bGUsIHBhcnRpYWwpIHtcbiAgICAgICAgLy9jb25zdCBzdHJ1Y3R1cmUgPSB0aGlzLmdldE9iajxQbHVnaW5TdGF0ZU9iamVjdC5Nb2xlY3VsZS5TdHJ1Y3R1cmU+KFN0YXRlRWxlbWVudHMuQXNzZW1ibHkpO1xuICAgICAgICB2YXIgc3RydWN0dXJlID0gdGhpcy5nZXRPYmoodGhpcy5hc3NlbWJseVJlZik7XG4gICAgICAgIGlmICghc3RydWN0dXJlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgc3R5bGUgPSBfc3R5bGUgfHwge307XG4gICAgICAgIHZhciB1cGRhdGUgPSB0aGlzLnN0YXRlLmJ1aWxkKCk7XG4gICAgICAgIGlmICghcGFydGlhbCB8fCAocGFydGlhbCAmJiBzdHlsZS5zZXF1ZW5jZSkpIHtcbiAgICAgICAgICAgIHZhciByb290ID0gdXBkYXRlLnRvKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLlNlcXVlbmNlKTtcbiAgICAgICAgICAgIGlmIChzdHlsZS5zZXF1ZW5jZSAmJiBzdHlsZS5zZXF1ZW5jZS5oaWRlKSB7XG4gICAgICAgICAgICAgICAgcm9vdC5kZWxldGUoaGVscGVyc18yLlN0YXRlRWxlbWVudHMuU2VxdWVuY2VWaXN1YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcm9vdC5hcHBseU9yVXBkYXRlKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLlNlcXVlbmNlVmlzdWFsLCB0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLlJlcHJlc2VudGF0aW9uLlN0cnVjdHVyZVJlcHJlc2VudGF0aW9uM0QsICgwLCBzdHJ1Y3R1cmVfcmVwcmVzZW50YXRpb25fcGFyYW1zXzEuY3JlYXRlU3RydWN0dXJlUmVwcmVzZW50YXRpb25QYXJhbXMpKHRoaXMucGx1Z2luLCBzdHJ1Y3R1cmUsIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogKHN0eWxlLnNlcXVlbmNlICYmIHN0eWxlLnNlcXVlbmNlLmtpbmQpIHx8ICdjYXJ0b29uJyxcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IChzdHlsZS5zZXF1ZW5jZSAmJiBzdHlsZS5zZXF1ZW5jZS5jb2xvcmluZykgfHwgJ3VuaXQtaW5kZXgnXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghcGFydGlhbCB8fCAocGFydGlhbCAmJiBzdHlsZS5oZXRHcm91cHMpKSB7XG4gICAgICAgICAgICB2YXIgcm9vdCA9IHVwZGF0ZS50byhoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5IZXQpO1xuICAgICAgICAgICAgaWYgKHN0eWxlLmhldEdyb3VwcyAmJiBzdHlsZS5oZXRHcm91cHMuaGlkZSkge1xuICAgICAgICAgICAgICAgIHJvb3QuZGVsZXRlKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLkhldFZpc3VhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUuaGV0R3JvdXBzICYmIHN0eWxlLmhldEdyb3Vwcy5oaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvb3QuZGVsZXRlKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLkhldFZpc3VhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByb290LmFwcGx5T3JVcGRhdGUoaGVscGVyc18yLlN0YXRlRWxlbWVudHMuSGV0VmlzdWFsLCB0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLlJlcHJlc2VudGF0aW9uLlN0cnVjdHVyZVJlcHJlc2VudGF0aW9uM0QsICgwLCBzdHJ1Y3R1cmVfcmVwcmVzZW50YXRpb25fcGFyYW1zXzEuY3JlYXRlU3RydWN0dXJlUmVwcmVzZW50YXRpb25QYXJhbXMpKHRoaXMucGx1Z2luLCBzdHJ1Y3R1cmUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IChzdHlsZS5oZXRHcm91cHMgJiYgc3R5bGUuaGV0R3JvdXBzLmtpbmQpIHx8ICdiYWxsLWFuZC1zdGljaycsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogc3R5bGUuaGV0R3JvdXBzICYmIHN0eWxlLmhldEdyb3Vwcy5jb2xvcmluZ1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghcGFydGlhbCB8fCAocGFydGlhbCAmJiBzdHlsZS5zbmZnM2QpKSB7XG4gICAgICAgICAgICB2YXIgcm9vdCA9IHVwZGF0ZS50byhoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5IZXQpO1xuICAgICAgICAgICAgaWYgKHN0eWxlLmhldEdyb3VwcyAmJiBzdHlsZS5oZXRHcm91cHMuaGlkZSkge1xuICAgICAgICAgICAgICAgIHJvb3QuZGVsZXRlKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLkhldFZpc3VhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoc3R5bGUuc25mZzNkICYmIHN0eWxlLnNuZmczZC5oaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvb3QuZGVsZXRlKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLkhldDNEU05GRyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByb290LmFwcGx5T3JVcGRhdGUoaGVscGVyc18yLlN0YXRlRWxlbWVudHMuSGV0M0RTTkZHLCB0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLlJlcHJlc2VudGF0aW9uLlN0cnVjdHVyZVJlcHJlc2VudGF0aW9uM0QsICgwLCBzdHJ1Y3R1cmVfcmVwcmVzZW50YXRpb25fcGFyYW1zXzEuY3JlYXRlU3RydWN0dXJlUmVwcmVzZW50YXRpb25QYXJhbXMpKHRoaXMucGx1Z2luLCBzdHJ1Y3R1cmUsIHsgdHlwZTogJ2NhcmJvaHlkcmF0ZScgfSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcnRpYWwgfHwgKHBhcnRpYWwgJiYgc3R5bGUud2F0ZXIpKSB7XG4gICAgICAgICAgICB2YXIgcm9vdCA9IHVwZGF0ZS50byhoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5XYXRlcik7XG4gICAgICAgICAgICBpZiAoc3R5bGUud2F0ZXIgJiYgc3R5bGUud2F0ZXIuaGlkZSkge1xuICAgICAgICAgICAgICAgIHJvb3QuZGVsZXRlKGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLldhdGVyVmlzdWFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJvb3QuYXBwbHlPclVwZGF0ZShoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5XYXRlclZpc3VhbCwgdHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5SZXByZXNlbnRhdGlvbi5TdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbjNELCAoMCwgc3RydWN0dXJlX3JlcHJlc2VudGF0aW9uX3BhcmFtc18xLmNyZWF0ZVN0cnVjdHVyZVJlcHJlc2VudGF0aW9uUGFyYW1zKSh0aGlzLnBsdWdpbiwgc3RydWN0dXJlLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IChzdHlsZS53YXRlciAmJiBzdHlsZS53YXRlci5raW5kKSB8fCAnYmFsbC1hbmQtc3RpY2snLFxuICAgICAgICAgICAgICAgICAgICB0eXBlUGFyYW1zOiB7IGFscGhhOiAwLjUxIH0sXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiBzdHlsZS53YXRlciAmJiBzdHlsZS53YXRlci5jb2xvcmluZ1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXBkYXRlO1xuICAgIH07XG4gICAgUERCZU1vbHN0YXJQbHVnaW4ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICh0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbSwgZGVmYXVsdFBEQmVTcGVjLCBwZGJlUGx1Z2luU3BlYywgX2IsIHNldHRpbmdzLCBkYXRhU291cmNlO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0UGFyYW1zID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgc3BlY18xLkRlZmF1bHRQYXJhbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChwYXJhbSBpbiBzcGVjXzEuRGVmYXVsdFBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc1twYXJhbV0gIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQYXJhbXNbcGFyYW1dID0gb3B0aW9uc1twYXJhbV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW5pdFBhcmFtcy5tb2xlY3VsZUlkICYmICF0aGlzLmluaXRQYXJhbXMuY3VzdG9tRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgZmFsc2VdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdFBhcmFtcy5jdXN0b21EYXRhICYmIHRoaXMuaW5pdFBhcmFtcy5jdXN0b21EYXRhLnVybCAmJiAhdGhpcy5pbml0UGFyYW1zLmN1c3RvbURhdGEuZm9ybWF0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBmYWxzZV07XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0UERCZVNwZWMgPSAoMCwgc3BlY18xLkRlZmF1bHRQbHVnaW5VSVNwZWMpKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiB0c2xpYl8xLl9fc3ByZWFkQXJyYXkoW10sIGRlZmF1bHRQREJlU3BlYy5hY3Rpb25zIHx8IFtdLCB0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWhhdmlvcnM6IHRzbGliXzEuX19zcHJlYWRBcnJheShbXSwgZGVmYXVsdFBEQmVTcGVjLmJlaGF2aW9ycywgdHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uczogdHNsaWJfMS5fX3NwcmVhZEFycmF5KFtdLCBkZWZhdWx0UERCZVNwZWMuYW5pbWF0aW9ucyB8fCBbXSwgdHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tUGFyYW1FZGl0b3JzOiBkZWZhdWx0UERCZVNwZWMuY3VzdG9tUGFyYW1FZGl0b3JzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZzogZGVmYXVsdFBEQmVTcGVjLmNvbmZpZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0UGFyYW1zLmxpZ2FuZFZpZXcgJiYgIXRoaXMuaW5pdFBhcmFtcy5zdXBlcnBvc2l0aW9uICYmIHRoaXMuaW5pdFBhcmFtcy5zZWxlY3RJbnRlcmFjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkYmVQbHVnaW5TcGVjLmJlaGF2aW9ycy5wdXNoKHNwZWNfMi5QbHVnaW5TcGVjLkJlaGF2aW9yKHN0cnVjdHVyZV9mb2N1c19yZXByZXNlbnRhdGlvbl8xLlN0cnVjdHVyZUZvY3VzUmVwcmVzZW50YXRpb24pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkYmVQbHVnaW5TcGVjLmJlaGF2aW9ycy5wdXNoKHNwZWNfMi5QbHVnaW5TcGVjLkJlaGF2aW9yKHN1cGVycG9zaXRpb25fZm9jdXNfcmVwcmVzZW50YXRpb25fMS5TdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvbiksIHNwZWNfMi5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzIuTUFRdWFsaXR5QXNzZXNzbWVudCwgeyBhdXRvQXR0YWNoOiB0cnVlLCBzaG93VG9vbHRpcDogdHJ1ZSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgY3VzdG9tIHByb3BlcnRpZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuZG9tYWluQW5ub3RhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkYmVQbHVnaW5TcGVjLmJlaGF2aW9ycy5wdXNoKHNwZWNfMi5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUERCZURvbWFpbkFubm90YXRpb25zLCB7IGF1dG9BdHRhY2g6IHRydWUsIHNob3dUb29sdGlwOiBmYWxzZSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLnZhbGlkYXRpb25Bbm5vdGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRiZVBsdWdpblNwZWMuYmVoYXZpb3JzLnB1c2goc3BlY18yLlBsdWdpblNwZWMuQmVoYXZpb3IocGRiZV8xLlBEQmVTdHJ1Y3R1cmVRdWFsaXR5UmVwb3J0LCB7IGF1dG9BdHRhY2g6IHRydWUsIHNob3dUb29sdGlwOiBmYWxzZSB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5sYXlvdXQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdGlhbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0V4cGFuZGVkOiB0aGlzLmluaXRQYXJhbXMubGFuZHNjYXBlID8gZmFsc2UgOiB0aGlzLmluaXRQYXJhbXMuZXhwYW5kZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDb250cm9sczogIXRoaXMuaW5pdFBhcmFtcy5oaWRlQ29udHJvbHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcGRiZVBsdWdpblNwZWMuY29tcG9uZW50cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBwZGJlX2xlZnRfcGFuZWxfMS5MZWZ0UGFuZWxDb250cm9scyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmlnaHQ6IERlZmF1bHRTdHJ1Y3R1cmVUb29scyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAnbm9uZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbTogJ25vbmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3cG9ydDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sczogcGRiZV92aWV3cG9ydF9jb250cm9sc18xLlBEQmVWaWV3cG9ydENvbnRyb2xzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3OiB0aGlzLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvbiA/IHN1cGVycG9zaXRpb25fdmlld3BvcnRfMS5TdXBlcnBvc3Rpb25WaWV3cG9ydCA6IHZvaWQgMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlU3RhdGU6ICdub25lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmVUb29sczogdGhpcy5pbml0UGFyYW1zLnN1cGVycG9zaXRpb24gPyBwZGJlX3N0cnVjdHVyZV9jb250cm9sc18xLlBEQmVTdXBlcnBvc2l0aW9uU3RydWN0dXJlVG9vbHMgOiB0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldyA/IHBkYmVfc3RydWN0dXJlX2NvbnRyb2xzXzEuUERCZUxpZ2FuZFZpZXdTdHJ1Y3R1cmVUb29scyA6IHBkYmVfc3RydWN0dXJlX2NvbnRyb2xzXzEuUERCZVN0cnVjdHVyZVRvb2xzXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdFBhcmFtcy5hbHBoYWZvbGRWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRiZVBsdWdpblNwZWMuYmVoYXZpb3JzLnB1c2goc3BlY18yLlBsdWdpblNwZWMuQmVoYXZpb3IoYmVoYXZpb3JfMi5NQVF1YWxpdHlBc3Nlc3NtZW50LCB7IGF1dG9BdHRhY2g6IHRydWUsIHNob3dUb29sdGlwOiB0cnVlIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5jb21wb25lbnRzLmNvbnRyb2xzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAnbm9uZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiAnbm9uZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvcDogJ25vbmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3R0b206ICdub25lJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLnNlcXVlbmNlUGFuZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKF9hID0gcGRiZVBsdWdpblNwZWMuY29tcG9uZW50cy5jb250cm9scykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRvcClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHBkYmVQbHVnaW5TcGVjLmNvbXBvbmVudHMuY29udHJvbHMudG9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGRiZVBsdWdpblNwZWMuY29uZmlnID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnXzEuUGx1Z2luQ29uZmlnLlN0cnVjdHVyZS5EZWZhdWx0UmVwcmVzZW50YXRpb25QcmVzZXRQYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsTmFtZTogKHRoaXMuaW5pdFBhcmFtcy5hbHBoYWZvbGRWaWV3KSA/ICdwbGRkdC1jb25maWRlbmNlJyA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJib25Db2xvcjogeyBuYW1lOiAnZWxlbWVudC1zeW1ib2wnLCBwYXJhbXM6IHt9IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2VsZW1lbnQtc3ltYm9sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7IGNhcmJvbkNvbG9yOiB7IG5hbWU6ICdlbGVtZW50LXN5bWJvbCcsIHBhcmFtczoge30gfSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRfc3ltYm9sXzEuRWxlbWVudFN5bWJvbENvbG9yVGhlbWVQYXJhbXMuY2FyYm9uQ29sb3IuZGVmYXVsdFZhbHVlID0geyBuYW1lOiAnZWxlbWVudC1zeW1ib2wnLCBwYXJhbXM6IHt9IH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYW5pbWF0aW9uIHByb3BzXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW5pdFBhcmFtcy5saWdhbmRWaWV3ICYmICF0aGlzLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkYmVQbHVnaW5TcGVjWydhbmltYXRpb25zJ10gPSBbbW9kZWxfaW5kZXhfMS5BbmltYXRlTW9kZWxJbmRleCwgY2FtZXJhX3NwaW5fMS5BbmltYXRlQ2FtZXJhU3BpbiwgY2FtZXJhX3JvY2tfMS5BbmltYXRlQ2FtZXJhUm9jaywgc3RhdGVfc25hcHNob3RzXzEuQW5pbWF0ZVN0YXRlU25hcHNob3RzLCBhc3NlbWJseV91bndpbmRfMS5BbmltYXRlQXNzZW1ibHlVbndpbmQsIHNwaW5fc3RydWN0dXJlXzEuQW5pbWF0ZVN0cnVjdHVyZVNwaW4sIHN0YXRlX2ludGVycG9sYXRpb25fMS5BbmltYXRlU3RhdGVJbnRlcnBvbGF0aW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5iZWhhdmlvcnMucHVzaChzcGVjXzIuUGx1Z2luU3BlYy5CZWhhdmlvcihtcDRfZXhwb3J0XzEuTXA0RXhwb3J0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRiZVBsdWdpblNwZWMuYmVoYXZpb3JzLnB1c2goc3BlY18yLlBsdWdpblNwZWMuQmVoYXZpb3IoZ2VvX2V4cG9ydF8xLkdlb21ldHJ5RXhwb3J0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmhpZGVDYW52YXNDb250cm9scykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuaGlkZUNhbnZhc0NvbnRyb2xzLmluZGV4T2YoJ2V4cGFuZCcpID4gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkYmVQbHVnaW5TcGVjLmNvbmZpZy5wdXNoKFtjb25maWdfMS5QbHVnaW5Db25maWcuVmlld3BvcnQuU2hvd0V4cGFuZCwgZmFsc2VdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmhpZGVDYW52YXNDb250cm9scy5pbmRleE9mKCdzZWxlY3Rpb24nKSA+IC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5jb25maWcucHVzaChbY29uZmlnXzEuUGx1Z2luQ29uZmlnLlZpZXdwb3J0LlNob3dTZWxlY3Rpb25Nb2RlLCBmYWxzZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuaGlkZUNhbnZhc0NvbnRyb2xzLmluZGV4T2YoJ2FuaW1hdGlvbicpID4gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkYmVQbHVnaW5TcGVjLmNvbmZpZy5wdXNoKFtjb25maWdfMS5QbHVnaW5Db25maWcuVmlld3BvcnQuU2hvd0FuaW1hdGlvbiwgZmFsc2VdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMubGFuZHNjYXBlICYmIHBkYmVQbHVnaW5TcGVjLmxheW91dCAmJiBwZGJlUGx1Z2luU3BlYy5sYXlvdXQuaW5pdGlhbClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5sYXlvdXQuaW5pdGlhbFsnY29udHJvbHNEaXNwbGF5J10gPSAnbGFuZHNjYXBlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG92ZXJyaWRlIGRlZmF1bHQgZXZlbnQgYmluZGluZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuc2VsZWN0QmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5iZWhhdmlvcnMucHVzaChzcGVjXzIuUGx1Z2luU3BlYy5CZWhhdmlvcihyZXByZXNlbnRhdGlvbl8xLlNlbGVjdExvY2ksIHsgYmluZGluZ3M6IHRoaXMuaW5pdFBhcmFtcy5zZWxlY3RCaW5kaW5ncyB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmZvY3VzQmluZGluZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGJlUGx1Z2luU3BlYy5iZWhhdmlvcnMucHVzaChzcGVjXzIuUGx1Z2luU3BlYy5CZWhhdmlvcihjYW1lcmFfMS5Gb2N1c0xvY2ksIHsgYmluZGluZ3M6IHRoaXMuaW5pdFBhcmFtcy5mb2N1c0JpbmRpbmdzIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCA9IHR5cGVvZiB0YXJnZXQgPT09ICdzdHJpbmcnID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0KSA6IHRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZS8gSW5pdGlhbGlzZSBQbHVnaW5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sICgwLCBzcGVjXzEuY3JlYXRlUGx1Z2luVUkpKHRoaXMudGFyZ2V0RWxlbWVudCwgcGRiZVBsdWdpblNwZWMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlLyBJbml0aWFsaXNlIFBsdWdpblxuICAgICAgICAgICAgICAgICAgICAgICAgX2IucGx1Z2luID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGUuaW5pdFBhcmFtcyA9IHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuaW5pdFBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5ldmVudHMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudFVwZGF0ZTogdGhpcy5fZXYoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXBlcnBvc2l0aW9uSW5pdDogdGhpcy5fZXYoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0J1c3k6IHRoaXMuX2V2KClcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgYmFja2dyb3VuZCBjb2xvdXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuYmdDb2xvciB8fCB0aGlzLmluaXRQYXJhbXMubGlnaHRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuYmdDb2xvcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuY29sb3IgPSB0aGlzLmluaXRQYXJhbXMuYmdDb2xvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmxpZ2h0aW5nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5saWdodGluZyA9IHRoaXMuaW5pdFBhcmFtcy5saWdodGluZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5hcHBseVNldHRpbmdzKHNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBzZWxlY3Rpb24gZ3JhbnVsYXJpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuZ3JhbnVsYXJpdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5pbnRlcmFjdGl2aXR5LnNldFByb3BzKHsgZ3JhbnVsYXJpdHk6IHRoaXMuaW5pdFBhcmFtcy5ncmFudWxhcml0eSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBkZWZhdWx0IGhpZ2hsaWdodCBhbmQgc2VsZWN0aW9uIGNvbG9yc1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdFBhcmFtcy5oaWdobGlnaHRDb2xvciB8fCB0aGlzLmluaXRQYXJhbXMuc2VsZWN0Q29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpc3VhbC5zZXRDb2xvcih7IGhpZ2hsaWdodDogdGhpcy5pbml0UGFyYW1zLmhpZ2hsaWdodENvbG9yLCBzZWxlY3Q6IHRoaXMuaW5pdFBhcmFtcy5zZWxlY3RDb2xvciB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlcHJlc2VudGF0aW9uLnN0cnVjdHVyZS50aGVtZXMuY29sb3JUaGVtZVJlZ2lzdHJ5LmFkZChhbm5vdGF0aW9uXzEuU2hhbm5vbkVudHJvcHkuY29sb3JUaGVtZVByb3ZpZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLm1hbmFnZXJzLmxvY2lMYWJlbHMuYWRkUHJvdmlkZXIoYW5ub3RhdGlvbl8xLlNoYW5ub25FbnRyb3B5LmxhYmVsUHJvdmlkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uY3VzdG9tTW9kZWxQcm9wZXJ0aWVzLnJlZ2lzdGVyKGFubm90YXRpb25fMS5TaGFubm9uRW50cm9weS5wcm9wZXJ0eVByb3ZpZGVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlcHJlc2VudGF0aW9uLnN0cnVjdHVyZS50aGVtZXMuY29sb3JUaGVtZVJlZ2lzdHJ5LmFkZChhbm5vdGF0aW9uXzIuVHdpbkNvbnNEYXRhLmNvbG9yVGhlbWVQcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5sb2NpTGFiZWxzLmFkZFByb3ZpZGVyKGFubm90YXRpb25fMi5Ud2luQ29uc0RhdGEubGFiZWxQcm92aWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5jdXN0b21Nb2RlbFByb3BlcnRpZXMucmVnaXN0ZXIoYW5ub3RhdGlvbl8yLlR3aW5Db25zRGF0YS5wcm9wZXJ0eVByb3ZpZGVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgcmVuZGVyZXIgZGVmYXVsdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdFJlbmRlcmVyUHJvcHMgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnBsdWdpbi5jYW52YXMzZC5wcm9wcy5yZW5kZXJlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLnN1cGVycG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgbGVmdCBwYW5lbCB0YWJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5iZWhhdmlvcnMubGF5b3V0LmxlZnRQYW5lbFRhYk5hbWUubmV4dCgnc2VnbWVudHMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXNlIHN1cGVycG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMCwgc3VwZXJwb3NpdGlvbl8xLmluaXRTdXBlcnBvc2l0aW9uKSh0aGlzLnBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb2xsYXBzZSBsZWZ0IHBhbmVsIGFuZCBzZXQgbGVmdCBwYW5lbCB0YWIgdG8gbm9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuTGF5b3V0LlVwZGF0ZSh0aGlzLnBsdWdpbiwgeyBzdGF0ZTogeyByZWdpb25TdGF0ZTogdHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnBsdWdpbi5sYXlvdXQuc3RhdGUucmVnaW9uU3RhdGUpLCB7IGxlZnQ6ICdjb2xsYXBzZWQnIH0pIH0gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYmVoYXZpb3JzLmxheW91dC5sZWZ0UGFuZWxUYWJOYW1lLm5leHQoJ25vbmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlID0gdGhpcy5nZXRNb2xlY3VsZVNyY1VybCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZCh7IHVybDogZGF0YVNvdXJjZS51cmwsIGZvcm1hdDogZGF0YVNvdXJjZS5mb3JtYXQsIGFzc2VtYmx5SWQ6IHRoaXMuaW5pdFBhcmFtcy5hc3NlbWJseUlkLCBpc0JpbmFyeTogZGF0YVNvdXJjZS5pc0JpbmFyeSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQmluZGluZyB0byBvdGhlciBQREIgQ29tcG9uZW50IGV2ZW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuc3Vic2NyaWJlRXZlbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgwLCBzdWJzY3JpYmVfZXZlbnRzXzEuc3Vic2NyaWJlVG9Db21wb25lbnRFdmVudHMpKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFdmVudCBoYW5kbGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbV9ldmVudHNfMS5DdXN0b21FdmVudHMuYWRkKHRoaXMucGx1Z2luLCB0aGlzLnRhcmdldEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFBEQmVNb2xzdGFyUGx1Z2luLnByb3RvdHlwZS5nZXRNb2xlY3VsZVNyY1VybCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN1cHBvcnRlZEZvcm1hdHMgPSBbJ21tY2lmJywgJ3BkYicsICdzZGYnXTtcbiAgICAgICAgdmFyIGlkID0gdGhpcy5pbml0UGFyYW1zLm1vbGVjdWxlSWQ7XG4gICAgICAgIGlmICghaWQgJiYgIXRoaXMuaW5pdFBhcmFtcy5jdXN0b21EYXRhKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNYW5kYXRvcnkgcGFyYW1ldGVycyBtaXNzaW5nIVwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcXVlcnkgPSAnZnVsbCc7XG4gICAgICAgIHZhciBzZXAgPSAnPyc7XG4gICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldykge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5UGFyYW1zID0gWydkYXRhX3NvdXJjZT1wZGItaCddO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldy5sYWJlbF9jb21wX2lkX2xpc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmxpZ2FuZFZpZXcubGFiZWxfY29tcF9pZCkge1xuICAgICAgICAgICAgICAgICAgICBxdWVyeVBhcmFtcy5wdXNoKCdsYWJlbF9jb21wX2lkPScgKyB0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldy5sYWJlbF9jb21wX2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5pbml0UGFyYW1zLmxpZ2FuZFZpZXcuYXV0aF9zZXFfaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMucHVzaCgnYXV0aF9zZXFfaWQ9JyArIHRoaXMuaW5pdFBhcmFtcy5saWdhbmRWaWV3LmF1dGhfc2VxX2lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdFBhcmFtcy5saWdhbmRWaWV3LmF1dGhfYXN5bV9pZClcbiAgICAgICAgICAgICAgICAgICAgcXVlcnlQYXJhbXMucHVzaCgnYXV0aF9hc3ltX2lkPScgKyB0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldy5hdXRoX2FzeW1faWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVlcnkgPSAncmVzaWR1ZVN1cnJvdW5kaW5ncz8nICsgcXVlcnlQYXJhbXMuam9pbignJicpO1xuICAgICAgICAgICAgc2VwID0gJyYnO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1cmwgPSBcIlwiLmNvbmNhdCh0aGlzLmluaXRQYXJhbXMucGRiZVVybCwgXCJtb2RlbC1zZXJ2ZXIvdjEvXCIpLmNvbmNhdChpZCwgXCIvXCIpLmNvbmNhdChxdWVyeSkuY29uY2F0KHNlcCwgXCJlbmNvZGluZz1cIikuY29uY2F0KHRoaXMuaW5pdFBhcmFtcy5lbmNvZGluZykuY29uY2F0KHRoaXMuaW5pdFBhcmFtcy5sb3dQcmVjaXNpb25Db29yZHMgPyAnJmxvd1ByZWNpc2lvbkNvb3Jkcz0xJyA6ICcnKTtcbiAgICAgICAgdmFyIGlzQmluYXJ5ID0gdGhpcy5pbml0UGFyYW1zLmVuY29kaW5nID09PSAnYmNpZicgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBmb3JtYXQgPSAnbW1jaWYnO1xuICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLmN1c3RvbURhdGEpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pbml0UGFyYW1zLmN1c3RvbURhdGEudXJsIHx8ICF0aGlzLmluaXRQYXJhbXMuY3VzdG9tRGF0YS5mb3JtYXQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm92aWRlIGFsbCBjdXN0b20gZGF0YSBwYXJhbWV0ZXJzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdXJsID0gdGhpcy5pbml0UGFyYW1zLmN1c3RvbURhdGEudXJsO1xuICAgICAgICAgICAgZm9ybWF0ID0gdGhpcy5pbml0UGFyYW1zLmN1c3RvbURhdGEuZm9ybWF0O1xuICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2NpZicgfHwgZm9ybWF0ID09PSAnYmNpZicpXG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gJ21tY2lmJztcbiAgICAgICAgICAgIC8vIFZhbGlkYXRlIHN1cHBvcnRlZCBmb3JtYXRcbiAgICAgICAgICAgIGlmIChzdXBwb3J0ZWRGb3JtYXRzLmluZGV4T2YoZm9ybWF0KSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJcIi5jb25jYXQoZm9ybWF0LCBcIiBub3Qgc3VwcG9ydGVkLlwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpc0JpbmFyeSA9IHRoaXMuaW5pdFBhcmFtcy5jdXN0b21EYXRhLmJpbmFyeSA/IHRoaXMuaW5pdFBhcmFtcy5jdXN0b21EYXRhLmJpbmFyeSA6IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0LFxuICAgICAgICAgICAgaXNCaW5hcnk6IGlzQmluYXJ5XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUERCZU1vbHN0YXJQbHVnaW4ucHJvdG90eXBlLCBcInN0YXRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFBEQmVNb2xzdGFyUGx1Z2luLnByb3RvdHlwZS5jcmVhdGVMaWdhbmRTdHJ1Y3R1cmUgPSBmdW5jdGlvbiAoaXNCcmFuY2hlZCkge1xuICAgICAgICB2YXIgX2EsIGVfNSwgX2IsIF9jO1xuICAgICAgICB2YXIgX2Q7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9lLCBfZiwgX2csIGNvbXAsIGVfNV8xLCBzdHJ1Y3R1cmUsIGxpZ2FuZFF1ZXJ5LCBsaWdhbmRWaXMsIGxpZ2FuZFN1cnIsIGxpZ1JlZiwgY2VsbCwgbGlnTG9jaTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2gpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9oLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFzc2VtYmx5UmVmID09PSAnJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBfaC5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oLnRyeXMucHVzaChbMSwgOSwgMTAsIDE1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZSA9IHRydWUsIF9mID0gdHNsaWJfMS5fX2FzeW5jVmFsdWVzKHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudENvbXBvbmVudEdyb3Vwcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaC5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgX2YubmV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2cgPSBfaC5zZW50KCksIF9hID0gX2cuZG9uZSwgIV9hKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IF9nLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2gudHJ5cy5wdXNoKFs0LCAsIDYsIDddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAgPSBfYztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuUmVtb3ZlT2JqZWN0KHRoaXMucGx1Z2luLCB7IHN0YXRlOiBjb21wWzBdLmNlbGwucGFyZW50LCByZWY6IGNvbXBbMF0uY2VsbC50cmFuc2Zvcm0ucmVmLCByZW1vdmVQYXJlbnRHaG9zdHM6IHRydWUgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBfaC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OiByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCAxNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfNV8xID0gX2guc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZV81ID0geyBlcnJvcjogZV81XzEgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDE1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oLnRyeXMucHVzaChbMTAsICwgMTMsIDE0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISghX2UgJiYgIV9hICYmIChfYiA9IF9mLnJldHVybikpKSByZXR1cm4gWzMgLypicmVhayovLCAxMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBfYi5jYWxsKF9mKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfaC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaC5sYWJlbCA9IDEyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzMgLypicmVhayovLCAxNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZV81KSB0aHJvdyBlXzUuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OiByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0dXJlID0gdGhpcy5zdGF0ZS5zZWxlY3QodGhpcy5hc3NlbWJseVJlZilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNCcmFuY2hlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZ2FuZFF1ZXJ5ID0gaGVscGVyc18xLkxpZ2FuZFZpZXcuYnJhbmNoZWRRdWVyeSgoX2QgPSB0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldykgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmxhYmVsX2NvbXBfaWRfbGlzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWdhbmRRdWVyeSA9IGhlbHBlcnNfMS5MaWdhbmRWaWV3LnF1ZXJ5KHRoaXMuaW5pdFBhcmFtcy5saWdhbmRWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS50cnlDcmVhdGVDb21wb25lbnRGcm9tRXhwcmVzc2lvbihzdHJ1Y3R1cmUsIGxpZ2FuZFF1ZXJ5LmNvcmUsICdwaXZvdCcsIHsgbGFiZWw6ICdMaWdhbmQnIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpZ2FuZFZpcyA9IF9oLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlnYW5kVmlzKSByZXR1cm4gWzMgLypicmVhayovLCAxOF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24obGlnYW5kVmlzLCB7IHR5cGU6ICdiYWxsLWFuZC1zdGljaycsIGNvbG9yOiAnZWxlbWVudC1zeW1ib2wnLCBjb2xvclBhcmFtczogeyBjYXJib25Db2xvcjogeyBuYW1lOiAnZWxlbWVudC1zeW1ib2wnLCBwYXJhbXM6IHt9IH0gfSwgc2l6ZTogJ3VuaWZvcm0nLCBzaXplUGFyYW1zOiB7IHZhbHVlOiAyLjUgfSB9LCB7IHRhZzogJ2xpZ2FuZC12aXMnIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oLmxhYmVsID0gMTg7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTg6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS50cnlDcmVhdGVDb21wb25lbnRGcm9tRXhwcmVzc2lvbihzdHJ1Y3R1cmUsIGxpZ2FuZFF1ZXJ5LnN1cnJvdW5kaW5ncywgJ3Jlc3QnLCB7IGxhYmVsOiAnU3Vycm91bmRpbmdzJyB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTk6XG4gICAgICAgICAgICAgICAgICAgICAgICBsaWdhbmRTdXJyID0gX2guc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaWdhbmRTdXJyKSByZXR1cm4gWzMgLypicmVhayovLCAyMV07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24obGlnYW5kU3VyciwgeyB0eXBlOiAnYmFsbC1hbmQtc3RpY2snLCBjb2xvcjogJ2VsZW1lbnQtc3ltYm9sJywgY29sb3JQYXJhbXM6IHsgY2FyYm9uQ29sb3I6IHsgbmFtZTogJ2VsZW1lbnQtc3ltYm9sJywgcGFyYW1zOiB7fSB9IH0sIHNpemU6ICd1bmlmb3JtJywgc2l6ZVBhcmFtczogeyB2YWx1ZTogMC44IH0gfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2guc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2gubGFiZWwgPSAyMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpZ1JlZiA9IG1vbF9zdGF0ZV8yLlN0YXRlU2VsZWN0aW9uLmZpbmRUYWdJblN1YnRyZWUodGhpcy5wbHVnaW4uc3RhdGUuZGF0YS50cmVlLCBtb2xfc3RhdGVfMS5TdGF0ZVRyYW5zZm9ybS5Sb290UmVmLCAnbGlnYW5kLXZpcycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaWdSZWYpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEuY2VsbHMuZ2V0KGxpZ1JlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZ0xvY2kgPSBjZWxsLm9iai5kYXRhLnJlcHIuZ2V0TG9jaSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5mb2N1cy5zZXRGcm9tTG9jaShsaWdMb2NpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBmb2N1cy1hZGQgaXMgbm90IGhhbmRsZWQgaW4gY2FtZXJhIGJlaGF2aW9yLCBkb2luZyBpdCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gKF9hID0gX3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5mb2N1cy5jdXJyZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubG9jaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuY2FtZXJhLmZvY3VzTG9jaShjdXJyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8vcHJpdmF0ZSBsb2FkZWRQYXJhbXM6IExvYWRQYXJhbXMgPSB7IHVybDogJycsIGZvcm1hdDogJ21tY2lmJywgaXNCaW5hcnk6IGZhbHNlLCBhc3NlbWJseUlkOiAnJyB9O1xuICAgIFBEQmVNb2xzdGFyUGx1Z2luLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKF9hLCBmdWxsTG9hZCkge1xuICAgICAgICB2YXIgdXJsID0gX2EudXJsLCBfYiA9IF9hLmZvcm1hdCwgZm9ybWF0ID0gX2IgPT09IHZvaWQgMCA/ICdtbWNpZicgOiBfYiwgX2MgPSBfYS5pc0JpbmFyeSwgaXNCaW5hcnkgPSBfYyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfYywgX2QgPSBfYS5hc3NlbWJseUlkLCBhc3NlbWJseUlkID0gX2QgPT09IHZvaWQgMCA/ICcnIDogX2QsIHJlcHJlc2VudGF0aW9uU3R5bGUgPSBfYS5yZXByZXNlbnRhdGlvblN0eWxlO1xuICAgICAgICBpZiAoZnVsbExvYWQgPT09IHZvaWQgMCkgeyBmdWxsTG9hZCA9IHRydWU7IH1cbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaXNIZXRWaWV3LCBkb3dubG9hZE9wdGlvbnMsIGlzQnJhbmNoZWRWaWV3LCBkYXRhLCB0cmFqZWN0b3J5LCBtb2RlbCwgcGl2b3RJbmRleCwgcGl2b3QsIGFzbSwgZGVmYXVsdE1hcFBhcmFtcywgcGRiZU1hcFBhcmFtcywgbG9hZFR5cGUsIHN0YXRlLCBtb2RlbFRyZWUsIGluZm8sIGFzbUlkLCBzdHJ1Y3R1cmVUcmVlLCB0cmVlLCBpbmZvLCBhc21JZCwgcHJvcHNfMTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2UubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bGxMb2FkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGV0VmlldyA9IHRoaXMuaW5pdFBhcmFtcy5saWdhbmRWaWV3ID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRPcHRpb25zID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNCcmFuY2hlZFZpZXcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldyAmJiB0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldy5sYWJlbF9jb21wX2lkX2xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JyYW5jaGVkVmlldyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRPcHRpb25zID0geyBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmluaXRQYXJhbXMubGlnYW5kVmlldy5sYWJlbF9jb21wX2lkX2xpc3QpLCBoZWFkZXJzOiBbWydDb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24vanNvbiddXSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wbHVnaW4uYnVpbGRlcnMuZGF0YS5kb3dubG9hZCh7IHVybDogYXNzZXRzXzEuQXNzZXQuVXJsKHVybCwgZG93bmxvYWRPcHRpb25zKSwgaXNCaW5hcnk6IGlzQmluYXJ5IH0sIHsgc3RhdGU6IHsgaXNHaG9zdDogdHJ1ZSB9IH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS5wYXJzZVRyYWplY3RvcnkoZGF0YSwgZm9ybWF0KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWplY3RvcnkgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFpc0hldFZpZXcpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wbHVnaW4uYnVpbGRlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5hcHBseVByZXNldCh0cmFqZWN0b3J5LCB0aGlzLmluaXRQYXJhbXMuZGVmYXVsdFByZXNldCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmU6IGFzc2VtYmx5SWQgPyAoYXNzZW1ibHlJZCA9PT0gJ3ByZWZlcnJlZCcpID8gdm9pZCAwIDogeyBuYW1lOiAnYXNzZW1ibHknLCBwYXJhbXM6IHsgaWQ6IGFzc2VtYmx5SWQgfSB9IDogeyBuYW1lOiAnbW9kZWwnLCBwYXJhbXM6IHt9IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dVbml0Y2VsbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcHJlc2VudGF0aW9uUHJlc2V0OiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmluaXRQYXJhbXMuaGlkZVN0cnVjdHVyZSB8fCB0aGlzLmluaXRQYXJhbXMudmlzdWFsU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5VmlzdWFsUGFyYW1zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUuY3JlYXRlTW9kZWwodHJhamVjdG9yeSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbCA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS5jcmVhdGVTdHJ1Y3R1cmUobW9kZWwsIHsgbmFtZTogJ21vZGVsJywgcGFyYW1zOiB7fSB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gNztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBzZWxlY3Rpb24gaWYgcGFyYW0gaXMgc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UGFyYW1zLnNlbGVjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlzdWFsLnNlbGVjdCh0aGlzLmluaXRQYXJhbXMuc2VsZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHBpdm90SW5kZXggPSB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LnNlbGVjdGlvbi5zdHJ1Y3R1cmVzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaXZvdCA9IHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuc2VsZWN0aW9uLnN0cnVjdHVyZXNbcGl2b3RJbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGl2b3QgJiYgcGl2b3QuY2VsbC5wYXJlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hc3NlbWJseVJlZiA9IHBpdm90LmNlbGwudHJhbnNmb3JtLnJlZjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0UGFyYW1zLmxvYWRNYXBzKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFzc2VtYmx5UmVmID09PSAnJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBhc20gPSB0aGlzLnN0YXRlLnNlbGVjdCh0aGlzLmFzc2VtYmx5UmVmKVswXS5vYmo7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TWFwUGFyYW1zID0gdHJhbnNmb3JtZXJzXzEuSW5pdFZvbHVtZVN0cmVhbWluZy5jcmVhdGVEZWZhdWx0UGFyYW1zKGFzbSwgdGhpcy5wbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGRiZU1hcFBhcmFtcyA9IGhlbHBlcnNfMS5QREJlVm9sdW1lcy5tYXBQYXJhbXMoZGVmYXVsdE1hcFBhcmFtcywgdGhpcy5pbml0UGFyYW1zLm1hcFNldHRpbmdzLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBkYmVNYXBQYXJhbXMpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wbHVnaW4ucnVuVGFzayh0aGlzLnN0YXRlLmFwcGx5QWN0aW9uKHRyYW5zZm9ybWVyc18xLkluaXRWb2x1bWVTdHJlYW1pbmcsIHBkYmVNYXBQYXJhbXMsIHRoaXMuYXNzZW1ibHlSZWYpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZGJlTWFwUGFyYW1zLm1ldGhvZCAhPT0gJ2VtJyAmJiAhdGhpcy5pbml0UGFyYW1zLmxpZ2FuZFZpZXcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyc18xLlBEQmVWb2x1bWVzLmRpc3BsYXlVc2liaWxpdHlNZXNzYWdlKHRoaXMucGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0hldFZpZXcpIHJldHVybiBbMyAvKmJyZWFrKi8sIDExXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY3JlYXRlTGlnYW5kU3RydWN0dXJlKGlzQnJhbmNoZWRWaWV3KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDExO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFR5cGUgPSAnZnVsbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHRoaXMucGx1Z2luLnN0YXRlLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubG9hZGVkUGFyYW1zLnVybCAhPT0gdXJsIHx8IHRoaXMubG9hZGVkUGFyYW1zLmZvcm1hdCAhPT0gZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFR5cGUgPSAnZnVsbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubG9hZGVkUGFyYW1zLnVybCA9PT0gdXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiAoc3RhdGUuc2VsZWN0KFN0YXRlRWxlbWVudHMuQXNzZW1ibHkpLmxlbmd0aCA+IDApIGxvYWRUeXBlID0gJ3VwZGF0ZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnNlbGVjdCh0aGlzLmFzc2VtYmx5UmVmKS5sZW5ndGggPiAwKSBsb2FkVHlwZSA9ICd1cGRhdGUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVsbExvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkVHlwZSA9ICdmdWxsJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRUeXBlID0gJ3VwZGF0ZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShsb2FkVHlwZSA9PT0gJ2Z1bGwnKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5TdGF0ZS5SZW1vdmVPYmplY3QodGhpcy5wbHVnaW4sIHsgc3RhdGU6IHN0YXRlLCByZWY6IHN0YXRlLnRyZWUucm9vdC5yZWYgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxUcmVlID0gdGhpcy5tb2RlbCh0aGlzLmRvd25sb2FkKHN0YXRlLmJ1aWxkKCkudG9Sb290KCksIHVybCwgaXNCaW5hcnkpLCBmb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5hcHBseVN0YXRlKG1vZGVsVHJlZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5kb0luZm8odHJ1ZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaW5mbyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzbUlkID0gKGFzc2VtYmx5SWQgPT09ICdwcmVmZXJyZWQnICYmIGluZm8gJiYgaW5mby5wcmVmZXJyZWRBc3NlbWJseUlkKSB8fCBhc3NlbWJseUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0dXJlVHJlZSA9IHRoaXMuc3RydWN0dXJlKGFzbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYXBwbHlTdGF0ZShzdHJ1Y3R1cmVUcmVlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxOV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmVlID0gc3RhdGUuYnVpbGQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZG9JbmZvKHRydWUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc21JZCA9IChhc3NlbWJseUlkID09PSAncHJlZmVycmVkJyAmJiBpbmZvICYmIGluZm8ucHJlZmVycmVkQXNzZW1ibHlJZCkgfHwgYXNzZW1ibHlJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzXzEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogYXNzZW1ibHlJZCA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2Fzc2VtYmx5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7IGlkOiBhc21JZCB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ21vZGVsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RyZWUudG8oU3RhdGVFbGVtZW50cy5Bc3NlbWJseSkudXBkYXRlKFN0YXRlVHJhbnNmb3Jtcy5Nb2RlbC5TdHJ1Y3R1cmVGcm9tTW9kZWwsIHAgPT4gKHsgLi4ucCwgLi4ucHJvcHMgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJlZS50byh0aGlzLmFzc2VtYmx5UmVmKS51cGRhdGUodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5Nb2RlbC5TdHJ1Y3R1cmVGcm9tTW9kZWwsIGZ1bmN0aW9uIChwKSB7IHJldHVybiAodHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCBwKSwgcHJvcHNfMSkpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYXBwbHlTdGF0ZSh0cmVlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDE5O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE5OlxuICAgICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy51cGRhdGVTdHlsZShyZXByZXNlbnRhdGlvblN0eWxlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cy5sb2FkQ29tcGxldGUubmV4dCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQREJlTW9sc3RhclBsdWdpbi5wcm90b3R5cGUubW9kZWwgPSBmdW5jdGlvbiAoYiwgZm9ybWF0KSB7XG4gICAgICAgIHZhciBwYXJzZWQgPSBmb3JtYXQgPT09ICdtbWNpZidcbiAgICAgICAgICAgID8gYi5hcHBseSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLkRhdGEuUGFyc2VDaWYpLmFwcGx5KHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuTW9kZWwuVHJhamVjdG9yeUZyb21NbUNpZilcbiAgICAgICAgICAgIDogYi5hcHBseSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLk1vZGVsLlRyYWplY3RvcnlGcm9tUERCKTtcbiAgICAgICAgcmV0dXJuIHBhcnNlZC5hcHBseSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLk1vZGVsLk1vZGVsRnJvbVRyYWplY3RvcnksIHsgbW9kZWxJbmRleDogMCB9LCB7IHJlZjogaGVscGVyc18yLlN0YXRlRWxlbWVudHMuTW9kZWwgfSk7XG4gICAgfTtcbiAgICBQREJlTW9sc3RhclBsdWdpbi5wcm90b3R5cGUuZG93bmxvYWQgPSBmdW5jdGlvbiAoYiwgdXJsLCBpc0JpbmFyeSkge1xuICAgICAgICByZXR1cm4gYi5hcHBseSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLkRhdGEuRG93bmxvYWQsIHsgdXJsOiBhc3NldHNfMS5Bc3NldC5VcmwodXJsKSwgaXNCaW5hcnk6IGlzQmluYXJ5IH0pO1xuICAgIH07XG4gICAgUERCZU1vbHN0YXJQbHVnaW4ucHJvdG90eXBlLnN0cnVjdHVyZSA9IGZ1bmN0aW9uIChhc3NlbWJseUlkKSB7XG4gICAgICAgIHZhciBtb2RlbCA9IHRoaXMuc3RhdGUuYnVpbGQoKS50byhoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5Nb2RlbCk7XG4gICAgICAgIHZhciBwcm9wcyA9IHtcbiAgICAgICAgICAgIHR5cGU6IGFzc2VtYmx5SWQgPyB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ2Fzc2VtYmx5JyxcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHsgaWQ6IGFzc2VtYmx5SWQgfVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnbW9kZWwnLFxuICAgICAgICAgICAgICAgIHBhcmFtczoge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHMgPSBtb2RlbFxuICAgICAgICAgICAgLy8gICAgLmFwcGx5KFN0YXRlVHJhbnNmb3Jtcy5Nb2RlbC5TdHJ1Y3R1cmVGcm9tTW9kZWwsIHByb3BzLCB7IHJlZjogU3RhdGVFbGVtZW50cy5Bc3NlbWJseSB9KTtcbiAgICAgICAgICAgIC5hcHBseSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLk1vZGVsLlN0cnVjdHVyZUZyb21Nb2RlbCwgcHJvcHMsIHsgcmVmOiB0aGlzLmFzc2VtYmx5UmVmIH0pO1xuICAgICAgICBzLmFwcGx5KHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuTW9kZWwuU3RydWN0dXJlQ29tcGxleEVsZW1lbnQsIHsgdHlwZTogJ2F0b21pYy1zZXF1ZW5jZScgfSwgeyByZWY6IGhlbHBlcnNfMi5TdGF0ZUVsZW1lbnRzLlNlcXVlbmNlIH0pO1xuICAgICAgICBzLmFwcGx5KHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuTW9kZWwuU3RydWN0dXJlQ29tcGxleEVsZW1lbnQsIHsgdHlwZTogJ2F0b21pYy1oZXQnIH0sIHsgcmVmOiBoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5IZXQgfSk7XG4gICAgICAgIHMuYXBwbHkodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5Nb2RlbC5TdHJ1Y3R1cmVDb21wbGV4RWxlbWVudCwgeyB0eXBlOiAnd2F0ZXInIH0sIHsgcmVmOiBoZWxwZXJzXzIuU3RhdGVFbGVtZW50cy5XYXRlciB9KTtcbiAgICAgICAgcmV0dXJuIHM7XG4gICAgfTtcbiAgICBQREJlTW9sc3RhclBsdWdpbi5wcm90b3R5cGUudXBkYXRlU3R5bGUgPSBmdW5jdGlvbiAoc3R5bGUsIHBhcnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdHJlZTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdHJlZSA9IHRoaXMudmlzdWFsMShzdHlsZSwgcGFydGlhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRyZWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5TdGF0ZS5VcGRhdGUodGhpcy5wbHVnaW4sIHsgc3RhdGU6IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEsIHRyZWU6IHRyZWUgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUERCZU1vbHN0YXJQbHVnaW4ucHJvdG90eXBlLmRvSW5mbyA9IGZ1bmN0aW9uIChjaGVja1ByZWZlcnJlZEFzc2VtYmx5KSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG1vZGVsLCBpbmZvO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbCA9IHRoaXMuZ2V0T2JqKCdtb2RlbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtb2RlbClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBoZWxwZXJzXzIuTW9kZWxJbmZvMi5nZXQodGhpcy5wbHVnaW4sIG1vZGVsLCBjaGVja1ByZWZlcnJlZEFzc2VtYmx5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZm8gPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50cy5tb2RlbEluZm8ubmV4dChpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBpbmZvXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQREJlTW9sc3RhclBsdWdpbi5wcm90b3R5cGUuYXBwbHlTdGF0ZSA9IGZ1bmN0aW9uICh0cmVlKSB7XG4gICAgICAgIHJldHVybiBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlVwZGF0ZSh0aGlzLnBsdWdpbiwgeyBzdGF0ZTogdGhpcy5wbHVnaW4uc3RhdGUuZGF0YSwgdHJlZTogdHJlZSB9KTtcbiAgICB9O1xuICAgIFBEQmVNb2xzdGFyUGx1Z2luLnByb3RvdHlwZS5nZXRPYmogPSBmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIHZhciBjZWxsID0gc3RhdGUuc2VsZWN0KHJlZilbMF07XG4gICAgICAgIGlmICghY2VsbCB8fCAhY2VsbC5vYmopXG4gICAgICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgICByZXR1cm4gY2VsbC5vYmouZGF0YTtcbiAgICB9O1xuICAgIFBEQmVNb2xzdGFyUGx1Z2luLnByb3RvdHlwZS5nZXRMb2NpRm9yUGFyYW1zID0gZnVuY3Rpb24gKHBhcmFtcywgc3RydWN0dXJlTnVtYmVyKSB7XG4gICAgICAgIHZhciBhc3NlbWJseVJlZiA9IHRoaXMuYXNzZW1ibHlSZWY7XG4gICAgICAgIGlmIChzdHJ1Y3R1cmVOdW1iZXIpIHtcbiAgICAgICAgICAgIGFzc2VtYmx5UmVmID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnN0cnVjdHVyZXNbc3RydWN0dXJlTnVtYmVyIC0gMV0uY2VsbC50cmFuc2Zvcm0ucmVmO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhc3NlbWJseVJlZiA9PT0gJycpXG4gICAgICAgICAgICByZXR1cm4gbG9jaV8xLkVtcHR5TG9jaTtcbiAgICAgICAgLy9pZiAodGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5zZWxlY3QoYXNzZW1ibHlSZWYpLmxlbmd0aCA9PSAwKSByZXR1cm4gRW1wdHlMb2NpO1xuICAgICAgICB2YXIgZGF0YSA9IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEuc2VsZWN0KGFzc2VtYmx5UmVmKVswXS5vYmouZGF0YTtcbiAgICAgICAgaWYgKCFkYXRhKVxuICAgICAgICAgICAgcmV0dXJuIGxvY2lfMS5FbXB0eUxvY2k7XG4gICAgICAgIHJldHVybiBoZWxwZXJzXzEuUXVlcnlIZWxwZXIuZ2V0SW50ZXJhY3Rpdml0eUxvY2kocGFyYW1zLCBkYXRhKTtcbiAgICB9O1xuICAgIFBEQmVNb2xzdGFyUGx1Z2luLnByb3RvdHlwZS5nZXRMb2NpQnlQTEREVCA9IGZ1bmN0aW9uIChzY29yZSwgc3RydWN0dXJlTnVtYmVyKSB7XG4gICAgICAgIHZhciBhc3NlbWJseVJlZiA9IHRoaXMuYXNzZW1ibHlSZWY7XG4gICAgICAgIGlmIChzdHJ1Y3R1cmVOdW1iZXIpIHtcbiAgICAgICAgICAgIGFzc2VtYmx5UmVmID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnN0cnVjdHVyZXNbc3RydWN0dXJlTnVtYmVyIC0gMV0uY2VsbC50cmFuc2Zvcm0ucmVmO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhc3NlbWJseVJlZiA9PT0gJycpXG4gICAgICAgICAgICByZXR1cm4gbG9jaV8xLkVtcHR5TG9jaTtcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLnNlbGVjdChhc3NlbWJseVJlZilbMF0ub2JqLmRhdGE7XG4gICAgICAgIGlmICghZGF0YSlcbiAgICAgICAgICAgIHJldHVybiBsb2NpXzEuRW1wdHlMb2NpO1xuICAgICAgICByZXR1cm4gaGVscGVyc18xLkFscGhhZm9sZFZpZXcuZ2V0TG9jaUJ5UExERFQoc2NvcmUsIGRhdGEpO1xuICAgIH07XG4gICAgUERCZU1vbHN0YXJQbHVnaW4ucHJvdG90eXBlLm5vcm1hbGl6ZUNvbG9yID0gZnVuY3Rpb24gKGNvbG9yVmFsLCBkZWZhdWx0Q29sb3IpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gY29sb3JfMS5Db2xvci5mcm9tUmdiKDE3MCwgMTcwLCAxNzApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb2xvclZhbC5yICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gY29sb3JfMS5Db2xvci5mcm9tUmdiKGNvbG9yVmFsLnIsIGNvbG9yVmFsLmcsIGNvbG9yVmFsLmIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29sb3JWYWxbMF0gPT09ICcjJykge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gKDAsIGNvbG9yXzEuQ29sb3IpKE51bWJlcihcIjB4XCIuY29uY2F0KGNvbG9yVmFsLnN1YnN0cigxKSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbG9yID0gKDAsIGNvbG9yXzEuQ29sb3IpKGNvbG9yVmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGRlZmF1bHRDb2xvcilcbiAgICAgICAgICAgICAgICBjb2xvciA9IGRlZmF1bHRDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgfTtcbiAgICBQREJlTW9sc3RhclBsdWdpbi5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uY2xlYXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2VtYmx5UmVmID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFBhcmFtcyA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB0aGlzLmlzSGlnaGxpZ2h0Q29sb3JVcGRhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1NlbGVjdGVkQ29sb3JVcGRhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFBEQmVNb2xzdGFyUGx1Z2luO1xufSgpKTtcbndpbmRvdy5QREJlTW9sc3RhclBsdWdpbiA9IFBEQmVNb2xzdGFyUGx1Z2luO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/index.js\n");
  
  /***/ }),
  
  /***/ "./lib/labels.js":
  /*!***********************!*\
    !*** ./lib/labels.js ***!
    \***********************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.PDBeLociLabelProvider = void 0;\nvar behavior_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior */ \"./node_modules/molstar/lib/mol-plugin/behavior.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar label_1 = __webpack_require__(/*! Molstar/mol-theme/label */ \"./node_modules/molstar/lib/mol-theme/label.js\");\nexports.PDBeLociLabelProvider = behavior_1.PluginBehavior.create({\n    name: 'pdbe-loci-label-provider',\n    category: 'interaction',\n    ctor: /** @class */ (function () {\n        function class_1(ctx) {\n            var _this = this;\n            this.ctx = ctx;\n            this.f = {\n                label: function (loci) {\n                    var customState = (_this.ctx.customState);\n                    var superpositionView = (customState && customState.initParams.superposition) ? true : false;\n                    var label = [];\n                    if (!superpositionView && structure_1.StructureElement.Loci.is(loci) && loci.elements.length === 1) {\n                        var entityNames = new Set();\n                        for (var _i = 0, _a = loci.elements; _i < _a.length; _i++) {\n                            var u = _a[_i].unit;\n                            var l = structure_1.StructureElement.Location.create(loci.structure, u, u.elements[0]);\n                            var name_1 = structure_1.StructureProperties.entity.pdbx_description(l).join(', ');\n                            entityNames.add(name_1);\n                        }\n                        if (entityNames.size === 1)\n                            entityNames.forEach(function (name) { return label.push(name); });\n                    }\n                    label.push((0, label_1.lociLabel)(loci));\n                    return label.filter(function (l) { return !!l; }).join('</br>');\n                },\n                group: function (label) { return label.toString().replace(/Model [0-9]+/g, 'Models'); },\n                priority: 100\n            };\n        }\n        class_1.prototype.register = function () { this.ctx.managers.lociLabels.addProvider(this.f); };\n        class_1.prototype.unregister = function () { this.ctx.managers.lociLabels.removeProvider(this.f); };\n        return class_1;\n    }()),\n    display: { name: 'Provide PDBe Loci Label' }\n});\n//# sourceMappingURL=labels.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvbGFiZWxzLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELDZCQUE2QjtBQUM3QixpQkFBaUIsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDdEQsa0JBQWtCLG1CQUFPLENBQUMsc0ZBQTZCO0FBQ3ZELGNBQWMsbUJBQU8sQ0FBQyw4RUFBeUI7QUFDL0MsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELGdCQUFnQjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRUFBa0UsMEJBQTBCO0FBQzVGO0FBQ0E7QUFDQSx1REFBdUQsYUFBYTtBQUNwRSxpQkFBaUI7QUFDakIsMENBQTBDLDZEQUE2RDtBQUN2RztBQUNBO0FBQ0E7QUFDQSxtREFBbUQ7QUFDbkQscURBQXFEO0FBQ3JEO0FBQ0EsS0FBSztBQUNMLGVBQWU7QUFDZixDQUFDO0FBQ0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvbGFiZWxzLmpzP2I1MzMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLlBEQmVMb2NpTGFiZWxQcm92aWRlciA9IHZvaWQgMDtcbnZhciBiZWhhdmlvcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9iZWhhdmlvclwiKTtcbnZhciBzdHJ1Y3R1cmVfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1tb2RlbC9zdHJ1Y3R1cmVcIik7XG52YXIgbGFiZWxfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC10aGVtZS9sYWJlbFwiKTtcbmV4cG9ydHMuUERCZUxvY2lMYWJlbFByb3ZpZGVyID0gYmVoYXZpb3JfMS5QbHVnaW5CZWhhdmlvci5jcmVhdGUoe1xuICAgIG5hbWU6ICdwZGJlLWxvY2ktbGFiZWwtcHJvdmlkZXInLFxuICAgIGNhdGVnb3J5OiAnaW50ZXJhY3Rpb24nLFxuICAgIGN0b3I6IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gY2xhc3NfMShjdHgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmN0eCA9IGN0eDtcbiAgICAgICAgICAgIHRoaXMuZiA9IHtcbiAgICAgICAgICAgICAgICBsYWJlbDogZnVuY3Rpb24gKGxvY2kpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gKF90aGlzLmN0eC5jdXN0b21TdGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdXBlcnBvc2l0aW9uVmlldyA9IChjdXN0b21TdGF0ZSAmJiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnN1cGVycG9zaXRpb24pID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdXBlcnBvc2l0aW9uVmlldyAmJiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVFbGVtZW50LkxvY2kuaXMobG9jaSkgJiYgbG9jaS5lbGVtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHlOYW1lcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBsb2NpLmVsZW1lbnRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1ID0gX2FbX2ldLnVuaXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVFbGVtZW50LkxvY2F0aW9uLmNyZWF0ZShsb2NpLnN0cnVjdHVyZSwgdSwgdS5lbGVtZW50c1swXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWVfMSA9IHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMuZW50aXR5LnBkYnhfZGVzY3JpcHRpb24obCkuam9pbignLCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHlOYW1lcy5hZGQobmFtZV8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnRpdHlOYW1lcy5zaXplID09PSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eU5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIGxhYmVsLnB1c2gobmFtZSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsLnB1c2goKDAsIGxhYmVsXzEubG9jaUxhYmVsKShsb2NpKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsYWJlbC5maWx0ZXIoZnVuY3Rpb24gKGwpIHsgcmV0dXJuICEhbDsgfSkuam9pbignPC9icj4nKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGdyb3VwOiBmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGxhYmVsLnRvU3RyaW5nKCkucmVwbGFjZSgvTW9kZWwgWzAtOV0rL2csICdNb2RlbHMnKTsgfSxcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogMTAwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNsYXNzXzEucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKCkgeyB0aGlzLmN0eC5tYW5hZ2Vycy5sb2NpTGFiZWxzLmFkZFByb3ZpZGVyKHRoaXMuZik7IH07XG4gICAgICAgIGNsYXNzXzEucHJvdG90eXBlLnVucmVnaXN0ZXIgPSBmdW5jdGlvbiAoKSB7IHRoaXMuY3R4Lm1hbmFnZXJzLmxvY2lMYWJlbHMucmVtb3ZlUHJvdmlkZXIodGhpcy5mKTsgfTtcbiAgICAgICAgcmV0dXJuIGNsYXNzXzE7XG4gICAgfSgpKSxcbiAgICBkaXNwbGF5OiB7IG5hbWU6ICdQcm92aWRlIFBEQmUgTG9jaSBMYWJlbCcgfVxufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1sYWJlbHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/labels.js\n");
  
  /***/ }),
  
  /***/ "./lib/loci-details.js":
  /*!*****************************!*\
    !*** ./lib/loci-details.js ***!
    \*****************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports._bundleLabel = exports.bondLabel = exports.lociDetails = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar int_1 = __webpack_require__(/*! Molstar/mol-data/int */ \"./node_modules/molstar/lib/mol-data/int.js\");\nvar sifts_mapping_1 = __webpack_require__(/*! Molstar/mol-model-props/sequence/sifts-mapping */ \"./node_modules/molstar/lib/mol-model-props/sequence/sifts-mapping.js\");\nfunction lociDetails(loci) {\n    switch (loci.kind) {\n        case 'structure-loci':\n            return { models: loci.structure.models.map(function (m) { return m.entry; }).filter(function (l) { return !!l; }) };\n        case 'element-loci':\n            return structureElementStatsDetail(structure_1.StructureElement.Stats.ofLoci(loci));\n        case 'bond-loci':\n            var bond = loci.bonds[0];\n            return bond ? bondLabel(bond, 'element') : '';\n        default:\n            return void 0;\n    }\n}\nexports.lociDetails = lociDetails;\nfunction structureElementStatsDetail(stats) {\n    var chainCount = stats.chainCount, residueCount = stats.residueCount, elementCount = stats.elementCount;\n    if (elementCount === 1 && residueCount === 0 && chainCount === 0) {\n        return getElementDetails(stats.firstElementLoc, 'element');\n    }\n    else if (elementCount === 0 && residueCount === 1 && chainCount === 0) {\n        return getElementDetails(stats.firstResidueLoc, 'residue');\n    }\n    else {\n        return void 0;\n    }\n}\nfunction getElementDetails(location, granularity) {\n    if (granularity === void 0) { granularity = 'element'; }\n    var basicDetails = {};\n    var entry = location.unit.model.entry;\n    if (entry.length > 30)\n        entry = entry.substr(0, 27) + '\\u2026'; // ellipsis\n    basicDetails['entry_id'] = entry; // entry\n    if (granularity !== 'structure') {\n        basicDetails['model'] = location.unit.model.modelNum; // model\n        basicDetails['instance'] = location.unit.conformation.operator.name; // instance\n    }\n    var elementDetails;\n    if (structure_1.Unit.isAtomic(location.unit)) {\n        elementDetails = atomicElementDetails(location, granularity);\n    }\n    else if (structure_1.Unit.isCoarse(location.unit)) {\n        elementDetails = coarseElementDetails(location, granularity);\n    }\n    return tslib_1.__assign(tslib_1.__assign({}, basicDetails), elementDetails);\n}\nfunction atomicElementDetails(location, granularity) {\n    var elementDetails = {\n        entity_id: structure_1.StructureProperties.chain.label_entity_id(location),\n        label_asym_id: structure_1.StructureProperties.chain.label_asym_id(location),\n        auth_asym_id: structure_1.StructureProperties.chain.auth_asym_id(location),\n        unp_accession: undefined,\n        unp_seq_id: undefined,\n        seq_id: structure_1.StructureProperties.residue.label_seq_id(location),\n        auth_seq_id: structure_1.StructureProperties.residue.auth_seq_id(location),\n        ins_code: structure_1.StructureProperties.residue.pdbx_PDB_ins_code(location),\n        comp_id: structure_1.StructureProperties.atom.label_comp_id(location),\n        atom_id: [structure_1.StructureProperties.atom.label_atom_id(location)],\n        alt_id: structure_1.StructureProperties.atom.label_alt_id(location)\n    };\n    var unpLabel = sifts_mapping_1.SIFTSMapping.getLabel(location);\n    if (unpLabel) {\n        var unpLabelDetails = unpLabel.split(' ');\n        if (unpLabelDetails[0] === 'UNP') {\n            elementDetails.unp_accession = unpLabelDetails[1];\n            elementDetails.unp_seq_id = +unpLabelDetails[2];\n        }\n    }\n    var microHetCompIds = structure_1.StructureProperties.residue.microheterogeneityCompIds(location);\n    elementDetails['micro_het_comp_ids'] = granularity === 'residue' && microHetCompIds.length > 1 ?\n        microHetCompIds : [elementDetails['comp_id']];\n    return elementDetails;\n}\nfunction coarseElementDetails(location, granularity) {\n    var elementDetails = {\n        asym_id: structure_1.StructureProperties.coarse.asym_id(location),\n        seq_id_begin: structure_1.StructureProperties.coarse.seq_id_begin(location),\n        seq_id_end: structure_1.StructureProperties.coarse.seq_id_end(location)\n    };\n    if (granularity === 'residue') {\n        if (elementDetails.seq_id_begin === elementDetails.seq_id_end) {\n            var entityIndex = structure_1.StructureProperties.coarse.entityKey(location);\n            var seq = location.unit.model.sequence.byEntityKey[entityIndex];\n            elementDetails['comp_id'] = seq.sequence.compId.value(elementDetails.seq_id_begin - 1); // 1-indexed\n        }\n    }\n    return elementDetails;\n}\nfunction bondLabel(bond, granularity) {\n    return _bundleLabel({ loci: [\n            structure_1.StructureElement.Loci(bond.aStructure, [{ unit: bond.aUnit, indices: int_1.OrderedSet.ofSingleton(bond.aIndex) }]),\n            structure_1.StructureElement.Loci(bond.bStructure, [{ unit: bond.bUnit, indices: int_1.OrderedSet.ofSingleton(bond.bIndex) }])\n        ] }, granularity);\n}\nexports.bondLabel = bondLabel;\nfunction _bundleLabel(bundle, granularity) {\n    var isSingleElements = true;\n    for (var _i = 0, _a = bundle.loci; _i < _a.length; _i++) {\n        var l = _a[_i];\n        if (!structure_1.StructureElement.Loci.is(l) || structure_1.StructureElement.Loci.size(l) !== 1) {\n            isSingleElements = false;\n            break;\n        }\n    }\n    if (isSingleElements) {\n        var locations = bundle.loci.map(function (l) {\n            var _a = l.elements[0], unit = _a.unit, indices = _a.indices;\n            return structure_1.StructureElement.Location.create(l.structure, unit, unit.elements[int_1.OrderedSet.start(indices)]);\n        });\n        var elementDetailsArr = locations.map(function (l) { return getElementDetails(l, granularity); });\n        var atomIds = [elementDetailsArr[0].atom_id[0], elementDetailsArr[1].atom_id[0]];\n        var elementDetails = elementDetailsArr[0];\n        elementDetails['atom_id'] = atomIds;\n        return elementDetails;\n    }\n    else {\n        var elementDetails = bundle.loci.map(function (l) { return lociDetails(l); });\n        return elementDetails;\n    }\n}\nexports._bundleLabel = _bundleLabel;\n//# sourceMappingURL=loci-details.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvbG9jaS1kZXRhaWxzLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELG9CQUFvQixHQUFHLGlCQUFpQixHQUFHLG1CQUFtQjtBQUM5RCxjQUFjLG1CQUFPLENBQUMsZ0RBQU87QUFDN0Isa0JBQWtCLG1CQUFPLENBQUMsc0ZBQTZCO0FBQ3ZELFlBQVksbUJBQU8sQ0FBQyx3RUFBc0I7QUFDMUMsc0JBQXNCLG1CQUFPLENBQUMsNEhBQWdEO0FBQzlFO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixpREFBaUQsaUJBQWlCLHdCQUF3QixhQUFhO0FBQzVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQsc0NBQXNDO0FBQ3RDO0FBQ0EsOERBQThEO0FBQzlELDZFQUE2RTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvR0FBb0c7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQixrRUFBa0Usc0VBQXNFO0FBQ3hJLGtFQUFrRSxzRUFBc0U7QUFDeEksV0FBVztBQUNYO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSx1Q0FBdUMsZ0JBQWdCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULDZEQUE2RCwyQ0FBMkM7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELHdCQUF3QjtBQUNwRjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvbG9jaS1kZXRhaWxzLmpzPzEzOTEiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLl9idW5kbGVMYWJlbCA9IGV4cG9ydHMuYm9uZExhYmVsID0gZXhwb3J0cy5sb2NpRGV0YWlscyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIHN0cnVjdHVyZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1vZGVsL3N0cnVjdHVyZVwiKTtcbnZhciBpbnRfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1kYXRhL2ludFwiKTtcbnZhciBzaWZ0c19tYXBwaW5nXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwtcHJvcHMvc2VxdWVuY2Uvc2lmdHMtbWFwcGluZ1wiKTtcbmZ1bmN0aW9uIGxvY2lEZXRhaWxzKGxvY2kpIHtcbiAgICBzd2l0Y2ggKGxvY2kua2luZCkge1xuICAgICAgICBjYXNlICdzdHJ1Y3R1cmUtbG9jaSc6XG4gICAgICAgICAgICByZXR1cm4geyBtb2RlbHM6IGxvY2kuc3RydWN0dXJlLm1vZGVscy5tYXAoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0uZW50cnk7IH0pLmZpbHRlcihmdW5jdGlvbiAobCkgeyByZXR1cm4gISFsOyB9KSB9O1xuICAgICAgICBjYXNlICdlbGVtZW50LWxvY2knOlxuICAgICAgICAgICAgcmV0dXJuIHN0cnVjdHVyZUVsZW1lbnRTdGF0c0RldGFpbChzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVFbGVtZW50LlN0YXRzLm9mTG9jaShsb2NpKSk7XG4gICAgICAgIGNhc2UgJ2JvbmQtbG9jaSc6XG4gICAgICAgICAgICB2YXIgYm9uZCA9IGxvY2kuYm9uZHNbMF07XG4gICAgICAgICAgICByZXR1cm4gYm9uZCA/IGJvbmRMYWJlbChib25kLCAnZWxlbWVudCcpIDogJyc7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbn1cbmV4cG9ydHMubG9jaURldGFpbHMgPSBsb2NpRGV0YWlscztcbmZ1bmN0aW9uIHN0cnVjdHVyZUVsZW1lbnRTdGF0c0RldGFpbChzdGF0cykge1xuICAgIHZhciBjaGFpbkNvdW50ID0gc3RhdHMuY2hhaW5Db3VudCwgcmVzaWR1ZUNvdW50ID0gc3RhdHMucmVzaWR1ZUNvdW50LCBlbGVtZW50Q291bnQgPSBzdGF0cy5lbGVtZW50Q291bnQ7XG4gICAgaWYgKGVsZW1lbnRDb3VudCA9PT0gMSAmJiByZXNpZHVlQ291bnQgPT09IDAgJiYgY2hhaW5Db3VudCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gZ2V0RWxlbWVudERldGFpbHMoc3RhdHMuZmlyc3RFbGVtZW50TG9jLCAnZWxlbWVudCcpO1xuICAgIH1cbiAgICBlbHNlIGlmIChlbGVtZW50Q291bnQgPT09IDAgJiYgcmVzaWR1ZUNvdW50ID09PSAxICYmIGNoYWluQ291bnQgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGdldEVsZW1lbnREZXRhaWxzKHN0YXRzLmZpcnN0UmVzaWR1ZUxvYywgJ3Jlc2lkdWUnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0RWxlbWVudERldGFpbHMobG9jYXRpb24sIGdyYW51bGFyaXR5KSB7XG4gICAgaWYgKGdyYW51bGFyaXR5ID09PSB2b2lkIDApIHsgZ3JhbnVsYXJpdHkgPSAnZWxlbWVudCc7IH1cbiAgICB2YXIgYmFzaWNEZXRhaWxzID0ge307XG4gICAgdmFyIGVudHJ5ID0gbG9jYXRpb24udW5pdC5tb2RlbC5lbnRyeTtcbiAgICBpZiAoZW50cnkubGVuZ3RoID4gMzApXG4gICAgICAgIGVudHJ5ID0gZW50cnkuc3Vic3RyKDAsIDI3KSArICdcXHUyMDI2JzsgLy8gZWxsaXBzaXNcbiAgICBiYXNpY0RldGFpbHNbJ2VudHJ5X2lkJ10gPSBlbnRyeTsgLy8gZW50cnlcbiAgICBpZiAoZ3JhbnVsYXJpdHkgIT09ICdzdHJ1Y3R1cmUnKSB7XG4gICAgICAgIGJhc2ljRGV0YWlsc1snbW9kZWwnXSA9IGxvY2F0aW9uLnVuaXQubW9kZWwubW9kZWxOdW07IC8vIG1vZGVsXG4gICAgICAgIGJhc2ljRGV0YWlsc1snaW5zdGFuY2UnXSA9IGxvY2F0aW9uLnVuaXQuY29uZm9ybWF0aW9uLm9wZXJhdG9yLm5hbWU7IC8vIGluc3RhbmNlXG4gICAgfVxuICAgIHZhciBlbGVtZW50RGV0YWlscztcbiAgICBpZiAoc3RydWN0dXJlXzEuVW5pdC5pc0F0b21pYyhsb2NhdGlvbi51bml0KSkge1xuICAgICAgICBlbGVtZW50RGV0YWlscyA9IGF0b21pY0VsZW1lbnREZXRhaWxzKGxvY2F0aW9uLCBncmFudWxhcml0eSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHN0cnVjdHVyZV8xLlVuaXQuaXNDb2Fyc2UobG9jYXRpb24udW5pdCkpIHtcbiAgICAgICAgZWxlbWVudERldGFpbHMgPSBjb2Fyc2VFbGVtZW50RGV0YWlscyhsb2NhdGlvbiwgZ3JhbnVsYXJpdHkpO1xuICAgIH1cbiAgICByZXR1cm4gdHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCBiYXNpY0RldGFpbHMpLCBlbGVtZW50RGV0YWlscyk7XG59XG5mdW5jdGlvbiBhdG9taWNFbGVtZW50RGV0YWlscyhsb2NhdGlvbiwgZ3JhbnVsYXJpdHkpIHtcbiAgICB2YXIgZWxlbWVudERldGFpbHMgPSB7XG4gICAgICAgIGVudGl0eV9pZDogc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5jaGFpbi5sYWJlbF9lbnRpdHlfaWQobG9jYXRpb24pLFxuICAgICAgICBsYWJlbF9hc3ltX2lkOiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLmNoYWluLmxhYmVsX2FzeW1faWQobG9jYXRpb24pLFxuICAgICAgICBhdXRoX2FzeW1faWQ6IHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMuY2hhaW4uYXV0aF9hc3ltX2lkKGxvY2F0aW9uKSxcbiAgICAgICAgdW5wX2FjY2Vzc2lvbjogdW5kZWZpbmVkLFxuICAgICAgICB1bnBfc2VxX2lkOiB1bmRlZmluZWQsXG4gICAgICAgIHNlcV9pZDogc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5yZXNpZHVlLmxhYmVsX3NlcV9pZChsb2NhdGlvbiksXG4gICAgICAgIGF1dGhfc2VxX2lkOiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLnJlc2lkdWUuYXV0aF9zZXFfaWQobG9jYXRpb24pLFxuICAgICAgICBpbnNfY29kZTogc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5yZXNpZHVlLnBkYnhfUERCX2luc19jb2RlKGxvY2F0aW9uKSxcbiAgICAgICAgY29tcF9pZDogc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5hdG9tLmxhYmVsX2NvbXBfaWQobG9jYXRpb24pLFxuICAgICAgICBhdG9tX2lkOiBbc3RydWN0dXJlXzEuU3RydWN0dXJlUHJvcGVydGllcy5hdG9tLmxhYmVsX2F0b21faWQobG9jYXRpb24pXSxcbiAgICAgICAgYWx0X2lkOiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLmF0b20ubGFiZWxfYWx0X2lkKGxvY2F0aW9uKVxuICAgIH07XG4gICAgdmFyIHVucExhYmVsID0gc2lmdHNfbWFwcGluZ18xLlNJRlRTTWFwcGluZy5nZXRMYWJlbChsb2NhdGlvbik7XG4gICAgaWYgKHVucExhYmVsKSB7XG4gICAgICAgIHZhciB1bnBMYWJlbERldGFpbHMgPSB1bnBMYWJlbC5zcGxpdCgnICcpO1xuICAgICAgICBpZiAodW5wTGFiZWxEZXRhaWxzWzBdID09PSAnVU5QJykge1xuICAgICAgICAgICAgZWxlbWVudERldGFpbHMudW5wX2FjY2Vzc2lvbiA9IHVucExhYmVsRGV0YWlsc1sxXTtcbiAgICAgICAgICAgIGVsZW1lbnREZXRhaWxzLnVucF9zZXFfaWQgPSArdW5wTGFiZWxEZXRhaWxzWzJdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBtaWNyb0hldENvbXBJZHMgPSBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLnJlc2lkdWUubWljcm9oZXRlcm9nZW5laXR5Q29tcElkcyhsb2NhdGlvbik7XG4gICAgZWxlbWVudERldGFpbHNbJ21pY3JvX2hldF9jb21wX2lkcyddID0gZ3JhbnVsYXJpdHkgPT09ICdyZXNpZHVlJyAmJiBtaWNyb0hldENvbXBJZHMubGVuZ3RoID4gMSA/XG4gICAgICAgIG1pY3JvSGV0Q29tcElkcyA6IFtlbGVtZW50RGV0YWlsc1snY29tcF9pZCddXTtcbiAgICByZXR1cm4gZWxlbWVudERldGFpbHM7XG59XG5mdW5jdGlvbiBjb2Fyc2VFbGVtZW50RGV0YWlscyhsb2NhdGlvbiwgZ3JhbnVsYXJpdHkpIHtcbiAgICB2YXIgZWxlbWVudERldGFpbHMgPSB7XG4gICAgICAgIGFzeW1faWQ6IHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMuY29hcnNlLmFzeW1faWQobG9jYXRpb24pLFxuICAgICAgICBzZXFfaWRfYmVnaW46IHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMuY29hcnNlLnNlcV9pZF9iZWdpbihsb2NhdGlvbiksXG4gICAgICAgIHNlcV9pZF9lbmQ6IHN0cnVjdHVyZV8xLlN0cnVjdHVyZVByb3BlcnRpZXMuY29hcnNlLnNlcV9pZF9lbmQobG9jYXRpb24pXG4gICAgfTtcbiAgICBpZiAoZ3JhbnVsYXJpdHkgPT09ICdyZXNpZHVlJykge1xuICAgICAgICBpZiAoZWxlbWVudERldGFpbHMuc2VxX2lkX2JlZ2luID09PSBlbGVtZW50RGV0YWlscy5zZXFfaWRfZW5kKSB7XG4gICAgICAgICAgICB2YXIgZW50aXR5SW5kZXggPSBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLmNvYXJzZS5lbnRpdHlLZXkobG9jYXRpb24pO1xuICAgICAgICAgICAgdmFyIHNlcSA9IGxvY2F0aW9uLnVuaXQubW9kZWwuc2VxdWVuY2UuYnlFbnRpdHlLZXlbZW50aXR5SW5kZXhdO1xuICAgICAgICAgICAgZWxlbWVudERldGFpbHNbJ2NvbXBfaWQnXSA9IHNlcS5zZXF1ZW5jZS5jb21wSWQudmFsdWUoZWxlbWVudERldGFpbHMuc2VxX2lkX2JlZ2luIC0gMSk7IC8vIDEtaW5kZXhlZFxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50RGV0YWlscztcbn1cbmZ1bmN0aW9uIGJvbmRMYWJlbChib25kLCBncmFudWxhcml0eSkge1xuICAgIHJldHVybiBfYnVuZGxlTGFiZWwoeyBsb2NpOiBbXG4gICAgICAgICAgICBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVFbGVtZW50LkxvY2koYm9uZC5hU3RydWN0dXJlLCBbeyB1bml0OiBib25kLmFVbml0LCBpbmRpY2VzOiBpbnRfMS5PcmRlcmVkU2V0Lm9mU2luZ2xldG9uKGJvbmQuYUluZGV4KSB9XSksXG4gICAgICAgICAgICBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVFbGVtZW50LkxvY2koYm9uZC5iU3RydWN0dXJlLCBbeyB1bml0OiBib25kLmJVbml0LCBpbmRpY2VzOiBpbnRfMS5PcmRlcmVkU2V0Lm9mU2luZ2xldG9uKGJvbmQuYkluZGV4KSB9XSlcbiAgICAgICAgXSB9LCBncmFudWxhcml0eSk7XG59XG5leHBvcnRzLmJvbmRMYWJlbCA9IGJvbmRMYWJlbDtcbmZ1bmN0aW9uIF9idW5kbGVMYWJlbChidW5kbGUsIGdyYW51bGFyaXR5KSB7XG4gICAgdmFyIGlzU2luZ2xlRWxlbWVudHMgPSB0cnVlO1xuICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBidW5kbGUubG9jaTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGwgPSBfYVtfaV07XG4gICAgICAgIGlmICghc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5Mb2NpLmlzKGwpIHx8IHN0cnVjdHVyZV8xLlN0cnVjdHVyZUVsZW1lbnQuTG9jaS5zaXplKGwpICE9PSAxKSB7XG4gICAgICAgICAgICBpc1NpbmdsZUVsZW1lbnRzID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNTaW5nbGVFbGVtZW50cykge1xuICAgICAgICB2YXIgbG9jYXRpb25zID0gYnVuZGxlLmxvY2kubWFwKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBsLmVsZW1lbnRzWzBdLCB1bml0ID0gX2EudW5pdCwgaW5kaWNlcyA9IF9hLmluZGljZXM7XG4gICAgICAgICAgICByZXR1cm4gc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5Mb2NhdGlvbi5jcmVhdGUobC5zdHJ1Y3R1cmUsIHVuaXQsIHVuaXQuZWxlbWVudHNbaW50XzEuT3JkZXJlZFNldC5zdGFydChpbmRpY2VzKV0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGVsZW1lbnREZXRhaWxzQXJyID0gbG9jYXRpb25zLm1hcChmdW5jdGlvbiAobCkgeyByZXR1cm4gZ2V0RWxlbWVudERldGFpbHMobCwgZ3JhbnVsYXJpdHkpOyB9KTtcbiAgICAgICAgdmFyIGF0b21JZHMgPSBbZWxlbWVudERldGFpbHNBcnJbMF0uYXRvbV9pZFswXSwgZWxlbWVudERldGFpbHNBcnJbMV0uYXRvbV9pZFswXV07XG4gICAgICAgIHZhciBlbGVtZW50RGV0YWlscyA9IGVsZW1lbnREZXRhaWxzQXJyWzBdO1xuICAgICAgICBlbGVtZW50RGV0YWlsc1snYXRvbV9pZCddID0gYXRvbUlkcztcbiAgICAgICAgcmV0dXJuIGVsZW1lbnREZXRhaWxzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGVsZW1lbnREZXRhaWxzID0gYnVuZGxlLmxvY2kubWFwKGZ1bmN0aW9uIChsKSB7IHJldHVybiBsb2NpRGV0YWlscyhsKTsgfSk7XG4gICAgICAgIHJldHVybiBlbGVtZW50RGV0YWlscztcbiAgICB9XG59XG5leHBvcnRzLl9idW5kbGVMYWJlbCA9IF9idW5kbGVMYWJlbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxvY2ktZGV0YWlscy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/loci-details.js\n");
  
  /***/ }),
  
  /***/ "./lib/spec.js":
  /*!*********************!*\
    !*** ./lib/spec.js ***!
    \*********************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.DefaultParams = exports.createPluginUI = exports.DefaultPluginUISpec = exports.DefaultPluginSpec = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar React = tslib_1.__importStar(__webpack_require__(/*! react */ \"./node_modules/react/index.js\"));\nvar ReactDOM = tslib_1.__importStar(__webpack_require__(/*! react-dom */ \"./node_modules/react-dom/index.js\"));\nvar volume_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/custom/volume */ \"./node_modules/molstar/lib/mol-plugin-ui/custom/volume.js\");\nvar plugin_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/plugin */ \"./node_modules/molstar/lib/mol-plugin-ui/plugin.js\");\nvar behavior_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior */ \"./node_modules/molstar/lib/mol-plugin/behavior.js\");\nvar transformers_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior/dynamic/volume-streaming/transformers */ \"./node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/transformers.js\");\nvar context_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/context */ \"./node_modules/molstar/lib/mol-plugin-ui/context.js\");\nvar spec_1 = __webpack_require__(/*! Molstar/mol-plugin/spec */ \"./node_modules/molstar/lib/mol-plugin/spec.js\");\nvar config_1 = __webpack_require__(/*! Molstar/mol-plugin/config */ \"./node_modules/molstar/lib/mol-plugin/config.js\");\nvar actions_1 = __webpack_require__(/*! Molstar/mol-plugin-state/actions */ \"./node_modules/molstar/lib/mol-plugin-state/actions.js\");\nvar labels_1 = __webpack_require__(/*! ./labels */ \"./lib/labels.js\");\nvar DefaultPluginSpec = function () { return ({\n    actions: [\n        spec_1.PluginSpec.Action(actions_1.StateActions.Structure.EnableStructureCustomProps)\n    ],\n    behaviors: [\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.Representation.HighlightLoci),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.Representation.SelectLoci),\n        spec_1.PluginSpec.Behavior(labels_1.PDBeLociLabelProvider),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.Representation.FocusLoci),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.Camera.FocusLoci),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.Camera.CameraAxisHelper),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.StructureInfo),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.AccessibleSurfaceArea),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.BestDatabaseSequenceMapping, { autoAttach: true, showTooltip: true }),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.Interactions),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.SecondaryStructure),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.ValenceModel),\n        spec_1.PluginSpec.Behavior(behavior_1.PluginBehaviors.CustomProps.CrossLinkRestraint),\n    ],\n    // animations: [],\n    config: [\n        [config_1.PluginConfig.VolumeStreaming.DefaultServer, 'https://www.ebi.ac.uk/pdbe/volume-server']\n    ]\n}); };\nexports.DefaultPluginSpec = DefaultPluginSpec;\nvar DefaultPluginUISpec = function () { return (tslib_1.__assign(tslib_1.__assign({}, (0, exports.DefaultPluginSpec)()), { customParamEditors: [\n        [transformers_1.CreateVolumeStreamingBehavior, volume_1.VolumeStreamingCustomControls]\n    ] })); };\nexports.DefaultPluginUISpec = DefaultPluginUISpec;\nfunction createPluginUI(target, spec, options) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var ctx;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    ctx = new context_1.PluginUIContext(spec || (0, exports.DefaultPluginUISpec)());\n                    return [4 /*yield*/, ctx.init()];\n                case 1:\n                    _a.sent();\n                    if (!(options === null || options === void 0 ? void 0 : options.onBeforeUIRender)) return [3 /*break*/, 3];\n                    return [4 /*yield*/, options.onBeforeUIRender(ctx)];\n                case 2:\n                    _a.sent();\n                    _a.label = 3;\n                case 3:\n                    ReactDOM.render(React.createElement(plugin_1.Plugin, { plugin: ctx }), target);\n                    return [2 /*return*/, ctx];\n            }\n        });\n    });\n}\nexports.createPluginUI = createPluginUI;\nexports.DefaultParams = {\n    moleculeId: undefined,\n    superposition: undefined,\n    superpositionParams: undefined,\n    customData: undefined,\n    ligandView: undefined,\n    assemblyId: undefined,\n    visualStyle: undefined,\n    highlightColor: undefined,\n    selectColor: undefined,\n    hideStructure: undefined,\n    hideCanvasControls: undefined,\n    granularity: undefined,\n    selection: undefined,\n    mapSettings: undefined,\n    selectBindings: undefined,\n    focusBindings: undefined,\n    defaultPreset: 'default',\n    pdbeUrl: 'https://www.ebi.ac.uk/pdbe/',\n    bgColor: { r: 0, g: 0, b: 0 },\n    lighting: undefined,\n    encoding: 'bcif',\n    selectInteraction: true,\n    loadMaps: false,\n    validationAnnotation: false,\n    domainAnnotation: false,\n    lowPrecisionCoords: false,\n    expanded: false,\n    hideControls: false,\n    pdbeLink: true,\n    loadCartoonsOnly: false,\n    landscape: false,\n    subscribeEvents: false,\n    alphafoldView: false,\n    sequencePanel: false\n};\n//# sourceMappingURL=spec.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvc3BlYy5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxxQkFBcUIsR0FBRyxzQkFBc0IsR0FBRywyQkFBMkIsR0FBRyx5QkFBeUI7QUFDeEcsY0FBYyxtQkFBTyxDQUFDLGdEQUFPO0FBQzdCLGlDQUFpQyxtQkFBTyxDQUFDLDRDQUFPO0FBQ2hELG9DQUFvQyxtQkFBTyxDQUFDLG9EQUFXO0FBQ3ZELGVBQWUsbUJBQU8sQ0FBQyxzR0FBcUM7QUFDNUQsZUFBZSxtQkFBTyxDQUFDLHdGQUE4QjtBQUNyRCxpQkFBaUIsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDdEQscUJBQXFCLG1CQUFPLENBQUMsa0tBQW1FO0FBQ2hHLGdCQUFnQixtQkFBTyxDQUFDLDBGQUErQjtBQUN2RCxhQUFhLG1CQUFPLENBQUMsOEVBQXlCO0FBQzlDLGVBQWUsbUJBQU8sQ0FBQyxrRkFBMkI7QUFDbEQsZ0JBQWdCLG1CQUFPLENBQUMsZ0dBQWtDO0FBQzFELGVBQWUsbUJBQU8sQ0FBQyxpQ0FBVTtBQUNqQyxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUdBQXlHLHFDQUFxQztBQUM5STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QseUJBQXlCO0FBQ3pCLHdDQUF3Qyw0Q0FBNEMsdUNBQXVDO0FBQzNIO0FBQ0EsT0FBTztBQUNQLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSxhQUFhO0FBQ3hGO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0Esc0JBQXNCO0FBQ3RCLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtCQUFrQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3NwZWMuanM/NzhhZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuRGVmYXVsdFBhcmFtcyA9IGV4cG9ydHMuY3JlYXRlUGx1Z2luVUkgPSBleHBvcnRzLkRlZmF1bHRQbHVnaW5VSVNwZWMgPSBleHBvcnRzLkRlZmF1bHRQbHVnaW5TcGVjID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIgUmVhY3QgPSB0c2xpYl8xLl9faW1wb3J0U3RhcihyZXF1aXJlKFwicmVhY3RcIikpO1xudmFyIFJlYWN0RE9NID0gdHNsaWJfMS5fX2ltcG9ydFN0YXIocmVxdWlyZShcInJlYWN0LWRvbVwiKSk7XG52YXIgdm9sdW1lXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2N1c3RvbS92b2x1bWVcIik7XG52YXIgcGx1Z2luXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3BsdWdpblwiKTtcbnZhciBiZWhhdmlvcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9iZWhhdmlvclwiKTtcbnZhciB0cmFuc2Zvcm1lcnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4vYmVoYXZpb3IvZHluYW1pYy92b2x1bWUtc3RyZWFtaW5nL3RyYW5zZm9ybWVyc1wiKTtcbnZhciBjb250ZXh0XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRleHRcIik7XG52YXIgc3BlY18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9zcGVjXCIpO1xudmFyIGNvbmZpZ18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9jb25maWdcIik7XG52YXIgYWN0aW9uc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi1zdGF0ZS9hY3Rpb25zXCIpO1xudmFyIGxhYmVsc18xID0gcmVxdWlyZShcIi4vbGFiZWxzXCIpO1xudmFyIERlZmF1bHRQbHVnaW5TcGVjID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBhY3Rpb25zOiBbXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkFjdGlvbihhY3Rpb25zXzEuU3RhdGVBY3Rpb25zLlN0cnVjdHVyZS5FbmFibGVTdHJ1Y3R1cmVDdXN0b21Qcm9wcylcbiAgICBdLFxuICAgIGJlaGF2aW9yczogW1xuICAgICAgICBzcGVjXzEuUGx1Z2luU3BlYy5CZWhhdmlvcihiZWhhdmlvcl8xLlBsdWdpbkJlaGF2aW9ycy5SZXByZXNlbnRhdGlvbi5IaWdobGlnaHRMb2NpKSxcbiAgICAgICAgc3BlY18xLlBsdWdpblNwZWMuQmVoYXZpb3IoYmVoYXZpb3JfMS5QbHVnaW5CZWhhdmlvcnMuUmVwcmVzZW50YXRpb24uU2VsZWN0TG9jaSksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGxhYmVsc18xLlBEQmVMb2NpTGFiZWxQcm92aWRlciksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLlJlcHJlc2VudGF0aW9uLkZvY3VzTG9jaSksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLkNhbWVyYS5Gb2N1c0xvY2kpLFxuICAgICAgICBzcGVjXzEuUGx1Z2luU3BlYy5CZWhhdmlvcihiZWhhdmlvcl8xLlBsdWdpbkJlaGF2aW9ycy5DYW1lcmEuQ2FtZXJhQXhpc0hlbHBlciksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLkN1c3RvbVByb3BzLlN0cnVjdHVyZUluZm8pLFxuICAgICAgICBzcGVjXzEuUGx1Z2luU3BlYy5CZWhhdmlvcihiZWhhdmlvcl8xLlBsdWdpbkJlaGF2aW9ycy5DdXN0b21Qcm9wcy5BY2Nlc3NpYmxlU3VyZmFjZUFyZWEpLFxuICAgICAgICBzcGVjXzEuUGx1Z2luU3BlYy5CZWhhdmlvcihiZWhhdmlvcl8xLlBsdWdpbkJlaGF2aW9ycy5DdXN0b21Qcm9wcy5CZXN0RGF0YWJhc2VTZXF1ZW5jZU1hcHBpbmcsIHsgYXV0b0F0dGFjaDogdHJ1ZSwgc2hvd1Rvb2x0aXA6IHRydWUgfSksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLkN1c3RvbVByb3BzLkludGVyYWN0aW9ucyksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLkN1c3RvbVByb3BzLlNlY29uZGFyeVN0cnVjdHVyZSksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLkN1c3RvbVByb3BzLlZhbGVuY2VNb2RlbCksXG4gICAgICAgIHNwZWNfMS5QbHVnaW5TcGVjLkJlaGF2aW9yKGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3JzLkN1c3RvbVByb3BzLkNyb3NzTGlua1Jlc3RyYWludCksXG4gICAgXSxcbiAgICAvLyBhbmltYXRpb25zOiBbXSxcbiAgICBjb25maWc6IFtcbiAgICAgICAgW2NvbmZpZ18xLlBsdWdpbkNvbmZpZy5Wb2x1bWVTdHJlYW1pbmcuRGVmYXVsdFNlcnZlciwgJ2h0dHBzOi8vd3d3LmViaS5hYy51ay9wZGJlL3ZvbHVtZS1zZXJ2ZXInXVxuICAgIF1cbn0pOyB9O1xuZXhwb3J0cy5EZWZhdWx0UGx1Z2luU3BlYyA9IERlZmF1bHRQbHVnaW5TcGVjO1xudmFyIERlZmF1bHRQbHVnaW5VSVNwZWMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAodHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCAoMCwgZXhwb3J0cy5EZWZhdWx0UGx1Z2luU3BlYykoKSksIHsgY3VzdG9tUGFyYW1FZGl0b3JzOiBbXG4gICAgICAgIFt0cmFuc2Zvcm1lcnNfMS5DcmVhdGVWb2x1bWVTdHJlYW1pbmdCZWhhdmlvciwgdm9sdW1lXzEuVm9sdW1lU3RyZWFtaW5nQ3VzdG9tQ29udHJvbHNdXG4gICAgXSB9KSk7IH07XG5leHBvcnRzLkRlZmF1bHRQbHVnaW5VSVNwZWMgPSBEZWZhdWx0UGx1Z2luVUlTcGVjO1xuZnVuY3Rpb24gY3JlYXRlUGx1Z2luVUkodGFyZ2V0LCBzcGVjLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdHg7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY3R4ID0gbmV3IGNvbnRleHRfMS5QbHVnaW5VSUNvbnRleHQoc3BlYyB8fCAoMCwgZXhwb3J0cy5EZWZhdWx0UGx1Z2luVUlTcGVjKSgpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY3R4LmluaXQoKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5vbkJlZm9yZVVJUmVuZGVyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIG9wdGlvbnMub25CZWZvcmVVSVJlbmRlcihjdHgpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgUmVhY3RET00ucmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQocGx1Z2luXzEuUGx1Z2luLCB7IHBsdWdpbjogY3R4IH0pLCB0YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgY3R4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmNyZWF0ZVBsdWdpblVJID0gY3JlYXRlUGx1Z2luVUk7XG5leHBvcnRzLkRlZmF1bHRQYXJhbXMgPSB7XG4gICAgbW9sZWN1bGVJZDogdW5kZWZpbmVkLFxuICAgIHN1cGVycG9zaXRpb246IHVuZGVmaW5lZCxcbiAgICBzdXBlcnBvc2l0aW9uUGFyYW1zOiB1bmRlZmluZWQsXG4gICAgY3VzdG9tRGF0YTogdW5kZWZpbmVkLFxuICAgIGxpZ2FuZFZpZXc6IHVuZGVmaW5lZCxcbiAgICBhc3NlbWJseUlkOiB1bmRlZmluZWQsXG4gICAgdmlzdWFsU3R5bGU6IHVuZGVmaW5lZCxcbiAgICBoaWdobGlnaHRDb2xvcjogdW5kZWZpbmVkLFxuICAgIHNlbGVjdENvbG9yOiB1bmRlZmluZWQsXG4gICAgaGlkZVN0cnVjdHVyZTogdW5kZWZpbmVkLFxuICAgIGhpZGVDYW52YXNDb250cm9sczogdW5kZWZpbmVkLFxuICAgIGdyYW51bGFyaXR5OiB1bmRlZmluZWQsXG4gICAgc2VsZWN0aW9uOiB1bmRlZmluZWQsXG4gICAgbWFwU2V0dGluZ3M6IHVuZGVmaW5lZCxcbiAgICBzZWxlY3RCaW5kaW5nczogdW5kZWZpbmVkLFxuICAgIGZvY3VzQmluZGluZ3M6IHVuZGVmaW5lZCxcbiAgICBkZWZhdWx0UHJlc2V0OiAnZGVmYXVsdCcsXG4gICAgcGRiZVVybDogJ2h0dHBzOi8vd3d3LmViaS5hYy51ay9wZGJlLycsXG4gICAgYmdDb2xvcjogeyByOiAwLCBnOiAwLCBiOiAwIH0sXG4gICAgbGlnaHRpbmc6IHVuZGVmaW5lZCxcbiAgICBlbmNvZGluZzogJ2JjaWYnLFxuICAgIHNlbGVjdEludGVyYWN0aW9uOiB0cnVlLFxuICAgIGxvYWRNYXBzOiBmYWxzZSxcbiAgICB2YWxpZGF0aW9uQW5ub3RhdGlvbjogZmFsc2UsXG4gICAgZG9tYWluQW5ub3RhdGlvbjogZmFsc2UsXG4gICAgbG93UHJlY2lzaW9uQ29vcmRzOiBmYWxzZSxcbiAgICBleHBhbmRlZDogZmFsc2UsXG4gICAgaGlkZUNvbnRyb2xzOiBmYWxzZSxcbiAgICBwZGJlTGluazogdHJ1ZSxcbiAgICBsb2FkQ2FydG9vbnNPbmx5OiBmYWxzZSxcbiAgICBsYW5kc2NhcGU6IGZhbHNlLFxuICAgIHN1YnNjcmliZUV2ZW50czogZmFsc2UsXG4gICAgYWxwaGFmb2xkVmlldzogZmFsc2UsXG4gICAgc2VxdWVuY2VQYW5lbDogZmFsc2Vcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zcGVjLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/spec.js\n");
  
  /***/ }),
  
  /***/ "./lib/subscribe-events.js":
  /*!*********************************!*\
    !*** ./lib/subscribe-events.js ***!
    \*********************************/
  /***/ ((__unused_webpack_module, exports) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.subscribeToComponentEvents = void 0;\nfunction subscribeToComponentEvents(wrapperCtx) {\n    document.addEventListener('PDB.interactions.click', function (e) {\n        if (typeof e.detail !== 'undefined') {\n            var data = e.detail.interacting_nodes ? { data: e.detail.interacting_nodes } : { data: [e.detail.selected_node] };\n            data.data[0]['focus'] = true;\n            wrapperCtx.visual.select(data);\n        }\n    });\n    document.addEventListener('PDB.interactions.mouseover', function (e) {\n        if (typeof e.detail !== 'undefined') {\n            var data = e.detail.interacting_nodes ? { data: e.detail.interacting_nodes } : { data: [e.detail.selected_node] };\n            wrapperCtx.visual.highlighting(data);\n        }\n    });\n    document.addEventListener('PDB.interactions.mouseout', function (e) {\n        wrapperCtx.visual.clearHighlighting();\n    });\n    document.addEventListener(\"PDB.RNA.viewer.mouseover\", function (e) {\n        if (void 0 !== e.eventData) {\n            var highlightQuery = {\n                entity_id: e.eventData.entityId,\n                start_residue_number: e.eventData.label_seq_id,\n                end_residue_number: e.eventData.label_seq_id\n            };\n            wrapperCtx.visual.highlighting({\n                data: [highlightQuery],\n                structureNumber: 1\n            });\n        }\n    });\n    document.addEventListener(\"PDB.RNA.viewer.mouseout\", function (e) {\n        wrapperCtx.visual.clearHighlighting();\n    });\n    document.addEventListener('PDB.topologyViewer.click', function (e) {\n        if (typeof e.eventData !== 'undefined') {\n            // Create query object from event data\n            var highlightQuery = {\n                entity_id: e.eventData.entityId,\n                struct_asym_id: e.eventData.structAsymId,\n                start_residue_number: e.eventData.residueNumber,\n                end_residue_number: e.eventData.residueNumber,\n                sideChain: true,\n                focus: true\n            };\n            // Call highlightAnnotation\n            wrapperCtx.visual.select({ data: [highlightQuery] });\n        }\n    });\n    document.addEventListener('PDB.topologyViewer.mouseover', function (e) {\n        if (typeof e.eventData !== 'undefined') {\n            // Abort if entryid do not match or viewer type is unipdb\n            // if(e.eventData.entryId != scope.pdbId) return;\n            // Create query object from event data\n            var highlightQuery = {\n                entity_id: e.eventData.entityId,\n                struct_asym_id: e.eventData.structAsymId,\n                start_residue_number: e.eventData.residueNumber,\n                end_residue_number: e.eventData.residueNumber\n            };\n            // Call highlightAnnotation\n            wrapperCtx.visual.highlighting({ data: [highlightQuery] });\n        }\n    });\n    document.addEventListener('PDB.topologyViewer.mouseout', function (e) {\n        wrapperCtx.visual.clearHighlighting();\n    });\n    document.addEventListener('protvista-mouseover', function (e) {\n        if (typeof e.detail !== 'undefined') {\n            var highlightQuery = undefined;\n            // Create query object from event data\n            if (e.detail.start && e.detail.end) {\n                highlightQuery = {\n                    start_residue_number: parseInt(e.detail.start),\n                    end_residue_number: parseInt(e.detail.end)\n                };\n            }\n            if (e.detail.feature && e.detail.feature.entityId)\n                highlightQuery['entity_id'] = e.detail.feature.entityId + '';\n            if (e.detail.feature && e.detail.feature.bestChainId)\n                highlightQuery['struct_asym_id'] = e.detail.feature.bestChainId;\n            if (e.detail.feature && e.detail.feature.chainId)\n                highlightQuery['struct_asym_id'] = e.detail.feature.chainId;\n            if (highlightQuery)\n                wrapperCtx.visual.highlighting({ data: [highlightQuery] });\n        }\n    });\n    document.addEventListener('protvista-mouseout', function (e) {\n        wrapperCtx.visual.clearHighlighting();\n    });\n    document.addEventListener('protvista-click', function (e) {\n        if (typeof e.detail !== 'undefined') {\n            var showInteraction = false;\n            var highlightQuery = undefined;\n            // Create query object from event data\n            if (e.detail.start && e.detail.end) {\n                highlightQuery = {\n                    start_residue_number: parseInt(e.detail.start),\n                    end_residue_number: parseInt(e.detail.end)\n                };\n            }\n            if (e.detail.feature && e.detail.feature.entityId)\n                highlightQuery['entity_id'] = e.detail.feature.entityId + '';\n            if (e.detail.feature && e.detail.feature.bestChainId)\n                highlightQuery['struct_asym_id'] = e.detail.feature.bestChainId;\n            if (e.detail.feature && e.detail.feature.chainId)\n                highlightQuery['struct_asym_id'] = e.detail.feature.chainId;\n            if (e.detail.feature && e.detail.feature.accession && e.detail.feature.accession.split(' ')[0] === 'Chain' || e.detail.feature.tooltipContent === 'Ligand binding site') {\n                showInteraction = true;\n            }\n            if (e.detail.start === e.detail.end)\n                showInteraction = true;\n            if (highlightQuery) {\n                if (showInteraction) {\n                    highlightQuery['sideChain'] = true;\n                }\n                else {\n                    var selColor = undefined;\n                    if (e.detail.trackIndex > -1 && e.detail.feature.locations && e.detail.feature.locations[0].fragments[e.detail.trackIndex].color)\n                        selColor = e.detail.feature.locations[0].fragments[e.detail.trackIndex].color;\n                    if (typeof selColor == 'undefined' && e.detail.feature.color)\n                        selColor = e.detail.feature.color;\n                    if (typeof selColor == 'undefined' && e.detail.color)\n                        selColor = e.detail.color;\n                    if (typeof selColor == 'undefined') {\n                        selColor = { r: 65, g: 96, b: 91 };\n                    }\n                    else {\n                        var isRgb = /rgb/g;\n                        if (isRgb.test(selColor)) {\n                            var rgbArr = selColor.substring(4, selColor.length - 1).split(',');\n                            selColor = { r: rgbArr[0], g: rgbArr[1], b: rgbArr[2] };\n                        }\n                    }\n                    highlightQuery['color'] = selColor;\n                }\n                highlightQuery['focus'] = true;\n                wrapperCtx.visual.select({ data: [highlightQuery] });\n            }\n        }\n    });\n    var elementTypeArrForRange = ['uniprot', 'pfam', 'cath', 'scop', 'strand', 'helice'];\n    var elementTypeArrForSingle = ['chain', 'quality', 'quality_outlier', 'binding site', 'alternate conformer'];\n    document.addEventListener('PDB.seqViewer.click', function (e) {\n        if (typeof e.eventData !== 'undefined') {\n            // Abort if entryid and entityid do not match or viewer type is unipdb\n            // if(e.eventData.entryId != scope.pdbId) return;\n            if (typeof e.eventData.elementData !== 'undefined' && elementTypeArrForSingle.indexOf(e.eventData.elementData.elementType) > -1) {\n                // Create query object from event data\n                var highlightQuery = {\n                    entity_id: e.eventData.entityId,\n                    struct_asym_id: e.eventData.elementData.pathData.struct_asym_id,\n                    start_residue_number: e.eventData.residueNumber,\n                    end_residue_number: e.eventData.residueNumber,\n                    sideChain: true,\n                    focus: true\n                };\n                // Call highlightAnnotation\n                wrapperCtx.visual.select({ data: [highlightQuery] });\n            }\n            else if (typeof e.eventData.elementData !== 'undefined' && elementTypeArrForRange.indexOf(e.eventData.elementData.elementType) > -1) {\n                var seqColorArray = e.eventData.elementData.color;\n                // Create query object from event data\n                var highlightQuery = {\n                    entity_id: e.eventData.entityId,\n                    struct_asym_id: e.eventData.elementData.pathData.struct_asym_id,\n                    start_residue_number: e.eventData.elementData.pathData.start.residue_number,\n                    end_residue_number: e.eventData.elementData.pathData.end.residue_number,\n                    color: { r: seqColorArray[0], g: seqColorArray[1], b: seqColorArray[2] },\n                    focus: true\n                };\n                wrapperCtx.visual.select({ data: [highlightQuery] });\n            }\n        }\n    });\n    document.addEventListener('PDB.seqViewer.mouseover', function (e) {\n        if (typeof e.eventData !== 'undefined') {\n            // Abort if entryid and entityid do not match or viewer type is unipdb\n            // if(e.eventData.entryId != scope.pdbId) return;\n            if (typeof e.eventData.elementData !== 'undefined' && elementTypeArrForSingle.indexOf(e.eventData.elementData.elementType) > -1) {\n                // Create query object from event data\n                var highlightQuery = {\n                    entity_id: e.eventData.entityId,\n                    struct_asym_id: e.eventData.elementData.pathData.struct_asym_id,\n                    start_residue_number: e.eventData.residueNumber,\n                    end_residue_number: e.eventData.residueNumber,\n                    focus: true\n                };\n                wrapperCtx.visual.select({ data: [highlightQuery] });\n            }\n            else if (typeof e.eventData.elementData !== 'undefined' && elementTypeArrForRange.indexOf(e.eventData.elementData.elementType) > -1) {\n                // Create query object from event data\n                var highlightQuery = {\n                    entity_id: e.eventData.entityId,\n                    struct_asym_id: e.eventData.elementData.pathData.struct_asym_id,\n                    start_residue_number: e.eventData.elementData.pathData.start.residue_number,\n                    end_residue_number: e.eventData.elementData.pathData.end.residue_number\n                };\n                // Call highlightAnnotation\n                wrapperCtx.visual.highlighting({ data: [highlightQuery] });\n            }\n        }\n    });\n    document.addEventListener('PDB.seqViewer.mouseout', function (e) {\n        wrapperCtx.visual.clearHighlighting();\n    });\n}\nexports.subscribeToComponentEvents = subscribeToComponentEvents;\n//# sourceMappingURL=subscribe-events.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvc3Vic2NyaWJlLWV2ZW50cy5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELG1DQUFtQyxJQUFJO0FBQzdGO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0Esc0RBQXNELG1DQUFtQyxJQUFJO0FBQzdGO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1Qyx3QkFBd0I7QUFDL0Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHdCQUF3QjtBQUNyRTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsd0JBQXdCO0FBQ3pFO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsd0JBQXdCO0FBQ25FO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyx3QkFBd0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLCtEQUErRDtBQUM1RjtBQUNBO0FBQ0EsMkNBQTJDLHdCQUF3QjtBQUNuRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHdCQUF3QjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCx3QkFBd0I7QUFDekU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0NBQWtDO0FBQ2xDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3N1YnNjcmliZS1ldmVudHMuanM/MzY4YSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuc3Vic2NyaWJlVG9Db21wb25lbnRFdmVudHMgPSB2b2lkIDA7XG5mdW5jdGlvbiBzdWJzY3JpYmVUb0NvbXBvbmVudEV2ZW50cyh3cmFwcGVyQ3R4KSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignUERCLmludGVyYWN0aW9ucy5jbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZS5kZXRhaWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGUuZGV0YWlsLmludGVyYWN0aW5nX25vZGVzID8geyBkYXRhOiBlLmRldGFpbC5pbnRlcmFjdGluZ19ub2RlcyB9IDogeyBkYXRhOiBbZS5kZXRhaWwuc2VsZWN0ZWRfbm9kZV0gfTtcbiAgICAgICAgICAgIGRhdGEuZGF0YVswXVsnZm9jdXMnXSA9IHRydWU7XG4gICAgICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5zZWxlY3QoZGF0YSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdQREIuaW50ZXJhY3Rpb25zLm1vdXNlb3ZlcicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZS5kZXRhaWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGUuZGV0YWlsLmludGVyYWN0aW5nX25vZGVzID8geyBkYXRhOiBlLmRldGFpbC5pbnRlcmFjdGluZ19ub2RlcyB9IDogeyBkYXRhOiBbZS5kZXRhaWwuc2VsZWN0ZWRfbm9kZV0gfTtcbiAgICAgICAgICAgIHdyYXBwZXJDdHgudmlzdWFsLmhpZ2hsaWdodGluZyhkYXRhKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ1BEQi5pbnRlcmFjdGlvbnMubW91c2VvdXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5jbGVhckhpZ2hsaWdodGluZygpO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJQREIuUk5BLnZpZXdlci5tb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gZS5ldmVudERhdGEpIHtcbiAgICAgICAgICAgIHZhciBoaWdobGlnaHRRdWVyeSA9IHtcbiAgICAgICAgICAgICAgICBlbnRpdHlfaWQ6IGUuZXZlbnREYXRhLmVudGl0eUlkLFxuICAgICAgICAgICAgICAgIHN0YXJ0X3Jlc2lkdWVfbnVtYmVyOiBlLmV2ZW50RGF0YS5sYWJlbF9zZXFfaWQsXG4gICAgICAgICAgICAgICAgZW5kX3Jlc2lkdWVfbnVtYmVyOiBlLmV2ZW50RGF0YS5sYWJlbF9zZXFfaWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5oaWdobGlnaHRpbmcoe1xuICAgICAgICAgICAgICAgIGRhdGE6IFtoaWdobGlnaHRRdWVyeV0sXG4gICAgICAgICAgICAgICAgc3RydWN0dXJlTnVtYmVyOiAxXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJQREIuUk5BLnZpZXdlci5tb3VzZW91dFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5jbGVhckhpZ2hsaWdodGluZygpO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ1BEQi50b3BvbG9neVZpZXdlci5jbGljaycsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZS5ldmVudERhdGEgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgcXVlcnkgb2JqZWN0IGZyb20gZXZlbnQgZGF0YVxuICAgICAgICAgICAgdmFyIGhpZ2hsaWdodFF1ZXJ5ID0ge1xuICAgICAgICAgICAgICAgIGVudGl0eV9pZDogZS5ldmVudERhdGEuZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgc3RydWN0X2FzeW1faWQ6IGUuZXZlbnREYXRhLnN0cnVjdEFzeW1JZCxcbiAgICAgICAgICAgICAgICBzdGFydF9yZXNpZHVlX251bWJlcjogZS5ldmVudERhdGEucmVzaWR1ZU51bWJlcixcbiAgICAgICAgICAgICAgICBlbmRfcmVzaWR1ZV9udW1iZXI6IGUuZXZlbnREYXRhLnJlc2lkdWVOdW1iZXIsXG4gICAgICAgICAgICAgICAgc2lkZUNoYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgIGZvY3VzOiB0cnVlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gQ2FsbCBoaWdobGlnaHRBbm5vdGF0aW9uXG4gICAgICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5zZWxlY3QoeyBkYXRhOiBbaGlnaGxpZ2h0UXVlcnldIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignUERCLnRvcG9sb2d5Vmlld2VyLm1vdXNlb3ZlcicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZS5ldmVudERhdGEgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAvLyBBYm9ydCBpZiBlbnRyeWlkIGRvIG5vdCBtYXRjaCBvciB2aWV3ZXIgdHlwZSBpcyB1bmlwZGJcbiAgICAgICAgICAgIC8vIGlmKGUuZXZlbnREYXRhLmVudHJ5SWQgIT0gc2NvcGUucGRiSWQpIHJldHVybjtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBxdWVyeSBvYmplY3QgZnJvbSBldmVudCBkYXRhXG4gICAgICAgICAgICB2YXIgaGlnaGxpZ2h0UXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgZW50aXR5X2lkOiBlLmV2ZW50RGF0YS5lbnRpdHlJZCxcbiAgICAgICAgICAgICAgICBzdHJ1Y3RfYXN5bV9pZDogZS5ldmVudERhdGEuc3RydWN0QXN5bUlkLFxuICAgICAgICAgICAgICAgIHN0YXJ0X3Jlc2lkdWVfbnVtYmVyOiBlLmV2ZW50RGF0YS5yZXNpZHVlTnVtYmVyLFxuICAgICAgICAgICAgICAgIGVuZF9yZXNpZHVlX251bWJlcjogZS5ldmVudERhdGEucmVzaWR1ZU51bWJlclxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIENhbGwgaGlnaGxpZ2h0QW5ub3RhdGlvblxuICAgICAgICAgICAgd3JhcHBlckN0eC52aXN1YWwuaGlnaGxpZ2h0aW5nKHsgZGF0YTogW2hpZ2hsaWdodFF1ZXJ5XSB9KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ1BEQi50b3BvbG9neVZpZXdlci5tb3VzZW91dCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHdyYXBwZXJDdHgudmlzdWFsLmNsZWFySGlnaGxpZ2h0aW5nKCk7XG4gICAgfSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncHJvdHZpc3RhLW1vdXNlb3ZlcicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZS5kZXRhaWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB2YXIgaGlnaGxpZ2h0UXVlcnkgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAvLyBDcmVhdGUgcXVlcnkgb2JqZWN0IGZyb20gZXZlbnQgZGF0YVxuICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnN0YXJ0ICYmIGUuZGV0YWlsLmVuZCkge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFF1ZXJ5ID0ge1xuICAgICAgICAgICAgICAgICAgICBzdGFydF9yZXNpZHVlX251bWJlcjogcGFyc2VJbnQoZS5kZXRhaWwuc3RhcnQpLFxuICAgICAgICAgICAgICAgICAgICBlbmRfcmVzaWR1ZV9udW1iZXI6IHBhcnNlSW50KGUuZGV0YWlsLmVuZClcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUuZGV0YWlsLmZlYXR1cmUgJiYgZS5kZXRhaWwuZmVhdHVyZS5lbnRpdHlJZClcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRRdWVyeVsnZW50aXR5X2lkJ10gPSBlLmRldGFpbC5mZWF0dXJlLmVudGl0eUlkICsgJyc7XG4gICAgICAgICAgICBpZiAoZS5kZXRhaWwuZmVhdHVyZSAmJiBlLmRldGFpbC5mZWF0dXJlLmJlc3RDaGFpbklkKVxuICAgICAgICAgICAgICAgIGhpZ2hsaWdodFF1ZXJ5WydzdHJ1Y3RfYXN5bV9pZCddID0gZS5kZXRhaWwuZmVhdHVyZS5iZXN0Q2hhaW5JZDtcbiAgICAgICAgICAgIGlmIChlLmRldGFpbC5mZWF0dXJlICYmIGUuZGV0YWlsLmZlYXR1cmUuY2hhaW5JZClcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRRdWVyeVsnc3RydWN0X2FzeW1faWQnXSA9IGUuZGV0YWlsLmZlYXR1cmUuY2hhaW5JZDtcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHRRdWVyeSlcbiAgICAgICAgICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5oaWdobGlnaHRpbmcoeyBkYXRhOiBbaGlnaGxpZ2h0UXVlcnldIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncHJvdHZpc3RhLW1vdXNlb3V0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgd3JhcHBlckN0eC52aXN1YWwuY2xlYXJIaWdobGlnaHRpbmcoKTtcbiAgICB9KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdwcm90dmlzdGEtY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodHlwZW9mIGUuZGV0YWlsICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdmFyIHNob3dJbnRlcmFjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGhpZ2hsaWdodFF1ZXJ5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHF1ZXJ5IG9iamVjdCBmcm9tIGV2ZW50IGRhdGFcbiAgICAgICAgICAgIGlmIChlLmRldGFpbC5zdGFydCAmJiBlLmRldGFpbC5lbmQpIHtcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRRdWVyeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRfcmVzaWR1ZV9udW1iZXI6IHBhcnNlSW50KGUuZGV0YWlsLnN0YXJ0KSxcbiAgICAgICAgICAgICAgICAgICAgZW5kX3Jlc2lkdWVfbnVtYmVyOiBwYXJzZUludChlLmRldGFpbC5lbmQpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmRldGFpbC5mZWF0dXJlICYmIGUuZGV0YWlsLmZlYXR1cmUuZW50aXR5SWQpXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0UXVlcnlbJ2VudGl0eV9pZCddID0gZS5kZXRhaWwuZmVhdHVyZS5lbnRpdHlJZCArICcnO1xuICAgICAgICAgICAgaWYgKGUuZGV0YWlsLmZlYXR1cmUgJiYgZS5kZXRhaWwuZmVhdHVyZS5iZXN0Q2hhaW5JZClcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRRdWVyeVsnc3RydWN0X2FzeW1faWQnXSA9IGUuZGV0YWlsLmZlYXR1cmUuYmVzdENoYWluSWQ7XG4gICAgICAgICAgICBpZiAoZS5kZXRhaWwuZmVhdHVyZSAmJiBlLmRldGFpbC5mZWF0dXJlLmNoYWluSWQpXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0UXVlcnlbJ3N0cnVjdF9hc3ltX2lkJ10gPSBlLmRldGFpbC5mZWF0dXJlLmNoYWluSWQ7XG4gICAgICAgICAgICBpZiAoZS5kZXRhaWwuZmVhdHVyZSAmJiBlLmRldGFpbC5mZWF0dXJlLmFjY2Vzc2lvbiAmJiBlLmRldGFpbC5mZWF0dXJlLmFjY2Vzc2lvbi5zcGxpdCgnICcpWzBdID09PSAnQ2hhaW4nIHx8IGUuZGV0YWlsLmZlYXR1cmUudG9vbHRpcENvbnRlbnQgPT09ICdMaWdhbmQgYmluZGluZyBzaXRlJykge1xuICAgICAgICAgICAgICAgIHNob3dJbnRlcmFjdGlvbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5kZXRhaWwuc3RhcnQgPT09IGUuZGV0YWlsLmVuZClcbiAgICAgICAgICAgICAgICBzaG93SW50ZXJhY3Rpb24gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodFF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHNob3dJbnRlcmFjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRRdWVyeVsnc2lkZUNoYWluJ10gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlbENvbG9yID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5kZXRhaWwudHJhY2tJbmRleCA+IC0xICYmIGUuZGV0YWlsLmZlYXR1cmUubG9jYXRpb25zICYmIGUuZGV0YWlsLmZlYXR1cmUubG9jYXRpb25zWzBdLmZyYWdtZW50c1tlLmRldGFpbC50cmFja0luZGV4XS5jb2xvcilcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbENvbG9yID0gZS5kZXRhaWwuZmVhdHVyZS5sb2NhdGlvbnNbMF0uZnJhZ21lbnRzW2UuZGV0YWlsLnRyYWNrSW5kZXhdLmNvbG9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlbENvbG9yID09ICd1bmRlZmluZWQnICYmIGUuZGV0YWlsLmZlYXR1cmUuY29sb3IpXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxDb2xvciA9IGUuZGV0YWlsLmZlYXR1cmUuY29sb3I7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsQ29sb3IgPT0gJ3VuZGVmaW5lZCcgJiYgZS5kZXRhaWwuY29sb3IpXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxDb2xvciA9IGUuZGV0YWlsLmNvbG9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlbENvbG9yID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxDb2xvciA9IHsgcjogNjUsIGc6IDk2LCBiOiA5MSB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzUmdiID0gL3JnYi9nO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzUmdiLnRlc3Qoc2VsQ29sb3IpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJnYkFyciA9IHNlbENvbG9yLnN1YnN0cmluZyg0LCBzZWxDb2xvci5sZW5ndGggLSAxKS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbENvbG9yID0geyByOiByZ2JBcnJbMF0sIGc6IHJnYkFyclsxXSwgYjogcmdiQXJyWzJdIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0UXVlcnlbJ2NvbG9yJ10gPSBzZWxDb2xvcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0UXVlcnlbJ2ZvY3VzJ10gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHdyYXBwZXJDdHgudmlzdWFsLnNlbGVjdCh7IGRhdGE6IFtoaWdobGlnaHRRdWVyeV0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB2YXIgZWxlbWVudFR5cGVBcnJGb3JSYW5nZSA9IFsndW5pcHJvdCcsICdwZmFtJywgJ2NhdGgnLCAnc2NvcCcsICdzdHJhbmQnLCAnaGVsaWNlJ107XG4gICAgdmFyIGVsZW1lbnRUeXBlQXJyRm9yU2luZ2xlID0gWydjaGFpbicsICdxdWFsaXR5JywgJ3F1YWxpdHlfb3V0bGllcicsICdiaW5kaW5nIHNpdGUnLCAnYWx0ZXJuYXRlIGNvbmZvcm1lciddO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ1BEQi5zZXFWaWV3ZXIuY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAodHlwZW9mIGUuZXZlbnREYXRhICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgLy8gQWJvcnQgaWYgZW50cnlpZCBhbmQgZW50aXR5aWQgZG8gbm90IG1hdGNoIG9yIHZpZXdlciB0eXBlIGlzIHVuaXBkYlxuICAgICAgICAgICAgLy8gaWYoZS5ldmVudERhdGEuZW50cnlJZCAhPSBzY29wZS5wZGJJZCkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBlLmV2ZW50RGF0YS5lbGVtZW50RGF0YSAhPT0gJ3VuZGVmaW5lZCcgJiYgZWxlbWVudFR5cGVBcnJGb3JTaW5nbGUuaW5kZXhPZihlLmV2ZW50RGF0YS5lbGVtZW50RGF0YS5lbGVtZW50VHlwZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBxdWVyeSBvYmplY3QgZnJvbSBldmVudCBkYXRhXG4gICAgICAgICAgICAgICAgdmFyIGhpZ2hsaWdodFF1ZXJ5ID0ge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHlfaWQ6IGUuZXZlbnREYXRhLmVudGl0eUlkLFxuICAgICAgICAgICAgICAgICAgICBzdHJ1Y3RfYXN5bV9pZDogZS5ldmVudERhdGEuZWxlbWVudERhdGEucGF0aERhdGEuc3RydWN0X2FzeW1faWQsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0X3Jlc2lkdWVfbnVtYmVyOiBlLmV2ZW50RGF0YS5yZXNpZHVlTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICBlbmRfcmVzaWR1ZV9udW1iZXI6IGUuZXZlbnREYXRhLnJlc2lkdWVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHNpZGVDaGFpbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXM6IHRydWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8vIENhbGwgaGlnaGxpZ2h0QW5ub3RhdGlvblxuICAgICAgICAgICAgICAgIHdyYXBwZXJDdHgudmlzdWFsLnNlbGVjdCh7IGRhdGE6IFtoaWdobGlnaHRRdWVyeV0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZS5ldmVudERhdGEuZWxlbWVudERhdGEgIT09ICd1bmRlZmluZWQnICYmIGVsZW1lbnRUeXBlQXJyRm9yUmFuZ2UuaW5kZXhPZihlLmV2ZW50RGF0YS5lbGVtZW50RGF0YS5lbGVtZW50VHlwZSkgPiAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBzZXFDb2xvckFycmF5ID0gZS5ldmVudERhdGEuZWxlbWVudERhdGEuY29sb3I7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHF1ZXJ5IG9iamVjdCBmcm9tIGV2ZW50IGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgaGlnaGxpZ2h0UXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eV9pZDogZS5ldmVudERhdGEuZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgIHN0cnVjdF9hc3ltX2lkOiBlLmV2ZW50RGF0YS5lbGVtZW50RGF0YS5wYXRoRGF0YS5zdHJ1Y3RfYXN5bV9pZCxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRfcmVzaWR1ZV9udW1iZXI6IGUuZXZlbnREYXRhLmVsZW1lbnREYXRhLnBhdGhEYXRhLnN0YXJ0LnJlc2lkdWVfbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICBlbmRfcmVzaWR1ZV9udW1iZXI6IGUuZXZlbnREYXRhLmVsZW1lbnREYXRhLnBhdGhEYXRhLmVuZC5yZXNpZHVlX251bWJlcixcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHsgcjogc2VxQ29sb3JBcnJheVswXSwgZzogc2VxQ29sb3JBcnJheVsxXSwgYjogc2VxQ29sb3JBcnJheVsyXSB9LFxuICAgICAgICAgICAgICAgICAgICBmb2N1czogdHJ1ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd3JhcHBlckN0eC52aXN1YWwuc2VsZWN0KHsgZGF0YTogW2hpZ2hsaWdodFF1ZXJ5XSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ1BEQi5zZXFWaWV3ZXIubW91c2VvdmVyJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBlLmV2ZW50RGF0YSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIC8vIEFib3J0IGlmIGVudHJ5aWQgYW5kIGVudGl0eWlkIGRvIG5vdCBtYXRjaCBvciB2aWV3ZXIgdHlwZSBpcyB1bmlwZGJcbiAgICAgICAgICAgIC8vIGlmKGUuZXZlbnREYXRhLmVudHJ5SWQgIT0gc2NvcGUucGRiSWQpIHJldHVybjtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZS5ldmVudERhdGEuZWxlbWVudERhdGEgIT09ICd1bmRlZmluZWQnICYmIGVsZW1lbnRUeXBlQXJyRm9yU2luZ2xlLmluZGV4T2YoZS5ldmVudERhdGEuZWxlbWVudERhdGEuZWxlbWVudFR5cGUpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgcXVlcnkgb2JqZWN0IGZyb20gZXZlbnQgZGF0YVxuICAgICAgICAgICAgICAgIHZhciBoaWdobGlnaHRRdWVyeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5X2lkOiBlLmV2ZW50RGF0YS5lbnRpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgc3RydWN0X2FzeW1faWQ6IGUuZXZlbnREYXRhLmVsZW1lbnREYXRhLnBhdGhEYXRhLnN0cnVjdF9hc3ltX2lkLFxuICAgICAgICAgICAgICAgICAgICBzdGFydF9yZXNpZHVlX251bWJlcjogZS5ldmVudERhdGEucmVzaWR1ZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgZW5kX3Jlc2lkdWVfbnVtYmVyOiBlLmV2ZW50RGF0YS5yZXNpZHVlTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICBmb2N1czogdHJ1ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd3JhcHBlckN0eC52aXN1YWwuc2VsZWN0KHsgZGF0YTogW2hpZ2hsaWdodFF1ZXJ5XSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBlLmV2ZW50RGF0YS5lbGVtZW50RGF0YSAhPT0gJ3VuZGVmaW5lZCcgJiYgZWxlbWVudFR5cGVBcnJGb3JSYW5nZS5pbmRleE9mKGUuZXZlbnREYXRhLmVsZW1lbnREYXRhLmVsZW1lbnRUeXBlKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHF1ZXJ5IG9iamVjdCBmcm9tIGV2ZW50IGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgaGlnaGxpZ2h0UXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgICAgIGVudGl0eV9pZDogZS5ldmVudERhdGEuZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgIHN0cnVjdF9hc3ltX2lkOiBlLmV2ZW50RGF0YS5lbGVtZW50RGF0YS5wYXRoRGF0YS5zdHJ1Y3RfYXN5bV9pZCxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRfcmVzaWR1ZV9udW1iZXI6IGUuZXZlbnREYXRhLmVsZW1lbnREYXRhLnBhdGhEYXRhLnN0YXJ0LnJlc2lkdWVfbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICBlbmRfcmVzaWR1ZV9udW1iZXI6IGUuZXZlbnREYXRhLmVsZW1lbnREYXRhLnBhdGhEYXRhLmVuZC5yZXNpZHVlX251bWJlclxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgLy8gQ2FsbCBoaWdobGlnaHRBbm5vdGF0aW9uXG4gICAgICAgICAgICAgICAgd3JhcHBlckN0eC52aXN1YWwuaGlnaGxpZ2h0aW5nKHsgZGF0YTogW2hpZ2hsaWdodFF1ZXJ5XSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ1BEQi5zZXFWaWV3ZXIubW91c2VvdXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICB3cmFwcGVyQ3R4LnZpc3VhbC5jbGVhckhpZ2hsaWdodGluZygpO1xuICAgIH0pO1xufVxuZXhwb3J0cy5zdWJzY3JpYmVUb0NvbXBvbmVudEV2ZW50cyA9IHN1YnNjcmliZVRvQ29tcG9uZW50RXZlbnRzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3Vic2NyaWJlLWV2ZW50cy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/subscribe-events.js\n");
  
  /***/ }),
  
  /***/ "./lib/superposition-export.js":
  /*!*************************************!*\
    !*** ./lib/superposition-export.js ***!
    \*************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.superpositionExportHierarchy = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar utf8_1 = __webpack_require__(/*! Molstar/mol-io/common/utf8 */ \"./node_modules/molstar/lib/mol-io/common/utf8.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar mol_task_1 = __webpack_require__(/*! Molstar/mol-task */ \"./node_modules/molstar/lib/mol-task/index.js\");\nvar date_1 = __webpack_require__(/*! Molstar/mol-util/date */ \"./node_modules/molstar/lib/mol-util/date.js\");\nvar download_1 = __webpack_require__(/*! Molstar/mol-util/download */ \"./node_modules/molstar/lib/mol-util/download.js\");\nvar zip_1 = __webpack_require__(/*! Molstar/mol-util/zip/zip */ \"./node_modules/molstar/lib/mol-util/zip/zip.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nfunction superpositionExportHierarchy(plugin, options) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var e_1;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    return [4 /*yield*/, plugin.runTask(_superpositionExportHierarchy(plugin, options), { useOverlay: true })];\n                case 1:\n                    _a.sent();\n                    return [3 /*break*/, 3];\n                case 2:\n                    e_1 = _a.sent();\n                    console.error(e_1);\n                    plugin.log.error(\"Model export failed. See console for details.\");\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.superpositionExportHierarchy = superpositionExportHierarchy;\nfunction _superpositionExportHierarchy(plugin, options) {\n    var _this = this;\n    return mol_task_1.Task.create('Export', function (ctx) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n        var format, customState, superpositionState, segmentIndex, files, entryMap, structures, _i, structures_1, molId, modelRef, isStrHidden, _s, _a, _b, strComp, s, name_1, zipData, _c, files_1, _d, fn, data, bytes, buffer;\n        var _e, _f, _g, _h, _j, _k, _l, _m;\n        return tslib_1.__generator(this, function (_o) {\n            switch (_o.label) {\n                case 0: return [4 /*yield*/, ctx.update({ message: 'Exporting...', isIndeterminate: true, canAbort: false })];\n                case 1:\n                    _o.sent();\n                    format = (_e = options === null || options === void 0 ? void 0 : options.format) !== null && _e !== void 0 ? _e : 'cif';\n                    customState = plugin.customState;\n                    superpositionState = customState.superpositionState;\n                    segmentIndex = superpositionState.activeSegment - 1;\n                    files = [];\n                    entryMap = new Map();\n                    structures = superpositionState.loadedStructs[segmentIndex].slice();\n                    if (superpositionState.alphafold.ref)\n                        structures.push(\"AF-\".concat(customState.initParams.moleculeId));\n                    _i = 0, structures_1 = structures;\n                    _o.label = 2;\n                case 2:\n                    if (!(_i < structures_1.length)) return [3 /*break*/, 7];\n                    molId = structures_1[_i];\n                    modelRef = superpositionState.models[molId];\n                    if (!modelRef)\n                        return [3 /*break*/, 6];\n                    isStrHidden = false;\n                    _s = plugin.managers.structure.hierarchy.current.refs.get(modelRef);\n                    if (_s.cell.state.isHidden)\n                        isStrHidden = true;\n                    for (_a = 0, _b = _s.components; _a < _b.length; _a++) {\n                        strComp = _b[_a];\n                        if (strComp.cell.state.isHidden)\n                            isStrHidden = true;\n                    }\n                    if (isStrHidden)\n                        return [3 /*break*/, 6];\n                    s = (_h = (_g = (_f = _s.transform) === null || _f === void 0 ? void 0 : _f.cell.obj) === null || _g === void 0 ? void 0 : _g.data) !== null && _h !== void 0 ? _h : (_j = _s.cell.obj) === null || _j === void 0 ? void 0 : _j.data;\n                    if (!s)\n                        return [3 /*break*/, 6];\n                    if (s.models.length > 1) {\n                        plugin.log.warn(\"[Export] Skipping \".concat((_k = _s.cell.obj) === null || _k === void 0 ? void 0 : _k.label, \": Multimodel exports not supported.\"));\n                        return [3 /*break*/, 6];\n                    }\n                    if (s.units.some(function (u) { return !structure_1.Unit.isAtomic(u); })) {\n                        plugin.log.warn(\"[Export] Skipping \".concat((_l = _s.cell.obj) === null || _l === void 0 ? void 0 : _l.label, \": Non-atomic model exports not supported.\"));\n                        return [3 /*break*/, 6];\n                    }\n                    name_1 = entryMap.has(s.model.entryId)\n                        ? \"\".concat(s.model.entryId, \"_\").concat(entryMap.get(s.model.entryId) + 1, \".\").concat(format)\n                        : \"\".concat(s.model.entryId, \".\").concat(format);\n                    entryMap.set(s.model.entryId, ((_m = entryMap.get(s.model.entryId)) !== null && _m !== void 0 ? _m : 0) + 1);\n                    return [4 /*yield*/, ctx.update({ message: \"Exporting \".concat(s.model.entryId, \"...\"), isIndeterminate: true, canAbort: false })];\n                case 3:\n                    _o.sent();\n                    if (!(s.elementCount > 100000)) return [3 /*break*/, 5];\n                    // Give UI chance to update, only needed for larger structures.\n                    return [4 /*yield*/, new Promise(function (res) { return setTimeout(res, 50); })];\n                case 4:\n                    // Give UI chance to update, only needed for larger structures.\n                    _o.sent();\n                    _o.label = 5;\n                case 5:\n                    try {\n                        files.push([name_1, (0, structure_1.to_mmCIF)(s.model.entryId, s, format === 'bcif', { copyAllCategories: true })]);\n                    }\n                    catch (e) {\n                        if (format === 'cif' && s.elementCount > 2000000) {\n                            plugin.log.warn(\"[Export] The structure might be too big to be exported as Text CIF, consider using the BinaryCIF format instead.\");\n                        }\n                        throw e;\n                    }\n                    _o.label = 6;\n                case 6:\n                    _i++;\n                    return [3 /*break*/, 2];\n                case 7:\n                    if (files.length === 0) {\n                        commands_1.PluginCommands.Toast.Show(plugin, {\n                            title: 'Export Models',\n                            message: 'No visible structure in the 3D view to export!',\n                            key: 'superposition-toast-1',\n                            timeoutMs: 7000\n                        });\n                        return [2 /*return*/];\n                    }\n                    if (!(files.length === 1)) return [3 /*break*/, 8];\n                    (0, download_1.download)(new Blob([files[0][1]]), files[0][0]);\n                    return [3 /*break*/, 11];\n                case 8:\n                    if (!(files.length > 1)) return [3 /*break*/, 11];\n                    zipData = {};\n                    for (_c = 0, files_1 = files; _c < files_1.length; _c++) {\n                        _d = files_1[_c], fn = _d[0], data = _d[1];\n                        if (data instanceof Uint8Array) {\n                            zipData[fn] = data;\n                        }\n                        else {\n                            bytes = new Uint8Array((0, utf8_1.utf8ByteCount)(data));\n                            (0, utf8_1.utf8Write)(bytes, 0, data);\n                            zipData[fn] = bytes;\n                        }\n                    }\n                    return [4 /*yield*/, ctx.update({ message: \"Compressing Data...\", isIndeterminate: true, canAbort: false })];\n                case 9:\n                    _o.sent();\n                    return [4 /*yield*/, (0, zip_1.zip)(ctx, zipData)];\n                case 10:\n                    buffer = _o.sent();\n                    (0, download_1.download)(new Blob([new Uint8Array(buffer, 0, buffer.byteLength)]), \"structures_\".concat((0, date_1.getFormattedTime)(), \".zip\"));\n                    _o.label = 11;\n                case 11:\n                    plugin.log.info(\"[Export] Done.\");\n                    return [2 /*return*/];\n            }\n        });\n    }); });\n}\n//# sourceMappingURL=superposition-export.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvc3VwZXJwb3NpdGlvbi1leHBvcnQuanMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsb0NBQW9DO0FBQ3BDLGNBQWMsbUJBQU8sQ0FBQyxnREFBTztBQUM3QixhQUFhLG1CQUFPLENBQUMsb0ZBQTRCO0FBQ2pELGtCQUFrQixtQkFBTyxDQUFDLHNGQUE2QjtBQUN2RCxpQkFBaUIsbUJBQU8sQ0FBQyxzRUFBa0I7QUFDM0MsYUFBYSxtQkFBTyxDQUFDLDBFQUF1QjtBQUM1QyxpQkFBaUIsbUJBQU8sQ0FBQyxrRkFBMkI7QUFDcEQsWUFBWSxtQkFBTyxDQUFDLGdGQUEwQjtBQUM5QyxpQkFBaUIsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwR0FBMEcsa0JBQWtCO0FBQzVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELGlFQUFpRTtBQUMzSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELGdCQUFnQjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCx1Q0FBdUM7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsOEZBQThGO0FBQ3BKO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLDZCQUE2QjtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrR0FBK0cseUJBQXlCO0FBQ3hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELHFCQUFxQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCx3RUFBd0U7QUFDOUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLLElBQUk7QUFDVDtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3N1cGVycG9zaXRpb24tZXhwb3J0LmpzP2QwYmQiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnN1cGVycG9zaXRpb25FeHBvcnRIaWVyYXJjaHkgPSB2b2lkIDA7XG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoXCJ0c2xpYlwiKTtcbnZhciB1dGY4XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtaW8vY29tbW9uL3V0ZjhcIik7XG52YXIgc3RydWN0dXJlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlXCIpO1xudmFyIG1vbF90YXNrXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdGFza1wiKTtcbnZhciBkYXRlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9kYXRlXCIpO1xudmFyIGRvd25sb2FkXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9kb3dubG9hZFwiKTtcbnZhciB6aXBfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC11dGlsL3ppcC96aXBcIik7XG52YXIgY29tbWFuZHNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4vY29tbWFuZHNcIik7XG5mdW5jdGlvbiBzdXBlcnBvc2l0aW9uRXhwb3J0SGllcmFyY2h5KHBsdWdpbiwgb3B0aW9ucykge1xuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZV8xO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgMiwgLCAzXSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5ydW5UYXNrKF9zdXBlcnBvc2l0aW9uRXhwb3J0SGllcmFyY2h5KHBsdWdpbiwgb3B0aW9ucyksIHsgdXNlT3ZlcmxheTogdHJ1ZSB9KV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgZV8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVfMSk7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5sb2cuZXJyb3IoXCJNb2RlbCBleHBvcnQgZmFpbGVkLiBTZWUgY29uc29sZSBmb3IgZGV0YWlscy5cIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuc3VwZXJwb3NpdGlvbkV4cG9ydEhpZXJhcmNoeSA9IHN1cGVycG9zaXRpb25FeHBvcnRIaWVyYXJjaHk7XG5mdW5jdGlvbiBfc3VwZXJwb3NpdGlvbkV4cG9ydEhpZXJhcmNoeShwbHVnaW4sIG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBtb2xfdGFza18xLlRhc2suY3JlYXRlKCdFeHBvcnQnLCBmdW5jdGlvbiAoY3R4KSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZvcm1hdCwgY3VzdG9tU3RhdGUsIHN1cGVycG9zaXRpb25TdGF0ZSwgc2VnbWVudEluZGV4LCBmaWxlcywgZW50cnlNYXAsIHN0cnVjdHVyZXMsIF9pLCBzdHJ1Y3R1cmVzXzEsIG1vbElkLCBtb2RlbFJlZiwgaXNTdHJIaWRkZW4sIF9zLCBfYSwgX2IsIHN0ckNvbXAsIHMsIG5hbWVfMSwgemlwRGF0YSwgX2MsIGZpbGVzXzEsIF9kLCBmbiwgZGF0YSwgYnl0ZXMsIGJ1ZmZlcjtcbiAgICAgICAgdmFyIF9lLCBfZiwgX2csIF9oLCBfaiwgX2ssIF9sLCBfbTtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9vKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9vLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBjdHgudXBkYXRlKHsgbWVzc2FnZTogJ0V4cG9ydGluZy4uLicsIGlzSW5kZXRlcm1pbmF0ZTogdHJ1ZSwgY2FuQWJvcnQ6IGZhbHNlIH0pXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9vLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0ID0gKF9lID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmZvcm1hdCkgIT09IG51bGwgJiYgX2UgIT09IHZvaWQgMCA/IF9lIDogJ2NpZic7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlID0gcGx1Z2luLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgICAgICAgICBzdXBlcnBvc2l0aW9uU3RhdGUgPSBjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnRJbmRleCA9IHN1cGVycG9zaXRpb25TdGF0ZS5hY3RpdmVTZWdtZW50IC0gMTtcbiAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZW50cnlNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZXMgPSBzdXBlcnBvc2l0aW9uU3RhdGUubG9hZGVkU3RydWN0c1tzZWdtZW50SW5kZXhdLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdXBlcnBvc2l0aW9uU3RhdGUuYWxwaGFmb2xkLnJlZilcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZXMucHVzaChcIkFGLVwiLmNvbmNhdChjdXN0b21TdGF0ZS5pbml0UGFyYW1zLm1vbGVjdWxlSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgX2kgPSAwLCBzdHJ1Y3R1cmVzXzEgPSBzdHJ1Y3R1cmVzO1xuICAgICAgICAgICAgICAgICAgICBfby5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IHN0cnVjdHVyZXNfMS5sZW5ndGgpKSByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgbW9sSWQgPSBzdHJ1Y3R1cmVzXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICBtb2RlbFJlZiA9IHN1cGVycG9zaXRpb25TdGF0ZS5tb2RlbHNbbW9sSWRdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZGVsUmVmKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGlzU3RySGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF9zID0gcGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudC5yZWZzLmdldChtb2RlbFJlZik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfcy5jZWxsLnN0YXRlLmlzSGlkZGVuKVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNTdHJIaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKF9hID0gMCwgX2IgPSBfcy5jb21wb25lbnRzOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyQ29tcCA9IF9iW19hXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJDb21wLmNlbGwuc3RhdGUuaXNIaWRkZW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdHJIaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1N0ckhpZGRlbilcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBzID0gKF9oID0gKF9nID0gKF9mID0gX3MudHJhbnNmb3JtKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2YuY2VsbC5vYmopID09PSBudWxsIHx8IF9nID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZy5kYXRhKSAhPT0gbnVsbCAmJiBfaCAhPT0gdm9pZCAwID8gX2ggOiAoX2ogPSBfcy5jZWxsLm9iaikgPT09IG51bGwgfHwgX2ogPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9qLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocy5tb2RlbHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmxvZy53YXJuKFwiW0V4cG9ydF0gU2tpcHBpbmcgXCIuY29uY2F0KChfayA9IF9zLmNlbGwub2JqKSA9PT0gbnVsbCB8fCBfayA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2subGFiZWwsIFwiOiBNdWx0aW1vZGVsIGV4cG9ydHMgbm90IHN1cHBvcnRlZC5cIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHMudW5pdHMuc29tZShmdW5jdGlvbiAodSkgeyByZXR1cm4gIXN0cnVjdHVyZV8xLlVuaXQuaXNBdG9taWModSk7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4ubG9nLndhcm4oXCJbRXhwb3J0XSBTa2lwcGluZyBcIi5jb25jYXQoKF9sID0gX3MuY2VsbC5vYmopID09PSBudWxsIHx8IF9sID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbC5sYWJlbCwgXCI6IE5vbi1hdG9taWMgbW9kZWwgZXhwb3J0cyBub3Qgc3VwcG9ydGVkLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuYW1lXzEgPSBlbnRyeU1hcC5oYXMocy5tb2RlbC5lbnRyeUlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBcIlwiLmNvbmNhdChzLm1vZGVsLmVudHJ5SWQsIFwiX1wiKS5jb25jYXQoZW50cnlNYXAuZ2V0KHMubW9kZWwuZW50cnlJZCkgKyAxLCBcIi5cIikuY29uY2F0KGZvcm1hdClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogXCJcIi5jb25jYXQocy5tb2RlbC5lbnRyeUlkLCBcIi5cIikuY29uY2F0KGZvcm1hdCk7XG4gICAgICAgICAgICAgICAgICAgIGVudHJ5TWFwLnNldChzLm1vZGVsLmVudHJ5SWQsICgoX20gPSBlbnRyeU1hcC5nZXQocy5tb2RlbC5lbnRyeUlkKSkgIT09IG51bGwgJiYgX20gIT09IHZvaWQgMCA/IF9tIDogMCkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY3R4LnVwZGF0ZSh7IG1lc3NhZ2U6IFwiRXhwb3J0aW5nIFwiLmNvbmNhdChzLm1vZGVsLmVudHJ5SWQsIFwiLi4uXCIpLCBpc0luZGV0ZXJtaW5hdGU6IHRydWUsIGNhbkFib3J0OiBmYWxzZSB9KV07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBfby5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHMuZWxlbWVudENvdW50ID4gMTAwMDAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIC8vIEdpdmUgVUkgY2hhbmNlIHRvIHVwZGF0ZSwgb25seSBuZWVkZWQgZm9yIGxhcmdlciBzdHJ1Y3R1cmVzLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzKSB7IHJldHVybiBzZXRUaW1lb3V0KHJlcywgNTApOyB9KV07XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAvLyBHaXZlIFVJIGNoYW5jZSB0byB1cGRhdGUsIG9ubHkgbmVlZGVkIGZvciBsYXJnZXIgc3RydWN0dXJlcy5cbiAgICAgICAgICAgICAgICAgICAgX28uc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBfby5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXMucHVzaChbbmFtZV8xLCAoMCwgc3RydWN0dXJlXzEudG9fbW1DSUYpKHMubW9kZWwuZW50cnlJZCwgcywgZm9ybWF0ID09PSAnYmNpZicsIHsgY29weUFsbENhdGVnb3JpZXM6IHRydWUgfSldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2NpZicgJiYgcy5lbGVtZW50Q291bnQgPiAyMDAwMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmxvZy53YXJuKFwiW0V4cG9ydF0gVGhlIHN0cnVjdHVyZSBtaWdodCBiZSB0b28gYmlnIHRvIGJlIGV4cG9ydGVkIGFzIFRleHQgQ0lGLCBjb25zaWRlciB1c2luZyB0aGUgQmluYXJ5Q0lGIGZvcm1hdCBpbnN0ZWFkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX28ubGFiZWwgPSA2O1xuICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgX2krKztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlRvYXN0LlNob3cocGx1Z2luLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdFeHBvcnQgTW9kZWxzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnTm8gdmlzaWJsZSBzdHJ1Y3R1cmUgaW4gdGhlIDNEIHZpZXcgdG8gZXhwb3J0IScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiAnc3VwZXJwb3NpdGlvbi10b2FzdC0xJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0TXM6IDcwMDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGZpbGVzLmxlbmd0aCA9PT0gMSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAoMCwgZG93bmxvYWRfMS5kb3dubG9hZCkobmV3IEJsb2IoW2ZpbGVzWzBdWzFdXSksIGZpbGVzWzBdWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTFdO1xuICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZmlsZXMubGVuZ3RoID4gMSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDExXTtcbiAgICAgICAgICAgICAgICAgICAgemlwRGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBmb3IgKF9jID0gMCwgZmlsZXNfMSA9IGZpbGVzOyBfYyA8IGZpbGVzXzEubGVuZ3RoOyBfYysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZCA9IGZpbGVzXzFbX2NdLCBmbiA9IF9kWzBdLCBkYXRhID0gX2RbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6aXBEYXRhW2ZuXSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlcyA9IG5ldyBVaW50OEFycmF5KCgwLCB1dGY4XzEudXRmOEJ5dGVDb3VudCkoZGF0YSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICgwLCB1dGY4XzEudXRmOFdyaXRlKShieXRlcywgMCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgemlwRGF0YVtmbl0gPSBieXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjdHgudXBkYXRlKHsgbWVzc2FnZTogXCJDb21wcmVzc2luZyBEYXRhLi4uXCIsIGlzSW5kZXRlcm1pbmF0ZTogdHJ1ZSwgY2FuQWJvcnQ6IGZhbHNlIH0pXTtcbiAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgIF9vLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIHppcF8xLnppcCkoY3R4LCB6aXBEYXRhKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyID0gX28uc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAoMCwgZG93bmxvYWRfMS5kb3dubG9hZCkobmV3IEJsb2IoW25ldyBVaW50OEFycmF5KGJ1ZmZlciwgMCwgYnVmZmVyLmJ5dGVMZW5ndGgpXSksIFwic3RydWN0dXJlc19cIi5jb25jYXQoKDAsIGRhdGVfMS5nZXRGb3JtYXR0ZWRUaW1lKSgpLCBcIi56aXBcIikpO1xuICAgICAgICAgICAgICAgICAgICBfby5sYWJlbCA9IDExO1xuICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5sb2cuaW5mbyhcIltFeHBvcnRdIERvbmUuXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pOyB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN1cGVycG9zaXRpb24tZXhwb3J0LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/superposition-export.js\n");
  
  /***/ }),
  
  /***/ "./lib/superposition-focus-representation.js":
  /*!***************************************************!*\
    !*** ./lib/superposition-focus-representation.js ***!
    \***************************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.SuperpositionFocusRepresentation = exports.SuperpositionFocusRepresentationTags = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nvar structure_representation_params_1 = __webpack_require__(/*! Molstar/mol-plugin-state/helpers/structure-representation-params */ \"./node_modules/molstar/lib/mol-plugin-state/helpers/structure-representation-params.js\");\nvar transforms_1 = __webpack_require__(/*! Molstar/mol-plugin-state/transforms */ \"./node_modules/molstar/lib/mol-plugin-state/transforms.js\");\nvar behavior_1 = __webpack_require__(/*! Molstar/mol-plugin/behavior */ \"./node_modules/molstar/lib/mol-plugin/behavior.js\");\nvar builder_1 = __webpack_require__(/*! Molstar/mol-script/language/builder */ \"./node_modules/molstar/lib/mol-script/language/builder.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar loci_details_1 = __webpack_require__(/*! ./loci-details */ \"./lib/loci-details.js\");\nvar SuperpositionFocusRepresentationParams = function (plugin) {\n    var reprParams = transforms_1.StateTransforms.Representation.StructureRepresentation3D.definition.params(void 0, plugin);\n    return {\n        expandRadius: param_definition_1.ParamDefinition.Numeric(5, { min: 1, max: 10, step: 1 }),\n        surroundingsParams: param_definition_1.ParamDefinition.Group(reprParams, {\n            label: 'Surroundings',\n            customDefault: (0, structure_representation_params_1.createStructureRepresentationParams)(plugin, void 0, { type: 'ball-and-stick', size: 'physical', typeParams: { sizeFactor: 0.16 }, sizeParams: { scale: 0.3 } })\n        })\n    };\n};\nvar SuperpositionFocusRepresentationTags;\n(function (SuperpositionFocusRepresentationTags) {\n    SuperpositionFocusRepresentationTags[\"SurrSel\"] = \"superposition-focus-surr-sel\";\n    SuperpositionFocusRepresentationTags[\"SurrRepr\"] = \"superposition-focus-surr-repr\";\n})(SuperpositionFocusRepresentationTags = exports.SuperpositionFocusRepresentationTags || (exports.SuperpositionFocusRepresentationTags = {}));\nvar TagSet = new Set([SuperpositionFocusRepresentationTags.SurrSel, SuperpositionFocusRepresentationTags.SurrRepr]);\nvar SuperpositionFocusRepresentationBehavior = /** @class */ (function (_super) {\n    tslib_1.__extends(SuperpositionFocusRepresentationBehavior, _super);\n    function SuperpositionFocusRepresentationBehavior() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SuperpositionFocusRepresentationBehavior.prototype, \"surrLabel\", {\n        get: function () { return \"[Focus] Surroundings (\".concat(this.params.expandRadius, \" \\u00C5)\"); },\n        enumerable: false,\n        configurable: true\n    });\n    SuperpositionFocusRepresentationBehavior.prototype.ensureShape = function (cell) {\n        var state = this.plugin.state.data, tree = state.tree;\n        var builder = state.build();\n        var refs = mol_state_1.StateSelection.findUniqueTagsInSubtree(tree, cell.transform.ref, TagSet);\n        // Selections\n        if (!refs[SuperpositionFocusRepresentationTags.SurrSel]) {\n            refs[SuperpositionFocusRepresentationTags.SurrSel] = builder\n                .to(cell)\n                .apply(transforms_1.StateTransforms.Model.StructureSelectionFromExpression, { expression: builder_1.MolScriptBuilder.struct.generator.empty(), label: this.surrLabel }, { tags: SuperpositionFocusRepresentationTags.SurrSel }).ref;\n        }\n        // Representations\n        if (!refs[SuperpositionFocusRepresentationTags.SurrRepr]) {\n            refs[SuperpositionFocusRepresentationTags.SurrRepr] = builder\n                .to(refs[SuperpositionFocusRepresentationTags.SurrSel])\n                .apply(transforms_1.StateTransforms.Representation.StructureRepresentation3D, this.params.surroundingsParams, { tags: SuperpositionFocusRepresentationTags.SurrRepr }).ref;\n        }\n        return { state: state, builder: builder, refs: refs };\n    };\n    SuperpositionFocusRepresentationBehavior.prototype.clear = function (root) {\n        var state = this.plugin.state.data;\n        var surrs = state.select(mol_state_1.StateSelection.Generators.byRef(root).subtree().withTag(SuperpositionFocusRepresentationTags.SurrSel));\n        if (surrs.length === 0)\n            return;\n        var update = state.build();\n        var expression = builder_1.MolScriptBuilder.struct.generator.empty();\n        for (var _i = 0, surrs_1 = surrs; _i < surrs_1.length; _i++) {\n            var s = surrs_1[_i];\n            update.to(s).update(transforms_1.StateTransforms.Model.StructureSelectionFromExpression, function (old) { return (tslib_1.__assign(tslib_1.__assign({}, old), { expression: expression })); });\n        }\n        return commands_1.PluginCommands.State.Update(this.plugin, { state: state, tree: update, options: { doNotLogTiming: true, doNotUpdateCurrent: true } });\n    };\n    SuperpositionFocusRepresentationBehavior.prototype.focus = function (sourceLoci) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var parent, loci, residueLoci, residueBundle, target, surroundings, lociDeatils, _a, state, builder, refs;\n            var _this = this;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        parent = this.plugin.helpers.substructureParent.get(sourceLoci.structure);\n                        if (!parent || !parent.obj)\n                            return [2 /*return*/];\n                        loci = structure_1.StructureElement.Loci.remap(sourceLoci, parent.obj.data);\n                        residueLoci = structure_1.StructureElement.Loci.extendToWholeResidues(loci);\n                        residueBundle = structure_1.StructureElement.Bundle.fromLoci(residueLoci);\n                        target = structure_1.StructureElement.Bundle.toExpression(residueBundle);\n                        surroundings = builder_1.MolScriptBuilder.struct.modifier.includeSurroundings({\n                            0: target,\n                            radius: this.params.expandRadius,\n                            'as-whole-residues': true\n                        });\n                        lociDeatils = (0, loci_details_1.lociDetails)(sourceLoci);\n                        if (!lociDeatils) {\n                            surroundings = builder_1.MolScriptBuilder.struct.modifier.exceptBy({\n                                0: surroundings,\n                                by: target\n                            });\n                        }\n                        _a = this.ensureShape(parent), state = _a.state, builder = _a.builder, refs = _a.refs;\n                        builder.to(refs[SuperpositionFocusRepresentationTags.SurrSel]).update(transforms_1.StateTransforms.Model.StructureSelectionFromExpression, function (old) { return (tslib_1.__assign(tslib_1.__assign({}, old), { expression: surroundings, label: _this.surrLabel })); });\n                        return [4 /*yield*/, commands_1.PluginCommands.State.Update(this.plugin, { state: state, tree: builder, options: { doNotLogTiming: true, doNotUpdateCurrent: true } })];\n                    case 1:\n                        _b.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SuperpositionFocusRepresentationBehavior.prototype.register = function (ref) {\n        var _this = this;\n        this.subscribeObservable(this.plugin.managers.structure.focus.behaviors.current, function (entry) {\n            // if (entry) this.focus(entry.loci);\n            // else this.clear(StateTransform.RootRef);\n            _this.clear(mol_state_1.StateTransform.RootRef);\n            if (entry)\n                _this.focus(entry.loci);\n        });\n    };\n    SuperpositionFocusRepresentationBehavior.prototype.update = function (params) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var old, state, builder, all, _i, _a, repr;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        old = this.params;\n                        this.params = params;\n                        state = this.plugin.state.data;\n                        builder = state.build();\n                        all = mol_state_1.StateSelection.Generators.root.subtree();\n                        for (_i = 0, _a = state.select(all.withTag(SuperpositionFocusRepresentationTags.SurrRepr)); _i < _a.length; _i++) {\n                            repr = _a[_i];\n                            builder.to(repr).update(this.params.surroundingsParams);\n                        }\n                        return [4 /*yield*/, commands_1.PluginCommands.State.Update(this.plugin, { state: state, tree: builder, options: { doNotLogTiming: true, doNotUpdateCurrent: true } })];\n                    case 1:\n                        _b.sent();\n                        if (!(params.expandRadius !== old.expandRadius)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.clear(mol_state_1.StateTransform.RootRef)];\n                    case 2:\n                        _b.sent();\n                        _b.label = 3;\n                    case 3: return [2 /*return*/, true];\n                }\n            });\n        });\n    };\n    return SuperpositionFocusRepresentationBehavior;\n}(behavior_1.PluginBehavior.WithSubscribers));\nexports.SuperpositionFocusRepresentation = behavior_1.PluginBehavior.create({\n    name: 'create-superposition-focus-representation',\n    display: { name: 'Superposition Focus Representation' },\n    category: 'interaction',\n    ctor: SuperpositionFocusRepresentationBehavior,\n    params: function (_, plugin) { return SuperpositionFocusRepresentationParams(plugin); }\n});\n//# sourceMappingURL=superposition-focus-representation.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvc3VwZXJwb3NpdGlvbi1mb2N1cy1yZXByZXNlbnRhdGlvbi5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCx3Q0FBd0MsR0FBRyw0Q0FBNEM7QUFDdkYsY0FBYyxtQkFBTyxDQUFDLGdEQUFPO0FBQzdCLGtCQUFrQixtQkFBTyxDQUFDLHNGQUE2QjtBQUN2RCx3Q0FBd0MsbUJBQU8sQ0FBQyxnS0FBa0U7QUFDbEgsbUJBQW1CLG1CQUFPLENBQUMsc0dBQXFDO0FBQ2hFLGlCQUFpQixtQkFBTyxDQUFDLHNGQUE2QjtBQUN0RCxnQkFBZ0IsbUJBQU8sQ0FBQyxzR0FBcUM7QUFDN0Qsa0JBQWtCLG1CQUFPLENBQUMsd0VBQW1CO0FBQzdDLHlCQUF5QixtQkFBTyxDQUFDLGtHQUFtQztBQUNwRSxpQkFBaUIsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDdEQscUJBQXFCLG1CQUFPLENBQUMsNkNBQWdCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSwwQkFBMEI7QUFDaEc7QUFDQTtBQUNBLHdIQUF3SCx3REFBd0Qsa0JBQWtCLGdCQUFnQixjQUFjO0FBQ2hPLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDBGQUEwRiw0Q0FBNEMsS0FBSztBQUM1STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwrRUFBK0U7QUFDMUc7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEZBQThGLHdGQUF3RixJQUFJLG9EQUFvRDtBQUM5TztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0lBQWdJLHFEQUFxRDtBQUNyTDtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHFCQUFxQjtBQUMvRDtBQUNBLHNIQUFzSCw0Q0FBNEMsVUFBVSx3QkFBd0IsS0FBSztBQUN6TTtBQUNBLHFFQUFxRSx1Q0FBdUMsa0RBQWtEO0FBQzlKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBLG9MQUFvTCw0Q0FBNEMsVUFBVSxrREFBa0QsS0FBSztBQUNqUyxtR0FBbUcsd0NBQXdDLGtEQUFrRDtBQUM3TDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9IQUFvSCxnQkFBZ0I7QUFDcEk7QUFDQTtBQUNBO0FBQ0EsbUdBQW1HLHdDQUF3QyxrREFBa0Q7QUFDN0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNELHdDQUF3QztBQUN4QztBQUNBLGVBQWUsNENBQTRDO0FBQzNEO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkMsQ0FBQztBQUNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3N1cGVycG9zaXRpb24tZm9jdXMtcmVwcmVzZW50YXRpb24uanM/YjAwMCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb24gPSBleHBvcnRzLlN1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uVGFncyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIHN0cnVjdHVyZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1vZGVsL3N0cnVjdHVyZVwiKTtcbnZhciBzdHJ1Y3R1cmVfcmVwcmVzZW50YXRpb25fcGFyYW1zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL2hlbHBlcnMvc3RydWN0dXJlLXJlcHJlc2VudGF0aW9uLXBhcmFtc1wiKTtcbnZhciB0cmFuc2Zvcm1zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL3RyYW5zZm9ybXNcIik7XG52YXIgYmVoYXZpb3JfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4vYmVoYXZpb3JcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXNjcmlwdC9sYW5ndWFnZS9idWlsZGVyXCIpO1xudmFyIG1vbF9zdGF0ZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXN0YXRlXCIpO1xudmFyIHBhcmFtX2RlZmluaXRpb25fMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC11dGlsL3BhcmFtLWRlZmluaXRpb25cIik7XG52YXIgY29tbWFuZHNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4vY29tbWFuZHNcIik7XG52YXIgbG9jaV9kZXRhaWxzXzEgPSByZXF1aXJlKFwiLi9sb2NpLWRldGFpbHNcIik7XG52YXIgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25QYXJhbXMgPSBmdW5jdGlvbiAocGx1Z2luKSB7XG4gICAgdmFyIHJlcHJQYXJhbXMgPSB0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLlJlcHJlc2VudGF0aW9uLlN0cnVjdHVyZVJlcHJlc2VudGF0aW9uM0QuZGVmaW5pdGlvbi5wYXJhbXModm9pZCAwLCBwbHVnaW4pO1xuICAgIHJldHVybiB7XG4gICAgICAgIGV4cGFuZFJhZGl1czogcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5OdW1lcmljKDUsIHsgbWluOiAxLCBtYXg6IDEwLCBzdGVwOiAxIH0pLFxuICAgICAgICBzdXJyb3VuZGluZ3NQYXJhbXM6IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uR3JvdXAocmVwclBhcmFtcywge1xuICAgICAgICAgICAgbGFiZWw6ICdTdXJyb3VuZGluZ3MnLFxuICAgICAgICAgICAgY3VzdG9tRGVmYXVsdDogKDAsIHN0cnVjdHVyZV9yZXByZXNlbnRhdGlvbl9wYXJhbXNfMS5jcmVhdGVTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvblBhcmFtcykocGx1Z2luLCB2b2lkIDAsIHsgdHlwZTogJ2JhbGwtYW5kLXN0aWNrJywgc2l6ZTogJ3BoeXNpY2FsJywgdHlwZVBhcmFtczogeyBzaXplRmFjdG9yOiAwLjE2IH0sIHNpemVQYXJhbXM6IHsgc2NhbGU6IDAuMyB9IH0pXG4gICAgICAgIH0pXG4gICAgfTtcbn07XG52YXIgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25UYWdzO1xuKGZ1bmN0aW9uIChTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MpIHtcbiAgICBTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3NbXCJTdXJyU2VsXCJdID0gXCJzdXBlcnBvc2l0aW9uLWZvY3VzLXN1cnItc2VsXCI7XG4gICAgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25UYWdzW1wiU3VyclJlcHJcIl0gPSBcInN1cGVycG9zaXRpb24tZm9jdXMtc3Vyci1yZXByXCI7XG59KShTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MgPSBleHBvcnRzLlN1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uVGFncyB8fCAoZXhwb3J0cy5TdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MgPSB7fSkpO1xudmFyIFRhZ1NldCA9IG5ldyBTZXQoW1N1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uVGFncy5TdXJyU2VsLCBTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclJlcHJdKTtcbnZhciBTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvbkJlaGF2aW9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uQmVoYXZpb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25CZWhhdmlvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25CZWhhdmlvci5wcm90b3R5cGUsIFwic3VyckxhYmVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBcIltGb2N1c10gU3Vycm91bmRpbmdzIChcIi5jb25jYXQodGhpcy5wYXJhbXMuZXhwYW5kUmFkaXVzLCBcIiBcXHUwMEM1KVwiKTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uQmVoYXZpb3IucHJvdG90eXBlLmVuc3VyZVNoYXBlID0gZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgdmFyIHN0YXRlID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YSwgdHJlZSA9IHN0YXRlLnRyZWU7XG4gICAgICAgIHZhciBidWlsZGVyID0gc3RhdGUuYnVpbGQoKTtcbiAgICAgICAgdmFyIHJlZnMgPSBtb2xfc3RhdGVfMS5TdGF0ZVNlbGVjdGlvbi5maW5kVW5pcXVlVGFnc0luU3VidHJlZSh0cmVlLCBjZWxsLnRyYW5zZm9ybS5yZWYsIFRhZ1NldCk7XG4gICAgICAgIC8vIFNlbGVjdGlvbnNcbiAgICAgICAgaWYgKCFyZWZzW1N1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uVGFncy5TdXJyU2VsXSkge1xuICAgICAgICAgICAgcmVmc1tTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclNlbF0gPSBidWlsZGVyXG4gICAgICAgICAgICAgICAgLnRvKGNlbGwpXG4gICAgICAgICAgICAgICAgLmFwcGx5KHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuTW9kZWwuU3RydWN0dXJlU2VsZWN0aW9uRnJvbUV4cHJlc3Npb24sIHsgZXhwcmVzc2lvbjogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmdlbmVyYXRvci5lbXB0eSgpLCBsYWJlbDogdGhpcy5zdXJyTGFiZWwgfSwgeyB0YWdzOiBTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclNlbCB9KS5yZWY7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVwcmVzZW50YXRpb25zXG4gICAgICAgIGlmICghcmVmc1tTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclJlcHJdKSB7XG4gICAgICAgICAgICByZWZzW1N1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uVGFncy5TdXJyUmVwcl0gPSBidWlsZGVyXG4gICAgICAgICAgICAgICAgLnRvKHJlZnNbU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25UYWdzLlN1cnJTZWxdKVxuICAgICAgICAgICAgICAgIC5hcHBseSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLlJlcHJlc2VudGF0aW9uLlN0cnVjdHVyZVJlcHJlc2VudGF0aW9uM0QsIHRoaXMucGFyYW1zLnN1cnJvdW5kaW5nc1BhcmFtcywgeyB0YWdzOiBTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclJlcHIgfSkucmVmO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHN0YXRlOiBzdGF0ZSwgYnVpbGRlcjogYnVpbGRlciwgcmVmczogcmVmcyB9O1xuICAgIH07XG4gICAgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25CZWhhdmlvci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAocm9vdCkge1xuICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnBsdWdpbi5zdGF0ZS5kYXRhO1xuICAgICAgICB2YXIgc3VycnMgPSBzdGF0ZS5zZWxlY3QobW9sX3N0YXRlXzEuU3RhdGVTZWxlY3Rpb24uR2VuZXJhdG9ycy5ieVJlZihyb290KS5zdWJ0cmVlKCkud2l0aFRhZyhTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclNlbCkpO1xuICAgICAgICBpZiAoc3VycnMubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdXBkYXRlID0gc3RhdGUuYnVpbGQoKTtcbiAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZ2VuZXJhdG9yLmVtcHR5KCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgc3VycnNfMSA9IHN1cnJzOyBfaSA8IHN1cnJzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgcyA9IHN1cnJzXzFbX2ldO1xuICAgICAgICAgICAgdXBkYXRlLnRvKHMpLnVwZGF0ZSh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLk1vZGVsLlN0cnVjdHVyZVNlbGVjdGlvbkZyb21FeHByZXNzaW9uLCBmdW5jdGlvbiAob2xkKSB7IHJldHVybiAodHNsaWJfMS5fX2Fzc2lnbih0c2xpYl8xLl9fYXNzaWduKHt9LCBvbGQpLCB7IGV4cHJlc3Npb246IGV4cHJlc3Npb24gfSkpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5TdGF0ZS5VcGRhdGUodGhpcy5wbHVnaW4sIHsgc3RhdGU6IHN0YXRlLCB0cmVlOiB1cGRhdGUsIG9wdGlvbnM6IHsgZG9Ob3RMb2dUaW1pbmc6IHRydWUsIGRvTm90VXBkYXRlQ3VycmVudDogdHJ1ZSB9IH0pO1xuICAgIH07XG4gICAgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25CZWhhdmlvci5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbiAoc291cmNlTG9jaSkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnQsIGxvY2ksIHJlc2lkdWVMb2NpLCByZXNpZHVlQnVuZGxlLCB0YXJnZXQsIHN1cnJvdW5kaW5ncywgbG9jaURlYXRpbHMsIF9hLCBzdGF0ZSwgYnVpbGRlciwgcmVmcztcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHRoaXMucGx1Z2luLmhlbHBlcnMuc3Vic3RydWN0dXJlUGFyZW50LmdldChzb3VyY2VMb2NpLnN0cnVjdHVyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudCB8fCAhcGFyZW50Lm9iailcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NpID0gc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5Mb2NpLnJlbWFwKHNvdXJjZUxvY2ksIHBhcmVudC5vYmouZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNpZHVlTG9jaSA9IHN0cnVjdHVyZV8xLlN0cnVjdHVyZUVsZW1lbnQuTG9jaS5leHRlbmRUb1dob2xlUmVzaWR1ZXMobG9jaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNpZHVlQnVuZGxlID0gc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5CdW5kbGUuZnJvbUxvY2kocmVzaWR1ZUxvY2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gc3RydWN0dXJlXzEuU3RydWN0dXJlRWxlbWVudC5CdW5kbGUudG9FeHByZXNzaW9uKHJlc2lkdWVCdW5kbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vycm91bmRpbmdzID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0Lm1vZGlmaWVyLmluY2x1ZGVTdXJyb3VuZGluZ3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDA6IHRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6IHRoaXMucGFyYW1zLmV4cGFuZFJhZGl1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXMtd2hvbGUtcmVzaWR1ZXMnOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2lEZWF0aWxzID0gKDAsIGxvY2lfZGV0YWlsc18xLmxvY2lEZXRhaWxzKShzb3VyY2VMb2NpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9jaURlYXRpbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXJyb3VuZGluZ3MgPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QubW9kaWZpZXIuZXhjZXB0Qnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwOiBzdXJyb3VuZGluZ3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5OiB0YXJnZXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy5lbnN1cmVTaGFwZShwYXJlbnQpLCBzdGF0ZSA9IF9hLnN0YXRlLCBidWlsZGVyID0gX2EuYnVpbGRlciwgcmVmcyA9IF9hLnJlZnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLnRvKHJlZnNbU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25UYWdzLlN1cnJTZWxdKS51cGRhdGUodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5Nb2RlbC5TdHJ1Y3R1cmVTZWxlY3Rpb25Gcm9tRXhwcmVzc2lvbiwgZnVuY3Rpb24gKG9sZCkgeyByZXR1cm4gKHRzbGliXzEuX19hc3NpZ24odHNsaWJfMS5fX2Fzc2lnbih7fSwgb2xkKSwgeyBleHByZXNzaW9uOiBzdXJyb3VuZGluZ3MsIGxhYmVsOiBfdGhpcy5zdXJyTGFiZWwgfSkpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuVXBkYXRlKHRoaXMucGx1Z2luLCB7IHN0YXRlOiBzdGF0ZSwgdHJlZTogYnVpbGRlciwgb3B0aW9uczogeyBkb05vdExvZ1RpbWluZzogdHJ1ZSwgZG9Ob3RVcGRhdGVDdXJyZW50OiB0cnVlIH0gfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25CZWhhdmlvci5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlT2JzZXJ2YWJsZSh0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuZm9jdXMuYmVoYXZpb3JzLmN1cnJlbnQsIGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICAgICAgLy8gaWYgKGVudHJ5KSB0aGlzLmZvY3VzKGVudHJ5LmxvY2kpO1xuICAgICAgICAgICAgLy8gZWxzZSB0aGlzLmNsZWFyKFN0YXRlVHJhbnNmb3JtLlJvb3RSZWYpO1xuICAgICAgICAgICAgX3RoaXMuY2xlYXIobW9sX3N0YXRlXzEuU3RhdGVUcmFuc2Zvcm0uUm9vdFJlZik7XG4gICAgICAgICAgICBpZiAoZW50cnkpXG4gICAgICAgICAgICAgICAgX3RoaXMuZm9jdXMoZW50cnkubG9jaSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25CZWhhdmlvci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvbGQsIHN0YXRlLCBidWlsZGVyLCBhbGwsIF9pLCBfYSwgcmVwcjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkID0gdGhpcy5wYXJhbXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIgPSBzdGF0ZS5idWlsZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxsID0gbW9sX3N0YXRlXzEuU3RhdGVTZWxlY3Rpb24uR2VuZXJhdG9ycy5yb290LnN1YnRyZWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBfYSA9IHN0YXRlLnNlbGVjdChhbGwud2l0aFRhZyhTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvblRhZ3MuU3VyclJlcHIpKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXByID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIudG8ocmVwcikudXBkYXRlKHRoaXMucGFyYW1zLnN1cnJvdW5kaW5nc1BhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlVwZGF0ZSh0aGlzLnBsdWdpbiwgeyBzdGF0ZTogc3RhdGUsIHRyZWU6IGJ1aWxkZXIsIG9wdGlvbnM6IHsgZG9Ob3RMb2dUaW1pbmc6IHRydWUsIGRvTm90VXBkYXRlQ3VycmVudDogdHJ1ZSB9IH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocGFyYW1zLmV4cGFuZFJhZGl1cyAhPT0gb2xkLmV4cGFuZFJhZGl1cykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGVhcihtb2xfc3RhdGVfMS5TdGF0ZVRyYW5zZm9ybS5Sb290UmVmKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qLywgdHJ1ZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uQmVoYXZpb3I7XG59KGJlaGF2aW9yXzEuUGx1Z2luQmVoYXZpb3IuV2l0aFN1YnNjcmliZXJzKSk7XG5leHBvcnRzLlN1cGVycG9zaXRpb25Gb2N1c1JlcHJlc2VudGF0aW9uID0gYmVoYXZpb3JfMS5QbHVnaW5CZWhhdmlvci5jcmVhdGUoe1xuICAgIG5hbWU6ICdjcmVhdGUtc3VwZXJwb3NpdGlvbi1mb2N1cy1yZXByZXNlbnRhdGlvbicsXG4gICAgZGlzcGxheTogeyBuYW1lOiAnU3VwZXJwb3NpdGlvbiBGb2N1cyBSZXByZXNlbnRhdGlvbicgfSxcbiAgICBjYXRlZ29yeTogJ2ludGVyYWN0aW9uJyxcbiAgICBjdG9yOiBTdXBlcnBvc2l0aW9uRm9jdXNSZXByZXNlbnRhdGlvbkJlaGF2aW9yLFxuICAgIHBhcmFtczogZnVuY3Rpb24gKF8sIHBsdWdpbikgeyByZXR1cm4gU3VwZXJwb3NpdGlvbkZvY3VzUmVwcmVzZW50YXRpb25QYXJhbXMocGx1Z2luKTsgfVxufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdXBlcnBvc2l0aW9uLWZvY3VzLXJlcHJlc2VudGF0aW9uLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/superposition-focus-representation.js\n");
  
  /***/ }),
  
  /***/ "./lib/superposition-sifts-mapping.js":
  /*!********************************************!*\
    !*** ./lib/superposition-sifts-mapping.js ***!
    \********************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.alignAndSuperposeWithSIFTSMapping = void 0;\nvar int_1 = __webpack_require__(/*! Molstar/mol-data/int */ \"./node_modules/molstar/lib/mol-data/int.js\");\nvar minimize_rmsd_1 = __webpack_require__(/*! Molstar/mol-math/linear-algebra/3d/minimize-rmsd */ \"./node_modules/molstar/lib/mol-math/linear-algebra/3d/minimize-rmsd.js\");\nvar sifts_mapping_1 = __webpack_require__(/*! Molstar/mol-model-props/sequence/sifts-mapping */ \"./node_modules/molstar/lib/mol-model-props/sequence/sifts-mapping.js\");\nvar element_1 = __webpack_require__(/*! Molstar/mol-model/structure/structure/element */ \"./node_modules/molstar/lib/mol-model/structure/structure/element.js\");\nfunction alignAndSuperposeWithSIFTSMapping(structures, options) {\n    var _a, _b;\n    var indexMap = new Map();\n    for (var i = 0; i < structures.length; i++) {\n        var includeResidueTest = (_a = options === null || options === void 0 ? void 0 : options.includeResidueTest) !== null && _a !== void 0 ? _a : _includeAllResidues;\n        if ((options === null || options === void 0 ? void 0 : options.applyTestIndex) && !options.applyTestIndex.includes(i))\n            includeResidueTest = _includeAllResidues;\n        buildIndex(structures[i], indexMap, i, (_b = options === null || options === void 0 ? void 0 : options.traceOnly) !== null && _b !== void 0 ? _b : true, includeResidueTest);\n    }\n    var index = Array.from(indexMap.values());\n    // TODO: support non-first structure pivots\n    var pairs = findPairs(structures.length, index);\n    var zeroOverlapPairs = [];\n    var failedPairs = [];\n    var entries = [];\n    for (var _i = 0, pairs_1 = pairs; _i < pairs_1.length; _i++) {\n        var p = pairs_1[_i];\n        if (p.count === 0) {\n            zeroOverlapPairs.push([p.i, p.j]);\n        }\n        else {\n            var _c = getPositionTables(index, p.i, p.j, p.count), a = _c[0], b = _c[1];\n            var transform = minimize_rmsd_1.MinimizeRmsd.compute({ a: a, b: b });\n            if (Number.isNaN(transform.rmsd)) {\n                failedPairs.push([p.i, p.j]);\n            }\n            else {\n                entries.push({ transform: transform, pivot: p.i, other: p.j });\n            }\n        }\n    }\n    return { entries: entries, zeroOverlapPairs: zeroOverlapPairs, failedPairs: failedPairs };\n}\nexports.alignAndSuperposeWithSIFTSMapping = alignAndSuperposeWithSIFTSMapping;\nfunction getPositionTables(index, pivot, other, N) {\n    var xs = minimize_rmsd_1.MinimizeRmsd.Positions.empty(N);\n    var ys = minimize_rmsd_1.MinimizeRmsd.Positions.empty(N);\n    var o = 0;\n    for (var _i = 0, index_1 = index; _i < index_1.length; _i++) {\n        var pivots = index_1[_i].pivots;\n        var a = pivots[pivot];\n        var b = pivots[other];\n        if (!a || !b)\n            continue;\n        var l = Math.min(a[2] - a[1], b[2] - b[1]);\n        // TODO: check if residue types match?\n        for (var i = 0; i < l; i++) {\n            var eI = (a[1] + i);\n            xs.x[o] = a[0].conformation.x(eI);\n            xs.y[o] = a[0].conformation.y(eI);\n            xs.z[o] = a[0].conformation.z(eI);\n            eI = (b[1] + i);\n            ys.x[o] = b[0].conformation.x(eI);\n            ys.y[o] = b[0].conformation.y(eI);\n            ys.z[o] = b[0].conformation.z(eI);\n            o++;\n        }\n    }\n    return [xs, ys];\n}\nfunction findPairs(N, index) {\n    var pairwiseCounts = [];\n    for (var i = 0; i < N; i++) {\n        pairwiseCounts[i] = [];\n        for (var j = 0; j < N; j++)\n            pairwiseCounts[i][j] = 0;\n    }\n    for (var _i = 0, index_2 = index; _i < index_2.length; _i++) {\n        var pivots = index_2[_i].pivots;\n        for (var i = 0; i < N; i++) {\n            if (!pivots[i])\n                continue;\n            var lI = pivots[i][2] - pivots[i][1];\n            for (var j = i + 1; j < N; j++) {\n                if (!pivots[j])\n                    continue;\n                var lJ = pivots[j][2] - pivots[j][1];\n                pairwiseCounts[i][j] = pairwiseCounts[i][j] + Math.min(lI, lJ);\n            }\n        }\n    }\n    var ret = [];\n    for (var j = 1; j < N; j++) {\n        ret[j - 1] = { i: 0, j: j, count: pairwiseCounts[0][j] };\n    }\n    // TODO: support non-first structure pivots\n    // for (let i = 0; i < N - 1; i++) {\n    //     let max = 0, maxJ = i;\n    //     for (let j = i + 1; j < N; j++) {\n    //         if (pairwiseCounts[i][j] > max) {\n    //             maxJ = j;\n    //             max = pairwiseCounts[i][j];\n    //         }\n    //     }\n    //     ret[i] = { i, j: maxJ, count: max };\n    // }\n    return ret;\n}\nfunction _includeAllResidues() { return true; }\nfunction buildIndex(structure, index, sI, traceOnly, includeTest) {\n    var _a;\n    var loc = element_1.StructureElement.Location.create(structure);\n    for (var _i = 0, _b = structure.units; _i < _b.length; _i++) {\n        var unit = _b[_i];\n        if (unit.kind !== 0 /* Unit.Kind.Atomic */)\n            continue;\n        var elements = unit.elements, model = unit.model;\n        loc.unit = unit;\n        var map = sifts_mapping_1.SIFTSMapping.Provider.get(model).value;\n        if (!map)\n            return;\n        var dbName = map.dbName, accession = map.accession, num = map.num;\n        var chainsIt = int_1.Segmentation.transientSegments(unit.model.atomicHierarchy.chainAtomSegments, elements);\n        var residuesIt = int_1.Segmentation.transientSegments(unit.model.atomicHierarchy.residueAtomSegments, elements);\n        var traceElementIndex = unit.model.atomicHierarchy.derived.residue.traceElementIndex;\n        while (chainsIt.hasNext) {\n            var chainSegment = chainsIt.move();\n            residuesIt.setSegment(chainSegment);\n            while (residuesIt.hasNext) {\n                var residueSegment = residuesIt.move();\n                var rI = residueSegment.index;\n                if (!dbName[rI])\n                    continue;\n                var traceElement = traceElementIndex[rI];\n                var start = void 0, end = void 0;\n                if (traceOnly) {\n                    start = traceElement;\n                    if (start === -1)\n                        continue;\n                    end = start + 1;\n                }\n                else {\n                    start = elements[residueSegment.start];\n                    end = elements[residueSegment.end - 1] + 1;\n                }\n                loc.element = (traceElement >= 0 ? traceElement : start);\n                if (!includeTest(loc, rI, start, end))\n                    continue;\n                var key = \"\".concat(dbName[rI], \"-\").concat(accession[rI].split('-')[0], \"-\").concat(num[rI]);\n                if (!index.has(key)) {\n                    index.set(key, { key: key, pivots: (_a = {}, _a[sI] = [unit, start, end], _a) });\n                }\n                else {\n                    var entry = index.get(key);\n                    if (!entry.pivots[sI]) {\n                        entry.pivots[sI] = [unit, start, end];\n                    }\n                }\n            }\n        }\n    }\n}\n//# sourceMappingURL=superposition-sifts-mapping.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvc3VwZXJwb3NpdGlvbi1zaWZ0cy1tYXBwaW5nLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHlDQUF5QztBQUN6QyxZQUFZLG1CQUFPLENBQUMsd0VBQXNCO0FBQzFDLHNCQUFzQixtQkFBTyxDQUFDLGdJQUFrRDtBQUNoRixzQkFBc0IsbUJBQU8sQ0FBQyw0SEFBZ0Q7QUFDOUUsZ0JBQWdCLG1CQUFPLENBQUMsMEhBQStDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxxQkFBcUI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLFlBQVk7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsOENBQThDO0FBQzdFO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxxQkFBcUI7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsT0FBTztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsT0FBTztBQUMzQjtBQUNBLHdCQUF3QixPQUFPO0FBQy9CO0FBQ0E7QUFDQSxzQ0FBc0MscUJBQXFCO0FBQzNEO0FBQ0Esd0JBQXdCLE9BQU87QUFDL0I7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLE9BQU87QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixPQUFPO0FBQzNCLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0EsdUJBQXVCLFdBQVc7QUFDbEM7QUFDQSwrQkFBK0IsT0FBTztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsZ0JBQWdCO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDBCQUEwQixvQ0FBb0M7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3N1cGVycG9zaXRpb24tc2lmdHMtbWFwcGluZy5qcz9lZDMxIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5hbGlnbkFuZFN1cGVycG9zZVdpdGhTSUZUU01hcHBpbmcgPSB2b2lkIDA7XG52YXIgaW50XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtZGF0YS9pbnRcIik7XG52YXIgbWluaW1pemVfcm1zZF8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLW1hdGgvbGluZWFyLWFsZ2VicmEvM2QvbWluaW1pemUtcm1zZFwiKTtcbnZhciBzaWZ0c19tYXBwaW5nXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwtcHJvcHMvc2VxdWVuY2Uvc2lmdHMtbWFwcGluZ1wiKTtcbnZhciBlbGVtZW50XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlL3N0cnVjdHVyZS9lbGVtZW50XCIpO1xuZnVuY3Rpb24gYWxpZ25BbmRTdXBlcnBvc2VXaXRoU0lGVFNNYXBwaW5nKHN0cnVjdHVyZXMsIG9wdGlvbnMpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIHZhciBpbmRleE1hcCA9IG5ldyBNYXAoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0cnVjdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGluY2x1ZGVSZXNpZHVlVGVzdCA9IChfYSA9IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5pbmNsdWRlUmVzaWR1ZVRlc3QpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IF9pbmNsdWRlQWxsUmVzaWR1ZXM7XG4gICAgICAgIGlmICgob3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmFwcGx5VGVzdEluZGV4KSAmJiAhb3B0aW9ucy5hcHBseVRlc3RJbmRleC5pbmNsdWRlcyhpKSlcbiAgICAgICAgICAgIGluY2x1ZGVSZXNpZHVlVGVzdCA9IF9pbmNsdWRlQWxsUmVzaWR1ZXM7XG4gICAgICAgIGJ1aWxkSW5kZXgoc3RydWN0dXJlc1tpXSwgaW5kZXhNYXAsIGksIChfYiA9IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy50cmFjZU9ubHkpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHRydWUsIGluY2x1ZGVSZXNpZHVlVGVzdCk7XG4gICAgfVxuICAgIHZhciBpbmRleCA9IEFycmF5LmZyb20oaW5kZXhNYXAudmFsdWVzKCkpO1xuICAgIC8vIFRPRE86IHN1cHBvcnQgbm9uLWZpcnN0IHN0cnVjdHVyZSBwaXZvdHNcbiAgICB2YXIgcGFpcnMgPSBmaW5kUGFpcnMoc3RydWN0dXJlcy5sZW5ndGgsIGluZGV4KTtcbiAgICB2YXIgemVyb092ZXJsYXBQYWlycyA9IFtdO1xuICAgIHZhciBmYWlsZWRQYWlycyA9IFtdO1xuICAgIHZhciBlbnRyaWVzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBwYWlyc18xID0gcGFpcnM7IF9pIDwgcGFpcnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHAgPSBwYWlyc18xW19pXTtcbiAgICAgICAgaWYgKHAuY291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHplcm9PdmVybGFwUGFpcnMucHVzaChbcC5pLCBwLmpdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBfYyA9IGdldFBvc2l0aW9uVGFibGVzKGluZGV4LCBwLmksIHAuaiwgcC5jb3VudCksIGEgPSBfY1swXSwgYiA9IF9jWzFdO1xuICAgICAgICAgICAgdmFyIHRyYW5zZm9ybSA9IG1pbmltaXplX3Jtc2RfMS5NaW5pbWl6ZVJtc2QuY29tcHV0ZSh7IGE6IGEsIGI6IGIgfSk7XG4gICAgICAgICAgICBpZiAoTnVtYmVyLmlzTmFOKHRyYW5zZm9ybS5ybXNkKSkge1xuICAgICAgICAgICAgICAgIGZhaWxlZFBhaXJzLnB1c2goW3AuaSwgcC5qXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRyaWVzLnB1c2goeyB0cmFuc2Zvcm06IHRyYW5zZm9ybSwgcGl2b3Q6IHAuaSwgb3RoZXI6IHAuaiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4geyBlbnRyaWVzOiBlbnRyaWVzLCB6ZXJvT3ZlcmxhcFBhaXJzOiB6ZXJvT3ZlcmxhcFBhaXJzLCBmYWlsZWRQYWlyczogZmFpbGVkUGFpcnMgfTtcbn1cbmV4cG9ydHMuYWxpZ25BbmRTdXBlcnBvc2VXaXRoU0lGVFNNYXBwaW5nID0gYWxpZ25BbmRTdXBlcnBvc2VXaXRoU0lGVFNNYXBwaW5nO1xuZnVuY3Rpb24gZ2V0UG9zaXRpb25UYWJsZXMoaW5kZXgsIHBpdm90LCBvdGhlciwgTikge1xuICAgIHZhciB4cyA9IG1pbmltaXplX3Jtc2RfMS5NaW5pbWl6ZVJtc2QuUG9zaXRpb25zLmVtcHR5KE4pO1xuICAgIHZhciB5cyA9IG1pbmltaXplX3Jtc2RfMS5NaW5pbWl6ZVJtc2QuUG9zaXRpb25zLmVtcHR5KE4pO1xuICAgIHZhciBvID0gMDtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluZGV4XzEgPSBpbmRleDsgX2kgPCBpbmRleF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcGl2b3RzID0gaW5kZXhfMVtfaV0ucGl2b3RzO1xuICAgICAgICB2YXIgYSA9IHBpdm90c1twaXZvdF07XG4gICAgICAgIHZhciBiID0gcGl2b3RzW290aGVyXTtcbiAgICAgICAgaWYgKCFhIHx8ICFiKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIHZhciBsID0gTWF0aC5taW4oYVsyXSAtIGFbMV0sIGJbMl0gLSBiWzFdKTtcbiAgICAgICAgLy8gVE9ETzogY2hlY2sgaWYgcmVzaWR1ZSB0eXBlcyBtYXRjaD9cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlSSA9IChhWzFdICsgaSk7XG4gICAgICAgICAgICB4cy54W29dID0gYVswXS5jb25mb3JtYXRpb24ueChlSSk7XG4gICAgICAgICAgICB4cy55W29dID0gYVswXS5jb25mb3JtYXRpb24ueShlSSk7XG4gICAgICAgICAgICB4cy56W29dID0gYVswXS5jb25mb3JtYXRpb24ueihlSSk7XG4gICAgICAgICAgICBlSSA9IChiWzFdICsgaSk7XG4gICAgICAgICAgICB5cy54W29dID0gYlswXS5jb25mb3JtYXRpb24ueChlSSk7XG4gICAgICAgICAgICB5cy55W29dID0gYlswXS5jb25mb3JtYXRpb24ueShlSSk7XG4gICAgICAgICAgICB5cy56W29dID0gYlswXS5jb25mb3JtYXRpb24ueihlSSk7XG4gICAgICAgICAgICBvKys7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFt4cywgeXNdO1xufVxuZnVuY3Rpb24gZmluZFBhaXJzKE4sIGluZGV4KSB7XG4gICAgdmFyIHBhaXJ3aXNlQ291bnRzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBOOyBpKyspIHtcbiAgICAgICAgcGFpcndpc2VDb3VudHNbaV0gPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBOOyBqKyspXG4gICAgICAgICAgICBwYWlyd2lzZUNvdW50c1tpXVtqXSA9IDA7XG4gICAgfVxuICAgIGZvciAodmFyIF9pID0gMCwgaW5kZXhfMiA9IGluZGV4OyBfaSA8IGluZGV4XzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwaXZvdHMgPSBpbmRleF8yW19pXS5waXZvdHM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIXBpdm90c1tpXSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIHZhciBsSSA9IHBpdm90c1tpXVsyXSAtIHBpdm90c1tpXVsxXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IE47IGorKykge1xuICAgICAgICAgICAgICAgIGlmICghcGl2b3RzW2pdKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB2YXIgbEogPSBwaXZvdHNbal1bMl0gLSBwaXZvdHNbal1bMV07XG4gICAgICAgICAgICAgICAgcGFpcndpc2VDb3VudHNbaV1bal0gPSBwYWlyd2lzZUNvdW50c1tpXVtqXSArIE1hdGgubWluKGxJLCBsSik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHJldCA9IFtdO1xuICAgIGZvciAodmFyIGogPSAxOyBqIDwgTjsgaisrKSB7XG4gICAgICAgIHJldFtqIC0gMV0gPSB7IGk6IDAsIGo6IGosIGNvdW50OiBwYWlyd2lzZUNvdW50c1swXVtqXSB9O1xuICAgIH1cbiAgICAvLyBUT0RPOiBzdXBwb3J0IG5vbi1maXJzdCBzdHJ1Y3R1cmUgcGl2b3RzXG4gICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBOIC0gMTsgaSsrKSB7XG4gICAgLy8gICAgIGxldCBtYXggPSAwLCBtYXhKID0gaTtcbiAgICAvLyAgICAgZm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgTjsgaisrKSB7XG4gICAgLy8gICAgICAgICBpZiAocGFpcndpc2VDb3VudHNbaV1bal0gPiBtYXgpIHtcbiAgICAvLyAgICAgICAgICAgICBtYXhKID0gajtcbiAgICAvLyAgICAgICAgICAgICBtYXggPSBwYWlyd2lzZUNvdW50c1tpXVtqXTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgfVxuICAgIC8vICAgICByZXRbaV0gPSB7IGksIGo6IG1heEosIGNvdW50OiBtYXggfTtcbiAgICAvLyB9XG4gICAgcmV0dXJuIHJldDtcbn1cbmZ1bmN0aW9uIF9pbmNsdWRlQWxsUmVzaWR1ZXMoKSB7IHJldHVybiB0cnVlOyB9XG5mdW5jdGlvbiBidWlsZEluZGV4KHN0cnVjdHVyZSwgaW5kZXgsIHNJLCB0cmFjZU9ubHksIGluY2x1ZGVUZXN0KSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBsb2MgPSBlbGVtZW50XzEuU3RydWN0dXJlRWxlbWVudC5Mb2NhdGlvbi5jcmVhdGUoc3RydWN0dXJlKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9iID0gc3RydWN0dXJlLnVuaXRzOyBfaSA8IF9iLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgdW5pdCA9IF9iW19pXTtcbiAgICAgICAgaWYgKHVuaXQua2luZCAhPT0gMCAvKiBVbml0LktpbmQuQXRvbWljICovKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIHZhciBlbGVtZW50cyA9IHVuaXQuZWxlbWVudHMsIG1vZGVsID0gdW5pdC5tb2RlbDtcbiAgICAgICAgbG9jLnVuaXQgPSB1bml0O1xuICAgICAgICB2YXIgbWFwID0gc2lmdHNfbWFwcGluZ18xLlNJRlRTTWFwcGluZy5Qcm92aWRlci5nZXQobW9kZWwpLnZhbHVlO1xuICAgICAgICBpZiAoIW1hcClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGRiTmFtZSA9IG1hcC5kYk5hbWUsIGFjY2Vzc2lvbiA9IG1hcC5hY2Nlc3Npb24sIG51bSA9IG1hcC5udW07XG4gICAgICAgIHZhciBjaGFpbnNJdCA9IGludF8xLlNlZ21lbnRhdGlvbi50cmFuc2llbnRTZWdtZW50cyh1bml0Lm1vZGVsLmF0b21pY0hpZXJhcmNoeS5jaGFpbkF0b21TZWdtZW50cywgZWxlbWVudHMpO1xuICAgICAgICB2YXIgcmVzaWR1ZXNJdCA9IGludF8xLlNlZ21lbnRhdGlvbi50cmFuc2llbnRTZWdtZW50cyh1bml0Lm1vZGVsLmF0b21pY0hpZXJhcmNoeS5yZXNpZHVlQXRvbVNlZ21lbnRzLCBlbGVtZW50cyk7XG4gICAgICAgIHZhciB0cmFjZUVsZW1lbnRJbmRleCA9IHVuaXQubW9kZWwuYXRvbWljSGllcmFyY2h5LmRlcml2ZWQucmVzaWR1ZS50cmFjZUVsZW1lbnRJbmRleDtcbiAgICAgICAgd2hpbGUgKGNoYWluc0l0Lmhhc05leHQpIHtcbiAgICAgICAgICAgIHZhciBjaGFpblNlZ21lbnQgPSBjaGFpbnNJdC5tb3ZlKCk7XG4gICAgICAgICAgICByZXNpZHVlc0l0LnNldFNlZ21lbnQoY2hhaW5TZWdtZW50KTtcbiAgICAgICAgICAgIHdoaWxlIChyZXNpZHVlc0l0Lmhhc05leHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzaWR1ZVNlZ21lbnQgPSByZXNpZHVlc0l0Lm1vdmUoKTtcbiAgICAgICAgICAgICAgICB2YXIgckkgPSByZXNpZHVlU2VnbWVudC5pbmRleDtcbiAgICAgICAgICAgICAgICBpZiAoIWRiTmFtZVtySV0pXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHZhciB0cmFjZUVsZW1lbnQgPSB0cmFjZUVsZW1lbnRJbmRleFtySV07XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gdm9pZCAwLCBlbmQgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNlT25seSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IHRyYWNlRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID09PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBlbmQgPSBzdGFydCArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGVsZW1lbnRzW3Jlc2lkdWVTZWdtZW50LnN0YXJ0XTtcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gZWxlbWVudHNbcmVzaWR1ZVNlZ21lbnQuZW5kIC0gMV0gKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsb2MuZWxlbWVudCA9ICh0cmFjZUVsZW1lbnQgPj0gMCA/IHRyYWNlRWxlbWVudCA6IHN0YXJ0KTtcbiAgICAgICAgICAgICAgICBpZiAoIWluY2x1ZGVUZXN0KGxvYywgckksIHN0YXJ0LCBlbmQpKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gXCJcIi5jb25jYXQoZGJOYW1lW3JJXSwgXCItXCIpLmNvbmNhdChhY2Nlc3Npb25bckldLnNwbGl0KCctJylbMF0sIFwiLVwiKS5jb25jYXQobnVtW3JJXSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpbmRleC5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBpbmRleC5zZXQoa2V5LCB7IGtleToga2V5LCBwaXZvdHM6IChfYSA9IHt9LCBfYVtzSV0gPSBbdW5pdCwgc3RhcnQsIGVuZF0sIF9hKSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbnRyeSA9IGluZGV4LmdldChrZXkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVudHJ5LnBpdm90c1tzSV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LnBpdm90c1tzSV0gPSBbdW5pdCwgc3RhcnQsIGVuZF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdXBlcnBvc2l0aW9uLXNpZnRzLW1hcHBpbmcuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/superposition-sifts-mapping.js\n");
  
  /***/ }),
  
  /***/ "./lib/superposition.js":
  /*!******************************!*\
    !*** ./lib/superposition.js ***!
    \******************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.renderSuperposition = exports.superposeAf = exports.loadAfStructure = exports.initSuperposition = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar linear_algebra_1 = __webpack_require__(/*! Molstar/mol-math/linear-algebra */ \"./node_modules/molstar/lib/mol-math/linear-algebra.js\");\nvar builder_1 = __webpack_require__(/*! Molstar/mol-script/language/builder */ \"./node_modules/molstar/lib/mol-script/language/builder.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar transforms_1 = __webpack_require__(/*! Molstar/mol-plugin-state/transforms */ \"./node_modules/molstar/lib/mol-plugin-state/transforms.js\");\nvar assets_1 = __webpack_require__(/*! Molstar/mol-util/assets */ \"./node_modules/molstar/lib/mol-util/assets.js\");\nvar helpers_1 = __webpack_require__(/*! ./helpers */ \"./lib/helpers.js\");\nvar lists_1 = __webpack_require__(/*! Molstar/mol-util/color/lists */ \"./node_modules/molstar/lib/mol-util/color/lists.js\");\nvar color_1 = __webpack_require__(/*! Molstar/mol-util/color/color */ \"./node_modules/molstar/lib/mol-util/color/color.js\");\nvar script_1 = __webpack_require__(/*! Molstar/mol-script/script */ \"./node_modules/molstar/lib/mol-script/script.js\");\nvar mol_task_1 = __webpack_require__(/*! Molstar/mol-task */ \"./node_modules/molstar/lib/mol-task/index.js\");\nvar superposition_sifts_mapping_1 = __webpack_require__(/*! ./superposition-sifts-mapping */ \"./lib/superposition-sifts-mapping.js\");\nvar alphafold_transparency_1 = __webpack_require__(/*! ./alphafold-transparency */ \"./lib/alphafold-transparency.js\");\nvar structure_1 = __webpack_require__(/*! Molstar/mol-model/structure */ \"./node_modules/molstar/lib/mol-model/structure.js\");\nfunction getRandomColor(plugin, segmentIndex) {\n    var clList = lists_1.ColorLists;\n    var spState = plugin.customState.superpositionState;\n    var palleteIndex = spState.colorState[segmentIndex].palleteIndex;\n    var colorIndex = spState.colorState[segmentIndex].colorIndex;\n    if (clList[spState.colorPalette[palleteIndex]].list[colorIndex + 1]) {\n        colorIndex += 1;\n    }\n    else {\n        colorIndex = 0;\n        palleteIndex = spState.colorPalette[palleteIndex + 1] ? palleteIndex + 1 : 0;\n    }\n    var palleteName = spState.colorPalette[palleteIndex];\n    plugin.customState.superpositionState.colorState[segmentIndex].palleteIndex = palleteIndex;\n    plugin.customState.superpositionState.colorState[segmentIndex].colorIndex = colorIndex;\n    return clList[palleteName].list[colorIndex];\n}\nfunction initSuperposition(plugin) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, superpositionParams, segmentData, afStrUrls, segmentIndex, clusterIndexs, entryList, clusters;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, plugin.clear()];\n                case 1:\n                    _a.sent();\n                    customState = plugin.customState;\n                    superpositionParams = customState.initParams.superpositionParams;\n                    plugin.customState.superpositionState = {\n                        models: {},\n                        entries: {},\n                        refMaps: {},\n                        segmentData: void 0,\n                        matrixData: {},\n                        activeSegment: 0,\n                        loadedStructs: [],\n                        visibleRefs: [],\n                        invalidStruct: [],\n                        noMatrixStruct: [],\n                        hets: {},\n                        colorPalette: ['dark-2', 'red-yellow-green', 'paired', 'set-1', 'accent', 'set-2', 'rainbow'],\n                        colorState: [],\n                        alphafold: {\n                            apiData: {\n                                cif: '',\n                                pae: '',\n                                length: 0\n                            },\n                            length: 0,\n                            ref: '',\n                            traceOnly: true,\n                            visibility: [],\n                            transforms: [],\n                            rmsds: [],\n                            coordinateSystems: []\n                        }\n                    };\n                    // Get segment and cluster information for the given uniprot accession\n                    return [4 /*yield*/, getSegmentData(plugin)];\n                case 2:\n                    // Get segment and cluster information for the given uniprot accession\n                    _a.sent();\n                    segmentData = plugin.customState.superpositionState.segmentData;\n                    if (!segmentData)\n                        return [2 /*return*/];\n                    // Load Matrix Data\n                    return [4 /*yield*/, getMatrixData(plugin)];\n                case 3:\n                    // Load Matrix Data\n                    _a.sent();\n                    if (!plugin.customState.superpositionState.segmentData)\n                        return [2 /*return*/];\n                    return [4 /*yield*/, getAfUrl(plugin, customState.initParams.moleculeId)];\n                case 4:\n                    afStrUrls = _a.sent();\n                    if (afStrUrls)\n                        customState.superpositionState.alphafold.apiData = afStrUrls;\n                    segmentData.forEach(function () {\n                        plugin.customState.superpositionState.loadedStructs.push([]);\n                        plugin.customState.superpositionState.visibleRefs.push([]);\n                        plugin.customState.superpositionState.colorState.push({ palleteIndex: 0, colorIndex: -1 });\n                    });\n                    segmentIndex = (superpositionParams && superpositionParams.segment) ? superpositionParams.segment - 1 : 0;\n                    plugin.customState.superpositionState.activeSegment = segmentIndex + 1;\n                    clusterIndexs = (superpositionParams && superpositionParams.cluster) ? superpositionParams.cluster : void 0;\n                    // Emit segment API data load event\n                    plugin.customState.events.superpositionInit.next(true);\n                    entryList = [];\n                    clusters = segmentData[segmentIndex].clusters;\n                    clusters.forEach(function (cluster, clusterIndex) {\n                        // Validate for cluster index if provided in superPositionParams\n                        if (clusterIndexs && clusterIndexs.indexOf(clusterIndex) === -1)\n                            return;\n                        // Add respresentative structure to the list\n                        if (superpositionParams && superpositionParams.superposeAll) {\n                            entryList = entryList.concat(cluster);\n                        }\n                        else {\n                            entryList.push(cluster[0]);\n                        }\n                    });\n                    return [4 /*yield*/, renderSuperposition(plugin, segmentIndex, entryList)];\n                case 5:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.initSuperposition = initSuperposition;\nfunction createCarbVisLabel(carbLigNamesAndCount) {\n    var compList = [];\n    for (var carbCompId in carbLigNamesAndCount) {\n        compList.push(\"\".concat(carbCompId, \" (\").concat(carbLigNamesAndCount[carbCompId], \")\"));\n    }\n    return compList.join(', ');\n}\nfunction getAfUrl(plugin, accession) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var apiResponse, apiData;\n        var _this = this;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, plugin.runTask(mol_task_1.Task.create('Get AlphaFold URL', function (ctx) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                        var e_1;\n                        return tslib_1.__generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0:\n                                    _a.trys.push([0, 2, , 3]);\n                                    return [4 /*yield*/, plugin.fetch({ url: \"https://alphafold.ebi.ac.uk/api/prediction/\".concat(accession), type: 'json' }).runInContext(ctx)];\n                                case 1:\n                                    apiResponse = _a.sent();\n                                    if (apiResponse && (apiResponse === null || apiResponse === void 0 ? void 0 : apiResponse[0].bcifUrl)) {\n                                        apiData = {\n                                            cif: apiResponse === null || apiResponse === void 0 ? void 0 : apiResponse[0].cifUrl,\n                                            pae: apiResponse === null || apiResponse === void 0 ? void 0 : apiResponse[0].paeImageUrl,\n                                            length: apiResponse === null || apiResponse === void 0 ? void 0 : apiResponse[0].uniprotEnd\n                                        };\n                                    }\n                                    return [3 /*break*/, 3];\n                                case 2:\n                                    e_1 = _a.sent();\n                                    return [3 /*break*/, 3];\n                                case 3: return [2 /*return*/];\n                            }\n                        });\n                    }); }))];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/, apiData];\n            }\n        });\n    });\n}\nfunction loadAfStructure(plugin) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, structure, strInstance, spState, chainSel;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    customState = plugin.customState;\n                    return [4 /*yield*/, loadStructure(plugin, customState.superpositionState.alphafold.apiData.cif, 'mmcif', false)];\n                case 1:\n                    structure = (_a.sent()).structure;\n                    strInstance = structure;\n                    if (!strInstance)\n                        return [2 /*return*/, false];\n                    spState = plugin.customState.superpositionState;\n                    spState.alphafold.ref = strInstance === null || strInstance === void 0 ? void 0 : strInstance.ref;\n                    spState.models[\"AF-\".concat(customState.initParams.moleculeId)] = strInstance === null || strInstance === void 0 ? void 0 : strInstance.ref;\n                    return [4 /*yield*/, plugin.builders.structure.tryCreateComponentStatic(strInstance, 'polymer', { label: \"AlphaFold Structure\", tags: [\"alphafold-chain\", \"superposition-sel\"] })];\n                case 2:\n                    chainSel = _a.sent();\n                    if (!chainSel) return [3 /*break*/, 4];\n                    return [4 /*yield*/, plugin.builders.structure.representation.addRepresentation(chainSel, { type: 'putty', color: 'plddt-confidence', size: 'uniform', sizeParams: { value: 1.5 } }, { tag: \"af-superposition-visual\" })];\n                case 3:\n                    _a.sent();\n                    return [2 /*return*/, strInstance === null || strInstance === void 0 ? void 0 : strInstance.ref];\n                case 4: return [2 /*return*/, false];\n            }\n        });\n    });\n}\nexports.loadAfStructure = loadAfStructure;\nfunction superposeAf(plugin, traceOnly, segmentIndex) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, spState, afStrRef, _a, afStr, segmentNum, mappingResult_1, coordinateSystems_1, failedPairsResult_1, zeroOverlapPairsResult_1, minRmsd_1, minIndex_1, rmsdList_1, segmentClusters;\n        return tslib_1.__generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    customState = plugin.customState;\n                    if (!customState.superpositionState || !customState.superpositionState.segmentData)\n                        return [2 /*return*/];\n                    spState = customState.superpositionState;\n                    _a = spState.alphafold.ref;\n                    if (_a) return [3 /*break*/, 2];\n                    return [4 /*yield*/, loadAfStructure(plugin)];\n                case 1:\n                    _a = (_b.sent());\n                    _b.label = 2;\n                case 2:\n                    afStrRef = _a;\n                    if (!afStrRef)\n                        return [2 /*return*/];\n                    afStr = plugin.managers.structure.hierarchy.current.refs.get(afStrRef);\n                    segmentNum = segmentIndex ? segmentIndex : spState.activeSegment - 1;\n                    if (!spState.alphafold.transforms[segmentNum]) {\n                        mappingResult_1 = [];\n                        coordinateSystems_1 = [];\n                        failedPairsResult_1 = [];\n                        zeroOverlapPairsResult_1 = [];\n                        minRmsd_1 = 0;\n                        minIndex_1 = 0;\n                        rmsdList_1 = [];\n                        segmentClusters = spState.segmentData[segmentNum].clusters;\n                        segmentClusters.forEach(function (cluster) {\n                            var _a, _b, _c;\n                            var modelRef = spState.models[\"\".concat(cluster[0].pdb_id, \"_\").concat(cluster[0].struct_asym_id)];\n                            if (modelRef) {\n                                var structHierarchy = plugin.managers.structure.hierarchy.current.refs.get(modelRef);\n                                if (structHierarchy) {\n                                    var input = [structHierarchy, afStr];\n                                    var structures = input.map(function (s) { var _a; return (_a = s.cell.obj) === null || _a === void 0 ? void 0 : _a.data; });\n                                    var _d = (0, superposition_sifts_mapping_1.alignAndSuperposeWithSIFTSMapping)(structures, { traceOnly: traceOnly, includeResidueTest: function (loc) { return structure_1.StructureProperties.atom.B_iso_or_equiv(loc) > 70; },\n                                        applyTestIndex: [1] }), entries = _d.entries, failedPairs = _d.failedPairs, zeroOverlapPairs = _d.zeroOverlapPairs;\n                                    if (entries.length === 0 || (entries && entries[0] && entries[0].transform.rmsd.toFixed(1) === '0.0')) {\n                                        var alignWithoutPlddt = (0, superposition_sifts_mapping_1.alignAndSuperposeWithSIFTSMapping)(structures, { traceOnly: traceOnly });\n                                        entries = alignWithoutPlddt.entries;\n                                    }\n                                    if (entries && entries[0]) {\n                                        mappingResult_1.push(entries[0]);\n                                        coordinateSystems_1.push((_c = (_b = (_a = input[0]) === null || _a === void 0 ? void 0 : _a.transform) === null || _b === void 0 ? void 0 : _b.cell.obj) === null || _c === void 0 ? void 0 : _c.data.coordinateSystem);\n                                        var totalMappings = mappingResult_1.length;\n                                        if (totalMappings === 1 || entries[0].transform.rmsd < minRmsd_1) {\n                                            minRmsd_1 = entries[0].transform.rmsd;\n                                            minIndex_1 = totalMappings === 1 ? 0 : mappingResult_1.length - 1;\n                                        }\n                                        rmsdList_1.push(\"\".concat(cluster[0].pdb_id, \" chain \").concat(cluster[0].struct_asym_id, \":\").concat(entries[0].transform.rmsd.toFixed(2)));\n                                    }\n                                    else {\n                                        if (failedPairs.length > 0)\n                                            failedPairsResult_1.push(failedPairs);\n                                        if (zeroOverlapPairs.length > 0)\n                                            zeroOverlapPairsResult_1.push(zeroOverlapPairs);\n                                        // rmsdList.push(`${cluster[0].pdb_id} ${cluster[0].struct_asym_id}:-`)\n                                    }\n                                }\n                            }\n                        });\n                        // console.log(failedPairsResult);\n                        // console.log(zeroOverlapPairsResult);\n                        if (mappingResult_1.length > 0) {\n                            spState.alphafold.visibility[segmentNum] = true;\n                            spState.alphafold.transforms[segmentNum] = mappingResult_1[minIndex_1].transform.bTransform;\n                            spState.alphafold.coordinateSystems[segmentNum] = coordinateSystems_1[minIndex_1];\n                            spState.alphafold.rmsds[segmentNum] = rmsdList_1.sort(function (a, b) { return parseFloat(a.split(':')[1]) - parseFloat(b.split(':')[1]); });\n                        }\n                    }\n                    return [4 /*yield*/, afTransform(plugin, afStr.cell, spState.alphafold.transforms[segmentNum], spState.alphafold.coordinateSystems[segmentNum])];\n                case 3:\n                    _b.sent();\n                    (0, alphafold_transparency_1.applyAFTransparency)(plugin, afStr, 0.8, 70);\n                    return [2 /*return*/, true];\n            }\n        });\n    });\n}\nexports.superposeAf = superposeAf;\nfunction renderSuperposition(plugin, segmentIndex, entryList) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, superpositionParams, busyFlagOn;\n        var _this = this;\n        return tslib_1.__generator(this, function (_a) {\n            customState = plugin.customState;\n            superpositionParams = customState.initParams.superpositionParams;\n            busyFlagOn = false;\n            if (entryList.length > 1) {\n                busyFlagOn = true;\n                customState.events.isBusy.next(true);\n            }\n            // Load Coordinates and render respresentations\n            return [2 /*return*/, plugin.dataTransaction(function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                    var spState, _a, entryList_1, entryList_1_1, s, strUrl, strInstance, modelRef, clearOnFail, polymerInstance, modelInstance, isBinary, _b, model, structure, matrix, chainSel, uniformColor1, uniformColor2, invalidStruct, state, hetInfo, hets, _c, hets_1, hets_1_1, het, ligand, labelTagParams, hetColor, _d, r, g, b, ligandExp, e_2_1, carbEntityCount, allCarbPolymers, polymerChainWithSurroundings, i, _i, _e, carbEntityChainId, carbEntityChain, carbEntityChainInVicinity, data, carbChainSel, carbLigands, carbLigNamesAndCount, carbLigList, _f, _g, carbLigs, ligResDetails, carbVisLabel, branchedEntity, labelTagParams, ligandExp, loadedStructIndex, e_3_1;\n                    var _h, e_3, _j, _k, _l, e_2, _m, _o;\n                    return tslib_1.__generator(this, function (_p) {\n                        switch (_p.label) {\n                            case 0:\n                                spState = plugin.customState.superpositionState;\n                                _p.label = 1;\n                            case 1:\n                                _p.trys.push([1, 47, 48, 53]);\n                                _a = true, entryList_1 = tslib_1.__asyncValues(entryList);\n                                _p.label = 2;\n                            case 2: return [4 /*yield*/, entryList_1.next()];\n                            case 3:\n                                if (!(entryList_1_1 = _p.sent(), _h = entryList_1_1.done, !_h)) return [3 /*break*/, 46];\n                                _k = entryList_1_1.value;\n                                _a = false;\n                                _p.label = 4;\n                            case 4:\n                                _p.trys.push([4, , 44, 45]);\n                                s = _k;\n                                // validate matrix availability\n                                if (!spState.matrixData[\"\".concat(s.pdb_id, \"_\").concat(s.auth_asym_id)]) {\n                                    spState.noMatrixStruct.push(\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id));\n                                    spState.invalidStruct.push(\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id));\n                                    return [3 /*break*/, 45];\n                                }\n                                spState.loadedStructs[segmentIndex].push(\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id));\n                                strUrl = \"\".concat(customState.initParams.pdbeUrl, \"model-server/v1/\").concat(s.pdb_id, \"/atoms?auth_asym_id=\").concat(s.auth_asym_id, \"&encoding=\").concat(customState.initParams.encoding);\n                                if (superpositionParams && superpositionParams.ligandView)\n                                    strUrl = \"https://www.ebi.ac.uk/pdbe/entry-files/download/\".concat(s.pdb_id, \".bcif\");\n                                strInstance = void 0;\n                                modelRef = void 0;\n                                clearOnFail = true;\n                                if (!(superpositionParams && superpositionParams.ligandView && spState.entries[s.pdb_id])) return [3 /*break*/, 6];\n                                polymerInstance = plugin.state.data.select(spState.entries[s.pdb_id])[0];\n                                modelRef = polymerInstance.transform.parent;\n                                modelInstance = plugin.state.data.select(modelRef)[0];\n                                return [4 /*yield*/, plugin.builders.structure.createStructure(modelInstance, { name: 'model', params: {} })];\n                            case 5:\n                                strInstance = _p.sent();\n                                clearOnFail = false;\n                                return [3 /*break*/, 8];\n                            case 6:\n                                isBinary = customState.initParams.encoding === 'bcif' ? true : false;\n                                return [4 /*yield*/, loadStructure(plugin, strUrl, 'mmcif', isBinary)];\n                            case 7:\n                                _b = _p.sent(), model = _b.model, structure = _b.structure;\n                                strInstance = structure;\n                                modelRef = model.ref;\n                                _p.label = 8;\n                            case 8:\n                                if (!strInstance)\n                                    return [3 /*break*/, 45];\n                                // Store Refs in state\n                                if (!spState.models[\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id)])\n                                    spState.models[\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id)] = strInstance === null || strInstance === void 0 ? void 0 : strInstance.ref;\n                                if (superpositionParams && superpositionParams.ligandView && !spState.entries[s.pdb_id])\n                                    spState.entries[s.pdb_id] = strInstance === null || strInstance === void 0 ? void 0 : strInstance.ref;\n                                matrix = linear_algebra_1.Mat4.ofRows(plugin.customState.superpositionState.matrixData[\"\".concat(s.pdb_id, \"_\").concat(s.auth_asym_id)].matrix);\n                                return [4 /*yield*/, transform(plugin, strInstance, matrix)];\n                            case 9:\n                                _p.sent();\n                                chainSel = void 0;\n                                if (!((superpositionParams && superpositionParams.ligandView) && s.is_representative)) return [3 /*break*/, 13];\n                                uniformColor1 = getRandomColor(plugin, segmentIndex);\n                                return [4 /*yield*/, plugin.builders.structure.tryCreateComponentFromExpression(strInstance, chainSelection(s.struct_asym_id), \"Chain-\".concat(segmentIndex), { label: \"Chain\", tags: [\"superposition-sel\"] })];\n                            case 10:\n                                chainSel = _p.sent();\n                                if (!chainSel) return [3 /*break*/, 12];\n                                return [4 /*yield*/, plugin.builders.structure.representation.addRepresentation(chainSel, { type: 'putty', color: 'uniform', colorParams: { value: uniformColor1 }, size: 'uniform' }, { tag: \"superposition-visual\" })];\n                            case 11:\n                                _p.sent();\n                                spState.refMaps[chainSel.ref] = \"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id);\n                                _p.label = 12;\n                            case 12: return [3 /*break*/, 17];\n                            case 13:\n                                if (!((superpositionParams && superpositionParams.ligandView) && !s.is_representative)) return [3 /*break*/, 14];\n                                return [3 /*break*/, 17];\n                            case 14:\n                                uniformColor2 = getRandomColor(plugin, segmentIndex);\n                                return [4 /*yield*/, plugin.builders.structure.tryCreateComponentStatic(strInstance, 'polymer', { label: \"Chain\", tags: [\"Chain-\".concat(segmentIndex), \"superposition-sel\"] })];\n                            case 15:\n                                chainSel = _p.sent();\n                                if (!chainSel) return [3 /*break*/, 17];\n                                return [4 /*yield*/, plugin.builders.structure.representation.addRepresentation(chainSel, { type: 'putty', color: 'uniform', colorParams: { value: uniformColor2 }, size: 'uniform' }, { tag: \"superposition-visual\" })];\n                            case 16:\n                                _p.sent();\n                                spState.refMaps[chainSel.ref] = \"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id);\n                                _p.label = 17;\n                            case 17:\n                                invalidStruct = chainSel ? false : true;\n                                if (!(superpositionParams && superpositionParams.ligandView)) return [3 /*break*/, 43];\n                                state = plugin.state.data;\n                                return [4 /*yield*/, getLigandNamesFromModelData(plugin, state, modelRef)];\n                            case 18:\n                                hetInfo = _p.sent();\n                                hets = hetInfo ? hetInfo.hetNames : [];\n                                if (!(hets && hets.length > 0)) return [3 /*break*/, 35];\n                                _p.label = 19;\n                            case 19:\n                                _p.trys.push([19, 29, 30, 35]);\n                                _c = true, hets_1 = (e_2 = void 0, tslib_1.__asyncValues(hets));\n                                _p.label = 20;\n                            case 20: return [4 /*yield*/, hets_1.next()];\n                            case 21:\n                                if (!(hets_1_1 = _p.sent(), _l = hets_1_1.done, !_l)) return [3 /*break*/, 28];\n                                _o = hets_1_1.value;\n                                _c = false;\n                                _p.label = 22;\n                            case 22:\n                                _p.trys.push([22, , 26, 27]);\n                                het = _o;\n                                ligand = builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                                    'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_asym_id(), s.auth_asym_id]),\n                                    'residue-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.label_comp_id(), het]),\n                                    'group-by': builder_1.MolScriptBuilder.core.str.concat([builder_1.MolScriptBuilder.struct.atomProperty.core.operatorName(), builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.residueKey()])\n                                });\n                                labelTagParams = { label: \"\".concat(het), tags: [\"superposition-ligand-sel\"] };\n                                hetColor = color_1.Color.fromRgb(253, 3, 253);\n                                if (superpositionParams && superpositionParams.ligandColor) {\n                                    _d = superpositionParams.ligandColor, r = _d.r, g = _d.g, b = _d.b;\n                                    hetColor = color_1.Color.fromRgb(r, g, b);\n                                }\n                                return [4 /*yield*/, plugin.builders.structure.tryCreateComponentFromExpression(strInstance, ligand, \"\".concat(het, \"-\").concat(segmentIndex), labelTagParams)];\n                            case 23:\n                                ligandExp = _p.sent();\n                                if (!ligandExp) return [3 /*break*/, 25];\n                                return [4 /*yield*/, plugin.builders.structure.representation.addRepresentation(ligandExp, { type: 'ball-and-stick', color: 'uniform', colorParams: { value: hetColor } }, { tag: \"superposition-ligand-visual\" })];\n                            case 24:\n                                _p.sent();\n                                spState.refMaps[ligandExp.ref] = \"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id);\n                                invalidStruct = false;\n                                _p.label = 25;\n                            case 25: return [3 /*break*/, 27];\n                            case 26:\n                                _c = true;\n                                return [7 /*endfinally*/];\n                            case 27: return [3 /*break*/, 20];\n                            case 28: return [3 /*break*/, 35];\n                            case 29:\n                                e_2_1 = _p.sent();\n                                e_2 = { error: e_2_1 };\n                                return [3 /*break*/, 35];\n                            case 30:\n                                _p.trys.push([30, , 33, 34]);\n                                if (!(!_c && !_l && (_m = hets_1.return))) return [3 /*break*/, 32];\n                                return [4 /*yield*/, _m.call(hets_1)];\n                            case 31:\n                                _p.sent();\n                                _p.label = 32;\n                            case 32: return [3 /*break*/, 34];\n                            case 33:\n                                if (e_2) throw e_2.error;\n                                return [7 /*endfinally*/];\n                            case 34: return [7 /*endfinally*/];\n                            case 35:\n                                carbEntityCount = hetInfo ? hetInfo.carbEntityCount : 0;\n                                if (!(carbEntityCount > 0)) return [3 /*break*/, 42];\n                                return [4 /*yield*/, getCarbPolymerDetailsFromApi(plugin, s.pdb_id)];\n                            case 36:\n                                allCarbPolymers = _p.sent();\n                                polymerChainWithSurroundings = builder_1.MolScriptBuilder.struct.modifier.includeSurroundings({\n                                    0: builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                                        'entity-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.ammp('entityType'), 'polymer']),\n                                        'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_asym_id(), s.auth_asym_id]),\n                                        'group-by': builder_1.MolScriptBuilder.core.str.concat([builder_1.MolScriptBuilder.struct.atomProperty.core.operatorName(), builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.residueKey()])\n                                    }),\n                                    radius: 5,\n                                    'as-whole-residues': true\n                                });\n                                i = 0;\n                                _i = 0, _e = allCarbPolymers.branchedChains;\n                                _p.label = 37;\n                            case 37:\n                                if (!(_i < _e.length)) return [3 /*break*/, 42];\n                                carbEntityChainId = _e[_i];\n                                carbEntityChain = builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                                    'entity-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.ammp('entityType'), 'branched']),\n                                    'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_asym_id(), carbEntityChainId]),\n                                    'group-by': builder_1.MolScriptBuilder.core.str.concat([builder_1.MolScriptBuilder.struct.atomProperty.core.operatorName(), builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.residueKey()])\n                                });\n                                carbEntityChainInVicinity = builder_1.MolScriptBuilder.struct.filter.intersectedBy({\n                                    0: polymerChainWithSurroundings,\n                                    by: carbEntityChain\n                                });\n                                data = (plugin.state.data.select(strInstance.ref)[0].obj).data;\n                                carbChainSel = script_1.Script.getStructureSelection(carbEntityChainInVicinity, data);\n                                if (!(carbChainSel && carbChainSel.kind === 'sequence')) return [3 /*break*/, 40];\n                                carbLigands = [];\n                                carbLigNamesAndCount = {};\n                                carbLigList = [];\n                                for (_f = 0, _g = allCarbPolymers.branchedLigands[i]; _f < _g.length; _f++) {\n                                    carbLigs = _g[_f];\n                                    ligResDetails = carbLigs.split('-');\n                                    carbLigands.push(builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_seq_id(), +ligResDetails[1]]));\n                                    if (carbLigNamesAndCount[ligResDetails[0]]) {\n                                        carbLigNamesAndCount[ligResDetails[0]]++;\n                                    }\n                                    else {\n                                        carbLigNamesAndCount[ligResDetails[0]] = 1;\n                                    }\n                                    carbLigList.push(ligResDetails[0]);\n                                }\n                                carbVisLabel = createCarbVisLabel(carbLigNamesAndCount);\n                                branchedEntity = builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                                    'entity-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.ammp('entityType'), 'branched']),\n                                    'group-by': builder_1.MolScriptBuilder.core.str.concat([builder_1.MolScriptBuilder.struct.atomProperty.core.operatorName(), builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.residueKey()]),\n                                    'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.auth_asym_id(), carbEntityChainId]),\n                                    'residue-test': builder_1.MolScriptBuilder.core.logic.or(carbLigands)\n                                });\n                                labelTagParams = { label: \"\".concat(carbVisLabel), tags: [\"superposition-carb-sel\"] };\n                                return [4 /*yield*/, plugin.builders.structure.tryCreateComponentFromExpression(strInstance, branchedEntity, \"\".concat(carbLigList.join('-'), \"-\").concat(segmentIndex), labelTagParams)];\n                            case 38:\n                                ligandExp = _p.sent();\n                                if (!ligandExp) return [3 /*break*/, 40];\n                                return [4 /*yield*/, plugin.builders.structure.representation.addRepresentation(ligandExp, { type: 'carbohydrate' }, { tag: \"superposition-carb-visual\" })];\n                            case 39:\n                                _p.sent();\n                                spState.refMaps[ligandExp.ref] = \"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id);\n                                invalidStruct = false;\n                                _p.label = 40;\n                            case 40:\n                                i++;\n                                _p.label = 41;\n                            case 41:\n                                _i++;\n                                return [3 /*break*/, 37];\n                            case 42:\n                                if (invalidStruct) {\n                                    spState.invalidStruct.push(\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id));\n                                    loadedStructIndex = spState.loadedStructs[segmentIndex].indexOf(\"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id));\n                                    if (loadedStructIndex > -1)\n                                        spState.loadedStructs[segmentIndex].splice(loadedStructIndex, 1);\n                                    // remove downloaded data\n                                    if (clearOnFail) {\n                                        // const m = plugin.state.data.select(modelRef)[0];\n                                        // const t = plugin.state.data.select(m.transform.parent)[0];\n                                        // const d = plugin.state.data.select(t.transform.parent)[0];\n                                        // PluginCommands.State.RemoveObject(plugin, { state: d.parent!, ref: d.transform.parent, removeParentGhosts: true });\n                                    }\n                                }\n                                else {\n                                    // if(interactingHets.length > 0) spState.hets[`${s.pdb_id}_${s.struct_asym_id}`] = interactingHets;\n                                }\n                                _p.label = 43;\n                            case 43: return [3 /*break*/, 45];\n                            case 44:\n                                _a = true;\n                                return [7 /*endfinally*/];\n                            case 45: return [3 /*break*/, 2];\n                            case 46: return [3 /*break*/, 53];\n                            case 47:\n                                e_3_1 = _p.sent();\n                                e_3 = { error: e_3_1 };\n                                return [3 /*break*/, 53];\n                            case 48:\n                                _p.trys.push([48, , 51, 52]);\n                                if (!(!_a && !_h && (_j = entryList_1.return))) return [3 /*break*/, 50];\n                                return [4 /*yield*/, _j.call(entryList_1)];\n                            case 49:\n                                _p.sent();\n                                _p.label = 50;\n                            case 50: return [3 /*break*/, 52];\n                            case 51:\n                                if (e_3) throw e_3.error;\n                                return [7 /*endfinally*/];\n                            case 52: return [7 /*endfinally*/];\n                            case 53:\n                                if (busyFlagOn) {\n                                    busyFlagOn = false;\n                                    customState.events.isBusy.next(false);\n                                }\n                                return [2 /*return*/];\n                        }\n                    });\n                }); })];\n        });\n    });\n}\nexports.renderSuperposition = renderSuperposition;\nfunction getLigandNamesFromModelData(plugin, state, modelRef) {\n    var _a;\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var cell, model, structures, _i, _b, s, structure, info;\n        return tslib_1.__generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    cell = state.select(modelRef)[0];\n                    if (!cell || !cell.obj)\n                        return [2 /*return*/, void 0];\n                    model = cell.obj.data;\n                    if (!model)\n                        return [2 /*return*/];\n                    structures = [];\n                    for (_i = 0, _b = plugin.managers.structure.hierarchy.selection.structures; _i < _b.length; _i++) {\n                        s = _b[_i];\n                        structure = (_a = s.cell.obj) === null || _a === void 0 ? void 0 : _a.data;\n                        if (structure)\n                            structures.push(structure);\n                    }\n                    return [4 /*yield*/, helpers_1.ModelInfo.get(model, structures)];\n                case 1:\n                    info = _c.sent();\n                    return [2 /*return*/, info];\n            }\n        });\n    });\n}\nfunction loadStructure(plugin, url, format, isBinary) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var data, trajectory, model, modelProperties, structure, e_4;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 7, , 8]);\n                    return [4 /*yield*/, plugin.builders.data.download({ url: assets_1.Asset.Url(url), isBinary: isBinary })];\n                case 1:\n                    data = _a.sent();\n                    return [4 /*yield*/, plugin.builders.structure.parseTrajectory(data, format)];\n                case 2:\n                    trajectory = _a.sent();\n                    return [4 /*yield*/, plugin.builders.structure.createModel(trajectory)];\n                case 3:\n                    model = _a.sent();\n                    return [4 /*yield*/, plugin.builders.structure.insertModelProperties(model)];\n                case 4:\n                    modelProperties = _a.sent();\n                    return [4 /*yield*/, plugin.builders.structure.createStructure(modelProperties || model, { name: 'model', params: {} })];\n                case 5:\n                    structure = _a.sent();\n                    return [4 /*yield*/, plugin.builders.structure.insertStructureProperties(structure)];\n                case 6:\n                    _a.sent();\n                    return [2 /*return*/, { data: data, trajectory: trajectory, model: model, structure: structure }];\n                case 7:\n                    e_4 = _a.sent();\n                    return [2 /*return*/, { structure: void 0 }];\n                case 8: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction chainSelection(struct_asym_id) {\n    return builder_1.MolScriptBuilder.struct.generator.atomGroups({\n        'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.label_asym_id(), struct_asym_id])\n    });\n}\nfunction transform(plugin, s, matrix) {\n    var b = plugin.state.data.build().to(s)\n        .insert(transforms_1.StateTransforms.Model.TransformStructureConformation, { transform: { name: 'matrix', params: { data: matrix, transpose: false } } });\n    return plugin.runTask(plugin.state.data.updateTree(b));\n}\nfunction afTransform(plugin, s, matrix, coordinateSystem) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var r, o, transform, params, b;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    r = mol_state_1.StateObjectRef.resolveAndCheck(plugin.state.data, s);\n                    if (!r)\n                        return [2 /*return*/];\n                    o = plugin.state.data.selectQ(function (q) { return q.byRef(r.transform.ref).subtree().withTransformer(transforms_1.StateTransforms.Model.TransformStructureConformation); })[0];\n                    transform = coordinateSystem && !linear_algebra_1.Mat4.isIdentity(coordinateSystem.matrix)\n                        ? linear_algebra_1.Mat4.mul((0, linear_algebra_1.Mat4)(), coordinateSystem.matrix, matrix)\n                        : matrix;\n                    params = {\n                        transform: {\n                            name: 'matrix',\n                            params: { data: transform, transpose: false }\n                        }\n                    };\n                    b = o\n                        ? plugin.state.data.build().to(o).update(params)\n                        : plugin.state.data.build().to(s)\n                            .insert(transforms_1.StateTransforms.Model.TransformStructureConformation, params, { tags: 'SuperpositionTransform' });\n                    return [4 /*yield*/, plugin.runTask(plugin.state.data.updateTree(b))];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction getMatrixData(plugin) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, matrixAccession, clusterRecUrlStr, assetManager, clusterRecUrl, clusterRecData, e_5;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    customState = plugin.customState;\n                    matrixAccession = customState.initParams.superpositionParams.matrixAccession ? customState.initParams.superpositionParams.matrixAccession : customState.initParams.moleculeId;\n                    clusterRecUrlStr = \"\".concat(customState.initParams.pdbeUrl, \"static/superpose/matrices/\").concat(matrixAccession);\n                    assetManager = plugin.managers.asset;\n                    clusterRecUrl = assets_1.Asset.getUrlAsset(assetManager, clusterRecUrlStr);\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, plugin.runTask(assetManager.resolve(clusterRecUrl, 'json', false))];\n                case 2:\n                    clusterRecData = _a.sent();\n                    if (clusterRecData && clusterRecData.data) {\n                        plugin.customState.superpositionState.matrixData = clusterRecData.data;\n                    }\n                    return [3 /*break*/, 4];\n                case 3:\n                    e_5 = _a.sent();\n                    customState['superpositionError'] = \"Matrix data not available for \".concat(matrixAccession);\n                    plugin.customState.events.superpositionInit.next(true); // Emit segment API data load event\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction getSegmentData(plugin) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, segmentsUrl, assetManager, url, result, e_6;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    customState = plugin.customState;\n                    segmentsUrl = \"\".concat(customState.initParams.pdbeUrl, \"graph-api/uniprot/superposition/\").concat(customState.initParams.moleculeId);\n                    assetManager = plugin.managers.asset;\n                    url = assets_1.Asset.getUrlAsset(assetManager, segmentsUrl);\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, plugin.runTask(assetManager.resolve(url, 'json', false))];\n                case 2:\n                    result = _a.sent();\n                    if (result && result.data) {\n                        customState.superpositionState.segmentData = result.data[customState.initParams.moleculeId];\n                    }\n                    return [3 /*break*/, 4];\n                case 3:\n                    e_6 = _a.sent();\n                    customState['superpositionError'] = \"Superposition data not available for \".concat(customState.initParams.moleculeId);\n                    plugin.customState.events.superpositionInit.next(true); // Emit segment API data load event\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nfunction getChainLigands(carbEntity) {\n    var ligandChain = [];\n    var ligandLabels = [];\n    var ligands = [];\n    var labelValueArr = [];\n    var ligNameStr = '';\n    for (var _i = 0, _a = carbEntity.chem_comp_list; _i < _a.length; _i++) {\n        var chemComp = _a[_i];\n        labelValueArr.push(\"\".concat(chemComp.chem_comp_id, \" (\").concat(chemComp.count, \")\"));\n    }\n    ligNameStr = labelValueArr.join(', ');\n    for (var _b = 0, _c = carbEntity.chains; _b < _c.length; _b++) {\n        var chain = _c[_b];\n        ligandChain.push(chain.chain_id);\n        ligandLabels.push(ligNameStr);\n        var chainLigands = [];\n        for (var _d = 0, _e = chain.residues; _d < _e.length; _d++) {\n            var residue = _e[_d];\n            chainLigands.push(residue.chem_comp_id + '-' + residue.residue_number);\n        }\n        ligands.push(chainLigands);\n    }\n    return {\n        ligands: ligands,\n        ligandChain: ligandChain,\n        ligandLabels: ligandLabels\n    };\n}\nfunction getCarbPolymerDetailsFromApi(plugin, pdb_id) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var customState, apiUrl, assetManager, url, branchedLigands, branchedChains, branchedlabels, result, carbEntities, _i, carbEntities_1, carbEntity, carbLigData, e_7;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    customState = plugin.customState;\n                    apiUrl = \"\".concat(customState.initParams.pdbeUrl, \"api/pdb/entry/carbohydrate_polymer/\").concat(pdb_id);\n                    assetManager = plugin.managers.asset;\n                    url = assets_1.Asset.getUrlAsset(assetManager, apiUrl);\n                    branchedLigands = [];\n                    branchedChains = [];\n                    branchedlabels = [];\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, plugin.runTask(assetManager.resolve(url, 'json', false))];\n                case 2:\n                    result = _a.sent();\n                    if (result && result.data) {\n                        carbEntities = result.data[pdb_id];\n                        for (_i = 0, carbEntities_1 = carbEntities; _i < carbEntities_1.length; _i++) {\n                            carbEntity = carbEntities_1[_i];\n                            carbLigData = getChainLigands(carbEntity);\n                            branchedLigands = branchedLigands.concat(carbLigData.ligands);\n                            branchedChains = branchedChains.concat(carbLigData.ligandChain);\n                            branchedlabels = branchedlabels.concat(carbLigData.ligandLabels);\n                        }\n                    }\n                    return [3 /*break*/, 4];\n                case 3:\n                    e_7 = _a.sent();\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/, {\n                        branchedChains: branchedChains,\n                        branchedLigands: branchedLigands,\n                        branchedlabels: branchedlabels\n                    }];\n            }\n        });\n    });\n}\n//# sourceMappingURL=superposition.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBO0FBQ0E7QUFDQSxvRUFBb0UsNEJBQTRCO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3BkYmUtbW9sc3Rhci8uL2xpYi9zdXBlcnBvc2l0aW9uLmpzPzI2MDYiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnJlbmRlclN1cGVycG9zaXRpb24gPSBleHBvcnRzLnN1cGVycG9zZUFmID0gZXhwb3J0cy5sb2FkQWZTdHJ1Y3R1cmUgPSBleHBvcnRzLmluaXRTdXBlcnBvc2l0aW9uID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIgbGluZWFyX2FsZ2VicmFfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1tYXRoL2xpbmVhci1hbGdlYnJhXCIpO1xudmFyIGJ1aWxkZXJfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1zY3JpcHQvbGFuZ3VhZ2UvYnVpbGRlclwiKTtcbnZhciBtb2xfc3RhdGVfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1zdGF0ZVwiKTtcbnZhciB0cmFuc2Zvcm1zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL3RyYW5zZm9ybXNcIik7XG52YXIgYXNzZXRzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9hc3NldHNcIik7XG52YXIgaGVscGVyc18xID0gcmVxdWlyZShcIi4vaGVscGVyc1wiKTtcbnZhciBsaXN0c18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvY29sb3IvbGlzdHNcIik7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC11dGlsL2NvbG9yL2NvbG9yXCIpO1xudmFyIHNjcmlwdF8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXNjcmlwdC9zY3JpcHRcIik7XG52YXIgbW9sX3Rhc2tfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC10YXNrXCIpO1xudmFyIHN1cGVycG9zaXRpb25fc2lmdHNfbWFwcGluZ18xID0gcmVxdWlyZShcIi4vc3VwZXJwb3NpdGlvbi1zaWZ0cy1tYXBwaW5nXCIpO1xudmFyIGFscGhhZm9sZF90cmFuc3BhcmVuY3lfMSA9IHJlcXVpcmUoXCIuL2FscGhhZm9sZC10cmFuc3BhcmVuY3lcIik7XG52YXIgc3RydWN0dXJlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtbW9kZWwvc3RydWN0dXJlXCIpO1xuZnVuY3Rpb24gZ2V0UmFuZG9tQ29sb3IocGx1Z2luLCBzZWdtZW50SW5kZXgpIHtcbiAgICB2YXIgY2xMaXN0ID0gbGlzdHNfMS5Db2xvckxpc3RzO1xuICAgIHZhciBzcFN0YXRlID0gcGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICB2YXIgcGFsbGV0ZUluZGV4ID0gc3BTdGF0ZS5jb2xvclN0YXRlW3NlZ21lbnRJbmRleF0ucGFsbGV0ZUluZGV4O1xuICAgIHZhciBjb2xvckluZGV4ID0gc3BTdGF0ZS5jb2xvclN0YXRlW3NlZ21lbnRJbmRleF0uY29sb3JJbmRleDtcbiAgICBpZiAoY2xMaXN0W3NwU3RhdGUuY29sb3JQYWxldHRlW3BhbGxldGVJbmRleF1dLmxpc3RbY29sb3JJbmRleCArIDFdKSB7XG4gICAgICAgIGNvbG9ySW5kZXggKz0gMTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbG9ySW5kZXggPSAwO1xuICAgICAgICBwYWxsZXRlSW5kZXggPSBzcFN0YXRlLmNvbG9yUGFsZXR0ZVtwYWxsZXRlSW5kZXggKyAxXSA/IHBhbGxldGVJbmRleCArIDEgOiAwO1xuICAgIH1cbiAgICB2YXIgcGFsbGV0ZU5hbWUgPSBzcFN0YXRlLmNvbG9yUGFsZXR0ZVtwYWxsZXRlSW5kZXhdO1xuICAgIHBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuY29sb3JTdGF0ZVtzZWdtZW50SW5kZXhdLnBhbGxldGVJbmRleCA9IHBhbGxldGVJbmRleDtcbiAgICBwbHVnaW4uY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmNvbG9yU3RhdGVbc2VnbWVudEluZGV4XS5jb2xvckluZGV4ID0gY29sb3JJbmRleDtcbiAgICByZXR1cm4gY2xMaXN0W3BhbGxldGVOYW1lXS5saXN0W2NvbG9ySW5kZXhdO1xufVxuZnVuY3Rpb24gaW5pdFN1cGVycG9zaXRpb24ocGx1Z2luKSB7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdXN0b21TdGF0ZSwgc3VwZXJwb3NpdGlvblBhcmFtcywgc2VnbWVudERhdGEsIGFmU3RyVXJscywgc2VnbWVudEluZGV4LCBjbHVzdGVySW5kZXhzLCBlbnRyeUxpc3QsIGNsdXN0ZXJzO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5jbGVhcigpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUgPSBwbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgIHN1cGVycG9zaXRpb25QYXJhbXMgPSBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnN1cGVycG9zaXRpb25QYXJhbXM7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbHM6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW50cmllczoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICByZWZNYXBzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlZ21lbnREYXRhOiB2b2lkIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXhEYXRhOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZVNlZ21lbnQ6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWRTdHJ1Y3RzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGVSZWZzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWRTdHJ1Y3Q6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgbm9NYXRyaXhTdHJ1Y3Q6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGV0czoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvclBhbGV0dGU6IFsnZGFyay0yJywgJ3JlZC15ZWxsb3ctZ3JlZW4nLCAncGFpcmVkJywgJ3NldC0xJywgJ2FjY2VudCcsICdzZXQtMicsICdyYWluYm93J10sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvclN0YXRlOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhZm9sZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaURhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2lmOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFlOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFjZU9ubHk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm1zZHM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVTeXN0ZW1zOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgc2VnbWVudCBhbmQgY2x1c3RlciBpbmZvcm1hdGlvbiBmb3IgdGhlIGdpdmVuIHVuaXByb3QgYWNjZXNzaW9uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGdldFNlZ21lbnREYXRhKHBsdWdpbildO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHNlZ21lbnQgYW5kIGNsdXN0ZXIgaW5mb3JtYXRpb24gZm9yIHRoZSBnaXZlbiB1bmlwcm90IGFjY2Vzc2lvblxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnREYXRhID0gcGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWdtZW50RGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9hZCBNYXRyaXggRGF0YVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBnZXRNYXRyaXhEYXRhKHBsdWdpbildO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9hZCBNYXRyaXggRGF0YVxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZ2V0QWZVcmwocGx1Z2luLCBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLm1vbGVjdWxlSWQpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIGFmU3RyVXJscyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFmU3RyVXJscylcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQuYXBpRGF0YSA9IGFmU3RyVXJscztcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudERhdGEuZm9yRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmxvYWRlZFN0cnVjdHMucHVzaChbXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLnZpc2libGVSZWZzLnB1c2goW10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5jb2xvclN0YXRlLnB1c2goeyBwYWxsZXRlSW5kZXg6IDAsIGNvbG9ySW5kZXg6IC0xIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudEluZGV4ID0gKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5zZWdtZW50KSA/IHN1cGVycG9zaXRpb25QYXJhbXMuc2VnbWVudCAtIDEgOiAwO1xuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmFjdGl2ZVNlZ21lbnQgPSBzZWdtZW50SW5kZXggKyAxO1xuICAgICAgICAgICAgICAgICAgICBjbHVzdGVySW5kZXhzID0gKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5jbHVzdGVyKSA/IHN1cGVycG9zaXRpb25QYXJhbXMuY2x1c3RlciA6IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgLy8gRW1pdCBzZWdtZW50IEFQSSBkYXRhIGxvYWQgZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmN1c3RvbVN0YXRlLmV2ZW50cy5zdXBlcnBvc2l0aW9uSW5pdC5uZXh0KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBlbnRyeUxpc3QgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgY2x1c3RlcnMgPSBzZWdtZW50RGF0YVtzZWdtZW50SW5kZXhdLmNsdXN0ZXJzO1xuICAgICAgICAgICAgICAgICAgICBjbHVzdGVycy5mb3JFYWNoKGZ1bmN0aW9uIChjbHVzdGVyLCBjbHVzdGVySW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFZhbGlkYXRlIGZvciBjbHVzdGVyIGluZGV4IGlmIHByb3ZpZGVkIGluIHN1cGVyUG9zaXRpb25QYXJhbXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbHVzdGVySW5kZXhzICYmIGNsdXN0ZXJJbmRleHMuaW5kZXhPZihjbHVzdGVySW5kZXgpID09PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgcmVzcHJlc2VudGF0aXZlIHN0cnVjdHVyZSB0byB0aGUgbGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5zdXBlcnBvc2VBbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyeUxpc3QgPSBlbnRyeUxpc3QuY29uY2F0KGNsdXN0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnlMaXN0LnB1c2goY2x1c3RlclswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZW5kZXJTdXBlcnBvc2l0aW9uKHBsdWdpbiwgc2VnbWVudEluZGV4LCBlbnRyeUxpc3QpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuaW5pdFN1cGVycG9zaXRpb24gPSBpbml0U3VwZXJwb3NpdGlvbjtcbmZ1bmN0aW9uIGNyZWF0ZUNhcmJWaXNMYWJlbChjYXJiTGlnTmFtZXNBbmRDb3VudCkge1xuICAgIHZhciBjb21wTGlzdCA9IFtdO1xuICAgIGZvciAodmFyIGNhcmJDb21wSWQgaW4gY2FyYkxpZ05hbWVzQW5kQ291bnQpIHtcbiAgICAgICAgY29tcExpc3QucHVzaChcIlwiLmNvbmNhdChjYXJiQ29tcElkLCBcIiAoXCIpLmNvbmNhdChjYXJiTGlnTmFtZXNBbmRDb3VudFtjYXJiQ29tcElkXSwgXCIpXCIpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBMaXN0LmpvaW4oJywgJyk7XG59XG5mdW5jdGlvbiBnZXRBZlVybChwbHVnaW4sIGFjY2Vzc2lvbikge1xuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXBpUmVzcG9uc2UsIGFwaURhdGE7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLnJ1blRhc2sobW9sX3Rhc2tfMS5UYXNrLmNyZWF0ZSgnR2V0IEFscGhhRm9sZCBVUkwnLCBmdW5jdGlvbiAoY3R4KSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlXzE7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgMiwgLCAzXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBwbHVnaW4uZmV0Y2goeyB1cmw6IFwiaHR0cHM6Ly9hbHBoYWZvbGQuZWJpLmFjLnVrL2FwaS9wcmVkaWN0aW9uL1wiLmNvbmNhdChhY2Nlc3Npb24pLCB0eXBlOiAnanNvbicgfSkucnVuSW5Db250ZXh0KGN0eCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGlSZXNwb25zZSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhcGlSZXNwb25zZSAmJiAoYXBpUmVzcG9uc2UgPT09IG51bGwgfHwgYXBpUmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFwaVJlc3BvbnNlWzBdLmJjaWZVcmwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpRGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2lmOiBhcGlSZXNwb25zZSA9PT0gbnVsbCB8fCBhcGlSZXNwb25zZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXBpUmVzcG9uc2VbMF0uY2lmVXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWU6IGFwaVJlc3BvbnNlID09PSBudWxsIHx8IGFwaVJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhcGlSZXNwb25zZVswXS5wYWVJbWFnZVVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiBhcGlSZXNwb25zZSA9PT0gbnVsbCB8fCBhcGlSZXNwb25zZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXBpUmVzcG9uc2VbMF0udW5pcHJvdEVuZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTsgfSkpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGFwaURhdGFdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGxvYWRBZlN0cnVjdHVyZShwbHVnaW4pIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlLCBzdHJ1Y3R1cmUsIHN0ckluc3RhbmNlLCBzcFN0YXRlLCBjaGFpblNlbDtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZSA9IHBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgbG9hZFN0cnVjdHVyZShwbHVnaW4sIGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQuYXBpRGF0YS5jaWYsICdtbWNpZicsIGZhbHNlKV07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmUgPSAoX2Euc2VudCgpKS5zdHJ1Y3R1cmU7XG4gICAgICAgICAgICAgICAgICAgIHN0ckluc3RhbmNlID0gc3RydWN0dXJlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXN0ckluc3RhbmNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGZhbHNlXTtcbiAgICAgICAgICAgICAgICAgICAgc3BTdGF0ZSA9IHBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgIHNwU3RhdGUuYWxwaGFmb2xkLnJlZiA9IHN0ckluc3RhbmNlID09PSBudWxsIHx8IHN0ckluc3RhbmNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHJJbnN0YW5jZS5yZWY7XG4gICAgICAgICAgICAgICAgICAgIHNwU3RhdGUubW9kZWxzW1wiQUYtXCIuY29uY2F0KGN1c3RvbVN0YXRlLmluaXRQYXJhbXMubW9sZWN1bGVJZCldID0gc3RySW5zdGFuY2UgPT09IG51bGwgfHwgc3RySW5zdGFuY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0ckluc3RhbmNlLnJlZjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS50cnlDcmVhdGVDb21wb25lbnRTdGF0aWMoc3RySW5zdGFuY2UsICdwb2x5bWVyJywgeyBsYWJlbDogXCJBbHBoYUZvbGQgU3RydWN0dXJlXCIsIHRhZ3M6IFtcImFscGhhZm9sZC1jaGFpblwiLCBcInN1cGVycG9zaXRpb24tc2VsXCJdIH0pXTtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGNoYWluU2VsID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoYWluU2VsKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS5yZXByZXNlbnRhdGlvbi5hZGRSZXByZXNlbnRhdGlvbihjaGFpblNlbCwgeyB0eXBlOiAncHV0dHknLCBjb2xvcjogJ3BsZGR0LWNvbmZpZGVuY2UnLCBzaXplOiAndW5pZm9ybScsIHNpemVQYXJhbXM6IHsgdmFsdWU6IDEuNSB9IH0sIHsgdGFnOiBcImFmLXN1cGVycG9zaXRpb24tdmlzdWFsXCIgfSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgc3RySW5zdGFuY2UgPT09IG51bGwgfHwgc3RySW5zdGFuY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0ckluc3RhbmNlLnJlZl07XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgZmFsc2VdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMubG9hZEFmU3RydWN0dXJlID0gbG9hZEFmU3RydWN0dXJlO1xuZnVuY3Rpb24gc3VwZXJwb3NlQWYocGx1Z2luLCB0cmFjZU9ubHksIHNlZ21lbnRJbmRleCkge1xuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VzdG9tU3RhdGUsIHNwU3RhdGUsIGFmU3RyUmVmLCBfYSwgYWZTdHIsIHNlZ21lbnROdW0sIG1hcHBpbmdSZXN1bHRfMSwgY29vcmRpbmF0ZVN5c3RlbXNfMSwgZmFpbGVkUGFpcnNSZXN1bHRfMSwgemVyb092ZXJsYXBQYWlyc1Jlc3VsdF8xLCBtaW5SbXNkXzEsIG1pbkluZGV4XzEsIHJtc2RMaXN0XzEsIHNlZ21lbnRDbHVzdGVycztcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZSA9IHBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUgfHwgIWN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgc3BTdGF0ZSA9IGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBzcFN0YXRlLmFscGhhZm9sZC5yZWY7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfYSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGxvYWRBZlN0cnVjdHVyZShwbHVnaW4pXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hID0gKF9iLnNlbnQoKSk7XG4gICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGFmU3RyUmVmID0gX2E7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYWZTdHJSZWYpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGFmU3RyID0gcGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudC5yZWZzLmdldChhZlN0clJlZik7XG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnROdW0gPSBzZWdtZW50SW5kZXggPyBzZWdtZW50SW5kZXggOiBzcFN0YXRlLmFjdGl2ZVNlZ21lbnQgLSAxO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNwU3RhdGUuYWxwaGFmb2xkLnRyYW5zZm9ybXNbc2VnbWVudE51bV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBpbmdSZXN1bHRfMSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29vcmRpbmF0ZVN5c3RlbXNfMSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkUGFpcnNSZXN1bHRfMSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgemVyb092ZXJsYXBQYWlyc1Jlc3VsdF8xID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBtaW5SbXNkXzEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWluSW5kZXhfMSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBybXNkTGlzdF8xID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWdtZW50Q2x1c3RlcnMgPSBzcFN0YXRlLnNlZ21lbnREYXRhW3NlZ21lbnROdW1dLmNsdXN0ZXJzO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudENsdXN0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGNsdXN0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZWxSZWYgPSBzcFN0YXRlLm1vZGVsc1tcIlwiLmNvbmNhdChjbHVzdGVyWzBdLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChjbHVzdGVyWzBdLnN0cnVjdF9hc3ltX2lkKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsUmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHJ1Y3RIaWVyYXJjaHkgPSBwbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnJlZnMuZ2V0KG1vZGVsUmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0cnVjdEhpZXJhcmNoeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gW3N0cnVjdEhpZXJhcmNoeSwgYWZTdHJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cnVjdHVyZXMgPSBpbnB1dC5tYXAoZnVuY3Rpb24gKHMpIHsgdmFyIF9hOyByZXR1cm4gKF9hID0gcy5jZWxsLm9iaikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhdGE7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9kID0gKDAsIHN1cGVycG9zaXRpb25fc2lmdHNfbWFwcGluZ18xLmFsaWduQW5kU3VwZXJwb3NlV2l0aFNJRlRTTWFwcGluZykoc3RydWN0dXJlcywgeyB0cmFjZU9ubHk6IHRyYWNlT25seSwgaW5jbHVkZVJlc2lkdWVUZXN0OiBmdW5jdGlvbiAobG9jKSB7IHJldHVybiBzdHJ1Y3R1cmVfMS5TdHJ1Y3R1cmVQcm9wZXJ0aWVzLmF0b20uQl9pc29fb3JfZXF1aXYobG9jKSA+IDcwOyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGx5VGVzdEluZGV4OiBbMV0gfSksIGVudHJpZXMgPSBfZC5lbnRyaWVzLCBmYWlsZWRQYWlycyA9IF9kLmZhaWxlZFBhaXJzLCB6ZXJvT3ZlcmxhcFBhaXJzID0gX2QuemVyb092ZXJsYXBQYWlycztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCA9PT0gMCB8fCAoZW50cmllcyAmJiBlbnRyaWVzWzBdICYmIGVudHJpZXNbMF0udHJhbnNmb3JtLnJtc2QudG9GaXhlZCgxKSA9PT0gJzAuMCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFsaWduV2l0aG91dFBsZGR0ID0gKDAsIHN1cGVycG9zaXRpb25fc2lmdHNfbWFwcGluZ18xLmFsaWduQW5kU3VwZXJwb3NlV2l0aFNJRlRTTWFwcGluZykoc3RydWN0dXJlcywgeyB0cmFjZU9ubHk6IHRyYWNlT25seSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnRyaWVzID0gYWxpZ25XaXRob3V0UGxkZHQuZW50cmllcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbnRyaWVzICYmIGVudHJpZXNbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwaW5nUmVzdWx0XzEucHVzaChlbnRyaWVzWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlU3lzdGVtc18xLnB1c2goKF9jID0gKF9iID0gKF9hID0gaW5wdXRbMF0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50cmFuc2Zvcm0pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jZWxsLm9iaikgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmRhdGEuY29vcmRpbmF0ZVN5c3RlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvdGFsTWFwcGluZ3MgPSBtYXBwaW5nUmVzdWx0XzEubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbE1hcHBpbmdzID09PSAxIHx8IGVudHJpZXNbMF0udHJhbnNmb3JtLnJtc2QgPCBtaW5SbXNkXzEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluUm1zZF8xID0gZW50cmllc1swXS50cmFuc2Zvcm0ucm1zZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluSW5kZXhfMSA9IHRvdGFsTWFwcGluZ3MgPT09IDEgPyAwIDogbWFwcGluZ1Jlc3VsdF8xLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJtc2RMaXN0XzEucHVzaChcIlwiLmNvbmNhdChjbHVzdGVyWzBdLnBkYl9pZCwgXCIgY2hhaW4gXCIpLmNvbmNhdChjbHVzdGVyWzBdLnN0cnVjdF9hc3ltX2lkLCBcIjpcIikuY29uY2F0KGVudHJpZXNbMF0udHJhbnNmb3JtLnJtc2QudG9GaXhlZCgyKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZhaWxlZFBhaXJzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxlZFBhaXJzUmVzdWx0XzEucHVzaChmYWlsZWRQYWlycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHplcm9PdmVybGFwUGFpcnMubGVuZ3RoID4gMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemVyb092ZXJsYXBQYWlyc1Jlc3VsdF8xLnB1c2goemVyb092ZXJsYXBQYWlycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcm1zZExpc3QucHVzaChgJHtjbHVzdGVyWzBdLnBkYl9pZH0gJHtjbHVzdGVyWzBdLnN0cnVjdF9hc3ltX2lkfTotYClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZmFpbGVkUGFpcnNSZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coemVyb092ZXJsYXBQYWlyc1Jlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFwcGluZ1Jlc3VsdF8xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlLmFscGhhZm9sZC52aXNpYmlsaXR5W3NlZ21lbnROdW1dID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlLmFscGhhZm9sZC50cmFuc2Zvcm1zW3NlZ21lbnROdW1dID0gbWFwcGluZ1Jlc3VsdF8xW21pbkluZGV4XzFdLnRyYW5zZm9ybS5iVHJhbnNmb3JtO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwU3RhdGUuYWxwaGFmb2xkLmNvb3JkaW5hdGVTeXN0ZW1zW3NlZ21lbnROdW1dID0gY29vcmRpbmF0ZVN5c3RlbXNfMVttaW5JbmRleF8xXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlLmFscGhhZm9sZC5ybXNkc1tzZWdtZW50TnVtXSA9IHJtc2RMaXN0XzEuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gcGFyc2VGbG9hdChhLnNwbGl0KCc6JylbMV0pIC0gcGFyc2VGbG9hdChiLnNwbGl0KCc6JylbMV0pOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBhZlRyYW5zZm9ybShwbHVnaW4sIGFmU3RyLmNlbGwsIHNwU3RhdGUuYWxwaGFmb2xkLnRyYW5zZm9ybXNbc2VnbWVudE51bV0sIHNwU3RhdGUuYWxwaGFmb2xkLmNvb3JkaW5hdGVTeXN0ZW1zW3NlZ21lbnROdW1dKV07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICgwLCBhbHBoYWZvbGRfdHJhbnNwYXJlbmN5XzEuYXBwbHlBRlRyYW5zcGFyZW5jeSkocGx1Z2luLCBhZlN0ciwgMC44LCA3MCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0cnVlXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLnN1cGVycG9zZUFmID0gc3VwZXJwb3NlQWY7XG5mdW5jdGlvbiByZW5kZXJTdXBlcnBvc2l0aW9uKHBsdWdpbiwgc2VnbWVudEluZGV4LCBlbnRyeUxpc3QpIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlLCBzdXBlcnBvc2l0aW9uUGFyYW1zLCBidXN5RmxhZ09uO1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIGN1c3RvbVN0YXRlID0gcGx1Z2luLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgc3VwZXJwb3NpdGlvblBhcmFtcyA9IGN1c3RvbVN0YXRlLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvblBhcmFtcztcbiAgICAgICAgICAgIGJ1c3lGbGFnT24gPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChlbnRyeUxpc3QubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGJ1c3lGbGFnT24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3kubmV4dCh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIExvYWQgQ29vcmRpbmF0ZXMgYW5kIHJlbmRlciByZXNwcmVzZW50YXRpb25zXG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgcGx1Z2luLmRhdGFUcmFuc2FjdGlvbihmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwU3RhdGUsIF9hLCBlbnRyeUxpc3RfMSwgZW50cnlMaXN0XzFfMSwgcywgc3RyVXJsLCBzdHJJbnN0YW5jZSwgbW9kZWxSZWYsIGNsZWFyT25GYWlsLCBwb2x5bWVySW5zdGFuY2UsIG1vZGVsSW5zdGFuY2UsIGlzQmluYXJ5LCBfYiwgbW9kZWwsIHN0cnVjdHVyZSwgbWF0cml4LCBjaGFpblNlbCwgdW5pZm9ybUNvbG9yMSwgdW5pZm9ybUNvbG9yMiwgaW52YWxpZFN0cnVjdCwgc3RhdGUsIGhldEluZm8sIGhldHMsIF9jLCBoZXRzXzEsIGhldHNfMV8xLCBoZXQsIGxpZ2FuZCwgbGFiZWxUYWdQYXJhbXMsIGhldENvbG9yLCBfZCwgciwgZywgYiwgbGlnYW5kRXhwLCBlXzJfMSwgY2FyYkVudGl0eUNvdW50LCBhbGxDYXJiUG9seW1lcnMsIHBvbHltZXJDaGFpbldpdGhTdXJyb3VuZGluZ3MsIGksIF9pLCBfZSwgY2FyYkVudGl0eUNoYWluSWQsIGNhcmJFbnRpdHlDaGFpbiwgY2FyYkVudGl0eUNoYWluSW5WaWNpbml0eSwgZGF0YSwgY2FyYkNoYWluU2VsLCBjYXJiTGlnYW5kcywgY2FyYkxpZ05hbWVzQW5kQ291bnQsIGNhcmJMaWdMaXN0LCBfZiwgX2csIGNhcmJMaWdzLCBsaWdSZXNEZXRhaWxzLCBjYXJiVmlzTGFiZWwsIGJyYW5jaGVkRW50aXR5LCBsYWJlbFRhZ1BhcmFtcywgbGlnYW5kRXhwLCBsb2FkZWRTdHJ1Y3RJbmRleCwgZV8zXzE7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfaCwgZV8zLCBfaiwgX2ssIF9sLCBlXzIsIF9tLCBfbztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9wLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlID0gcGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AudHJ5cy5wdXNoKFsxLCA0NywgNDgsIDUzXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdHJ1ZSwgZW50cnlMaXN0XzEgPSB0c2xpYl8xLl9fYXN5bmNWYWx1ZXMoZW50cnlMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgZW50cnlMaXN0XzEubmV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGVudHJ5TGlzdF8xXzEgPSBfcC5zZW50KCksIF9oID0gZW50cnlMaXN0XzFfMS5kb25lLCAhX2gpKSByZXR1cm4gWzMgLypicmVhayovLCA0Nl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9rID0gZW50cnlMaXN0XzFfMS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AudHJ5cy5wdXNoKFs0LCAsIDQ0LCA0NV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gX2s7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhbGlkYXRlIG1hdHJpeCBhdmFpbGFiaWxpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzcFN0YXRlLm1hdHJpeERhdGFbXCJcIi5jb25jYXQocy5wZGJfaWQsIFwiX1wiKS5jb25jYXQocy5hdXRoX2FzeW1faWQpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BTdGF0ZS5ub01hdHJpeFN0cnVjdC5wdXNoKFwiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwU3RhdGUuaW52YWxpZFN0cnVjdC5wdXNoKFwiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDQ1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlLmxvYWRlZFN0cnVjdHNbc2VnbWVudEluZGV4XS5wdXNoKFwiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyVXJsID0gXCJcIi5jb25jYXQoY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5wZGJlVXJsLCBcIm1vZGVsLXNlcnZlci92MS9cIikuY29uY2F0KHMucGRiX2lkLCBcIi9hdG9tcz9hdXRoX2FzeW1faWQ9XCIpLmNvbmNhdChzLmF1dGhfYXN5bV9pZCwgXCImZW5jb2Rpbmc9XCIpLmNvbmNhdChjdXN0b21TdGF0ZS5pbml0UGFyYW1zLmVuY29kaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5saWdhbmRWaWV3KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyVXJsID0gXCJodHRwczovL3d3dy5lYmkuYWMudWsvcGRiZS9lbnRyeS1maWxlcy9kb3dubG9hZC9cIi5jb25jYXQocy5wZGJfaWQsIFwiLmJjaWZcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ckluc3RhbmNlID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbFJlZiA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJPbkZhaWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShzdXBlcnBvc2l0aW9uUGFyYW1zICYmIHN1cGVycG9zaXRpb25QYXJhbXMubGlnYW5kVmlldyAmJiBzcFN0YXRlLmVudHJpZXNbcy5wZGJfaWRdKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvbHltZXJJbnN0YW5jZSA9IHBsdWdpbi5zdGF0ZS5kYXRhLnNlbGVjdChzcFN0YXRlLmVudHJpZXNbcy5wZGJfaWRdKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxSZWYgPSBwb2x5bWVySW5zdGFuY2UudHJhbnNmb3JtLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxJbnN0YW5jZSA9IHBsdWdpbi5zdGF0ZS5kYXRhLnNlbGVjdChtb2RlbFJlZilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUuY3JlYXRlU3RydWN0dXJlKG1vZGVsSW5zdGFuY2UsIHsgbmFtZTogJ21vZGVsJywgcGFyYW1zOiB7fSB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJJbnN0YW5jZSA9IF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJPbkZhaWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0JpbmFyeSA9IGN1c3RvbVN0YXRlLmluaXRQYXJhbXMuZW5jb2RpbmcgPT09ICdiY2lmJyA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgbG9hZFN0cnVjdHVyZShwbHVnaW4sIHN0clVybCwgJ21tY2lmJywgaXNCaW5hcnkpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gX3Auc2VudCgpLCBtb2RlbCA9IF9iLm1vZGVsLCBzdHJ1Y3R1cmUgPSBfYi5zdHJ1Y3R1cmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ckluc3RhbmNlID0gc3RydWN0dXJlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbFJlZiA9IG1vZGVsLnJlZjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSA4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdHJJbnN0YW5jZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDQ1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgUmVmcyBpbiBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNwU3RhdGUubW9kZWxzW1wiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwU3RhdGUubW9kZWxzW1wiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpXSA9IHN0ckluc3RhbmNlID09PSBudWxsIHx8IHN0ckluc3RhbmNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHJJbnN0YW5jZS5yZWY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdXBlcnBvc2l0aW9uUGFyYW1zICYmIHN1cGVycG9zaXRpb25QYXJhbXMubGlnYW5kVmlldyAmJiAhc3BTdGF0ZS5lbnRyaWVzW3MucGRiX2lkXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwU3RhdGUuZW50cmllc1tzLnBkYl9pZF0gPSBzdHJJbnN0YW5jZSA9PT0gbnVsbCB8fCBzdHJJbnN0YW5jZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RySW5zdGFuY2UucmVmO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRyaXggPSBsaW5lYXJfYWxnZWJyYV8xLk1hdDQub2ZSb3dzKHBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUubWF0cml4RGF0YVtcIlwiLmNvbmNhdChzLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChzLmF1dGhfYXN5bV9pZCldLm1hdHJpeCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRyYW5zZm9ybShwbHVnaW4sIHN0ckluc3RhbmNlLCBtYXRyaXgpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhaW5TZWwgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKChzdXBlcnBvc2l0aW9uUGFyYW1zICYmIHN1cGVycG9zaXRpb25QYXJhbXMubGlnYW5kVmlldykgJiYgcy5pc19yZXByZXNlbnRhdGl2ZSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDEzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pZm9ybUNvbG9yMSA9IGdldFJhbmRvbUNvbG9yKHBsdWdpbiwgc2VnbWVudEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS50cnlDcmVhdGVDb21wb25lbnRGcm9tRXhwcmVzc2lvbihzdHJJbnN0YW5jZSwgY2hhaW5TZWxlY3Rpb24ocy5zdHJ1Y3RfYXN5bV9pZCksIFwiQ2hhaW4tXCIuY29uY2F0KHNlZ21lbnRJbmRleCksIHsgbGFiZWw6IFwiQ2hhaW5cIiwgdGFnczogW1wic3VwZXJwb3NpdGlvbi1zZWxcIl0gfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluU2VsID0gX3Auc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNoYWluU2VsKSByZXR1cm4gWzMgLypicmVhayovLCAxMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24oY2hhaW5TZWwsIHsgdHlwZTogJ3B1dHR5JywgY29sb3I6ICd1bmlmb3JtJywgY29sb3JQYXJhbXM6IHsgdmFsdWU6IHVuaWZvcm1Db2xvcjEgfSwgc2l6ZTogJ3VuaWZvcm0nIH0sIHsgdGFnOiBcInN1cGVycG9zaXRpb24tdmlzdWFsXCIgfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BTdGF0ZS5yZWZNYXBzW2NoYWluU2VsLnJlZl0gPSBcIlwiLmNvbmNhdChzLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChzLnN0cnVjdF9hc3ltX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSAxMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzMgLypicmVhayovLCAxN107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5saWdhbmRWaWV3KSAmJiAhcy5pc19yZXByZXNlbnRhdGl2ZSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDE0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaWZvcm1Db2xvcjIgPSBnZXRSYW5kb21Db2xvcihwbHVnaW4sIHNlZ21lbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUudHJ5Q3JlYXRlQ29tcG9uZW50U3RhdGljKHN0ckluc3RhbmNlLCAncG9seW1lcicsIHsgbGFiZWw6IFwiQ2hhaW5cIiwgdGFnczogW1wiQ2hhaW4tXCIuY29uY2F0KHNlZ21lbnRJbmRleCksIFwic3VwZXJwb3NpdGlvbi1zZWxcIl0gfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluU2VsID0gX3Auc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNoYWluU2VsKSByZXR1cm4gWzMgLypicmVhayovLCAxN107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24oY2hhaW5TZWwsIHsgdHlwZTogJ3B1dHR5JywgY29sb3I6ICd1bmlmb3JtJywgY29sb3JQYXJhbXM6IHsgdmFsdWU6IHVuaWZvcm1Db2xvcjIgfSwgc2l6ZTogJ3VuaWZvcm0nIH0sIHsgdGFnOiBcInN1cGVycG9zaXRpb24tdmlzdWFsXCIgfSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BTdGF0ZS5yZWZNYXBzW2NoYWluU2VsLnJlZl0gPSBcIlwiLmNvbmNhdChzLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChzLnN0cnVjdF9hc3ltX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSAxNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkU3RydWN0ID0gY2hhaW5TZWwgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5saWdhbmRWaWV3KSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9IHBsdWdpbi5zdGF0ZS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBnZXRMaWdhbmROYW1lc0Zyb21Nb2RlbERhdGEocGx1Z2luLCBzdGF0ZSwgbW9kZWxSZWYpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXRJbmZvID0gX3Auc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZXRzID0gaGV0SW5mbyA/IGhldEluZm8uaGV0TmFtZXMgOiBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaGV0cyAmJiBoZXRzLmxlbmd0aCA+IDApKSByZXR1cm4gWzMgLypicmVhayovLCAzNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLmxhYmVsID0gMTk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AudHJ5cy5wdXNoKFsxOSwgMjksIDMwLCAzNV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYyA9IHRydWUsIGhldHNfMSA9IChlXzIgPSB2b2lkIDAsIHRzbGliXzEuX19hc3luY1ZhbHVlcyhoZXRzKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLmxhYmVsID0gMjA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyMDogcmV0dXJuIFs0IC8qeWllbGQqLywgaGV0c18xLm5leHQoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaGV0c18xXzEgPSBfcC5zZW50KCksIF9sID0gaGV0c18xXzEuZG9uZSwgIV9sKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMjhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbyA9IGhldHNfMV8xLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcC5sYWJlbCA9IDIyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLnRyeXMucHVzaChbMjIsICwgMjYsIDI3XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhldCA9IF9vO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWdhbmQgPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZ2VuZXJhdG9yLmF0b21Hcm91cHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYWluLXRlc3QnOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnJlbC5lcShbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5tYWNyb21vbGVjdWxhci5hdXRoX2FzeW1faWQoKSwgcy5hdXRoX2FzeW1faWRdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZXNpZHVlLXRlc3QnOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnJlbC5lcShbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5tYWNyb21vbGVjdWxhci5sYWJlbF9jb21wX2lkKCksIGhldF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dyb3VwLWJ5JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5zdHIuY29uY2F0KFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5LmNvcmUub3BlcmF0b3JOYW1lKCksIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIucmVzaWR1ZUtleSgpXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsVGFnUGFyYW1zID0geyBsYWJlbDogXCJcIi5jb25jYXQoaGV0KSwgdGFnczogW1wic3VwZXJwb3NpdGlvbi1saWdhbmQtc2VsXCJdIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhldENvbG9yID0gY29sb3JfMS5Db2xvci5mcm9tUmdiKDI1MywgMywgMjUzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5saWdhbmRDb2xvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSBzdXBlcnBvc2l0aW9uUGFyYW1zLmxpZ2FuZENvbG9yLCByID0gX2QuciwgZyA9IF9kLmcsIGIgPSBfZC5iO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGV0Q29sb3IgPSBjb2xvcl8xLkNvbG9yLmZyb21SZ2IociwgZywgYik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS50cnlDcmVhdGVDb21wb25lbnRGcm9tRXhwcmVzc2lvbihzdHJJbnN0YW5jZSwgbGlnYW5kLCBcIlwiLmNvbmNhdChoZXQsIFwiLVwiKS5jb25jYXQoc2VnbWVudEluZGV4KSwgbGFiZWxUYWdQYXJhbXMpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDIzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWdhbmRFeHAgPSBfcC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlnYW5kRXhwKSByZXR1cm4gWzMgLypicmVhayovLCAyNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24obGlnYW5kRXhwLCB7IHR5cGU6ICdiYWxsLWFuZC1zdGljaycsIGNvbG9yOiAndW5pZm9ybScsIGNvbG9yUGFyYW1zOiB7IHZhbHVlOiBoZXRDb2xvciB9IH0sIHsgdGFnOiBcInN1cGVycG9zaXRpb24tbGlnYW5kLXZpc3VhbFwiIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwU3RhdGUucmVmTWFwc1tsaWdhbmRFeHAucmVmXSA9IFwiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkU3RydWN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLmxhYmVsID0gMjU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyNTogcmV0dXJuIFszIC8qYnJlYWsqLywgMjddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI3OiByZXR1cm4gWzMgLypicmVhayovLCAyMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyODogcmV0dXJuIFszIC8qYnJlYWsqLywgMzVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMl8xID0gX3Auc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlXzIgPSB7IGVycm9yOiBlXzJfMSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AudHJ5cy5wdXNoKFszMCwgLCAzMywgMzRdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIV9jICYmICFfbCAmJiAoX20gPSBoZXRzXzEucmV0dXJuKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDMyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgX20uY2FsbChoZXRzXzEpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDMxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLmxhYmVsID0gMzI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMjogcmV0dXJuIFszIC8qYnJlYWsqLywgMzRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM0OiByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJFbnRpdHlDb3VudCA9IGhldEluZm8gPyBoZXRJbmZvLmNhcmJFbnRpdHlDb3VudCA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGNhcmJFbnRpdHlDb3VudCA+IDApKSByZXR1cm4gWzMgLypicmVhayovLCA0Ml07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGdldENhcmJQb2x5bWVyRGV0YWlsc0Zyb21BcGkocGx1Z2luLCBzLnBkYl9pZCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbENhcmJQb2x5bWVycyA9IF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9seW1lckNoYWluV2l0aFN1cnJvdW5kaW5ncyA9IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5tb2RpZmllci5pbmNsdWRlU3Vycm91bmRpbmdzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDA6IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5nZW5lcmF0b3IuYXRvbUdyb3Vwcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VudGl0eS10ZXN0JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmFtbXAoJ2VudGl0eVR5cGUnKSwgJ3BvbHltZXInXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYWluLXRlc3QnOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnJlbC5lcShbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5tYWNyb21vbGVjdWxhci5hdXRoX2FzeW1faWQoKSwgcy5hdXRoX2FzeW1faWRdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZ3JvdXAtYnknOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnN0ci5jb25jYXQoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkuY29yZS5vcGVyYXRvck5hbWUoKSwgYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5tYWNyb21vbGVjdWxhci5yZXNpZHVlS2V5KCldKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYXMtd2hvbGUtcmVzaWR1ZXMnOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2kgPSAwLCBfZSA9IGFsbENhcmJQb2x5bWVycy5icmFuY2hlZENoYWlucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSAzNztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IF9lLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDQyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyYkVudGl0eUNoYWluSWQgPSBfZVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJFbnRpdHlDaGFpbiA9IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5nZW5lcmF0b3IuYXRvbUdyb3Vwcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZW50aXR5LXRlc3QnOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnJlbC5lcShbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuYW1tcCgnZW50aXR5VHlwZScpLCAnYnJhbmNoZWQnXSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhaW4tdGVzdCc6IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmNvcmUucmVsLmVxKFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5Lm1hY3JvbW9sZWN1bGFyLmF1dGhfYXN5bV9pZCgpLCBjYXJiRW50aXR5Q2hhaW5JZF0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2dyb3VwLWJ5JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5zdHIuY29uY2F0KFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5LmNvcmUub3BlcmF0b3JOYW1lKCksIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIucmVzaWR1ZUtleSgpXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJFbnRpdHlDaGFpbkluVmljaW5pdHkgPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZmlsdGVyLmludGVyc2VjdGVkQnkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMDogcG9seW1lckNoYWluV2l0aFN1cnJvdW5kaW5ncyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ5OiBjYXJiRW50aXR5Q2hhaW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSAocGx1Z2luLnN0YXRlLmRhdGEuc2VsZWN0KHN0ckluc3RhbmNlLnJlZilbMF0ub2JqKS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJiQ2hhaW5TZWwgPSBzY3JpcHRfMS5TY3JpcHQuZ2V0U3RydWN0dXJlU2VsZWN0aW9uKGNhcmJFbnRpdHlDaGFpbkluVmljaW5pdHksIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShjYXJiQ2hhaW5TZWwgJiYgY2FyYkNoYWluU2VsLmtpbmQgPT09ICdzZXF1ZW5jZScpKSByZXR1cm4gWzMgLypicmVhayovLCA0MF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJMaWdhbmRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJMaWdOYW1lc0FuZENvdW50ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJMaWdMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2YgPSAwLCBfZyA9IGFsbENhcmJQb2x5bWVycy5icmFuY2hlZExpZ2FuZHNbaV07IF9mIDwgX2cubGVuZ3RoOyBfZisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJiTGlncyA9IF9nW19mXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpZ1Jlc0RldGFpbHMgPSBjYXJiTGlncy5zcGxpdCgnLScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyYkxpZ2FuZHMucHVzaChidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnJlbC5lcShbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5tYWNyb21vbGVjdWxhci5hdXRoX3NlcV9pZCgpLCArbGlnUmVzRGV0YWlsc1sxXV0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYXJiTGlnTmFtZXNBbmRDb3VudFtsaWdSZXNEZXRhaWxzWzBdXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJMaWdOYW1lc0FuZENvdW50W2xpZ1Jlc0RldGFpbHNbMF1dKys7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJiTGlnTmFtZXNBbmRDb3VudFtsaWdSZXNEZXRhaWxzWzBdXSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXJiTGlnTGlzdC5wdXNoKGxpZ1Jlc0RldGFpbHNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJWaXNMYWJlbCA9IGNyZWF0ZUNhcmJWaXNMYWJlbChjYXJiTGlnTmFtZXNBbmRDb3VudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyYW5jaGVkRW50aXR5ID0gYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmdlbmVyYXRvci5hdG9tR3JvdXBzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbnRpdHktdGVzdCc6IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmNvcmUucmVsLmVxKFtidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5hbW1wKCdlbnRpdHlUeXBlJyksICdicmFuY2hlZCddKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdncm91cC1ieSc6IGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLmNvcmUuc3RyLmNvbmNhdChbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5jb3JlLm9wZXJhdG9yTmFtZSgpLCBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuYXRvbVByb3BlcnR5Lm1hY3JvbW9sZWN1bGFyLnJlc2lkdWVLZXkoKV0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYWluLXRlc3QnOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLnJlbC5lcShbYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuc3RydWN0LmF0b21Qcm9wZXJ0eS5tYWNyb21vbGVjdWxhci5hdXRoX2FzeW1faWQoKSwgY2FyYkVudGl0eUNoYWluSWRdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZXNpZHVlLXRlc3QnOiBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5jb3JlLmxvZ2ljLm9yKGNhcmJMaWdhbmRzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxUYWdQYXJhbXMgPSB7IGxhYmVsOiBcIlwiLmNvbmNhdChjYXJiVmlzTGFiZWwpLCB0YWdzOiBbXCJzdXBlcnBvc2l0aW9uLWNhcmItc2VsXCJdIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUudHJ5Q3JlYXRlQ29tcG9uZW50RnJvbUV4cHJlc3Npb24oc3RySW5zdGFuY2UsIGJyYW5jaGVkRW50aXR5LCBcIlwiLmNvbmNhdChjYXJiTGlnTGlzdC5qb2luKCctJyksIFwiLVwiKS5jb25jYXQoc2VnbWVudEluZGV4KSwgbGFiZWxUYWdQYXJhbXMpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWdhbmRFeHAgPSBfcC5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlnYW5kRXhwKSByZXR1cm4gWzMgLypicmVhayovLCA0MF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24obGlnYW5kRXhwLCB7IHR5cGU6ICdjYXJib2h5ZHJhdGUnIH0sIHsgdGFnOiBcInN1cGVycG9zaXRpb24tY2FyYi12aXN1YWxcIiB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Auc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlLnJlZk1hcHNbbGlnYW5kRXhwLnJlZl0gPSBcIlwiLmNvbmNhdChzLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChzLnN0cnVjdF9hc3ltX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52YWxpZFN0cnVjdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcC5sYWJlbCA9IDQwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSA0MTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzN107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGludmFsaWRTdHJ1Y3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwU3RhdGUuaW52YWxpZFN0cnVjdC5wdXNoKFwiXCIuY29uY2F0KHMucGRiX2lkLCBcIl9cIikuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZFN0cnVjdEluZGV4ID0gc3BTdGF0ZS5sb2FkZWRTdHJ1Y3RzW3NlZ21lbnRJbmRleF0uaW5kZXhPZihcIlwiLmNvbmNhdChzLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChzLnN0cnVjdF9hc3ltX2lkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGVkU3RydWN0SW5kZXggPiAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcFN0YXRlLmxvYWRlZFN0cnVjdHNbc2VnbWVudEluZGV4XS5zcGxpY2UobG9hZGVkU3RydWN0SW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGRvd25sb2FkZWQgZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsZWFyT25GYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgbSA9IHBsdWdpbi5zdGF0ZS5kYXRhLnNlbGVjdChtb2RlbFJlZilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgdCA9IHBsdWdpbi5zdGF0ZS5kYXRhLnNlbGVjdChtLnRyYW5zZm9ybS5wYXJlbnQpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0IGQgPSBwbHVnaW4uc3RhdGUuZGF0YS5zZWxlY3QodC50cmFuc2Zvcm0ucGFyZW50KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQbHVnaW5Db21tYW5kcy5TdGF0ZS5SZW1vdmVPYmplY3QocGx1Z2luLCB7IHN0YXRlOiBkLnBhcmVudCEsIHJlZjogZC50cmFuc2Zvcm0ucGFyZW50LCByZW1vdmVQYXJlbnRHaG9zdHM6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZihpbnRlcmFjdGluZ0hldHMubGVuZ3RoID4gMCkgc3BTdGF0ZS5oZXRzW2Ake3MucGRiX2lkfV8ke3Muc3RydWN0X2FzeW1faWR9YF0gPSBpbnRlcmFjdGluZ0hldHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSA0MztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQzOiByZXR1cm4gWzMgLypicmVhayovLCA0NV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0NDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDU6IHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDY6IHJldHVybiBbMyAvKmJyZWFrKi8sIDUzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ3OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlXzNfMSA9IF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZV8zID0geyBlcnJvcjogZV8zXzEgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNTNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDg6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLnRyeXMucHVzaChbNDgsICwgNTEsIDUyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFfYSAmJiAhX2ggJiYgKF9qID0gZW50cnlMaXN0XzEucmV0dXJuKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDUwXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgX2ouY2FsbChlbnRyeUxpc3RfMSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3AubGFiZWwgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDUwOiByZXR1cm4gWzMgLypicmVhayovLCA1Ml07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTI6IHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJ1c3lGbGFnT24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1c3lGbGFnT24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3kubmV4dChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTsgfSldO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmV4cG9ydHMucmVuZGVyU3VwZXJwb3NpdGlvbiA9IHJlbmRlclN1cGVycG9zaXRpb247XG5mdW5jdGlvbiBnZXRMaWdhbmROYW1lc0Zyb21Nb2RlbERhdGEocGx1Z2luLCBzdGF0ZSwgbW9kZWxSZWYpIHtcbiAgICB2YXIgX2E7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjZWxsLCBtb2RlbCwgc3RydWN0dXJlcywgX2ksIF9iLCBzLCBzdHJ1Y3R1cmUsIGluZm87XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHN0YXRlLnNlbGVjdChtb2RlbFJlZilbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2VsbCB8fCAhY2VsbC5vYmopXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdm9pZCAwXTtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwgPSBjZWxsLm9iai5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW1vZGVsKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmVzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBfYiA9IHBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LnNlbGVjdGlvbi5zdHJ1Y3R1cmVzOyBfaSA8IF9iLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcyA9IF9iW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZSA9IChfYSA9IHMuY2VsbC5vYmopID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0cnVjdHVyZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3R1cmVzLnB1c2goc3RydWN0dXJlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBoZWxwZXJzXzEuTW9kZWxJbmZvLmdldChtb2RlbCwgc3RydWN0dXJlcyldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGluZm9dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGxvYWRTdHJ1Y3R1cmUocGx1Z2luLCB1cmwsIGZvcm1hdCwgaXNCaW5hcnkpIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGRhdGEsIHRyYWplY3RvcnksIG1vZGVsLCBtb2RlbFByb3BlcnRpZXMsIHN0cnVjdHVyZSwgZV80O1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMCwgNywgLCA4XSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5kYXRhLmRvd25sb2FkKHsgdXJsOiBhc3NldHNfMS5Bc3NldC5VcmwodXJsKSwgaXNCaW5hcnk6IGlzQmluYXJ5IH0pXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucGFyc2VUcmFqZWN0b3J5KGRhdGEsIGZvcm1hdCldO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdHJhamVjdG9yeSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS5jcmVhdGVNb2RlbCh0cmFqZWN0b3J5KV07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBtb2RlbCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS5pbnNlcnRNb2RlbFByb3BlcnRpZXMobW9kZWwpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsUHJvcGVydGllcyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS5jcmVhdGVTdHJ1Y3R1cmUobW9kZWxQcm9wZXJ0aWVzIHx8IG1vZGVsLCB7IG5hbWU6ICdtb2RlbCcsIHBhcmFtczoge30gfSldO1xuICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgc3RydWN0dXJlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBwbHVnaW4uYnVpbGRlcnMuc3RydWN0dXJlLmluc2VydFN0cnVjdHVyZVByb3BlcnRpZXMoc3RydWN0dXJlKV07XG4gICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7IGRhdGE6IGRhdGEsIHRyYWplY3Rvcnk6IHRyYWplY3RvcnksIG1vZGVsOiBtb2RlbCwgc3RydWN0dXJlOiBzdHJ1Y3R1cmUgfV07XG4gICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICBlXzQgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7IHN0cnVjdHVyZTogdm9pZCAwIH1dO1xuICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNoYWluU2VsZWN0aW9uKHN0cnVjdF9hc3ltX2lkKSB7XG4gICAgcmV0dXJuIGJ1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5nZW5lcmF0b3IuYXRvbUdyb3Vwcyh7XG4gICAgICAgICdjaGFpbi10ZXN0JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIubGFiZWxfYXN5bV9pZCgpLCBzdHJ1Y3RfYXN5bV9pZF0pXG4gICAgfSk7XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm0ocGx1Z2luLCBzLCBtYXRyaXgpIHtcbiAgICB2YXIgYiA9IHBsdWdpbi5zdGF0ZS5kYXRhLmJ1aWxkKCkudG8ocylcbiAgICAgICAgLmluc2VydCh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLk1vZGVsLlRyYW5zZm9ybVN0cnVjdHVyZUNvbmZvcm1hdGlvbiwgeyB0cmFuc2Zvcm06IHsgbmFtZTogJ21hdHJpeCcsIHBhcmFtczogeyBkYXRhOiBtYXRyaXgsIHRyYW5zcG9zZTogZmFsc2UgfSB9IH0pO1xuICAgIHJldHVybiBwbHVnaW4ucnVuVGFzayhwbHVnaW4uc3RhdGUuZGF0YS51cGRhdGVUcmVlKGIpKTtcbn1cbmZ1bmN0aW9uIGFmVHJhbnNmb3JtKHBsdWdpbiwgcywgbWF0cml4LCBjb29yZGluYXRlU3lzdGVtKSB7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByLCBvLCB0cmFuc2Zvcm0sIHBhcmFtcywgYjtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICByID0gbW9sX3N0YXRlXzEuU3RhdGVPYmplY3RSZWYucmVzb2x2ZUFuZENoZWNrKHBsdWdpbi5zdGF0ZS5kYXRhLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBvID0gcGx1Z2luLnN0YXRlLmRhdGEuc2VsZWN0UShmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5ieVJlZihyLnRyYW5zZm9ybS5yZWYpLnN1YnRyZWUoKS53aXRoVHJhbnNmb3JtZXIodHJhbnNmb3Jtc18xLlN0YXRlVHJhbnNmb3Jtcy5Nb2RlbC5UcmFuc2Zvcm1TdHJ1Y3R1cmVDb25mb3JtYXRpb24pOyB9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtID0gY29vcmRpbmF0ZVN5c3RlbSAmJiAhbGluZWFyX2FsZ2VicmFfMS5NYXQ0LmlzSWRlbnRpdHkoY29vcmRpbmF0ZVN5c3RlbS5tYXRyaXgpXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGxpbmVhcl9hbGdlYnJhXzEuTWF0NC5tdWwoKDAsIGxpbmVhcl9hbGdlYnJhXzEuTWF0NCkoKSwgY29vcmRpbmF0ZVN5c3RlbS5tYXRyaXgsIG1hdHJpeClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbWF0cml4O1xuICAgICAgICAgICAgICAgICAgICBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnbWF0cml4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsgZGF0YTogdHJhbnNmb3JtLCB0cmFuc3Bvc2U6IGZhbHNlIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYiA9IG9cbiAgICAgICAgICAgICAgICAgICAgICAgID8gcGx1Z2luLnN0YXRlLmRhdGEuYnVpbGQoKS50byhvKS51cGRhdGUocGFyYW1zKVxuICAgICAgICAgICAgICAgICAgICAgICAgOiBwbHVnaW4uc3RhdGUuZGF0YS5idWlsZCgpLnRvKHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmluc2VydCh0cmFuc2Zvcm1zXzEuU3RhdGVUcmFuc2Zvcm1zLk1vZGVsLlRyYW5zZm9ybVN0cnVjdHVyZUNvbmZvcm1hdGlvbiwgcGFyYW1zLCB7IHRhZ3M6ICdTdXBlcnBvc2l0aW9uVHJhbnNmb3JtJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLnJ1blRhc2socGx1Z2luLnN0YXRlLmRhdGEudXBkYXRlVHJlZShiKSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZ2V0TWF0cml4RGF0YShwbHVnaW4pIHtcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlLCBtYXRyaXhBY2Nlc3Npb24sIGNsdXN0ZXJSZWNVcmxTdHIsIGFzc2V0TWFuYWdlciwgY2x1c3RlclJlY1VybCwgY2x1c3RlclJlY0RhdGEsIGVfNTtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZSA9IHBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgbWF0cml4QWNjZXNzaW9uID0gY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5zdXBlcnBvc2l0aW9uUGFyYW1zLm1hdHJpeEFjY2Vzc2lvbiA/IGN1c3RvbVN0YXRlLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvblBhcmFtcy5tYXRyaXhBY2Nlc3Npb24gOiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLm1vbGVjdWxlSWQ7XG4gICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJSZWNVcmxTdHIgPSBcIlwiLmNvbmNhdChjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnBkYmVVcmwsIFwic3RhdGljL3N1cGVycG9zZS9tYXRyaWNlcy9cIikuY29uY2F0KG1hdHJpeEFjY2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0TWFuYWdlciA9IHBsdWdpbi5tYW5hZ2Vycy5hc3NldDtcbiAgICAgICAgICAgICAgICAgICAgY2x1c3RlclJlY1VybCA9IGFzc2V0c18xLkFzc2V0LmdldFVybEFzc2V0KGFzc2V0TWFuYWdlciwgY2x1c3RlclJlY1VybFN0cik7XG4gICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5ydW5UYXNrKGFzc2V0TWFuYWdlci5yZXNvbHZlKGNsdXN0ZXJSZWNVcmwsICdqc29uJywgZmFsc2UpKV07XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBjbHVzdGVyUmVjRGF0YSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsdXN0ZXJSZWNEYXRhICYmIGNsdXN0ZXJSZWNEYXRhLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUubWF0cml4RGF0YSA9IGNsdXN0ZXJSZWNEYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBlXzUgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlWydzdXBlcnBvc2l0aW9uRXJyb3InXSA9IFwiTWF0cml4IGRhdGEgbm90IGF2YWlsYWJsZSBmb3IgXCIuY29uY2F0KG1hdHJpeEFjY2Vzc2lvbik7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jdXN0b21TdGF0ZS5ldmVudHMuc3VwZXJwb3NpdGlvbkluaXQubmV4dCh0cnVlKTsgLy8gRW1pdCBzZWdtZW50IEFQSSBkYXRhIGxvYWQgZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZ2V0U2VnbWVudERhdGEocGx1Z2luKSB7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdXN0b21TdGF0ZSwgc2VnbWVudHNVcmwsIGFzc2V0TWFuYWdlciwgdXJsLCByZXN1bHQsIGVfNjtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZSA9IHBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgc2VnbWVudHNVcmwgPSBcIlwiLmNvbmNhdChjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnBkYmVVcmwsIFwiZ3JhcGgtYXBpL3VuaXByb3Qvc3VwZXJwb3NpdGlvbi9cIikuY29uY2F0KGN1c3RvbVN0YXRlLmluaXRQYXJhbXMubW9sZWN1bGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0TWFuYWdlciA9IHBsdWdpbi5tYW5hZ2Vycy5hc3NldDtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gYXNzZXRzXzEuQXNzZXQuZ2V0VXJsQXNzZXQoYXNzZXRNYW5hZ2VyLCBzZWdtZW50c1VybCk7XG4gICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHBsdWdpbi5ydW5UYXNrKGFzc2V0TWFuYWdlci5yZXNvbHZlKHVybCwgJ2pzb24nLCBmYWxzZSkpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLnNlZ21lbnREYXRhID0gcmVzdWx0LmRhdGFbY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5tb2xlY3VsZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGVfNiA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3RhdGVbJ3N1cGVycG9zaXRpb25FcnJvciddID0gXCJTdXBlcnBvc2l0aW9uIGRhdGEgbm90IGF2YWlsYWJsZSBmb3IgXCIuY29uY2F0KGN1c3RvbVN0YXRlLmluaXRQYXJhbXMubW9sZWN1bGVJZCk7XG4gICAgICAgICAgICAgICAgICAgIHBsdWdpbi5jdXN0b21TdGF0ZS5ldmVudHMuc3VwZXJwb3NpdGlvbkluaXQubmV4dCh0cnVlKTsgLy8gRW1pdCBzZWdtZW50IEFQSSBkYXRhIGxvYWQgZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZ2V0Q2hhaW5MaWdhbmRzKGNhcmJFbnRpdHkpIHtcbiAgICB2YXIgbGlnYW5kQ2hhaW4gPSBbXTtcbiAgICB2YXIgbGlnYW5kTGFiZWxzID0gW107XG4gICAgdmFyIGxpZ2FuZHMgPSBbXTtcbiAgICB2YXIgbGFiZWxWYWx1ZUFyciA9IFtdO1xuICAgIHZhciBsaWdOYW1lU3RyID0gJyc7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGNhcmJFbnRpdHkuY2hlbV9jb21wX2xpc3Q7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBjaGVtQ29tcCA9IF9hW19pXTtcbiAgICAgICAgbGFiZWxWYWx1ZUFyci5wdXNoKFwiXCIuY29uY2F0KGNoZW1Db21wLmNoZW1fY29tcF9pZCwgXCIgKFwiKS5jb25jYXQoY2hlbUNvbXAuY291bnQsIFwiKVwiKSk7XG4gICAgfVxuICAgIGxpZ05hbWVTdHIgPSBsYWJlbFZhbHVlQXJyLmpvaW4oJywgJyk7XG4gICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IGNhcmJFbnRpdHkuY2hhaW5zOyBfYiA8IF9jLmxlbmd0aDsgX2IrKykge1xuICAgICAgICB2YXIgY2hhaW4gPSBfY1tfYl07XG4gICAgICAgIGxpZ2FuZENoYWluLnB1c2goY2hhaW4uY2hhaW5faWQpO1xuICAgICAgICBsaWdhbmRMYWJlbHMucHVzaChsaWdOYW1lU3RyKTtcbiAgICAgICAgdmFyIGNoYWluTGlnYW5kcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfZCA9IDAsIF9lID0gY2hhaW4ucmVzaWR1ZXM7IF9kIDwgX2UubGVuZ3RoOyBfZCsrKSB7XG4gICAgICAgICAgICB2YXIgcmVzaWR1ZSA9IF9lW19kXTtcbiAgICAgICAgICAgIGNoYWluTGlnYW5kcy5wdXNoKHJlc2lkdWUuY2hlbV9jb21wX2lkICsgJy0nICsgcmVzaWR1ZS5yZXNpZHVlX251bWJlcik7XG4gICAgICAgIH1cbiAgICAgICAgbGlnYW5kcy5wdXNoKGNoYWluTGlnYW5kcyk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGxpZ2FuZHM6IGxpZ2FuZHMsXG4gICAgICAgIGxpZ2FuZENoYWluOiBsaWdhbmRDaGFpbixcbiAgICAgICAgbGlnYW5kTGFiZWxzOiBsaWdhbmRMYWJlbHNcbiAgICB9O1xufVxuZnVuY3Rpb24gZ2V0Q2FyYlBvbHltZXJEZXRhaWxzRnJvbUFwaShwbHVnaW4sIHBkYl9pZCkge1xuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VzdG9tU3RhdGUsIGFwaVVybCwgYXNzZXRNYW5hZ2VyLCB1cmwsIGJyYW5jaGVkTGlnYW5kcywgYnJhbmNoZWRDaGFpbnMsIGJyYW5jaGVkbGFiZWxzLCByZXN1bHQsIGNhcmJFbnRpdGllcywgX2ksIGNhcmJFbnRpdGllc18xLCBjYXJiRW50aXR5LCBjYXJiTGlnRGF0YSwgZV83O1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlID0gcGx1Z2luLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgICAgICAgICBhcGlVcmwgPSBcIlwiLmNvbmNhdChjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnBkYmVVcmwsIFwiYXBpL3BkYi9lbnRyeS9jYXJib2h5ZHJhdGVfcG9seW1lci9cIikuY29uY2F0KHBkYl9pZCk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2V0TWFuYWdlciA9IHBsdWdpbi5tYW5hZ2Vycy5hc3NldDtcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gYXNzZXRzXzEuQXNzZXQuZ2V0VXJsQXNzZXQoYXNzZXRNYW5hZ2VyLCBhcGlVcmwpO1xuICAgICAgICAgICAgICAgICAgICBicmFuY2hlZExpZ2FuZHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoZWRDaGFpbnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJhbmNoZWRsYWJlbHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLnJ1blRhc2soYXNzZXRNYW5hZ2VyLnJlc29sdmUodXJsLCAnanNvbicsIGZhbHNlKSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5kYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXJiRW50aXRpZXMgPSByZXN1bHQuZGF0YVtwZGJfaWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChfaSA9IDAsIGNhcmJFbnRpdGllc18xID0gY2FyYkVudGl0aWVzOyBfaSA8IGNhcmJFbnRpdGllc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcmJFbnRpdHkgPSBjYXJiRW50aXRpZXNfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FyYkxpZ0RhdGEgPSBnZXRDaGFpbkxpZ2FuZHMoY2FyYkVudGl0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoZWRMaWdhbmRzID0gYnJhbmNoZWRMaWdhbmRzLmNvbmNhdChjYXJiTGlnRGF0YS5saWdhbmRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hlZENoYWlucyA9IGJyYW5jaGVkQ2hhaW5zLmNvbmNhdChjYXJiTGlnRGF0YS5saWdhbmRDaGFpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoZWRsYWJlbHMgPSBicmFuY2hlZGxhYmVscy5jb25jYXQoY2FyYkxpZ0RhdGEubGlnYW5kTGFiZWxzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGVfNyA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoZWRDaGFpbnM6IGJyYW5jaGVkQ2hhaW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJhbmNoZWRMaWdhbmRzOiBicmFuY2hlZExpZ2FuZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBicmFuY2hlZGxhYmVsczogYnJhbmNoZWRsYWJlbHNcbiAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3VwZXJwb3NpdGlvbi5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/superposition.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/alphafold-superposition.js":
  /*!*******************************************!*\
    !*** ./lib/ui/alphafold-superposition.js ***!
    \*******************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.AfSuperpositionControls = exports.AlphafoldSuperpositionParams = exports.AlphafoldSuperpositionControls = exports.AlphafoldPaeControls = exports.InfoIconSvg = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar react_1 = tslib_1.__importDefault(__webpack_require__(/*! react */ \"./node_modules/react/index.js\"));\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar superposition_1 = __webpack_require__(/*! ../superposition */ \"./lib/superposition.js\");\nvar d3_scale_1 = __webpack_require__(/*! d3-scale */ \"./node_modules/d3-scale/src/index.js\");\nvar d3_axis_1 = __webpack_require__(/*! d3-axis */ \"./node_modules/d3-axis/src/index.js\");\nvar d3_selection_1 = __webpack_require__(/*! d3-selection */ \"./node_modules/d3-selection/src/index.js\");\nvar _InfoIcon = (0, jsx_runtime_1.jsx)(\"svg\", tslib_1.__assign({ width: '24px', height: '24px', viewBox: '0 0 24 24', strokeWidth: '0.1px' }, { children: (0, jsx_runtime_1.jsx)(\"path\", { fill: \"currentColor\", d: \"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z\" }) }));\nfunction InfoIconSvg() { return _InfoIcon; }\nexports.InfoIconSvg = InfoIconSvg;\nvar AlphafoldPaeControls = /** @class */ (function (_super) {\n    tslib_1.__extends(AlphafoldPaeControls, _super);\n    function AlphafoldPaeControls(props, context) {\n        var _this = _super.call(this, props, context) || this;\n        _this.axisBoxRef = react_1.default.createRef();\n        return _this;\n    }\n    AlphafoldPaeControls.prototype.defaultState = function () {\n        return {\n            isCollapsed: false,\n            header: 'AlphaFold PAE',\n            brand: { accent: 'gray', svg: icons_1.SuperpositionSvg },\n            isHidden: true\n        };\n    };\n    AlphafoldPaeControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (sel) {\n            var superpositionState = _this.plugin.customState.superpositionState;\n            if (superpositionState && superpositionState.alphafold.ref && superpositionState.alphafold.apiData.pae && superpositionState.alphafold.apiData.pae !== '' && superpositionState.alphafold.apiData.pae !== '') {\n                _this.setState({ isHidden: false });\n                var domainMax = superpositionState.alphafold.apiData.length;\n                var x = (0, d3_scale_1.scaleLinear)().domain([0, domainMax]).range([0, 200]);\n                var xAxis = (0, d3_axis_1.axisBottom)(x).ticks(6).tickFormat(_this.formatTicks).tickSizeOuter(0);\n                var yAxis = (0, d3_axis_1.axisLeft)(x).ticks(6).tickFormat(_this.formatTicks).tickSizeOuter(0);\n                var axisContainer = (0, d3_selection_1.select)(_this.axisBoxRef.current);\n                axisContainer.append('svg:svg')\n                    .attr('width', 220)\n                    .attr('height', 30)\n                    .attr('class', 'pae-x-axis')\n                    .style('z-index', '1')\n                    .style('position', 'absolute')\n                    .attr('transform', \"translate(-93,202)\")\n                    .append('g')\n                    .attr('transform', \"translate(6,0)\")\n                    .call(xAxis);\n                axisContainer.append('svg:svg')\n                    .attr('width', 50)\n                    .attr('height', 220)\n                    .attr('class', 'pae-y-axis')\n                    .style('z-index', '1')\n                    .style('position', 'absolute')\n                    .attr('transform', \"translate(-123,0)\")\n                    .append('g')\n                    .attr('transform', \"translate(36,4)\")\n                    .call(yAxis);\n            }\n        });\n    };\n    AlphafoldPaeControls.prototype.formatTicks = function (d) {\n        return d > 999 ? d / 1000 + 'k' : d;\n    };\n    AlphafoldPaeControls.prototype.renderControls = function () {\n        var superpositionState = this.plugin.customState.superpositionState;\n        if (!superpositionState || !superpositionState.alphafold)\n            return null;\n        var errorScale = [0, 5, 10, 15, 20, 25, 30];\n        return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row', style: { height: 'auto', textAlign: 'center', justifyContent: 'center', padding: '15px 0', position: 'relative', fontSize: '12px' } }, { children: [(0, jsx_runtime_1.jsx)(\"div\", { ref: this.axisBoxRef, className: 'pae-axis-box', style: { position: 'absolute', width: '100%', height: '100%' } }), (0, jsx_runtime_1.jsx)(\"span\", tslib_1.__assign({ style: { transform: 'rotate(270deg)', position: 'absolute', transformOrigin: '0 0', left: '10px', top: '165px', fontWeight: 500 } }, { children: \"Aligned residue\" })), (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row', style: { height: 'auto', flexDirection: 'column' } }, { children: [(0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { width: '200px', height: '200px', border: '1px solid #6a635a', margin: '2px 0 25px 25px', position: 'relative' } }, { children: (0, jsx_runtime_1.jsx)(\"img\", { style: { width: '100%', height: '100%', position: 'absolute', left: 0, top: 0 }, src: \"\".concat(superpositionState.alphafold.apiData.pae), alt: \"PAE\" }) })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { textAlign: 'center', paddingLeft: '30px', marginBottom: '20px', fontWeight: 500 } }, { children: \"Scored residue\" })), (0, jsx_runtime_1.jsx)(\"img\", { style: { width: '200px', height: '10px', border: '1px solid #6a635a', margin: '2px 0 25px 25px', transform: 'rotate(180deg)' }, src: 'https://alphafold.ebi.ac.uk/assets/img/horizontal_colorbar.png', alt: \"PAE Scale\" }), (0, jsx_runtime_1.jsx)(\"ul\", tslib_1.__assign({ style: { listStyleType: 'none', fontWeight: 500, margin: 0, display: 'inline-block', position: 'absolute', top: '292px', marginLeft: '24px' } }, { children: errorScale.map(function (errValue) { return (0, jsx_runtime_1.jsx)(\"li\", tslib_1.__assign({ style: { float: 'left', marginRight: '18px' } }, { children: errValue }), errValue); }) })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { textAlign: 'center', paddingLeft: '20px', fontWeight: 500 } }, { children: \"Expected position error (\\u00C5ngstr\\u00F6ms)\" }))] }))] }));\n    };\n    return AlphafoldPaeControls;\n}(base_1.CollapsableControls));\nexports.AlphafoldPaeControls = AlphafoldPaeControls;\nvar AlphafoldSuperpositionControls = /** @class */ (function (_super) {\n    tslib_1.__extends(AlphafoldSuperpositionControls, _super);\n    function AlphafoldSuperpositionControls() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AlphafoldSuperpositionControls.prototype.defaultState = function () {\n        return {\n            isCollapsed: false,\n            header: 'AlphaFold Superposition',\n            brand: { accent: 'gray', svg: icons_1.SuperpositionSvg },\n            isHidden: true\n        };\n    };\n    AlphafoldSuperpositionControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (sel) {\n            var superpositionState = _this.plugin.customState.superpositionState;\n            if (superpositionState && superpositionState.alphafold.apiData.cif && superpositionState.alphafold.apiData.cif !== '') {\n                _this.setState({ isHidden: false });\n            }\n        });\n    };\n    AlphafoldSuperpositionControls.prototype.rmsdTable = function () {\n        var spData = this.plugin.customState.superpositionState;\n        var activeSegment = spData.activeSegment;\n        var rmsds = spData.alphafold.rmsds;\n        return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-control-offset' }, { children: [(rmsds.length == 0 || !rmsds[activeSegment - 1]) && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-flex-row', style: { padding: '5px 0 0 10px' } }, { children: (0, jsx_runtime_1.jsx)(\"strong\", { children: \"No overlap found!\" }) })), rmsds[activeSegment - 1] && (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [(0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { width: '40%', borderRight: '1px solid rgb(213 206 196)', padding: '5px 0 0 5px' } }, { children: (0, jsx_runtime_1.jsx)(\"strong\", { children: \"Entry\" }) })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { padding: '5px 0 0 5px' } }, { children: (0, jsx_runtime_1.jsx)(\"strong\", { children: \"RMSD (\\u212B)\" }) }))] })), rmsds[activeSegment - 1] && rmsds[activeSegment - 1].map(function (d) {\n                    var details = d.split(':');\n                    return details[1] !== '-' ? (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [(0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-row-label', style: { width: '40%', borderRight: '1px solid rgb(213 206 196)', padding: '5px 0 0 5px' } }, { children: details[0] })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { padding: '5px 0 0 5px' } }, { children: details[1] }))] }), d) : null;\n                })] }));\n    };\n    AlphafoldSuperpositionControls.prototype.renderControls = function () {\n        var superpositionState = this.plugin.customState.superpositionState;\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [superpositionState.alphafold.ref !== '' && this.rmsdTable(), superpositionState.alphafold.ref === '' && (0, jsx_runtime_1.jsx)(AfSuperpositionControls, {})] });\n    };\n    return AlphafoldSuperpositionControls;\n}(base_1.CollapsableControls));\nexports.AlphafoldSuperpositionControls = AlphafoldSuperpositionControls;\nexports.AlphafoldSuperpositionParams = {\n    // alignSequences: PD.Boolean(true, { isEssential: true, description: 'For Chain-based 3D superposition, perform a sequence alignment and use the aligned residue pairs to guide the 3D superposition.' }),\n    traceOnly: param_definition_1.ParamDefinition.Boolean(true, { description: 'For Chain- and Uniprot-based 3D superposition, base superposition only on CA (and equivalent) atoms.' })\n};\nvar DefaultAlphafoldSuperpositionOptions = param_definition_1.ParamDefinition.getDefaultValues(exports.AlphafoldSuperpositionParams);\nvar AfSuperpositionControls = /** @class */ (function (_super) {\n    tslib_1.__extends(AfSuperpositionControls, _super);\n    function AfSuperpositionControls() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            isBusy: false,\n            canUseDb: true,\n            action: undefined,\n            options: DefaultAlphafoldSuperpositionOptions\n        };\n        _this.superposeDb = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var spData;\n            return tslib_1.__generator(this, function (_a) {\n                this.setState({ isBusy: true });\n                spData = this.plugin.customState.superpositionState;\n                spData.alphafold.traceOnly = this.state.options.traceOnly;\n                (0, superposition_1.superposeAf)(this.plugin, this.state.options.traceOnly);\n                return [2 /*return*/];\n            });\n        }); };\n        _this.toggleOptions = function () { return _this.setState({ action: _this.state.action === 'options' ? void 0 : 'options' }); };\n        _this.setOptions = function (values) {\n            _this.setState({ options: values });\n        };\n        return _this;\n    }\n    AfSuperpositionControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\n            _this.setState({ isBusy: v });\n        });\n    };\n    Object.defineProperty(AfSuperpositionControls.prototype, \"selection\", {\n        get: function () {\n            return this.plugin.managers.structure.selection;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(AfSuperpositionControls.prototype, \"customState\", {\n        get: function () {\n            return this.plugin.customState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    AfSuperpositionControls.prototype.superposeByDbMapping = function () {\n        return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.SuperposeChainsSvg, title: 'Superpose AlphaFold structure using intersection of residues from SIFTS UNIPROT mapping.', className: 'msp-btn msp-btn-block', onClick: this.superposeDb, style: { marginTop: '1px', textAlign: 'left' }, disabled: this.state.isBusy }, { children: \"Load AlphaFold structure\" })) });\n    };\n    AfSuperpositionControls.prototype.render = function () {\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { backgroundColor: '#dce54e', fontWeight: 500, padding: '5px 12px' } }, { children: \"New Feature!\" })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-help-text', style: { margin: '2px 0' } }, { children: (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-help-description' }, { children: [(0, jsx_runtime_1.jsx)(icons_1.Icon, { svg: InfoIconSvg, inline: true }), \"Load and superpose AlphaFold structure against representative chains.\"] })) })), (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [this.state.canUseDb && this.superposeByDbMapping(), (0, jsx_runtime_1.jsx)(common_1.ToggleButton, { icon: icons_1.TuneSvg, label: '', title: 'Options', toggle: this.toggleOptions, isSelected: this.state.action === 'options', disabled: this.state.isBusy, style: { flex: '0 0 40px', padding: 0 } })] })), this.state.action === 'options' && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-offset' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: exports.AlphafoldSuperpositionParams, values: this.state.options, onChangeValues: this.setOptions, isDisabled: this.state.isBusy }) }))] });\n    };\n    return AfSuperpositionControls;\n}(base_1.PurePluginUIComponent));\nexports.AfSuperpositionControls = AfSuperpositionControls;\n//# sourceMappingURL=alphafold-superposition.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0EsQ0FBQztBQUNELHNDQUFzQztBQUN0QyxvQ0FBb0M7QUFDcEMsMENBQTBDLG1LQUFtSztBQUM3TSxrRUFBa0UscUhBQXFIO0FBQ3ZMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0EsZ0NBQWdDLGNBQWM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNULDRDQUE0Qyx3QkFBd0IsK0RBQStEO0FBQ25JO0FBQ0EsNkJBQTZCLGlCQUFpQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsV0FBVztBQUN4QyxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdFQUFnRSxxRUFBcUUsNk1BQTZNLHFDQUFxQywrQkFBK0IsSUFBSSxzQ0FBc0MsSUFBSTtBQUNwYztBQUNBO0FBQ0EsaUVBQWlFLDREQUE0RCxTQUFTLG9FQUFvRSxJQUFJLDBCQUEwQixxREFBcUQscUNBQXFDLG1CQUFtQixJQUFJLDREQUE0RCxtQ0FBbUMsSUFBSSxrREFBa0QsZ0NBQWdDLDZFQUE2RSxJQUFJLHNEQUFzRCwyQkFBMkIsSUFBSSwrR0FBK0csbUtBQW1LLGdDQUFnQyxJQUFJLHdGQUF3RixpQ0FBaUMsSUFBSSxtRUFBbUUsMElBQTBJLEdBQUcsS0FBSztBQUM1ekM7QUFDQTtBQUNBLENBQUM7QUFDRCwrQkFBK0I7QUFDL0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvdWkvYWxwaGFmb2xkLXN1cGVycG9zaXRpb24uanM/MTYwMCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMgPSBleHBvcnRzLkFscGhhZm9sZFN1cGVycG9zaXRpb25QYXJhbXMgPSBleHBvcnRzLkFscGhhZm9sZFN1cGVycG9zaXRpb25Db250cm9scyA9IGV4cG9ydHMuQWxwaGFmb2xkUGFlQ29udHJvbHMgPSBleHBvcnRzLkluZm9JY29uU3ZnID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIganN4X3J1bnRpbWVfMSA9IHJlcXVpcmUoXCJyZWFjdC9qc3gtcnVudGltZVwiKTtcbnZhciByZWFjdF8xID0gdHNsaWJfMS5fX2ltcG9ydERlZmF1bHQocmVxdWlyZShcInJlYWN0XCIpKTtcbnZhciBiYXNlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2Jhc2VcIik7XG52YXIgaWNvbnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvaWNvbnNcIik7XG52YXIgY29tbW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2NvbW1vblwiKTtcbnZhciBwYXJhbV9kZWZpbml0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9wYXJhbS1kZWZpbml0aW9uXCIpO1xudmFyIHBhcmFtZXRlcnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvcGFyYW1ldGVyc1wiKTtcbnZhciBzdXBlcnBvc2l0aW9uXzEgPSByZXF1aXJlKFwiLi4vc3VwZXJwb3NpdGlvblwiKTtcbnZhciBkM19zY2FsZV8xID0gcmVxdWlyZShcImQzLXNjYWxlXCIpO1xudmFyIGQzX2F4aXNfMSA9IHJlcXVpcmUoXCJkMy1heGlzXCIpO1xudmFyIGQzX3NlbGVjdGlvbl8xID0gcmVxdWlyZShcImQzLXNlbGVjdGlvblwiKTtcbnZhciBfSW5mb0ljb24gPSAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwic3ZnXCIsIHRzbGliXzEuX19hc3NpZ24oeyB3aWR0aDogJzI0cHgnLCBoZWlnaHQ6ICcyNHB4Jywgdmlld0JveDogJzAgMCAyNCAyNCcsIHN0cm9rZVdpZHRoOiAnMC4xcHgnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJwYXRoXCIsIHsgZmlsbDogXCJjdXJyZW50Q29sb3JcIiwgZDogXCJNMTEsOUgxM1Y3SDExTTEyLDIwQzcuNTksMjAgNCwxNi40MSA0LDEyQzQsNy41OSA3LjU5LDQgMTIsNEMxNi40MSw0IDIwLDcuNTkgMjAsMTJDMjAsMTYuNDEgMTYuNDEsMjAgMTIsMjBNMTIsMkExMCwxMCAwIDAsMCAyLDEyQTEwLDEwIDAgMCwwIDEyLDIyQTEwLDEwIDAgMCwwIDIyLDEyQTEwLDEwIDAgMCwwIDEyLDJNMTEsMTdIMTNWMTFIMTFWMTdaXCIgfSkgfSkpO1xuZnVuY3Rpb24gSW5mb0ljb25TdmcoKSB7IHJldHVybiBfSW5mb0ljb247IH1cbmV4cG9ydHMuSW5mb0ljb25TdmcgPSBJbmZvSWNvblN2ZztcbnZhciBBbHBoYWZvbGRQYWVDb250cm9scyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBbHBoYWZvbGRQYWVDb250cm9scywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbHBoYWZvbGRQYWVDb250cm9scyhwcm9wcywgY29udGV4dCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcywgY29udGV4dCkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuYXhpc0JveFJlZiA9IHJlYWN0XzEuZGVmYXVsdC5jcmVhdGVSZWYoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBBbHBoYWZvbGRQYWVDb250cm9scy5wcm90b3R5cGUuZGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNDb2xsYXBzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgaGVhZGVyOiAnQWxwaGFGb2xkIFBBRScsXG4gICAgICAgICAgICBicmFuZDogeyBhY2NlbnQ6ICdncmF5Jywgc3ZnOiBpY29uc18xLlN1cGVycG9zaXRpb25TdmcgfSxcbiAgICAgICAgICAgIGlzSGlkZGVuOiB0cnVlXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbHBoYWZvbGRQYWVDb250cm9scy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuYmVoYXZpb3JzLnNlbGVjdGlvbiwgZnVuY3Rpb24gKHNlbCkge1xuICAgICAgICAgICAgdmFyIHN1cGVycG9zaXRpb25TdGF0ZSA9IF90aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICBpZiAoc3VwZXJwb3NpdGlvblN0YXRlICYmIHN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQucmVmICYmIHN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQuYXBpRGF0YS5wYWUgJiYgc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5hcGlEYXRhLnBhZSAhPT0gJycgJiYgc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5hcGlEYXRhLnBhZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICB2YXIgZG9tYWluTWF4ID0gc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5hcGlEYXRhLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgeCA9ICgwLCBkM19zY2FsZV8xLnNjYWxlTGluZWFyKSgpLmRvbWFpbihbMCwgZG9tYWluTWF4XSkucmFuZ2UoWzAsIDIwMF0pO1xuICAgICAgICAgICAgICAgIHZhciB4QXhpcyA9ICgwLCBkM19heGlzXzEuYXhpc0JvdHRvbSkoeCkudGlja3MoNikudGlja0Zvcm1hdChfdGhpcy5mb3JtYXRUaWNrcykudGlja1NpemVPdXRlcigwKTtcbiAgICAgICAgICAgICAgICB2YXIgeUF4aXMgPSAoMCwgZDNfYXhpc18xLmF4aXNMZWZ0KSh4KS50aWNrcyg2KS50aWNrRm9ybWF0KF90aGlzLmZvcm1hdFRpY2tzKS50aWNrU2l6ZU91dGVyKDApO1xuICAgICAgICAgICAgICAgIHZhciBheGlzQ29udGFpbmVyID0gKDAsIGQzX3NlbGVjdGlvbl8xLnNlbGVjdCkoX3RoaXMuYXhpc0JveFJlZi5jdXJyZW50KTtcbiAgICAgICAgICAgICAgICBheGlzQ29udGFpbmVyLmFwcGVuZCgnc3ZnOnN2ZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIDIyMClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIDMwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAncGFlLXgtYXhpcycpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnei1pbmRleCcsICcxJylcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCdwb3NpdGlvbicsICdhYnNvbHV0ZScpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBcInRyYW5zbGF0ZSgtOTMsMjAyKVwiKVxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCdnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIFwidHJhbnNsYXRlKDYsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeEF4aXMpO1xuICAgICAgICAgICAgICAgIGF4aXNDb250YWluZXIuYXBwZW5kKCdzdmc6c3ZnJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3dpZHRoJywgNTApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCAyMjApXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdwYWUteS1heGlzJylcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCd6LWluZGV4JywgJzEnKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ2Fic29sdXRlJylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsIFwidHJhbnNsYXRlKC0xMjMsMClcIilcbiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCBcInRyYW5zbGF0ZSgzNiw0KVwiKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh5QXhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWxwaGFmb2xkUGFlQ29udHJvbHMucHJvdG90eXBlLmZvcm1hdFRpY2tzID0gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgcmV0dXJuIGQgPiA5OTkgPyBkIC8gMTAwMCArICdrJyA6IGQ7XG4gICAgfTtcbiAgICBBbHBoYWZvbGRQYWVDb250cm9scy5wcm90b3R5cGUucmVuZGVyQ29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdXBlcnBvc2l0aW9uU3RhdGUgPSB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgIGlmICghc3VwZXJwb3NpdGlvblN0YXRlIHx8ICFzdXBlcnBvc2l0aW9uU3RhdGUuYWxwaGFmb2xkKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBlcnJvclNjYWxlID0gWzAsIDUsIDEwLCAxNSwgMjAsIDI1LCAzMF07XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWZsZXgtcm93Jywgc3R5bGU6IHsgaGVpZ2h0OiAnYXV0bycsIHRleHRBbGlnbjogJ2NlbnRlcicsIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJywgcGFkZGluZzogJzE1cHggMCcsIHBvc2l0aW9uOiAncmVsYXRpdmUnLCBmb250U2l6ZTogJzEycHgnIH0gfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgeyByZWY6IHRoaXMuYXhpc0JveFJlZiwgY2xhc3NOYW1lOiAncGFlLWF4aXMtYm94Jywgc3R5bGU6IHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIHdpZHRoOiAnMTAwJScsIGhlaWdodDogJzEwMCUnIH0gfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJzcGFuXCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyB0cmFuc2Zvcm06ICdyb3RhdGUoMjcwZGVnKScsIHBvc2l0aW9uOiAnYWJzb2x1dGUnLCB0cmFuc2Zvcm1PcmlnaW46ICcwIDAnLCBsZWZ0OiAnMTBweCcsIHRvcDogJzE2NXB4JywgZm9udFdlaWdodDogNTAwIH0gfSwgeyBjaGlsZHJlbjogXCJBbGlnbmVkIHJlc2lkdWVcIiB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtZmxleC1yb3cnLCBzdHlsZTogeyBoZWlnaHQ6ICdhdXRvJywgZmxleERpcmVjdGlvbjogJ2NvbHVtbicgfSB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgd2lkdGg6ICcyMDBweCcsIGhlaWdodDogJzIwMHB4JywgYm9yZGVyOiAnMXB4IHNvbGlkICM2YTYzNWEnLCBtYXJnaW46ICcycHggMCAyNXB4IDI1cHgnLCBwb3NpdGlvbjogJ3JlbGF0aXZlJyB9IH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJpbWdcIiwgeyBzdHlsZTogeyB3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcxMDAlJywgcG9zaXRpb246ICdhYnNvbHV0ZScsIGxlZnQ6IDAsIHRvcDogMCB9LCBzcmM6IFwiXCIuY29uY2F0KHN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQuYXBpRGF0YS5wYWUpLCBhbHQ6IFwiUEFFXCIgfSkgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyB0ZXh0QWxpZ246ICdjZW50ZXInLCBwYWRkaW5nTGVmdDogJzMwcHgnLCBtYXJnaW5Cb3R0b206ICcyMHB4JywgZm9udFdlaWdodDogNTAwIH0gfSwgeyBjaGlsZHJlbjogXCJTY29yZWQgcmVzaWR1ZVwiIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImltZ1wiLCB7IHN0eWxlOiB7IHdpZHRoOiAnMjAwcHgnLCBoZWlnaHQ6ICcxMHB4JywgYm9yZGVyOiAnMXB4IHNvbGlkICM2YTYzNWEnLCBtYXJnaW46ICcycHggMCAyNXB4IDI1cHgnLCB0cmFuc2Zvcm06ICdyb3RhdGUoMTgwZGVnKScgfSwgc3JjOiAnaHR0cHM6Ly9hbHBoYWZvbGQuZWJpLmFjLnVrL2Fzc2V0cy9pbWcvaG9yaXpvbnRhbF9jb2xvcmJhci5wbmcnLCBhbHQ6IFwiUEFFIFNjYWxlXCIgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJ1bFwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgbGlzdFN0eWxlVHlwZTogJ25vbmUnLCBmb250V2VpZ2h0OiA1MDAsIG1hcmdpbjogMCwgZGlzcGxheTogJ2lubGluZS1ibG9jaycsIHBvc2l0aW9uOiAnYWJzb2x1dGUnLCB0b3A6ICcyOTJweCcsIG1hcmdpbkxlZnQ6ICcyNHB4JyB9IH0sIHsgY2hpbGRyZW46IGVycm9yU2NhbGUubWFwKGZ1bmN0aW9uIChlcnJWYWx1ZSkgeyByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImxpXCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyBmbG9hdDogJ2xlZnQnLCBtYXJnaW5SaWdodDogJzE4cHgnIH0gfSwgeyBjaGlsZHJlbjogZXJyVmFsdWUgfSksIGVyclZhbHVlKTsgfSkgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyB0ZXh0QWxpZ246ICdjZW50ZXInLCBwYWRkaW5nTGVmdDogJzIwcHgnLCBmb250V2VpZ2h0OiA1MDAgfSB9LCB7IGNoaWxkcmVuOiBcIkV4cGVjdGVkIHBvc2l0aW9uIGVycm9yIChcXHUwMEM1bmdzdHJcXHUwMEY2bXMpXCIgfSkpXSB9KSldIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBBbHBoYWZvbGRQYWVDb250cm9scztcbn0oYmFzZV8xLkNvbGxhcHNhYmxlQ29udHJvbHMpKTtcbmV4cG9ydHMuQWxwaGFmb2xkUGFlQ29udHJvbHMgPSBBbHBoYWZvbGRQYWVDb250cm9scztcbnZhciBBbHBoYWZvbGRTdXBlcnBvc2l0aW9uQ29udHJvbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQWxwaGFmb2xkU3VwZXJwb3NpdGlvbkNvbnRyb2xzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFscGhhZm9sZFN1cGVycG9zaXRpb25Db250cm9scygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBbHBoYWZvbGRTdXBlcnBvc2l0aW9uQ29udHJvbHMucHJvdG90eXBlLmRlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzQ29sbGFwc2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGhlYWRlcjogJ0FscGhhRm9sZCBTdXBlcnBvc2l0aW9uJyxcbiAgICAgICAgICAgIGJyYW5kOiB7IGFjY2VudDogJ2dyYXknLCBzdmc6IGljb25zXzEuU3VwZXJwb3NpdGlvblN2ZyB9LFxuICAgICAgICAgICAgaXNIaWRkZW46IHRydWVcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEFscGhhZm9sZFN1cGVycG9zaXRpb25Db250cm9scy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuYmVoYXZpb3JzLnNlbGVjdGlvbiwgZnVuY3Rpb24gKHNlbCkge1xuICAgICAgICAgICAgdmFyIHN1cGVycG9zaXRpb25TdGF0ZSA9IF90aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICBpZiAoc3VwZXJwb3NpdGlvblN0YXRlICYmIHN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQuYXBpRGF0YS5jaWYgJiYgc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5hcGlEYXRhLmNpZiAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBbHBoYWZvbGRTdXBlcnBvc2l0aW9uQ29udHJvbHMucHJvdG90eXBlLnJtc2RUYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNwRGF0YSA9IHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgdmFyIGFjdGl2ZVNlZ21lbnQgPSBzcERhdGEuYWN0aXZlU2VnbWVudDtcbiAgICAgICAgdmFyIHJtc2RzID0gc3BEYXRhLmFscGhhZm9sZC5ybXNkcztcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1vZmZzZXQnIH0sIHsgY2hpbGRyZW46IFsocm1zZHMubGVuZ3RoID09IDAgfHwgIXJtc2RzW2FjdGl2ZVNlZ21lbnQgLSAxXSkgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWZsZXgtcm93Jywgc3R5bGU6IHsgcGFkZGluZzogJzVweCAwIDAgMTBweCcgfSB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwic3Ryb25nXCIsIHsgY2hpbGRyZW46IFwiTm8gb3ZlcmxhcCBmb3VuZCFcIiB9KSB9KSksIHJtc2RzW2FjdGl2ZVNlZ21lbnQgLSAxXSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWZsZXgtcm93JyB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgd2lkdGg6ICc0MCUnLCBib3JkZXJSaWdodDogJzFweCBzb2xpZCByZ2IoMjEzIDIwNiAxOTYpJywgcGFkZGluZzogJzVweCAwIDAgNXB4JyB9IH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJzdHJvbmdcIiwgeyBjaGlsZHJlbjogXCJFbnRyeVwiIH0pIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgcGFkZGluZzogJzVweCAwIDAgNXB4JyB9IH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJzdHJvbmdcIiwgeyBjaGlsZHJlbjogXCJSTVNEIChcXHUyMTJCKVwiIH0pIH0pKV0gfSkpLCBybXNkc1thY3RpdmVTZWdtZW50IC0gMV0gJiYgcm1zZHNbYWN0aXZlU2VnbWVudCAtIDFdLm1hcChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGV0YWlscyA9IGQuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRldGFpbHNbMV0gIT09ICctJyA/ICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtZmxleC1yb3cnIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1yb3ctbGFiZWwnLCBzdHlsZTogeyB3aWR0aDogJzQwJScsIGJvcmRlclJpZ2h0OiAnMXB4IHNvbGlkIHJnYigyMTMgMjA2IDE5NiknLCBwYWRkaW5nOiAnNXB4IDAgMCA1cHgnIH0gfSwgeyBjaGlsZHJlbjogZGV0YWlsc1swXSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IHN0eWxlOiB7IHBhZGRpbmc6ICc1cHggMCAwIDVweCcgfSB9LCB7IGNoaWxkcmVuOiBkZXRhaWxzWzFdIH0pKV0gfSksIGQpIDogbnVsbDtcbiAgICAgICAgICAgICAgICB9KV0gfSkpO1xuICAgIH07XG4gICAgQWxwaGFmb2xkU3VwZXJwb3NpdGlvbkNvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXJDb250cm9scyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN1cGVycG9zaXRpb25TdGF0ZSA9IHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtzdXBlcnBvc2l0aW9uU3RhdGUuYWxwaGFmb2xkLnJlZiAhPT0gJycgJiYgdGhpcy5ybXNkVGFibGUoKSwgc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5yZWYgPT09ICcnICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMsIHt9KV0gfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQWxwaGFmb2xkU3VwZXJwb3NpdGlvbkNvbnRyb2xzO1xufShiYXNlXzEuQ29sbGFwc2FibGVDb250cm9scykpO1xuZXhwb3J0cy5BbHBoYWZvbGRTdXBlcnBvc2l0aW9uQ29udHJvbHMgPSBBbHBoYWZvbGRTdXBlcnBvc2l0aW9uQ29udHJvbHM7XG5leHBvcnRzLkFscGhhZm9sZFN1cGVycG9zaXRpb25QYXJhbXMgPSB7XG4gICAgLy8gYWxpZ25TZXF1ZW5jZXM6IFBELkJvb2xlYW4odHJ1ZSwgeyBpc0Vzc2VudGlhbDogdHJ1ZSwgZGVzY3JpcHRpb246ICdGb3IgQ2hhaW4tYmFzZWQgM0Qgc3VwZXJwb3NpdGlvbiwgcGVyZm9ybSBhIHNlcXVlbmNlIGFsaWdubWVudCBhbmQgdXNlIHRoZSBhbGlnbmVkIHJlc2lkdWUgcGFpcnMgdG8gZ3VpZGUgdGhlIDNEIHN1cGVycG9zaXRpb24uJyB9KSxcbiAgICB0cmFjZU9ubHk6IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uQm9vbGVhbih0cnVlLCB7IGRlc2NyaXB0aW9uOiAnRm9yIENoYWluLSBhbmQgVW5pcHJvdC1iYXNlZCAzRCBzdXBlcnBvc2l0aW9uLCBiYXNlIHN1cGVycG9zaXRpb24gb25seSBvbiBDQSAoYW5kIGVxdWl2YWxlbnQpIGF0b21zLicgfSlcbn07XG52YXIgRGVmYXVsdEFscGhhZm9sZFN1cGVycG9zaXRpb25PcHRpb25zID0gcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5nZXREZWZhdWx0VmFsdWVzKGV4cG9ydHMuQWxwaGFmb2xkU3VwZXJwb3NpdGlvblBhcmFtcyk7XG52YXIgQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGlzQnVzeTogZmFsc2UsXG4gICAgICAgICAgICBjYW5Vc2VEYjogdHJ1ZSxcbiAgICAgICAgICAgIGFjdGlvbjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb3B0aW9uczogRGVmYXVsdEFscGhhZm9sZFN1cGVycG9zaXRpb25PcHRpb25zXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnN1cGVycG9zZURiID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3BEYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzQnVzeTogdHJ1ZSB9KTtcbiAgICAgICAgICAgICAgICBzcERhdGEgPSB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICAgICAgc3BEYXRhLmFscGhhZm9sZC50cmFjZU9ubHkgPSB0aGlzLnN0YXRlLm9wdGlvbnMudHJhY2VPbmx5O1xuICAgICAgICAgICAgICAgICgwLCBzdXBlcnBvc2l0aW9uXzEuc3VwZXJwb3NlQWYpKHRoaXMucGx1Z2luLCB0aGlzLnN0YXRlLm9wdGlvbnMudHJhY2VPbmx5KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH07XG4gICAgICAgIF90aGlzLnRvZ2dsZU9wdGlvbnMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zZXRTdGF0ZSh7IGFjdGlvbjogX3RoaXMuc3RhdGUuYWN0aW9uID09PSAnb3B0aW9ucycgPyB2b2lkIDAgOiAnb3B0aW9ucycgfSk7IH07XG4gICAgICAgIF90aGlzLnNldE9wdGlvbnMgPSBmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IG9wdGlvbnM6IHZhbHVlcyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBBZlN1cGVycG9zaXRpb25Db250cm9scy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLmJlaGF2aW9ycy5zdGF0ZS5pc0J1c3ksIGZ1bmN0aW9uICh2KSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzQnVzeTogdiB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMucHJvdG90eXBlLCBcInNlbGVjdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5zZWxlY3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWZTdXBlcnBvc2l0aW9uQ29udHJvbHMucHJvdG90eXBlLCBcImN1c3RvbVN0YXRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBZlN1cGVycG9zaXRpb25Db250cm9scy5wcm90b3R5cGUuc3VwZXJwb3NlQnlEYk1hcHBpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQnV0dG9uLCB0c2xpYl8xLl9fYXNzaWduKHsgaWNvbjogaWNvbnNfMS5TdXBlcnBvc2VDaGFpbnNTdmcsIHRpdGxlOiAnU3VwZXJwb3NlIEFscGhhRm9sZCBzdHJ1Y3R1cmUgdXNpbmcgaW50ZXJzZWN0aW9uIG9mIHJlc2lkdWVzIGZyb20gU0lGVFMgVU5JUFJPVCBtYXBwaW5nLicsIGNsYXNzTmFtZTogJ21zcC1idG4gbXNwLWJ0bi1ibG9jaycsIG9uQ2xpY2s6IHRoaXMuc3VwZXJwb3NlRGIsIHN0eWxlOiB7IG1hcmdpblRvcDogJzFweCcsIHRleHRBbGlnbjogJ2xlZnQnIH0sIGRpc2FibGVkOiB0aGlzLnN0YXRlLmlzQnVzeSB9LCB7IGNoaWxkcmVuOiBcIkxvYWQgQWxwaGFGb2xkIHN0cnVjdHVyZVwiIH0pKSB9KTtcbiAgICB9O1xuICAgIEFmU3VwZXJwb3NpdGlvbkNvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgYmFja2dyb3VuZENvbG9yOiAnI2RjZTU0ZScsIGZvbnRXZWlnaHQ6IDUwMCwgcGFkZGluZzogJzVweCAxMnB4JyB9IH0sIHsgY2hpbGRyZW46IFwiTmV3IEZlYXR1cmUhXCIgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtaGVscC10ZXh0Jywgc3R5bGU6IHsgbWFyZ2luOiAnMnB4IDAnIH0gfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1oZWxwLWRlc2NyaXB0aW9uJyB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShpY29uc18xLkljb24sIHsgc3ZnOiBJbmZvSWNvblN2ZywgaW5saW5lOiB0cnVlIH0pLCBcIkxvYWQgYW5kIHN1cGVycG9zZSBBbHBoYUZvbGQgc3RydWN0dXJlIGFnYWluc3QgcmVwcmVzZW50YXRpdmUgY2hhaW5zLlwiXSB9KSkgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWZsZXgtcm93JyB9LCB7IGNoaWxkcmVuOiBbdGhpcy5zdGF0ZS5jYW5Vc2VEYiAmJiB0aGlzLnN1cGVycG9zZUJ5RGJNYXBwaW5nKCksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuVG9nZ2xlQnV0dG9uLCB7IGljb246IGljb25zXzEuVHVuZVN2ZywgbGFiZWw6ICcnLCB0aXRsZTogJ09wdGlvbnMnLCB0b2dnbGU6IHRoaXMudG9nZ2xlT3B0aW9ucywgaXNTZWxlY3RlZDogdGhpcy5zdGF0ZS5hY3Rpb24gPT09ICdvcHRpb25zJywgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5LCBzdHlsZTogeyBmbGV4OiAnMCAwIDQwcHgnLCBwYWRkaW5nOiAwIH0gfSldIH0pKSwgdGhpcy5zdGF0ZS5hY3Rpb24gPT09ICdvcHRpb25zJyAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1vZmZzZXQnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkocGFyYW1ldGVyc18xLlBhcmFtZXRlckNvbnRyb2xzLCB7IHBhcmFtczogZXhwb3J0cy5BbHBoYWZvbGRTdXBlcnBvc2l0aW9uUGFyYW1zLCB2YWx1ZXM6IHRoaXMuc3RhdGUub3B0aW9ucywgb25DaGFuZ2VWYWx1ZXM6IHRoaXMuc2V0T3B0aW9ucywgaXNEaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0J1c3kgfSkgfSkpXSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBBZlN1cGVycG9zaXRpb25Db250cm9scztcbn0oYmFzZV8xLlB1cmVQbHVnaW5VSUNvbXBvbmVudCkpO1xuZXhwb3J0cy5BZlN1cGVycG9zaXRpb25Db250cm9scyA9IEFmU3VwZXJwb3NpdGlvbkNvbnRyb2xzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWxwaGFmb2xkLXN1cGVycG9zaXRpb24uanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/ui/alphafold-superposition.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/alphafold-tranparency.js":
  /*!*****************************************!*\
    !*** ./lib/ui/alphafold-tranparency.js ***!
    \*****************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.AlphafoldTransparencyControls = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar alphafold_transparency_1 = __webpack_require__(/*! ../alphafold-transparency */ \"./lib/alphafold-transparency.js\");\nvar TransparencyParams = {\n    score: param_definition_1.ParamDefinition.Numeric(70, { min: 0, max: 100, step: 1 }, { label: 'pLDDT less than', description: 'pLDDT score value in the range of 0 to 100' }),\n    opacity: param_definition_1.ParamDefinition.Numeric(0.2, { min: 0, max: 1, step: 0.01 }, { description: 'Opacity value in the range 0 to 1' })\n};\nvar AlphafoldTransparencyControls = /** @class */ (function (_super) {\n    tslib_1.__extends(AlphafoldTransparencyControls, _super);\n    function AlphafoldTransparencyControls() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.updateTransparency = function (val) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var superpositionState, afStr;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.setState({ transpareny: val });\n                        superpositionState = this.plugin.customState.superpositionState;\n                        afStr = this.plugin.managers.structure.hierarchy.current.refs.get(superpositionState.alphafold.ref);\n                        return [4 /*yield*/, (0, alphafold_transparency_1.clearStructureTransparency)(this.plugin, afStr.components)];\n                    case 1:\n                        _a.sent();\n                        return [4 /*yield*/, (0, alphafold_transparency_1.applyAFTransparency)(this.plugin, afStr, 1 - val.opacity, val.score)];\n                    case 2:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        return _this;\n    }\n    AlphafoldTransparencyControls.prototype.defaultState = function () {\n        return {\n            isCollapsed: false,\n            header: 'AlphaFold Structure Opacity',\n            brand: { accent: 'gray', svg: icons_1.SuperpositionSvg },\n            isHidden: true,\n            transpareny: {\n                score: 70,\n                opacity: 0.2\n            }\n        };\n    };\n    AlphafoldTransparencyControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (sel) {\n            var superpositionState = _this.plugin.customState.superpositionState;\n            if (superpositionState && superpositionState.alphafold.ref && superpositionState.alphafold.ref !== '') {\n                _this.setState({ isHidden: false });\n            }\n        });\n    };\n    AlphafoldTransparencyControls.prototype.renderControls = function () {\n        return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: TransparencyParams, values: this.state.transpareny, onChangeValues: this.updateTransparency }) });\n    };\n    return AlphafoldTransparencyControls;\n}(base_1.CollapsableControls));\nexports.AlphafoldTransparencyControls = AlphafoldTransparencyControls;\n//# sourceMappingURL=alphafold-tranparency.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvYWxwaGFmb2xkLXRyYW5wYXJlbmN5LmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHFDQUFxQztBQUNyQyxjQUFjLG1CQUFPLENBQUMsZ0RBQU87QUFDN0Isb0JBQW9CLG1CQUFPLENBQUMsOERBQW1CO0FBQy9DLGFBQWEsbUJBQU8sQ0FBQyxvRkFBNEI7QUFDakQsY0FBYyxtQkFBTyxDQUFDLHdHQUFzQztBQUM1RCx5QkFBeUIsbUJBQU8sQ0FBQyxrR0FBbUM7QUFDcEUsbUJBQW1CLG1CQUFPLENBQUMsa0hBQTJDO0FBQ3RFLCtCQUErQixtQkFBTyxDQUFDLGtFQUEyQjtBQUNsRTtBQUNBLDREQUE0RCwyQkFBMkIsSUFBSSxxRkFBcUY7QUFDaEwsK0RBQStELDRCQUE0QixJQUFJLGtEQUFrRDtBQUNqSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLGtCQUFrQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLCtDQUErQztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsaUJBQWlCO0FBQ2xEO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxnRUFBZ0UsbUVBQW1FLHFHQUFxRyxHQUFHO0FBQzNPO0FBQ0E7QUFDQSxDQUFDO0FBQ0QscUNBQXFDO0FBQ3JDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3VpL2FscGhhZm9sZC10cmFucGFyZW5jeS5qcz80NjhhIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5BbHBoYWZvbGRUcmFuc3BhcmVuY3lDb250cm9scyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGpzeF9ydW50aW1lXzEgPSByZXF1aXJlKFwicmVhY3QvanN4LXJ1bnRpbWVcIik7XG52YXIgYmFzZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9iYXNlXCIpO1xudmFyIGljb25zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2ljb25zXCIpO1xudmFyIHBhcmFtX2RlZmluaXRpb25fMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC11dGlsL3BhcmFtLWRlZmluaXRpb25cIik7XG52YXIgcGFyYW1ldGVyc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9jb250cm9scy9wYXJhbWV0ZXJzXCIpO1xudmFyIGFscGhhZm9sZF90cmFuc3BhcmVuY3lfMSA9IHJlcXVpcmUoXCIuLi9hbHBoYWZvbGQtdHJhbnNwYXJlbmN5XCIpO1xudmFyIFRyYW5zcGFyZW5jeVBhcmFtcyA9IHtcbiAgICBzY29yZTogcGFyYW1fZGVmaW5pdGlvbl8xLlBhcmFtRGVmaW5pdGlvbi5OdW1lcmljKDcwLCB7IG1pbjogMCwgbWF4OiAxMDAsIHN0ZXA6IDEgfSwgeyBsYWJlbDogJ3BMRERUIGxlc3MgdGhhbicsIGRlc2NyaXB0aW9uOiAncExERFQgc2NvcmUgdmFsdWUgaW4gdGhlIHJhbmdlIG9mIDAgdG8gMTAwJyB9KSxcbiAgICBvcGFjaXR5OiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLk51bWVyaWMoMC4yLCB7IG1pbjogMCwgbWF4OiAxLCBzdGVwOiAwLjAxIH0sIHsgZGVzY3JpcHRpb246ICdPcGFjaXR5IHZhbHVlIGluIHRoZSByYW5nZSAwIHRvIDEnIH0pXG59O1xudmFyIEFscGhhZm9sZFRyYW5zcGFyZW5jeUNvbnRyb2xzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEFscGhhZm9sZFRyYW5zcGFyZW5jeUNvbnRyb2xzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFscGhhZm9sZFRyYW5zcGFyZW5jeUNvbnRyb2xzKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMudXBkYXRlVHJhbnNwYXJlbmN5ID0gZnVuY3Rpb24gKHZhbCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3VwZXJwb3NpdGlvblN0YXRlLCBhZlN0cjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRyYW5zcGFyZW55OiB2YWwgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdXBlcnBvc2l0aW9uU3RhdGUgPSB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZlN0ciA9IHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudC5yZWZzLmdldChzdXBlcnBvc2l0aW9uU3RhdGUuYWxwaGFmb2xkLnJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoMCwgYWxwaGFmb2xkX3RyYW5zcGFyZW5jeV8xLmNsZWFyU3RydWN0dXJlVHJhbnNwYXJlbmN5KSh0aGlzLnBsdWdpbiwgYWZTdHIuY29tcG9uZW50cyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoMCwgYWxwaGFmb2xkX3RyYW5zcGFyZW5jeV8xLmFwcGx5QUZUcmFuc3BhcmVuY3kpKHRoaXMucGx1Z2luLCBhZlN0ciwgMSAtIHZhbC5vcGFjaXR5LCB2YWwuc2NvcmUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBBbHBoYWZvbGRUcmFuc3BhcmVuY3lDb250cm9scy5wcm90b3R5cGUuZGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNDb2xsYXBzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgaGVhZGVyOiAnQWxwaGFGb2xkIFN0cnVjdHVyZSBPcGFjaXR5JyxcbiAgICAgICAgICAgIGJyYW5kOiB7IGFjY2VudDogJ2dyYXknLCBzdmc6IGljb25zXzEuU3VwZXJwb3NpdGlvblN2ZyB9LFxuICAgICAgICAgICAgaXNIaWRkZW46IHRydWUsXG4gICAgICAgICAgICB0cmFuc3BhcmVueToge1xuICAgICAgICAgICAgICAgIHNjb3JlOiA3MCxcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEFscGhhZm9sZFRyYW5zcGFyZW5jeUNvbnRyb2xzLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5iZWhhdmlvcnMuc2VsZWN0aW9uLCBmdW5jdGlvbiAoc2VsKSB7XG4gICAgICAgICAgICB2YXIgc3VwZXJwb3NpdGlvblN0YXRlID0gX3RoaXMucGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgICAgIGlmIChzdXBlcnBvc2l0aW9uU3RhdGUgJiYgc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5yZWYgJiYgc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5yZWYgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc0hpZGRlbjogZmFsc2UgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWxwaGFmb2xkVHJhbnNwYXJlbmN5Q29udHJvbHMucHJvdG90eXBlLnJlbmRlckNvbnRyb2xzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHBhcmFtZXRlcnNfMS5QYXJhbWV0ZXJDb250cm9scywgeyBwYXJhbXM6IFRyYW5zcGFyZW5jeVBhcmFtcywgdmFsdWVzOiB0aGlzLnN0YXRlLnRyYW5zcGFyZW55LCBvbkNoYW5nZVZhbHVlczogdGhpcy51cGRhdGVUcmFuc3BhcmVuY3kgfSkgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQWxwaGFmb2xkVHJhbnNwYXJlbmN5Q29udHJvbHM7XG59KGJhc2VfMS5Db2xsYXBzYWJsZUNvbnRyb2xzKSk7XG5leHBvcnRzLkFscGhhZm9sZFRyYW5zcGFyZW5jeUNvbnRyb2xzID0gQWxwaGFmb2xkVHJhbnNwYXJlbmN5Q29udHJvbHM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbHBoYWZvbGQtdHJhbnBhcmVuY3kuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/ui/alphafold-tranparency.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/annotation-controls.js":
  /*!***************************************!*\
    !*** ./lib/ui/annotation-controls.js ***!
    \***************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.AnnotationsComponentControls = exports.TextsmsOutlinedSvg = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar color_1 = __webpack_require__(/*! Molstar/extensions/pdbe/structure-quality-report/color */ \"./node_modules/molstar/lib/extensions/pdbe/structure-quality-report/color.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar color_2 = __webpack_require__(/*! ../domain-annotations/color */ \"./lib/domain-annotations/color.js\");\nvar behavior_1 = __webpack_require__(/*! Molstar/extensions/pdbe/structure-quality-report/behavior */ \"./node_modules/molstar/lib/extensions/pdbe/structure-quality-report/behavior.js\");\nvar behavior_2 = __webpack_require__(/*! ../domain-annotations/behavior */ \"./lib/domain-annotations/behavior.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar hierarchy_1 = __webpack_require__(/*! Molstar/mol-plugin-state/manager/structure/hierarchy */ \"./node_modules/molstar/lib/mol-plugin-state/manager/structure/hierarchy.js\");\nvar _TextsmsOutlined = (0, jsx_runtime_1.jsxs)(\"svg\", tslib_1.__assign({ width: '24px', height: '24px', viewBox: '0 0 24 24' }, { children: [(0, jsx_runtime_1.jsx)(\"path\", { fill: \"none\", d: \"M0 0h24v24H0V0z\" }), (0, jsx_runtime_1.jsxs)(\"g\", { children: [(0, jsx_runtime_1.jsx)(\"path\", { d: \"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z\" }), (0, jsx_runtime_1.jsx)(\"path\", { d: \"M7 9h2v2H7zM11 9h2v2h-2zM15 9h2v2h-2z\" })] })] }));\nfunction TextsmsOutlinedSvg() { return _TextsmsOutlined; }\nexports.TextsmsOutlinedSvg = TextsmsOutlinedSvg;\nvar AnnotationsComponentControls = /** @class */ (function (_super) {\n    tslib_1.__extends(AnnotationsComponentControls, _super);\n    function AnnotationsComponentControls() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            isCollapsed: false,\n            validationApplied: false,\n            domainAtnApplied: false,\n            validationOptions: false,\n            domainAtnOptions: false\n        };\n        _this.getOptionParams = function () {\n            var validationAnnotationCtrl = false;\n            var domainAnnotationCtrl = false;\n            var customState = _this.plugin.customState;\n            if (customState && customState.initParams) {\n                if (customState.initParams.validationAnnotation)\n                    validationAnnotationCtrl = true;\n                if (customState.initParams.domainAnnotation)\n                    domainAnnotationCtrl = true;\n            }\n            if ((validationAnnotationCtrl && !_this.state.validationParams) || (domainAnnotationCtrl && !_this.state.domainAtnParams)) {\n                var groupRef = mol_state_1.StateSelection.findTagInSubtree(_this.plugin.state.data.tree, mol_state_1.StateTransform.RootRef, 'structure-component-static-polymer');\n                if (groupRef) {\n                    var struct = _this.plugin.state.data.select(groupRef)[0].obj;\n                    if (struct) {\n                        var themeDataCtx = { structure: struct.data };\n                        if (validationAnnotationCtrl && !_this.state.validationParams) {\n                            var validationActionsParams = color_1.StructureQualityReportColorThemeProvider.getParams(themeDataCtx);\n                            if (validationActionsParams) {\n                                _this.setState({ validationParams: {\n                                        params: validationActionsParams,\n                                        values: { type: validationActionsParams.type.defaultValue }\n                                    } });\n                            }\n                        }\n                        if (domainAnnotationCtrl && !_this.state.domainAtnParams) {\n                            var domainActionsParams = color_2.DomainAnnotationsColorThemeProvider.getParams(themeDataCtx);\n                            if (domainActionsParams) {\n                                _this.setState({ domainAtnParams: {\n                                        params: domainActionsParams,\n                                        values: { type: domainActionsParams.type.defaultValue }\n                                    } });\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        _this.toggleCollapsed = function () {\n            _this.setState({ isCollapsed: !_this.state.isCollapsed });\n        };\n        _this.toggleOptions = function (type) {\n            if (type === 0)\n                _this.setState({ validationOptions: !_this.state.validationOptions });\n            if (type === 1)\n                _this.setState({ domainAtnOptions: !_this.state.domainAtnOptions });\n        };\n        _this.applyAnnotation = function (type, visibleState, params) {\n            // Defaults\n            var themeName = 'polymer-id';\n            var themePropsToAdd = behavior_1.PDBeStructureQualityReport;\n            var themePropsToRemove = _this.state.domainAtnParams ? behavior_2.PDBeDomainAnnotations : void 0;\n            // Set Theme Params\n            if (type === 0) {\n                if (visibleState) {\n                    themeName = 'pdbe-structure-quality-report';\n                }\n                _this.setState({ validationApplied: visibleState });\n                _this.setState({ domainAtnApplied: false });\n            }\n            else {\n                themePropsToAdd = behavior_2.PDBeDomainAnnotations;\n                themePropsToRemove = _this.state.validationParams ? behavior_1.PDBeStructureQualityReport : void 0;\n                if (visibleState)\n                    themeName = 'pdbe-domain-annotations';\n                _this.setState({ domainAtnApplied: visibleState });\n                _this.setState({ validationApplied: false });\n            }\n            // Update Tooltip\n            if (visibleState && themeName !== 'polymer-id') {\n                var addTooltipUpdate = _this.plugin.state.behaviors.build().to(themePropsToAdd.id).update(themePropsToAdd, function (old) { old.showTooltip = true; });\n                _this.plugin.runTask(_this.plugin.state.behaviors.updateTree(addTooltipUpdate));\n                if (themePropsToRemove) {\n                    var removeTooltipUpdate = _this.plugin.state.behaviors.build().to(themePropsToRemove.id).update(themePropsToRemove, function (old) { old.showTooltip = false; });\n                    _this.plugin.runTask(_this.plugin.state.behaviors.updateTree(removeTooltipUpdate));\n                }\n            }\n            var polymerGroup;\n            var componentGroups = _this.plugin.managers.structure.hierarchy.currentComponentGroups;\n            componentGroups.forEach(function (compGrp) {\n                if (compGrp[0].key === 'structure-component-static-polymer')\n                    polymerGroup = compGrp;\n            });\n            if (polymerGroup) {\n                _this.plugin.managers.structure.component.updateRepresentationsTheme(polymerGroup, { color: themeName, colorParams: params ? params : void 0 });\n            }\n        };\n        _this.initApplyAnnotation = function (type) {\n            if (type === 0)\n                _this.applyAnnotation(0, !_this.state.validationApplied, _this.state.validationParams.values);\n            if (type === 1)\n                _this.applyAnnotation(1, !_this.state.domainAtnApplied, _this.state.domainAtnParams.values);\n        };\n        _this.updateValidationParams = function (val) {\n            var updatedParams = tslib_1.__assign({}, _this.state.validationParams);\n            updatedParams.values = val;\n            _this.setState({ validationParams: updatedParams });\n            if (_this.state.validationApplied)\n                _this.applyAnnotation(0, _this.state.validationApplied, val);\n        };\n        _this.updateDomainAtnParams = function (val) {\n            var updatedParams = tslib_1.__assign({}, _this.state.domainAtnParams);\n            updatedParams.values = val;\n            _this.setState({ domainAtnParams: updatedParams });\n            if (_this.state.domainAtnApplied)\n                _this.applyAnnotation(1, _this.state.domainAtnApplied, val);\n        };\n        return _this;\n    }\n    AnnotationsComponentControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function () {\n            _this.getOptionParams();\n            _this.forceUpdate();\n        });\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function (c) { return _this.setState({\n            description: hierarchy_1.StructureHierarchyManager.getSelectedStructuresDescription(_this.plugin)\n        }); });\n    };\n    AnnotationsComponentControls.prototype.render = function () {\n        var _this = this;\n        if (!this.state.validationParams && !this.state.domainAtnParams)\n            return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, {});\n        var brand = {\n            accent: 'green',\n            svg: TextsmsOutlinedSvg\n        };\n        var wrapClass = this.state.isCollapsed\n            ? 'msp-transform-wrapper msp-transform-wrapper-collapsed'\n            : 'msp-transform-wrapper';\n        return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: wrapClass }, { children: [(0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-transform-header' }, { children: (0, jsx_runtime_1.jsxs)(common_1.Button, tslib_1.__assign({ icon: brand ? void 0 : this.state.isCollapsed ? icons_1.ArrowRightSvg : icons_1.ArrowDropDownSvg, noOverflow: true, onClick: this.toggleCollapsed, className: brand ? \"msp-transform-header-brand msp-transform-header-brand-\".concat(brand.accent) : void 0, title: \"Click to \".concat(this.state.isCollapsed ? 'expand' : 'collapse') }, { children: [(0, jsx_runtime_1.jsx)(icons_1.Icon, { svg: brand === null || brand === void 0 ? void 0 : brand.svg, inline: true }), \"Annotations\", (0, jsx_runtime_1.jsx)(\"small\", tslib_1.__assign({ style: { margin: '0 6px' } }, { children: this.state.isCollapsed ? '' : this.state.description }))] })) })), !this.state.isCollapsed && this.state.validationParams &&\n                    (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [(0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ noOverflow: true, className: 'msp-control-button-label', title: \"Validation Report Annotations.\", style: { textAlign: 'left' } }, { children: \"Validation Report\" })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { onClick: function () { return _this.initApplyAnnotation(0); }, toggleState: false, svg: !this.state.validationApplied ? icons_1.VisibilityOffOutlinedSvg : icons_1.VisibilityOutlinedSvg, title: \"Click to \".concat(this.state.validationApplied ? 'Hide' : 'Show', \" Validation Report Annotation\"), small: true, className: 'msp-form-control', flex: true }), (0, jsx_runtime_1.jsx)(common_1.IconButton, { onClick: function () { return _this.toggleOptions(0); }, svg: icons_1.MoreHorizSvg, title: 'Actions', toggleState: this.state.validationOptions, className: 'msp-form-control', flex: true })] })), !this.state.isCollapsed && this.state.validationParams && this.state.validationOptions && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { marginBottom: '6px' } }, { children: (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: \"msp-accent-offset\" }, { children: (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: this.state.validationParams.params, values: this.state.validationParams.values, onChangeValues: this.updateValidationParams }) })) })) })), !this.state.isCollapsed && this.state.domainAtnParams &&\n                    (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [(0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ noOverflow: true, className: 'msp-control-button-label', title: \"Domain Annotations.\", style: { textAlign: 'left' } }, { children: \"Domains\" })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { onClick: function () { return _this.initApplyAnnotation(1); }, toggleState: false, svg: !this.state.domainAtnApplied ? icons_1.VisibilityOffOutlinedSvg : icons_1.VisibilityOutlinedSvg, title: \"Click to \".concat(this.state.domainAtnApplied ? 'Hide' : 'Show', \" Domain Annotation\"), small: true, className: 'msp-form-control', flex: true }), (0, jsx_runtime_1.jsx)(common_1.IconButton, { onClick: function () { return _this.toggleOptions(1); }, svg: icons_1.MoreHorizSvg, title: 'Actions', toggleState: this.state.domainAtnOptions, className: 'msp-form-control', flex: true })] })), !this.state.isCollapsed && this.state.domainAtnParams && this.state.domainAtnOptions && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { marginBottom: '6px' } }, { children: (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: \"msp-accent-offset\" }, { children: (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: this.state.domainAtnParams.params, values: this.state.domainAtnParams.values, onChangeValues: this.updateDomainAtnParams }) })) })) }))] }));\n    };\n    return AnnotationsComponentControls;\n}(base_1.PurePluginUIComponent));\nexports.AnnotationsComponentControls = AnnotationsComponentControls;\n//# sourceMappingURL=annotation-controls.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dUJBQXVCLGdDQUFnQyxxSUFBcUksSUFBSSwrSUFBK0ksU0FBUyx1QkFBdUIsSUFBSSwyREFBMkQsZ0NBQWdDLElBQUksMkRBQTJELHVDQUF1QyxJQUFJLG1FQUFtRSxxSUFBcUksR0FBRyxJQUFJLElBQUk7QUFDMWhELHNFQUFzRSwyQkFBMkIsSUFBSSxzRUFBc0UsZ0dBQWdHLHFCQUFxQixJQUFJLHFCQUFxQixrREFBa0QsdUJBQXVCLHNDQUFzQyxvUkFBb1IsaURBQWlELHVCQUF1QixnQ0FBZ0Msb0lBQW9JLElBQUksNklBQTZJLFNBQVMsdUJBQXVCLElBQUksMkRBQTJELGdDQUFnQyxJQUFJLDJEQUEyRCx1Q0FBdUMsSUFBSSxtRUFBbUUsa0lBQWtJLEdBQUcsSUFBSSxJQUFJLEtBQUs7QUFDdi9DO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsb0NBQW9DO0FBQ3BDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3VpL2Fubm90YXRpb24tY29udHJvbHMuanM/MjU3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQW5ub3RhdGlvbnNDb21wb25lbnRDb250cm9scyA9IGV4cG9ydHMuVGV4dHNtc091dGxpbmVkU3ZnID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIganN4X3J1bnRpbWVfMSA9IHJlcXVpcmUoXCJyZWFjdC9qc3gtcnVudGltZVwiKTtcbnZhciBjb21tb25fMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvY29tbW9uXCIpO1xudmFyIGJhc2VfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvYmFzZVwiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvZXh0ZW5zaW9ucy9wZGJlL3N0cnVjdHVyZS1xdWFsaXR5LXJlcG9ydC9jb2xvclwiKTtcbnZhciBtb2xfc3RhdGVfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1zdGF0ZVwiKTtcbnZhciBwYXJhbWV0ZXJzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL3BhcmFtZXRlcnNcIik7XG52YXIgY29sb3JfMiA9IHJlcXVpcmUoXCIuLi9kb21haW4tYW5ub3RhdGlvbnMvY29sb3JcIik7XG52YXIgYmVoYXZpb3JfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL2V4dGVuc2lvbnMvcGRiZS9zdHJ1Y3R1cmUtcXVhbGl0eS1yZXBvcnQvYmVoYXZpb3JcIik7XG52YXIgYmVoYXZpb3JfMiA9IHJlcXVpcmUoXCIuLi9kb21haW4tYW5ub3RhdGlvbnMvYmVoYXZpb3JcIik7XG52YXIgaWNvbnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvaWNvbnNcIik7XG52YXIgaGllcmFyY2h5XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXN0YXRlL21hbmFnZXIvc3RydWN0dXJlL2hpZXJhcmNoeVwiKTtcbnZhciBfVGV4dHNtc091dGxpbmVkID0gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJzdmdcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IHdpZHRoOiAnMjRweCcsIGhlaWdodDogJzI0cHgnLCB2aWV3Qm94OiAnMCAwIDI0IDI0JyB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcInBhdGhcIiwgeyBmaWxsOiBcIm5vbmVcIiwgZDogXCJNMCAwaDI0djI0SDBWMHpcIiB9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJnXCIsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwicGF0aFwiLCB7IGQ6IFwiTTIwIDJINGMtMS4xIDAtMiAuOS0yIDJ2MThsNC00aDE0YzEuMSAwIDItLjkgMi0yVjRjMC0xLjEtLjktMi0yLTJ6bTAgMTRINmwtMiAyVjRoMTZ2MTJ6XCIgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJwYXRoXCIsIHsgZDogXCJNNyA5aDJ2Mkg3ek0xMSA5aDJ2MmgtMnpNMTUgOWgydjJoLTJ6XCIgfSldIH0pXSB9KSk7XG5mdW5jdGlvbiBUZXh0c21zT3V0bGluZWRTdmcoKSB7IHJldHVybiBfVGV4dHNtc091dGxpbmVkOyB9XG5leHBvcnRzLlRleHRzbXNPdXRsaW5lZFN2ZyA9IFRleHRzbXNPdXRsaW5lZFN2ZztcbnZhciBBbm5vdGF0aW9uc0NvbXBvbmVudENvbnRyb2xzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEFubm90YXRpb25zQ29tcG9uZW50Q29udHJvbHMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQW5ub3RhdGlvbnNDb21wb25lbnRDb250cm9scygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaXNDb2xsYXBzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgdmFsaWRhdGlvbkFwcGxpZWQ6IGZhbHNlLFxuICAgICAgICAgICAgZG9tYWluQXRuQXBwbGllZDogZmFsc2UsXG4gICAgICAgICAgICB2YWxpZGF0aW9uT3B0aW9uczogZmFsc2UsXG4gICAgICAgICAgICBkb21haW5BdG5PcHRpb25zOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5nZXRPcHRpb25QYXJhbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmFsaWRhdGlvbkFubm90YXRpb25DdHJsID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgZG9tYWluQW5ub3RhdGlvbkN0cmwgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBjdXN0b21TdGF0ZSA9IF90aGlzLnBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgICAgIGlmIChjdXN0b21TdGF0ZSAmJiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1c3RvbVN0YXRlLmluaXRQYXJhbXMudmFsaWRhdGlvbkFubm90YXRpb24pXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25Bbm5vdGF0aW9uQ3RybCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGN1c3RvbVN0YXRlLmluaXRQYXJhbXMuZG9tYWluQW5ub3RhdGlvbilcbiAgICAgICAgICAgICAgICAgICAgZG9tYWluQW5ub3RhdGlvbkN0cmwgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCh2YWxpZGF0aW9uQW5ub3RhdGlvbkN0cmwgJiYgIV90aGlzLnN0YXRlLnZhbGlkYXRpb25QYXJhbXMpIHx8IChkb21haW5Bbm5vdGF0aW9uQ3RybCAmJiAhX3RoaXMuc3RhdGUuZG9tYWluQXRuUGFyYW1zKSkge1xuICAgICAgICAgICAgICAgIHZhciBncm91cFJlZiA9IG1vbF9zdGF0ZV8xLlN0YXRlU2VsZWN0aW9uLmZpbmRUYWdJblN1YnRyZWUoX3RoaXMucGx1Z2luLnN0YXRlLmRhdGEudHJlZSwgbW9sX3N0YXRlXzEuU3RhdGVUcmFuc2Zvcm0uUm9vdFJlZiwgJ3N0cnVjdHVyZS1jb21wb25lbnQtc3RhdGljLXBvbHltZXInKTtcbiAgICAgICAgICAgICAgICBpZiAoZ3JvdXBSZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cnVjdCA9IF90aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLnNlbGVjdChncm91cFJlZilbMF0ub2JqO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RydWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhlbWVEYXRhQ3R4ID0geyBzdHJ1Y3R1cmU6IHN0cnVjdC5kYXRhIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbkFubm90YXRpb25DdHJsICYmICFfdGhpcy5zdGF0ZS52YWxpZGF0aW9uUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGlkYXRpb25BY3Rpb25zUGFyYW1zID0gY29sb3JfMS5TdHJ1Y3R1cmVRdWFsaXR5UmVwb3J0Q29sb3JUaGVtZVByb3ZpZGVyLmdldFBhcmFtcyh0aGVtZURhdGFDdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uQWN0aW9uc1BhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHZhbGlkYXRpb25QYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHZhbGlkYXRpb25BY3Rpb25zUGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogeyB0eXBlOiB2YWxpZGF0aW9uQWN0aW9uc1BhcmFtcy50eXBlLmRlZmF1bHRWYWx1ZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21haW5Bbm5vdGF0aW9uQ3RybCAmJiAhX3RoaXMuc3RhdGUuZG9tYWluQXRuUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRvbWFpbkFjdGlvbnNQYXJhbXMgPSBjb2xvcl8yLkRvbWFpbkFubm90YXRpb25zQ29sb3JUaGVtZVByb3ZpZGVyLmdldFBhcmFtcyh0aGVtZURhdGFDdHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21haW5BY3Rpb25zUGFyYW1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgZG9tYWluQXRuUGFyYW1zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBkb21haW5BY3Rpb25zUGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogeyB0eXBlOiBkb21haW5BY3Rpb25zUGFyYW1zLnR5cGUuZGVmYXVsdFZhbHVlIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy50b2dnbGVDb2xsYXBzZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzQ29sbGFwc2VkOiAhX3RoaXMuc3RhdGUuaXNDb2xsYXBzZWQgfSk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnRvZ2dsZU9wdGlvbnMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IDApXG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyB2YWxpZGF0aW9uT3B0aW9uczogIV90aGlzLnN0YXRlLnZhbGlkYXRpb25PcHRpb25zIH0pO1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IDEpXG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBkb21haW5BdG5PcHRpb25zOiAhX3RoaXMuc3RhdGUuZG9tYWluQXRuT3B0aW9ucyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuYXBwbHlBbm5vdGF0aW9uID0gZnVuY3Rpb24gKHR5cGUsIHZpc2libGVTdGF0ZSwgcGFyYW1zKSB7XG4gICAgICAgICAgICAvLyBEZWZhdWx0c1xuICAgICAgICAgICAgdmFyIHRoZW1lTmFtZSA9ICdwb2x5bWVyLWlkJztcbiAgICAgICAgICAgIHZhciB0aGVtZVByb3BzVG9BZGQgPSBiZWhhdmlvcl8xLlBEQmVTdHJ1Y3R1cmVRdWFsaXR5UmVwb3J0O1xuICAgICAgICAgICAgdmFyIHRoZW1lUHJvcHNUb1JlbW92ZSA9IF90aGlzLnN0YXRlLmRvbWFpbkF0blBhcmFtcyA/IGJlaGF2aW9yXzIuUERCZURvbWFpbkFubm90YXRpb25zIDogdm9pZCAwO1xuICAgICAgICAgICAgLy8gU2V0IFRoZW1lIFBhcmFtc1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBpZiAodmlzaWJsZVN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoZW1lTmFtZSA9ICdwZGJlLXN0cnVjdHVyZS1xdWFsaXR5LXJlcG9ydCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgdmFsaWRhdGlvbkFwcGxpZWQ6IHZpc2libGVTdGF0ZSB9KTtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGRvbWFpbkF0bkFwcGxpZWQ6IGZhbHNlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhlbWVQcm9wc1RvQWRkID0gYmVoYXZpb3JfMi5QREJlRG9tYWluQW5ub3RhdGlvbnM7XG4gICAgICAgICAgICAgICAgdGhlbWVQcm9wc1RvUmVtb3ZlID0gX3RoaXMuc3RhdGUudmFsaWRhdGlvblBhcmFtcyA/IGJlaGF2aW9yXzEuUERCZVN0cnVjdHVyZVF1YWxpdHlSZXBvcnQgOiB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKHZpc2libGVTdGF0ZSlcbiAgICAgICAgICAgICAgICAgICAgdGhlbWVOYW1lID0gJ3BkYmUtZG9tYWluLWFubm90YXRpb25zJztcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGRvbWFpbkF0bkFwcGxpZWQ6IHZpc2libGVTdGF0ZSB9KTtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHZhbGlkYXRpb25BcHBsaWVkOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBUb29sdGlwXG4gICAgICAgICAgICBpZiAodmlzaWJsZVN0YXRlICYmIHRoZW1lTmFtZSAhPT0gJ3BvbHltZXItaWQnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFkZFRvb2x0aXBVcGRhdGUgPSBfdGhpcy5wbHVnaW4uc3RhdGUuYmVoYXZpb3JzLmJ1aWxkKCkudG8odGhlbWVQcm9wc1RvQWRkLmlkKS51cGRhdGUodGhlbWVQcm9wc1RvQWRkLCBmdW5jdGlvbiAob2xkKSB7IG9sZC5zaG93VG9vbHRpcCA9IHRydWU7IH0pO1xuICAgICAgICAgICAgICAgIF90aGlzLnBsdWdpbi5ydW5UYXNrKF90aGlzLnBsdWdpbi5zdGF0ZS5iZWhhdmlvcnMudXBkYXRlVHJlZShhZGRUb29sdGlwVXBkYXRlKSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoZW1lUHJvcHNUb1JlbW92ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlVG9vbHRpcFVwZGF0ZSA9IF90aGlzLnBsdWdpbi5zdGF0ZS5iZWhhdmlvcnMuYnVpbGQoKS50byh0aGVtZVByb3BzVG9SZW1vdmUuaWQpLnVwZGF0ZSh0aGVtZVByb3BzVG9SZW1vdmUsIGZ1bmN0aW9uIChvbGQpIHsgb2xkLnNob3dUb29sdGlwID0gZmFsc2U7IH0pO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW4ucnVuVGFzayhfdGhpcy5wbHVnaW4uc3RhdGUuYmVoYXZpb3JzLnVwZGF0ZVRyZWUocmVtb3ZlVG9vbHRpcFVwZGF0ZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwb2x5bWVyR3JvdXA7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50R3JvdXBzID0gX3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudENvbXBvbmVudEdyb3VwcztcbiAgICAgICAgICAgIGNvbXBvbmVudEdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChjb21wR3JwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBHcnBbMF0ua2V5ID09PSAnc3RydWN0dXJlLWNvbXBvbmVudC1zdGF0aWMtcG9seW1lcicpXG4gICAgICAgICAgICAgICAgICAgIHBvbHltZXJHcm91cCA9IGNvbXBHcnA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChwb2x5bWVyR3JvdXApIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmNvbXBvbmVudC51cGRhdGVSZXByZXNlbnRhdGlvbnNUaGVtZShwb2x5bWVyR3JvdXAsIHsgY29sb3I6IHRoZW1lTmFtZSwgY29sb3JQYXJhbXM6IHBhcmFtcyA/IHBhcmFtcyA6IHZvaWQgMCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuaW5pdEFwcGx5QW5ub3RhdGlvbiA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gMClcbiAgICAgICAgICAgICAgICBfdGhpcy5hcHBseUFubm90YXRpb24oMCwgIV90aGlzLnN0YXRlLnZhbGlkYXRpb25BcHBsaWVkLCBfdGhpcy5zdGF0ZS52YWxpZGF0aW9uUGFyYW1zLnZhbHVlcyk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gMSlcbiAgICAgICAgICAgICAgICBfdGhpcy5hcHBseUFubm90YXRpb24oMSwgIV90aGlzLnN0YXRlLmRvbWFpbkF0bkFwcGxpZWQsIF90aGlzLnN0YXRlLmRvbWFpbkF0blBhcmFtcy52YWx1ZXMpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy51cGRhdGVWYWxpZGF0aW9uUGFyYW1zID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgdmFyIHVwZGF0ZWRQYXJhbXMgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBfdGhpcy5zdGF0ZS52YWxpZGF0aW9uUGFyYW1zKTtcbiAgICAgICAgICAgIHVwZGF0ZWRQYXJhbXMudmFsdWVzID0gdmFsO1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyB2YWxpZGF0aW9uUGFyYW1zOiB1cGRhdGVkUGFyYW1zIH0pO1xuICAgICAgICAgICAgaWYgKF90aGlzLnN0YXRlLnZhbGlkYXRpb25BcHBsaWVkKVxuICAgICAgICAgICAgICAgIF90aGlzLmFwcGx5QW5ub3RhdGlvbigwLCBfdGhpcy5zdGF0ZS52YWxpZGF0aW9uQXBwbGllZCwgdmFsKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMudXBkYXRlRG9tYWluQXRuUGFyYW1zID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgdmFyIHVwZGF0ZWRQYXJhbXMgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBfdGhpcy5zdGF0ZS5kb21haW5BdG5QYXJhbXMpO1xuICAgICAgICAgICAgdXBkYXRlZFBhcmFtcy52YWx1ZXMgPSB2YWw7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGRvbWFpbkF0blBhcmFtczogdXBkYXRlZFBhcmFtcyB9KTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS5kb21haW5BdG5BcHBsaWVkKVxuICAgICAgICAgICAgICAgIF90aGlzLmFwcGx5QW5ub3RhdGlvbigxLCBfdGhpcy5zdGF0ZS5kb21haW5BdG5BcHBsaWVkLCB2YWwpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEFubm90YXRpb25zQ29tcG9uZW50Q29udHJvbHMucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmJlaGF2aW9ycy5zZWxlY3Rpb24sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLmdldE9wdGlvblBhcmFtcygpO1xuICAgICAgICAgICAgX3RoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuYmVoYXZpb3JzLnNlbGVjdGlvbiwgZnVuY3Rpb24gKGMpIHsgcmV0dXJuIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBoaWVyYXJjaHlfMS5TdHJ1Y3R1cmVIaWVyYXJjaHlNYW5hZ2VyLmdldFNlbGVjdGVkU3RydWN0dXJlc0Rlc2NyaXB0aW9uKF90aGlzLnBsdWdpbilcbiAgICAgICAgfSk7IH0pO1xuICAgIH07XG4gICAgQW5ub3RhdGlvbnNDb21wb25lbnRDb250cm9scy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUudmFsaWRhdGlvblBhcmFtcyAmJiAhdGhpcy5zdGF0ZS5kb21haW5BdG5QYXJhbXMpXG4gICAgICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7fSk7XG4gICAgICAgIHZhciBicmFuZCA9IHtcbiAgICAgICAgICAgIGFjY2VudDogJ2dyZWVuJyxcbiAgICAgICAgICAgIHN2ZzogVGV4dHNtc091dGxpbmVkU3ZnXG4gICAgICAgIH07XG4gICAgICAgIHZhciB3cmFwQ2xhc3MgPSB0aGlzLnN0YXRlLmlzQ29sbGFwc2VkXG4gICAgICAgICAgICA/ICdtc3AtdHJhbnNmb3JtLXdyYXBwZXIgbXNwLXRyYW5zZm9ybS13cmFwcGVyLWNvbGxhcHNlZCdcbiAgICAgICAgICAgIDogJ21zcC10cmFuc2Zvcm0td3JhcHBlcic7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiB3cmFwQ2xhc3MgfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC10cmFuc2Zvcm0taGVhZGVyJyB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBpY29uOiBicmFuZCA/IHZvaWQgMCA6IHRoaXMuc3RhdGUuaXNDb2xsYXBzZWQgPyBpY29uc18xLkFycm93UmlnaHRTdmcgOiBpY29uc18xLkFycm93RHJvcERvd25TdmcsIG5vT3ZlcmZsb3c6IHRydWUsIG9uQ2xpY2s6IHRoaXMudG9nZ2xlQ29sbGFwc2VkLCBjbGFzc05hbWU6IGJyYW5kID8gXCJtc3AtdHJhbnNmb3JtLWhlYWRlci1icmFuZCBtc3AtdHJhbnNmb3JtLWhlYWRlci1icmFuZC1cIi5jb25jYXQoYnJhbmQuYWNjZW50KSA6IHZvaWQgMCwgdGl0bGU6IFwiQ2xpY2sgdG8gXCIuY29uY2F0KHRoaXMuc3RhdGUuaXNDb2xsYXBzZWQgPyAnZXhwYW5kJyA6ICdjb2xsYXBzZScpIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGljb25zXzEuSWNvbiwgeyBzdmc6IGJyYW5kID09PSBudWxsIHx8IGJyYW5kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBicmFuZC5zdmcsIGlubGluZTogdHJ1ZSB9KSwgXCJBbm5vdGF0aW9uc1wiLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwic21hbGxcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IHN0eWxlOiB7IG1hcmdpbjogJzAgNnB4JyB9IH0sIHsgY2hpbGRyZW46IHRoaXMuc3RhdGUuaXNDb2xsYXBzZWQgPyAnJyA6IHRoaXMuc3RhdGUuZGVzY3JpcHRpb24gfSkpXSB9KSkgfSkpLCAhdGhpcy5zdGF0ZS5pc0NvbGxhcHNlZCAmJiB0aGlzLnN0YXRlLnZhbGlkYXRpb25QYXJhbXMgJiZcbiAgICAgICAgICAgICAgICAgICAgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1mbGV4LXJvdycgfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQnV0dG9uLCB0c2xpYl8xLl9fYXNzaWduKHsgbm9PdmVyZmxvdzogdHJ1ZSwgY2xhc3NOYW1lOiAnbXNwLWNvbnRyb2wtYnV0dG9uLWxhYmVsJywgdGl0bGU6IFwiVmFsaWRhdGlvbiBSZXBvcnQgQW5ub3RhdGlvbnMuXCIsIHN0eWxlOiB7IHRleHRBbGlnbjogJ2xlZnQnIH0gfSwgeyBjaGlsZHJlbjogXCJWYWxpZGF0aW9uIFJlcG9ydFwiIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5JY29uQnV0dG9uLCB7IG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmluaXRBcHBseUFubm90YXRpb24oMCk7IH0sIHRvZ2dsZVN0YXRlOiBmYWxzZSwgc3ZnOiAhdGhpcy5zdGF0ZS52YWxpZGF0aW9uQXBwbGllZCA/IGljb25zXzEuVmlzaWJpbGl0eU9mZk91dGxpbmVkU3ZnIDogaWNvbnNfMS5WaXNpYmlsaXR5T3V0bGluZWRTdmcsIHRpdGxlOiBcIkNsaWNrIHRvIFwiLmNvbmNhdCh0aGlzLnN0YXRlLnZhbGlkYXRpb25BcHBsaWVkID8gJ0hpZGUnIDogJ1Nob3cnLCBcIiBWYWxpZGF0aW9uIFJlcG9ydCBBbm5vdGF0aW9uXCIpLCBzbWFsbDogdHJ1ZSwgY2xhc3NOYW1lOiAnbXNwLWZvcm0tY29udHJvbCcsIGZsZXg6IHRydWUgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy50b2dnbGVPcHRpb25zKDApOyB9LCBzdmc6IGljb25zXzEuTW9yZUhvcml6U3ZnLCB0aXRsZTogJ0FjdGlvbnMnLCB0b2dnbGVTdGF0ZTogdGhpcy5zdGF0ZS52YWxpZGF0aW9uT3B0aW9ucywgY2xhc3NOYW1lOiAnbXNwLWZvcm0tY29udHJvbCcsIGZsZXg6IHRydWUgfSldIH0pKSwgIXRoaXMuc3RhdGUuaXNDb2xsYXBzZWQgJiYgdGhpcy5zdGF0ZS52YWxpZGF0aW9uUGFyYW1zICYmIHRoaXMuc3RhdGUudmFsaWRhdGlvbk9wdGlvbnMgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgbWFyZ2luQm90dG9tOiAnNnB4JyB9IH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogXCJtc3AtYWNjZW50LW9mZnNldFwiIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1yZXByZXNlbnRhdGlvbi1lbnRyeScgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShwYXJhbWV0ZXJzXzEuUGFyYW1ldGVyQ29udHJvbHMsIHsgcGFyYW1zOiB0aGlzLnN0YXRlLnZhbGlkYXRpb25QYXJhbXMucGFyYW1zLCB2YWx1ZXM6IHRoaXMuc3RhdGUudmFsaWRhdGlvblBhcmFtcy52YWx1ZXMsIG9uQ2hhbmdlVmFsdWVzOiB0aGlzLnVwZGF0ZVZhbGlkYXRpb25QYXJhbXMgfSkgfSkpIH0pKSB9KSksICF0aGlzLnN0YXRlLmlzQ29sbGFwc2VkICYmIHRoaXMuc3RhdGUuZG9tYWluQXRuUGFyYW1zICYmXG4gICAgICAgICAgICAgICAgICAgICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtZmxleC1yb3cnIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgdHNsaWJfMS5fX2Fzc2lnbih7IG5vT3ZlcmZsb3c6IHRydWUsIGNsYXNzTmFtZTogJ21zcC1jb250cm9sLWJ1dHRvbi1sYWJlbCcsIHRpdGxlOiBcIkRvbWFpbiBBbm5vdGF0aW9ucy5cIiwgc3R5bGU6IHsgdGV4dEFsaWduOiAnbGVmdCcgfSB9LCB7IGNoaWxkcmVuOiBcIkRvbWFpbnNcIiB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5pbml0QXBwbHlBbm5vdGF0aW9uKDEpOyB9LCB0b2dnbGVTdGF0ZTogZmFsc2UsIHN2ZzogIXRoaXMuc3RhdGUuZG9tYWluQXRuQXBwbGllZCA/IGljb25zXzEuVmlzaWJpbGl0eU9mZk91dGxpbmVkU3ZnIDogaWNvbnNfMS5WaXNpYmlsaXR5T3V0bGluZWRTdmcsIHRpdGxlOiBcIkNsaWNrIHRvIFwiLmNvbmNhdCh0aGlzLnN0YXRlLmRvbWFpbkF0bkFwcGxpZWQgPyAnSGlkZScgOiAnU2hvdycsIFwiIERvbWFpbiBBbm5vdGF0aW9uXCIpLCBzbWFsbDogdHJ1ZSwgY2xhc3NOYW1lOiAnbXNwLWZvcm0tY29udHJvbCcsIGZsZXg6IHRydWUgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy50b2dnbGVPcHRpb25zKDEpOyB9LCBzdmc6IGljb25zXzEuTW9yZUhvcml6U3ZnLCB0aXRsZTogJ0FjdGlvbnMnLCB0b2dnbGVTdGF0ZTogdGhpcy5zdGF0ZS5kb21haW5BdG5PcHRpb25zLCBjbGFzc05hbWU6ICdtc3AtZm9ybS1jb250cm9sJywgZmxleDogdHJ1ZSB9KV0gfSkpLCAhdGhpcy5zdGF0ZS5pc0NvbGxhcHNlZCAmJiB0aGlzLnN0YXRlLmRvbWFpbkF0blBhcmFtcyAmJiB0aGlzLnN0YXRlLmRvbWFpbkF0bk9wdGlvbnMgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgbWFyZ2luQm90dG9tOiAnNnB4JyB9IH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogXCJtc3AtYWNjZW50LW9mZnNldFwiIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1yZXByZXNlbnRhdGlvbi1lbnRyeScgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShwYXJhbWV0ZXJzXzEuUGFyYW1ldGVyQ29udHJvbHMsIHsgcGFyYW1zOiB0aGlzLnN0YXRlLmRvbWFpbkF0blBhcmFtcy5wYXJhbXMsIHZhbHVlczogdGhpcy5zdGF0ZS5kb21haW5BdG5QYXJhbXMudmFsdWVzLCBvbkNoYW5nZVZhbHVlczogdGhpcy51cGRhdGVEb21haW5BdG5QYXJhbXMgfSkgfSkpIH0pKSB9KSldIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBBbm5vdGF0aW9uc0NvbXBvbmVudENvbnRyb2xzO1xufShiYXNlXzEuUHVyZVBsdWdpblVJQ29tcG9uZW50KSk7XG5leHBvcnRzLkFubm90YXRpb25zQ29tcG9uZW50Q29udHJvbHMgPSBBbm5vdGF0aW9uc0NvbXBvbmVudENvbnRyb2xzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5ub3RhdGlvbi1jb250cm9scy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/ui/annotation-controls.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/export-superposition.js":
  /*!****************************************!*\
    !*** ./lib/ui/export-superposition.js ***!
    \****************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.SuperpositionModelExportUI = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar react_1 = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar use_behavior_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/hooks/use-behavior */ \"./node_modules/molstar/lib/mol-plugin-ui/hooks/use-behavior.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar superposition_export_1 = __webpack_require__(/*! ../superposition-export */ \"./lib/superposition-export.js\");\nvar SuperpositionModelExportUI = /** @class */ (function (_super) {\n    tslib_1.__extends(SuperpositionModelExportUI, _super);\n    function SuperpositionModelExportUI() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SuperpositionModelExportUI.prototype.defaultState = function () {\n        return {\n            header: 'Export Models',\n            isCollapsed: true,\n            brand: { accent: 'cyan', svg: icons_1.GetAppSvg }\n        };\n    };\n    SuperpositionModelExportUI.prototype.renderControls = function () {\n        return (0, jsx_runtime_1.jsx)(SuperpositionExportControls, { plugin: this.plugin });\n    };\n    return SuperpositionModelExportUI;\n}(base_1.CollapsableControls));\nexports.SuperpositionModelExportUI = SuperpositionModelExportUI;\nvar Params = {\n    format: param_definition_1.ParamDefinition.Select('cif', [['cif', 'mmCIF'], ['bcif', 'Binary mmCIF']])\n};\nvar DefaultParams = param_definition_1.ParamDefinition.getDefaultValues(Params);\nfunction SuperpositionExportControls(_a) {\n    var _this = this;\n    var plugin = _a.plugin;\n    var _b = (0, react_1.useState)(DefaultParams), params = _b[0], setParams = _b[1];\n    var _c = (0, react_1.useState)(false), exporting = _c[0], setExporting = _c[1];\n    (0, use_behavior_1.useBehavior)(plugin.managers.structure.hierarchy.behaviors.selection); // triggers UI update\n    var isBusy = (0, use_behavior_1.useBehavior)(plugin.behaviors.state.isBusy);\n    var hierarchy = plugin.managers.structure.hierarchy.current;\n    var label = 'Nothing to Export';\n    if (hierarchy.structures.length === 1) {\n        label = 'Export';\n    }\n    if (hierarchy.structures.length > 1) {\n        label = 'Export (as ZIP)';\n    }\n    var onExport = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    setExporting(true);\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, , 3, 4]);\n                    return [4 /*yield*/, (0, superposition_export_1.superpositionExportHierarchy)(plugin, { format: params.format })];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 4];\n                case 3:\n                    setExporting(false);\n                    return [7 /*endfinally*/];\n                case 4: return [2 /*return*/];\n            }\n        });\n    }); };\n    return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: Params, values: params, onChangeValues: setParams, isDisabled: isBusy || exporting }), (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ onClick: onExport, style: { marginTop: 1 }, disabled: isBusy || hierarchy.structures.length === 0 || exporting, commit: hierarchy.structures.length ? 'on' : 'off' }, { children: label }))] });\n}\n//# sourceMappingURL=export-superposition.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvZXhwb3J0LXN1cGVycG9zaXRpb24uanMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsa0NBQWtDO0FBQ2xDLGNBQWMsbUJBQU8sQ0FBQyxnREFBTztBQUM3QixvQkFBb0IsbUJBQU8sQ0FBQyw4REFBbUI7QUFDL0MsY0FBYyxtQkFBTyxDQUFDLDRDQUFPO0FBQzdCLGFBQWEsbUJBQU8sQ0FBQyxvRkFBNEI7QUFDakQsZUFBZSxtQkFBTyxDQUFDLDBHQUF1QztBQUM5RCxjQUFjLG1CQUFPLENBQUMsd0dBQXNDO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLGtIQUEyQztBQUN0RSxxQkFBcUIsbUJBQU8sQ0FBQyxnSEFBMEM7QUFDdkUseUJBQXlCLG1CQUFPLENBQUMsa0dBQW1DO0FBQ3BFLDZCQUE2QixtQkFBTyxDQUFDLDhEQUF5QjtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLHFCQUFxQjtBQUMxRjtBQUNBO0FBQ0EsQ0FBQztBQUNELGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RkFBOEY7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEdBQTRHLHVCQUF1QjtBQUNuSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTCw2REFBNkQsb0VBQW9FLDRGQUE0Riw4REFBOEQsNEJBQTRCLGNBQWMsMEhBQTBILElBQUksaUJBQWlCLEtBQUs7QUFDemQ7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3BkYmUtbW9sc3Rhci8uL2xpYi91aS9leHBvcnQtc3VwZXJwb3NpdGlvbi5qcz8yNDRiIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5TdXBlcnBvc2l0aW9uTW9kZWxFeHBvcnRVSSA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGpzeF9ydW50aW1lXzEgPSByZXF1aXJlKFwicmVhY3QvanN4LXJ1bnRpbWVcIik7XG52YXIgcmVhY3RfMSA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcbnZhciBiYXNlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2Jhc2VcIik7XG52YXIgY29tbW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2NvbW1vblwiKTtcbnZhciBpY29uc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9jb250cm9scy9pY29uc1wiKTtcbnZhciBwYXJhbWV0ZXJzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL3BhcmFtZXRlcnNcIik7XG52YXIgdXNlX2JlaGF2aW9yXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2hvb2tzL3VzZS1iZWhhdmlvclwiKTtcbnZhciBwYXJhbV9kZWZpbml0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9wYXJhbS1kZWZpbml0aW9uXCIpO1xudmFyIHN1cGVycG9zaXRpb25fZXhwb3J0XzEgPSByZXF1aXJlKFwiLi4vc3VwZXJwb3NpdGlvbi1leHBvcnRcIik7XG52YXIgU3VwZXJwb3NpdGlvbk1vZGVsRXhwb3J0VUkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU3VwZXJwb3NpdGlvbk1vZGVsRXhwb3J0VUksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VwZXJwb3NpdGlvbk1vZGVsRXhwb3J0VUkoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VwZXJwb3NpdGlvbk1vZGVsRXhwb3J0VUkucHJvdG90eXBlLmRlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhlYWRlcjogJ0V4cG9ydCBNb2RlbHMnLFxuICAgICAgICAgICAgaXNDb2xsYXBzZWQ6IHRydWUsXG4gICAgICAgICAgICBicmFuZDogeyBhY2NlbnQ6ICdjeWFuJywgc3ZnOiBpY29uc18xLkdldEFwcFN2ZyB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTdXBlcnBvc2l0aW9uTW9kZWxFeHBvcnRVSS5wcm90b3R5cGUucmVuZGVyQ29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFN1cGVycG9zaXRpb25FeHBvcnRDb250cm9scywgeyBwbHVnaW46IHRoaXMucGx1Z2luIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cGVycG9zaXRpb25Nb2RlbEV4cG9ydFVJO1xufShiYXNlXzEuQ29sbGFwc2FibGVDb250cm9scykpO1xuZXhwb3J0cy5TdXBlcnBvc2l0aW9uTW9kZWxFeHBvcnRVSSA9IFN1cGVycG9zaXRpb25Nb2RlbEV4cG9ydFVJO1xudmFyIFBhcmFtcyA9IHtcbiAgICBmb3JtYXQ6IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uU2VsZWN0KCdjaWYnLCBbWydjaWYnLCAnbW1DSUYnXSwgWydiY2lmJywgJ0JpbmFyeSBtbUNJRiddXSlcbn07XG52YXIgRGVmYXVsdFBhcmFtcyA9IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uZ2V0RGVmYXVsdFZhbHVlcyhQYXJhbXMpO1xuZnVuY3Rpb24gU3VwZXJwb3NpdGlvbkV4cG9ydENvbnRyb2xzKF9hKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICB2YXIgcGx1Z2luID0gX2EucGx1Z2luO1xuICAgIHZhciBfYiA9ICgwLCByZWFjdF8xLnVzZVN0YXRlKShEZWZhdWx0UGFyYW1zKSwgcGFyYW1zID0gX2JbMF0sIHNldFBhcmFtcyA9IF9iWzFdO1xuICAgIHZhciBfYyA9ICgwLCByZWFjdF8xLnVzZVN0YXRlKShmYWxzZSksIGV4cG9ydGluZyA9IF9jWzBdLCBzZXRFeHBvcnRpbmcgPSBfY1sxXTtcbiAgICAoMCwgdXNlX2JlaGF2aW9yXzEudXNlQmVoYXZpb3IpKHBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmJlaGF2aW9ycy5zZWxlY3Rpb24pOyAvLyB0cmlnZ2VycyBVSSB1cGRhdGVcbiAgICB2YXIgaXNCdXN5ID0gKDAsIHVzZV9iZWhhdmlvcl8xLnVzZUJlaGF2aW9yKShwbHVnaW4uYmVoYXZpb3JzLnN0YXRlLmlzQnVzeSk7XG4gICAgdmFyIGhpZXJhcmNoeSA9IHBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQ7XG4gICAgdmFyIGxhYmVsID0gJ05vdGhpbmcgdG8gRXhwb3J0JztcbiAgICBpZiAoaGllcmFyY2h5LnN0cnVjdHVyZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGxhYmVsID0gJ0V4cG9ydCc7XG4gICAgfVxuICAgIGlmIChoaWVyYXJjaHkuc3RydWN0dXJlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGxhYmVsID0gJ0V4cG9ydCAoYXMgWklQKSc7XG4gICAgfVxuICAgIHZhciBvbkV4cG9ydCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIHNldEV4cG9ydGluZyh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAsIDMsIDRdKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIHN1cGVycG9zaXRpb25fZXhwb3J0XzEuc3VwZXJwb3NpdGlvbkV4cG9ydEhpZXJhcmNoeSkocGx1Z2luLCB7IGZvcm1hdDogcGFyYW1zLmZvcm1hdCB9KV07XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgc2V0RXhwb3J0aW5nKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7IH07XG4gICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKHBhcmFtZXRlcnNfMS5QYXJhbWV0ZXJDb250cm9scywgeyBwYXJhbXM6IFBhcmFtcywgdmFsdWVzOiBwYXJhbXMsIG9uQ2hhbmdlVmFsdWVzOiBzZXRQYXJhbXMsIGlzRGlzYWJsZWQ6IGlzQnVzeSB8fCBleHBvcnRpbmcgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQnV0dG9uLCB0c2xpYl8xLl9fYXNzaWduKHsgb25DbGljazogb25FeHBvcnQsIHN0eWxlOiB7IG1hcmdpblRvcDogMSB9LCBkaXNhYmxlZDogaXNCdXN5IHx8IGhpZXJhcmNoeS5zdHJ1Y3R1cmVzLmxlbmd0aCA9PT0gMCB8fCBleHBvcnRpbmcsIGNvbW1pdDogaGllcmFyY2h5LnN0cnVjdHVyZXMubGVuZ3RoID8gJ29uJyA6ICdvZmYnIH0sIHsgY2hpbGRyZW46IGxhYmVsIH0pKV0gfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1leHBvcnQtc3VwZXJwb3NpdGlvbi5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/ui/export-superposition.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/pdbe-left-panel.js":
  /*!***********************************!*\
    !*** ./lib/ui/pdbe-left-panel.js ***!
    \***********************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.LeftPanelControls = exports.WavesIconSvg = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar canvas3d_1 = __webpack_require__(/*! Molstar/mol-canvas3d/canvas3d */ \"./node_modules/molstar/lib/mol-canvas3d/canvas3d.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar actions_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/state/actions */ \"./node_modules/molstar/lib/mol-plugin-ui/state/actions.js\");\nvar snapshots_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/state/snapshots */ \"./node_modules/molstar/lib/mol-plugin-ui/state/snapshots.js\");\nvar tree_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/state/tree */ \"./node_modules/molstar/lib/mol-plugin-ui/state/tree.js\");\nvar help_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/viewport/help */ \"./node_modules/molstar/lib/mol-plugin-ui/viewport/help.js\");\nvar segment_tree_1 = __webpack_require__(/*! ./segment-tree */ \"./lib/ui/segment-tree.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar help_2 = __webpack_require__(/*! Molstar/mol-plugin-ui/viewport/help */ \"./node_modules/molstar/lib/mol-plugin-ui/viewport/help.js\");\nvar _WavesIcon = (0, jsx_runtime_1.jsx)(\"svg\", tslib_1.__assign({ width: '24px', height: '24px', viewBox: '0 0 24 24' }, { children: (0, jsx_runtime_1.jsx)(\"path\", { d: \"M17 16.99c-1.35 0-2.2.42-2.95.8-.65.33-1.18.6-2.05.6-.9 0-1.4-.25-2.05-.6-.75-.38-1.57-.8-2.95-.8s-2.2.42-2.95.8c-.65.33-1.17.6-2.05.6v1.95c1.35 0 2.2-.42 2.95-.8.65-.33 1.17-.6 2.05-.6s1.4.25 2.05.6c.75.38 1.57.8 2.95.8s2.2-.42 2.95-.8c.65-.33 1.18-.6 2.05-.6.9 0 1.4.25 2.05.6.75.38 1.58.8 2.95.8v-1.95c-.9 0-1.4-.25-2.05-.6-.75-.38-1.6-.8-2.95-.8zm0-4.45c-1.35 0-2.2.43-2.95.8-.65.32-1.18.6-2.05.6-.9 0-1.4-.25-2.05-.6-.75-.38-1.57-.8-2.95-.8s-2.2.43-2.95.8c-.65.32-1.17.6-2.05.6v1.95c1.35 0 2.2-.43 2.95-.8.65-.35 1.15-.6 2.05-.6s1.4.25 2.05.6c.75.38 1.57.8 2.95.8s2.2-.43 2.95-.8c.65-.35 1.15-.6 2.05-.6s1.4.25 2.05.6c.75.38 1.58.8 2.95.8v-1.95c-.9 0-1.4-.25-2.05-.6-.75-.38-1.6-.8-2.95-.8zm2.95-8.08c-.75-.38-1.58-.8-2.95-.8s-2.2.42-2.95.8c-.65.32-1.18.6-2.05.6-.9 0-1.4-.25-2.05-.6-.75-.37-1.57-.8-2.95-.8s-2.2.42-2.95.8c-.65.33-1.17.6-2.05.6v1.93c1.35 0 2.2-.43 2.95-.8.65-.33 1.17-.6 2.05-.6s1.4.25 2.05.6c.75.38 1.57.8 2.95.8s2.2-.43 2.95-.8c.65-.32 1.18-.6 2.05-.6.9 0 1.4.25 2.05.6.75.38 1.58.8 2.95.8V5.04c-.9 0-1.4-.25-2.05-.58zM17 8.09c-1.35 0-2.2.43-2.95.8-.65.35-1.15.6-2.05.6s-1.4-.25-2.05-.6c-.75-.38-1.57-.8-2.95-.8s-2.2.43-2.95.8c-.65.35-1.15.6-2.05.6v1.95c1.35 0 2.2-.43 2.95-.8.65-.32 1.18-.6 2.05-.6s1.4.25 2.05.6c.75.38 1.57.8 2.95.8s2.2-.43 2.95-.8c.65-.32 1.18-.6 2.05-.6.9 0 1.4.25 2.05.6.75.38 1.58.8 2.95.8V9.49c-.9 0-1.4-.25-2.05-.6-.75-.38-1.6-.8-2.95-.8z\" }) }));\nfunction WavesIconSvg() { return _WavesIcon; }\nexports.WavesIconSvg = WavesIconSvg;\nvar LeftPanelControls = /** @class */ (function (_super) {\n    tslib_1.__extends(LeftPanelControls, _super);\n    function LeftPanelControls() {\n        var _this = this;\n        var _a;\n        _this = _super.apply(this, arguments) || this;\n        _this.state = { tab: _this.plugin.behaviors.layout.leftPanelTabName.value };\n        _this.set = function (tab) {\n            if (_this.state.tab === tab) {\n                _this.setState({ tab: 'none' }, function () { return _this.plugin.behaviors.layout.leftPanelTabName.next('none'); });\n                commands_1.PluginCommands.Layout.Update(_this.plugin, { state: { regionState: tslib_1.__assign(tslib_1.__assign({}, _this.plugin.layout.state.regionState), { left: 'collapsed' }) } });\n                return;\n            }\n            _this.setState({ tab: tab }, function () { return _this.plugin.behaviors.layout.leftPanelTabName.next(tab); });\n            if (_this.plugin.layout.state.regionState.left !== 'full') {\n                commands_1.PluginCommands.Layout.Update(_this.plugin, { state: { regionState: tslib_1.__assign(tslib_1.__assign({}, _this.plugin.layout.state.regionState), { left: 'full' }) } });\n            }\n        };\n        _this.tabs = {\n            'none': (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, {}),\n            'root': (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.SectionHeader, { icon: icons_1.HomeOutlinedSvg, title: 'Home' }), (0, jsx_runtime_1.jsx)(actions_1.StateObjectActions, { state: _this.plugin.state.data, nodeRef: mol_state_1.StateTransform.RootRef, hideHeader: true, initiallyCollapsed: true, alwaysExpandFirst: true }), ((_a = _this.plugin.spec.components) === null || _a === void 0 ? void 0 : _a.remoteState) !== 'none' && (0, jsx_runtime_1.jsx)(snapshots_1.RemoteStateSnapshots, { listOnly: true })] }),\n            'data': (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.SectionHeader, { icon: icons_1.AccountTreeOutlinedSvg, title: (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(RemoveAllButton, {}), \" State Tree\"] }) }), (0, jsx_runtime_1.jsx)(tree_1.StateTree, { state: _this.plugin.state.data })] }),\n            'segments': (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: (0, jsx_runtime_1.jsx)(segment_tree_1.SegmentTree, {}) }),\n            'states': (0, jsx_runtime_1.jsx)(snapshots_1.StateSnapshots, {}),\n            'settings': (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.SectionHeader, { icon: icons_1.TuneSvg, title: 'Plugin Settings' }), (0, jsx_runtime_1.jsx)(FullSettings, {})] }),\n            'help': (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.SectionHeader, { icon: icons_1.HelpOutlineSvg, title: 'Help' }), (0, jsx_runtime_1.jsx)(help_1.HelpContent, {}), (0, jsx_runtime_1.jsx)(SuperpositionHelpContent, {})] })\n        };\n        return _this;\n    }\n    LeftPanelControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.behaviors.layout.leftPanelTabName, function (tab) {\n            if (_this.state.tab !== tab)\n                _this.setState({ tab: tab });\n            if (tab === 'none' && _this.plugin.layout.state.regionState.left !== 'collapsed') {\n                commands_1.PluginCommands.Layout.Update(_this.plugin, { state: { regionState: tslib_1.__assign(tslib_1.__assign({}, _this.plugin.layout.state.regionState), { left: 'collapsed' }) } });\n            }\n        });\n        this.subscribe(this.plugin.state.data.events.changed, function (_a) {\n            var state = _a.state;\n            if (_this.state.tab !== 'data')\n                return;\n            if (state.cells.size === 1)\n                _this.set('root');\n        });\n    };\n    LeftPanelControls.prototype.render = function () {\n        var _this = this;\n        var tab = this.state.tab;\n        var customState = this.plugin.customState;\n        return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-left-panel-controls' }, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-left-panel-controls-buttons' }, { children: [(0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: icons_1.HelpOutlineSvg, toggleState: tab === 'help', transparent: true, onClick: function () { return _this.set('help'); }, title: 'Help' }), customState && customState.initParams && customState.initParams.superposition && (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: WavesIconSvg, toggleState: tab === 'segments', transparent: true, onClick: function () { return _this.set('segments'); }, title: 'Superpose segments' }), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-left-panel-controls-buttons-bottom' }, { children: (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: icons_1.TuneSvg, toggleState: tab === 'settings', transparent: true, onClick: function () { return _this.set('settings'); }, title: 'Settings' }) }))] })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-scrollable-container' }, { children: this.tabs[tab] }))] }));\n    };\n    return LeftPanelControls;\n}(base_1.PluginUIComponent));\nexports.LeftPanelControls = LeftPanelControls;\n// class DataIcon extends PluginUIComponent<{ set: (tab: LeftPanelTabName) => void }, { changed: boolean }> {\n//     state = { changed: false };\n//     get tab() {\n//         return this.plugin.behaviors.layout.leftPanelTabName.value;\n//     }\n//     componentDidMount() {\n//         this.subscribe(this.plugin.behaviors.layout.leftPanelTabName, tab => {\n//             if (this.tab === 'data') this.setState({ changed: false });\n//             else this.forceUpdate();\n//         });\n//         this.subscribe(this.plugin.state.data.events.changed, state => {\n//             if (this.tab !== 'data') this.setState({ changed: true });\n//         });\n//     }\n//     render() {\n//         return <IconButton\n//             svg={AccountTreeOutlinedSvg} toggleState={this.tab === 'data'} transparent onClick={() => this.props.set('data')} title='State Tree'\n//             style={{ position: 'relative' }} extraContent={this.state.changed ? <div className='msp-left-panel-controls-button-data-dirty' /> : void 0} />;\n//     }\n// }\nvar FullSettings = /** @class */ (function (_super) {\n    tslib_1.__extends(FullSettings, _super);\n    function FullSettings() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.setSettings = function (p) {\n            var _a;\n            commands_1.PluginCommands.Canvas3D.SetSettings(_this.plugin, { settings: (_a = {}, _a[p.name] = p.value, _a) });\n        };\n        return _this;\n    }\n    FullSettings.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () { return _this.forceUpdate(); });\n        this.subscribe(this.plugin.layout.events.updated, function () { return _this.forceUpdate(); });\n        this.subscribe(this.plugin.canvas3d.camera.stateChanged, function (state) {\n            if (state.radiusMax !== undefined || state.radius !== undefined) {\n                _this.forceUpdate();\n            }\n        });\n    };\n    FullSettings.prototype.render = function () {\n        return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: this.plugin.canvas3d && (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.SectionHeader, { title: 'Viewport' }), (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: canvas3d_1.Canvas3DParams, values: this.plugin.canvas3d.props, onChange: this.setSettings })] }) });\n    };\n    return FullSettings;\n}(base_1.PluginUIComponent));\nvar RemoveAllButton = /** @class */ (function (_super) {\n    tslib_1.__extends(RemoveAllButton, _super);\n    function RemoveAllButton() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.remove = function (e) {\n            e.preventDefault();\n            commands_1.PluginCommands.State.RemoveObject(_this.plugin, { state: _this.plugin.state.data, ref: mol_state_1.StateTransform.RootRef });\n        };\n        return _this;\n    }\n    RemoveAllButton.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.state.events.cell.created, function (e) {\n            if (e.cell.transform.parent === mol_state_1.StateTransform.RootRef)\n                _this.forceUpdate();\n        });\n        this.subscribe(this.plugin.state.events.cell.removed, function (e) {\n            if (e.parent === mol_state_1.StateTransform.RootRef)\n                _this.forceUpdate();\n        });\n    };\n    RemoveAllButton.prototype.render = function () {\n        var count = this.plugin.state.data.tree.children.get(mol_state_1.StateTransform.RootRef).size;\n        if (count === 0)\n            return null;\n        return (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: icons_1.DeleteOutlinedSvg, onClick: this.remove, title: 'Remove All', style: { display: 'inline-block' }, small: true, className: 'msp-no-hover-outline', transparent: true });\n    };\n    return RemoveAllButton;\n}(base_1.PluginUIComponent));\nfunction HelpSection(props) {\n    return (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-simple-help-section' }, { children: props.header }));\n}\nvar SuperpositionHelpContent = /** @class */ (function (_super) {\n    tslib_1.__extends(SuperpositionHelpContent, _super);\n    function SuperpositionHelpContent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SuperpositionHelpContent.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.events.canvas3d.settingsUpdated, function () { return _this.forceUpdate(); });\n    };\n    SuperpositionHelpContent.prototype.render = function () {\n        return (0, jsx_runtime_1.jsxs)(\"div\", { children: [(0, jsx_runtime_1.jsx)(HelpSection, { header: 'Superposition' }), (0, jsx_runtime_1.jsx)(help_2.HelpGroup, tslib_1.__assign({ header: 'Segment' }, { children: (0, jsx_runtime_1.jsx)(help_2.HelpText, { children: (0, jsx_runtime_1.jsx)(\"p\", { children: \"Discrete UniProt sequence range mapped to the structure\" }) }) })), (0, jsx_runtime_1.jsx)(help_2.HelpGroup, tslib_1.__assign({ header: 'Cluster' }, { children: (0, jsx_runtime_1.jsx)(help_2.HelpText, { children: (0, jsx_runtime_1.jsx)(\"p\", { children: \"Structural chains that possess significantly close superposition Q-score\" }) }) })), (0, jsx_runtime_1.jsx)(help_2.HelpGroup, tslib_1.__assign({ header: 'Representative chain' }, { children: (0, jsx_runtime_1.jsx)(help_2.HelpText, { children: (0, jsx_runtime_1.jsx)(\"p\", { children: \"The best-ranked chain within a cluster chosen based on the model quality, resolution, observed residues ratio and UniProt sequence coverage\" }) }) }))] });\n    };\n    return SuperpositionHelpContent;\n}(base_1.PluginUIComponent));\n//# sourceMappingURL=pdbe-left-panel.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLGtCQUFrQiw2QkFBNkI7QUFDMUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtGQUFrRiw2QkFBNkI7QUFDL0csd0VBQXdFLDZCQUE2QjtBQUNyRztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZ0VBQWdFLG9GQUFvRiw0REFBNEQsbUJBQW1CLDREQUE0RCxtR0FBbUcsSUFBSSxHQUFHO0FBQ3pZO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUVBQXlFLHlFQUF5RTtBQUNsSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELG9GQUFvRix5QkFBeUIscUVBQXFFO0FBQy9PO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0REFBNEQsc0NBQXNDLElBQUksd0JBQXdCO0FBQzlIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0YsNkJBQTZCO0FBQy9HO0FBQ0E7QUFDQSxnREFBZ0QsaURBQWlELHlCQUF5QiwrREFBK0QsbUJBQW1CLElBQUksb0RBQW9ELHdDQUF3QyxxRUFBcUUsR0FBRyxHQUFHLGdFQUFnRSxtQkFBbUIsSUFBSSxvREFBb0Qsd0NBQXdDLHNGQUFzRixHQUFHLEdBQUcsZ0VBQWdFLGdDQUFnQyxJQUFJLG9EQUFvRCx3Q0FBd0MseUpBQXlKLEdBQUcsR0FBRyxLQUFLO0FBQzErQjtBQUNBO0FBQ0EsQ0FBQztBQUNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3VpL3BkYmUtbGVmdC1wYW5lbC5qcz8wNDA0Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5MZWZ0UGFuZWxDb250cm9scyA9IGV4cG9ydHMuV2F2ZXNJY29uU3ZnID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIganN4X3J1bnRpbWVfMSA9IHJlcXVpcmUoXCJyZWFjdC9qc3gtcnVudGltZVwiKTtcbnZhciBjYW52YXMzZF8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLWNhbnZhczNkL2NhbnZhczNkXCIpO1xudmFyIGNvbW1hbmRzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2NvbW1hbmRzXCIpO1xudmFyIG1vbF9zdGF0ZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXN0YXRlXCIpO1xudmFyIGJhc2VfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvYmFzZVwiKTtcbnZhciBjb21tb25fMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvY29tbW9uXCIpO1xudmFyIHBhcmFtZXRlcnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvcGFyYW1ldGVyc1wiKTtcbnZhciBhY3Rpb25zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3N0YXRlL2FjdGlvbnNcIik7XG52YXIgc25hcHNob3RzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3N0YXRlL3NuYXBzaG90c1wiKTtcbnZhciB0cmVlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3N0YXRlL3RyZWVcIik7XG52YXIgaGVscF8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS92aWV3cG9ydC9oZWxwXCIpO1xudmFyIHNlZ21lbnRfdHJlZV8xID0gcmVxdWlyZShcIi4vc2VnbWVudC10cmVlXCIpO1xudmFyIGljb25zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2ljb25zXCIpO1xudmFyIGhlbHBfMiA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvdmlld3BvcnQvaGVscFwiKTtcbnZhciBfV2F2ZXNJY29uID0gKDAsIGpzeF9ydW50aW1lXzEuanN4KShcInN2Z1wiLCB0c2xpYl8xLl9fYXNzaWduKHsgd2lkdGg6ICcyNHB4JywgaGVpZ2h0OiAnMjRweCcsIHZpZXdCb3g6ICcwIDAgMjQgMjQnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJwYXRoXCIsIHsgZDogXCJNMTcgMTYuOTljLTEuMzUgMC0yLjIuNDItMi45NS44LS42NS4zMy0xLjE4LjYtMi4wNS42LS45IDAtMS40LS4yNS0yLjA1LS42LS43NS0uMzgtMS41Ny0uOC0yLjk1LS44cy0yLjIuNDItMi45NS44Yy0uNjUuMzMtMS4xNy42LTIuMDUuNnYxLjk1YzEuMzUgMCAyLjItLjQyIDIuOTUtLjguNjUtLjMzIDEuMTctLjYgMi4wNS0uNnMxLjQuMjUgMi4wNS42Yy43NS4zOCAxLjU3LjggMi45NS44czIuMi0uNDIgMi45NS0uOGMuNjUtLjMzIDEuMTgtLjYgMi4wNS0uNi45IDAgMS40LjI1IDIuMDUuNi43NS4zOCAxLjU4LjggMi45NS44di0xLjk1Yy0uOSAwLTEuNC0uMjUtMi4wNS0uNi0uNzUtLjM4LTEuNi0uOC0yLjk1LS44em0wLTQuNDVjLTEuMzUgMC0yLjIuNDMtMi45NS44LS42NS4zMi0xLjE4LjYtMi4wNS42LS45IDAtMS40LS4yNS0yLjA1LS42LS43NS0uMzgtMS41Ny0uOC0yLjk1LS44cy0yLjIuNDMtMi45NS44Yy0uNjUuMzItMS4xNy42LTIuMDUuNnYxLjk1YzEuMzUgMCAyLjItLjQzIDIuOTUtLjguNjUtLjM1IDEuMTUtLjYgMi4wNS0uNnMxLjQuMjUgMi4wNS42Yy43NS4zOCAxLjU3LjggMi45NS44czIuMi0uNDMgMi45NS0uOGMuNjUtLjM1IDEuMTUtLjYgMi4wNS0uNnMxLjQuMjUgMi4wNS42Yy43NS4zOCAxLjU4LjggMi45NS44di0xLjk1Yy0uOSAwLTEuNC0uMjUtMi4wNS0uNi0uNzUtLjM4LTEuNi0uOC0yLjk1LS44em0yLjk1LTguMDhjLS43NS0uMzgtMS41OC0uOC0yLjk1LS44cy0yLjIuNDItMi45NS44Yy0uNjUuMzItMS4xOC42LTIuMDUuNi0uOSAwLTEuNC0uMjUtMi4wNS0uNi0uNzUtLjM3LTEuNTctLjgtMi45NS0uOHMtMi4yLjQyLTIuOTUuOGMtLjY1LjMzLTEuMTcuNi0yLjA1LjZ2MS45M2MxLjM1IDAgMi4yLS40MyAyLjk1LS44LjY1LS4zMyAxLjE3LS42IDIuMDUtLjZzMS40LjI1IDIuMDUuNmMuNzUuMzggMS41Ny44IDIuOTUuOHMyLjItLjQzIDIuOTUtLjhjLjY1LS4zMiAxLjE4LS42IDIuMDUtLjYuOSAwIDEuNC4yNSAyLjA1LjYuNzUuMzggMS41OC44IDIuOTUuOFY1LjA0Yy0uOSAwLTEuNC0uMjUtMi4wNS0uNTh6TTE3IDguMDljLTEuMzUgMC0yLjIuNDMtMi45NS44LS42NS4zNS0xLjE1LjYtMi4wNS42cy0xLjQtLjI1LTIuMDUtLjZjLS43NS0uMzgtMS41Ny0uOC0yLjk1LS44cy0yLjIuNDMtMi45NS44Yy0uNjUuMzUtMS4xNS42LTIuMDUuNnYxLjk1YzEuMzUgMCAyLjItLjQzIDIuOTUtLjguNjUtLjMyIDEuMTgtLjYgMi4wNS0uNnMxLjQuMjUgMi4wNS42Yy43NS4zOCAxLjU3LjggMi45NS44czIuMi0uNDMgMi45NS0uOGMuNjUtLjMyIDEuMTgtLjYgMi4wNS0uNi45IDAgMS40LjI1IDIuMDUuNi43NS4zOCAxLjU4LjggMi45NS44VjkuNDljLS45IDAtMS40LS4yNS0yLjA1LS42LS43NS0uMzgtMS42LS44LTIuOTUtLjh6XCIgfSkgfSkpO1xuZnVuY3Rpb24gV2F2ZXNJY29uU3ZnKCkgeyByZXR1cm4gX1dhdmVzSWNvbjsgfVxuZXhwb3J0cy5XYXZlc0ljb25TdmcgPSBXYXZlc0ljb25Tdmc7XG52YXIgTGVmdFBhbmVsQ29udHJvbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTGVmdFBhbmVsQ29udHJvbHMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGVmdFBhbmVsQ29udHJvbHMoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHsgdGFiOiBfdGhpcy5wbHVnaW4uYmVoYXZpb3JzLmxheW91dC5sZWZ0UGFuZWxUYWJOYW1lLnZhbHVlIH07XG4gICAgICAgIF90aGlzLnNldCA9IGZ1bmN0aW9uICh0YWIpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS50YWIgPT09IHRhYikge1xuICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgdGFiOiAnbm9uZScgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucGx1Z2luLmJlaGF2aW9ycy5sYXlvdXQubGVmdFBhbmVsVGFiTmFtZS5uZXh0KCdub25lJyk7IH0pO1xuICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuTGF5b3V0LlVwZGF0ZShfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IHsgcmVnaW9uU3RhdGU6IHRzbGliXzEuX19hc3NpZ24odHNsaWJfMS5fX2Fzc2lnbih7fSwgX3RoaXMucGx1Z2luLmxheW91dC5zdGF0ZS5yZWdpb25TdGF0ZSksIHsgbGVmdDogJ2NvbGxhcHNlZCcgfSkgfSB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHRhYjogdGFiIH0sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnBsdWdpbi5iZWhhdmlvcnMubGF5b3V0LmxlZnRQYW5lbFRhYk5hbWUubmV4dCh0YWIpOyB9KTtcbiAgICAgICAgICAgIGlmIChfdGhpcy5wbHVnaW4ubGF5b3V0LnN0YXRlLnJlZ2lvblN0YXRlLmxlZnQgIT09ICdmdWxsJykge1xuICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuTGF5b3V0LlVwZGF0ZShfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IHsgcmVnaW9uU3RhdGU6IHRzbGliXzEuX19hc3NpZ24odHNsaWJfMS5fX2Fzc2lnbih7fSwgX3RoaXMucGx1Z2luLmxheW91dC5zdGF0ZS5yZWdpb25TdGF0ZSksIHsgbGVmdDogJ2Z1bGwnIH0pIH0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnRhYnMgPSB7XG4gICAgICAgICAgICAnbm9uZSc6ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwge30pLFxuICAgICAgICAgICAgJ3Jvb3QnOiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5TZWN0aW9uSGVhZGVyLCB7IGljb246IGljb25zXzEuSG9tZU91dGxpbmVkU3ZnLCB0aXRsZTogJ0hvbWUnIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGFjdGlvbnNfMS5TdGF0ZU9iamVjdEFjdGlvbnMsIHsgc3RhdGU6IF90aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLCBub2RlUmVmOiBtb2xfc3RhdGVfMS5TdGF0ZVRyYW5zZm9ybS5Sb290UmVmLCBoaWRlSGVhZGVyOiB0cnVlLCBpbml0aWFsbHlDb2xsYXBzZWQ6IHRydWUsIGFsd2F5c0V4cGFuZEZpcnN0OiB0cnVlIH0pLCAoKF9hID0gX3RoaXMucGx1Z2luLnNwZWMuY29tcG9uZW50cykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlbW90ZVN0YXRlKSAhPT0gJ25vbmUnICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoc25hcHNob3RzXzEuUmVtb3RlU3RhdGVTbmFwc2hvdHMsIHsgbGlzdE9ubHk6IHRydWUgfSldIH0pLFxuICAgICAgICAgICAgJ2RhdGEnOiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5TZWN0aW9uSGVhZGVyLCB7IGljb246IGljb25zXzEuQWNjb3VudFRyZWVPdXRsaW5lZFN2ZywgdGl0bGU6ICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKFJlbW92ZUFsbEJ1dHRvbiwge30pLCBcIiBTdGF0ZSBUcmVlXCJdIH0pIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHRyZWVfMS5TdGF0ZVRyZWUsIHsgc3RhdGU6IF90aGlzLnBsdWdpbi5zdGF0ZS5kYXRhIH0pXSB9KSxcbiAgICAgICAgICAgICdzZWdtZW50cyc6ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShzZWdtZW50X3RyZWVfMS5TZWdtZW50VHJlZSwge30pIH0pLFxuICAgICAgICAgICAgJ3N0YXRlcyc6ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoc25hcHNob3RzXzEuU3RhdGVTbmFwc2hvdHMsIHt9KSxcbiAgICAgICAgICAgICdzZXR0aW5ncyc6ICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLlNlY3Rpb25IZWFkZXIsIHsgaWNvbjogaWNvbnNfMS5UdW5lU3ZnLCB0aXRsZTogJ1BsdWdpbiBTZXR0aW5ncycgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoRnVsbFNldHRpbmdzLCB7fSldIH0pLFxuICAgICAgICAgICAgJ2hlbHAnOiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5TZWN0aW9uSGVhZGVyLCB7IGljb246IGljb25zXzEuSGVscE91dGxpbmVTdmcsIHRpdGxlOiAnSGVscCcgfSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoaGVscF8xLkhlbHBDb250ZW50LCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoU3VwZXJwb3NpdGlvbkhlbHBDb250ZW50LCB7fSldIH0pXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgTGVmdFBhbmVsQ29udHJvbHMucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5iZWhhdmlvcnMubGF5b3V0LmxlZnRQYW5lbFRhYk5hbWUsIGZ1bmN0aW9uICh0YWIpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5zdGF0ZS50YWIgIT09IHRhYilcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHRhYjogdGFiIH0pO1xuICAgICAgICAgICAgaWYgKHRhYiA9PT0gJ25vbmUnICYmIF90aGlzLnBsdWdpbi5sYXlvdXQuc3RhdGUucmVnaW9uU3RhdGUubGVmdCAhPT0gJ2NvbGxhcHNlZCcpIHtcbiAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkxheW91dC5VcGRhdGUoX3RoaXMucGx1Z2luLCB7IHN0YXRlOiB7IHJlZ2lvblN0YXRlOiB0c2xpYl8xLl9fYXNzaWduKHRzbGliXzEuX19hc3NpZ24oe30sIF90aGlzLnBsdWdpbi5sYXlvdXQuc3RhdGUucmVnaW9uU3RhdGUpLCB7IGxlZnQ6ICdjb2xsYXBzZWQnIH0pIH0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLmV2ZW50cy5jaGFuZ2VkLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZSA9IF9hLnN0YXRlO1xuICAgICAgICAgICAgaWYgKF90aGlzLnN0YXRlLnRhYiAhPT0gJ2RhdGEnKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGlmIChzdGF0ZS5jZWxscy5zaXplID09PSAxKVxuICAgICAgICAgICAgICAgIF90aGlzLnNldCgncm9vdCcpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIExlZnRQYW5lbENvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB0YWIgPSB0aGlzLnN0YXRlLnRhYjtcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWxlZnQtcGFuZWwtY29udHJvbHMnIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWxlZnQtcGFuZWwtY29udHJvbHMtYnV0dG9ucycgfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBzdmc6IGljb25zXzEuSGVscE91dGxpbmVTdmcsIHRvZ2dsZVN0YXRlOiB0YWIgPT09ICdoZWxwJywgdHJhbnNwYXJlbnQ6IHRydWUsIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNldCgnaGVscCcpOyB9LCB0aXRsZTogJ0hlbHAnIH0pLCBjdXN0b21TdGF0ZSAmJiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zICYmIGN1c3RvbVN0YXRlLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvbiAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkljb25CdXR0b24sIHsgc3ZnOiBXYXZlc0ljb25TdmcsIHRvZ2dsZVN0YXRlOiB0YWIgPT09ICdzZWdtZW50cycsIHRyYW5zcGFyZW50OiB0cnVlLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zZXQoJ3NlZ21lbnRzJyk7IH0sIHRpdGxlOiAnU3VwZXJwb3NlIHNlZ21lbnRzJyB9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWxlZnQtcGFuZWwtY29udHJvbHMtYnV0dG9ucy1ib3R0b20nIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBzdmc6IGljb25zXzEuVHVuZVN2ZywgdG9nZ2xlU3RhdGU6IHRhYiA9PT0gJ3NldHRpbmdzJywgdHJhbnNwYXJlbnQ6IHRydWUsIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnNldCgnc2V0dGluZ3MnKTsgfSwgdGl0bGU6ICdTZXR0aW5ncycgfSkgfSkpXSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1zY3JvbGxhYmxlLWNvbnRhaW5lcicgfSwgeyBjaGlsZHJlbjogdGhpcy50YWJzW3RhYl0gfSkpXSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gTGVmdFBhbmVsQ29udHJvbHM7XG59KGJhc2VfMS5QbHVnaW5VSUNvbXBvbmVudCkpO1xuZXhwb3J0cy5MZWZ0UGFuZWxDb250cm9scyA9IExlZnRQYW5lbENvbnRyb2xzO1xuLy8gY2xhc3MgRGF0YUljb24gZXh0ZW5kcyBQbHVnaW5VSUNvbXBvbmVudDx7IHNldDogKHRhYjogTGVmdFBhbmVsVGFiTmFtZSkgPT4gdm9pZCB9LCB7IGNoYW5nZWQ6IGJvb2xlYW4gfT4ge1xuLy8gICAgIHN0YXRlID0geyBjaGFuZ2VkOiBmYWxzZSB9O1xuLy8gICAgIGdldCB0YWIoKSB7XG4vLyAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5iZWhhdmlvcnMubGF5b3V0LmxlZnRQYW5lbFRhYk5hbWUudmFsdWU7XG4vLyAgICAgfVxuLy8gICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuLy8gICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5iZWhhdmlvcnMubGF5b3V0LmxlZnRQYW5lbFRhYk5hbWUsIHRhYiA9PiB7XG4vLyAgICAgICAgICAgICBpZiAodGhpcy50YWIgPT09ICdkYXRhJykgdGhpcy5zZXRTdGF0ZSh7IGNoYW5nZWQ6IGZhbHNlIH0pO1xuLy8gICAgICAgICAgICAgZWxzZSB0aGlzLmZvcmNlVXBkYXRlKCk7XG4vLyAgICAgICAgIH0pO1xuLy8gICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLmV2ZW50cy5jaGFuZ2VkLCBzdGF0ZSA9PiB7XG4vLyAgICAgICAgICAgICBpZiAodGhpcy50YWIgIT09ICdkYXRhJykgdGhpcy5zZXRTdGF0ZSh7IGNoYW5nZWQ6IHRydWUgfSk7XG4vLyAgICAgICAgIH0pO1xuLy8gICAgIH1cbi8vICAgICByZW5kZXIoKSB7XG4vLyAgICAgICAgIHJldHVybiA8SWNvbkJ1dHRvblxuLy8gICAgICAgICAgICAgc3ZnPXtBY2NvdW50VHJlZU91dGxpbmVkU3ZnfSB0b2dnbGVTdGF0ZT17dGhpcy50YWIgPT09ICdkYXRhJ30gdHJhbnNwYXJlbnQgb25DbGljaz17KCkgPT4gdGhpcy5wcm9wcy5zZXQoJ2RhdGEnKX0gdGl0bGU9J1N0YXRlIFRyZWUnXG4vLyAgICAgICAgICAgICBzdHlsZT17eyBwb3NpdGlvbjogJ3JlbGF0aXZlJyB9fSBleHRyYUNvbnRlbnQ9e3RoaXMuc3RhdGUuY2hhbmdlZCA/IDxkaXYgY2xhc3NOYW1lPSdtc3AtbGVmdC1wYW5lbC1jb250cm9scy1idXR0b24tZGF0YS1kaXJ0eScgLz4gOiB2b2lkIDB9IC8+O1xuLy8gICAgIH1cbi8vIH1cbnZhciBGdWxsU2V0dGluZ3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRnVsbFNldHRpbmdzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZ1bGxTZXR0aW5ncygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnNldFNldHRpbmdzID0gZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuQ2FudmFzM0QuU2V0U2V0dGluZ3MoX3RoaXMucGx1Z2luLCB7IHNldHRpbmdzOiAoX2EgPSB7fSwgX2FbcC5uYW1lXSA9IHAudmFsdWUsIF9hKSB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBGdWxsU2V0dGluZ3MucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5ldmVudHMuY2FudmFzM2Quc2V0dGluZ3NVcGRhdGVkLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5mb3JjZVVwZGF0ZSgpOyB9KTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4ubGF5b3V0LmV2ZW50cy51cGRhdGVkLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5mb3JjZVVwZGF0ZSgpOyB9KTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uY2FudmFzM2QuY2FtZXJhLnN0YXRlQ2hhbmdlZCwgZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICBpZiAoc3RhdGUucmFkaXVzTWF4ICE9PSB1bmRlZmluZWQgfHwgc3RhdGUucmFkaXVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEZ1bGxTZXR0aW5ncy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiB0aGlzLnBsdWdpbi5jYW52YXMzZCAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5TZWN0aW9uSGVhZGVyLCB7IHRpdGxlOiAnVmlld3BvcnQnIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHBhcmFtZXRlcnNfMS5QYXJhbWV0ZXJDb250cm9scywgeyBwYXJhbXM6IGNhbnZhczNkXzEuQ2FudmFzM0RQYXJhbXMsIHZhbHVlczogdGhpcy5wbHVnaW4uY2FudmFzM2QucHJvcHMsIG9uQ2hhbmdlOiB0aGlzLnNldFNldHRpbmdzIH0pXSB9KSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBGdWxsU2V0dGluZ3M7XG59KGJhc2VfMS5QbHVnaW5VSUNvbXBvbmVudCkpO1xudmFyIFJlbW92ZUFsbEJ1dHRvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZW1vdmVBbGxCdXR0b24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUmVtb3ZlQWxsQnV0dG9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMucmVtb3ZlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuUmVtb3ZlT2JqZWN0KF90aGlzLnBsdWdpbiwgeyBzdGF0ZTogX3RoaXMucGx1Z2luLnN0YXRlLmRhdGEsIHJlZjogbW9sX3N0YXRlXzEuU3RhdGVUcmFuc2Zvcm0uUm9vdFJlZiB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBSZW1vdmVBbGxCdXR0b24ucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5zdGF0ZS5ldmVudHMuY2VsbC5jcmVhdGVkLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUuY2VsbC50cmFuc2Zvcm0ucGFyZW50ID09PSBtb2xfc3RhdGVfMS5TdGF0ZVRyYW5zZm9ybS5Sb290UmVmKVxuICAgICAgICAgICAgICAgIF90aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5zdGF0ZS5ldmVudHMuY2VsbC5yZW1vdmVkLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUucGFyZW50ID09PSBtb2xfc3RhdGVfMS5TdGF0ZVRyYW5zZm9ybS5Sb290UmVmKVxuICAgICAgICAgICAgICAgIF90aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUmVtb3ZlQWxsQnV0dG9uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb3VudCA9IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEudHJlZS5jaGlsZHJlbi5nZXQobW9sX3N0YXRlXzEuU3RhdGVUcmFuc2Zvcm0uUm9vdFJlZikuc2l6ZTtcbiAgICAgICAgaWYgKGNvdW50ID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkljb25CdXR0b24sIHsgc3ZnOiBpY29uc18xLkRlbGV0ZU91dGxpbmVkU3ZnLCBvbkNsaWNrOiB0aGlzLnJlbW92ZSwgdGl0bGU6ICdSZW1vdmUgQWxsJywgc3R5bGU6IHsgZGlzcGxheTogJ2lubGluZS1ibG9jaycgfSwgc21hbGw6IHRydWUsIGNsYXNzTmFtZTogJ21zcC1uby1ob3Zlci1vdXRsaW5lJywgdHJhbnNwYXJlbnQ6IHRydWUgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gUmVtb3ZlQWxsQnV0dG9uO1xufShiYXNlXzEuUGx1Z2luVUlDb21wb25lbnQpKTtcbmZ1bmN0aW9uIEhlbHBTZWN0aW9uKHByb3BzKSB7XG4gICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1zaW1wbGUtaGVscC1zZWN0aW9uJyB9LCB7IGNoaWxkcmVuOiBwcm9wcy5oZWFkZXIgfSkpO1xufVxudmFyIFN1cGVycG9zaXRpb25IZWxwQ29udGVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTdXBlcnBvc2l0aW9uSGVscENvbnRlbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VwZXJwb3NpdGlvbkhlbHBDb250ZW50KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN1cGVycG9zaXRpb25IZWxwQ29udGVudC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLmV2ZW50cy5jYW52YXMzZC5zZXR0aW5nc1VwZGF0ZWQsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmZvcmNlVXBkYXRlKCk7IH0pO1xuICAgIH07XG4gICAgU3VwZXJwb3NpdGlvbkhlbHBDb250ZW50LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShIZWxwU2VjdGlvbiwgeyBoZWFkZXI6ICdTdXBlcnBvc2l0aW9uJyB9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShoZWxwXzIuSGVscEdyb3VwLCB0c2xpYl8xLl9fYXNzaWduKHsgaGVhZGVyOiAnU2VnbWVudCcgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShoZWxwXzIuSGVscFRleHQsIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJwXCIsIHsgY2hpbGRyZW46IFwiRGlzY3JldGUgVW5pUHJvdCBzZXF1ZW5jZSByYW5nZSBtYXBwZWQgdG8gdGhlIHN0cnVjdHVyZVwiIH0pIH0pIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShoZWxwXzIuSGVscEdyb3VwLCB0c2xpYl8xLl9fYXNzaWduKHsgaGVhZGVyOiAnQ2x1c3RlcicgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShoZWxwXzIuSGVscFRleHQsIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJwXCIsIHsgY2hpbGRyZW46IFwiU3RydWN0dXJhbCBjaGFpbnMgdGhhdCBwb3NzZXNzIHNpZ25pZmljYW50bHkgY2xvc2Ugc3VwZXJwb3NpdGlvbiBRLXNjb3JlXCIgfSkgfSkgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGhlbHBfMi5IZWxwR3JvdXAsIHRzbGliXzEuX19hc3NpZ24oeyBoZWFkZXI6ICdSZXByZXNlbnRhdGl2ZSBjaGFpbicgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShoZWxwXzIuSGVscFRleHQsIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJwXCIsIHsgY2hpbGRyZW46IFwiVGhlIGJlc3QtcmFua2VkIGNoYWluIHdpdGhpbiBhIGNsdXN0ZXIgY2hvc2VuIGJhc2VkIG9uIHRoZSBtb2RlbCBxdWFsaXR5LCByZXNvbHV0aW9uLCBvYnNlcnZlZCByZXNpZHVlcyByYXRpbyBhbmQgVW5pUHJvdCBzZXF1ZW5jZSBjb3ZlcmFnZVwiIH0pIH0pIH0pKV0gfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VwZXJwb3NpdGlvbkhlbHBDb250ZW50O1xufShiYXNlXzEuUGx1Z2luVUlDb21wb25lbnQpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBkYmUtbGVmdC1wYW5lbC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/ui/pdbe-left-panel.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/pdbe-screenshot-controls.js":
  /*!********************************************!*\
    !*** ./lib/ui/pdbe-screenshot-controls.js ***!
    \********************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.DownloadScreenshotControls = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar screenshot_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/screenshot */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/screenshot.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar use_behavior_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/hooks/use-behavior */ \"./node_modules/molstar/lib/mol-plugin-ui/hooks/use-behavior.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar DownloadScreenshotControls = /** @class */ (function (_super) {\n    tslib_1.__extends(DownloadScreenshotControls, _super);\n    function DownloadScreenshotControls() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            showPreview: true,\n            isDisabled: false\n        };\n        _this.download = function () {\n            var _a;\n            (_a = _this.plugin.helpers.viewportScreenshot) === null || _a === void 0 ? void 0 : _a.download();\n            _this.props.close();\n        };\n        _this.copy = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var _a;\n            var _b;\n            return tslib_1.__generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _c.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, ((_b = this.plugin.helpers.viewportScreenshot) === null || _b === void 0 ? void 0 : _b.copyToClipboard())];\n                    case 1:\n                        _c.sent();\n                        commands_1.PluginCommands.Toast.Show(this.plugin, {\n                            message: 'Copied to clipboard.',\n                            title: 'Screenshot',\n                            timeoutMs: 1500\n                        });\n                        return [3 /*break*/, 3];\n                    case 2:\n                        _a = _c.sent();\n                        return [2 /*return*/, this.copyImg()];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.copyImg = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var src;\n            var _a;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, ((_a = this.plugin.helpers.viewportScreenshot) === null || _a === void 0 ? void 0 : _a.getImageDataUri())];\n                    case 1:\n                        src = _b.sent();\n                        this.setState({ imageData: src });\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.open = function (e) {\n            if (!e.target.files || !e.target.files[0])\n                return;\n            commands_1.PluginCommands.State.Snapshots.OpenFile(_this.plugin, { file: e.target.files[0] });\n        };\n        return _this;\n    }\n    DownloadScreenshotControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.state.data.behaviors.isUpdating, function (v) {\n            _this.setState({ isDisabled: v });\n        });\n    };\n    DownloadScreenshotControls.prototype.componentWillUnmount = function () {\n        this.setState({ imageData: void 0 });\n    };\n    DownloadScreenshotControls.prototype.render = function () {\n        var _this = this;\n        var _a;\n        var hasClipboardApi = !!((_a = navigator.clipboard) === null || _a === void 0 ? void 0 : _a.write);\n        return (0, jsx_runtime_1.jsxs)(\"div\", { children: [this.state.showPreview && (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-image-preview' }, { children: [(0, jsx_runtime_1.jsx)(screenshot_1.ScreenshotPreview, { plugin: this.plugin }), (0, jsx_runtime_1.jsx)(CropControls, { plugin: this.plugin })] })), (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [!this.state.imageData && (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CopySvg, onClick: hasClipboardApi ? this.copy : this.copyImg, disabled: this.state.isDisabled }, { children: \"Copy\" })), this.state.imageData && (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ onClick: function () { return _this.setState({ imageData: void 0 }); }, disabled: this.state.isDisabled }, { children: \"Clear\" })), (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.GetAppSvg, onClick: this.download, disabled: this.state.isDisabled }, { children: \"Download\" }))] })), this.state.imageData && (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-row msp-copy-image-wrapper' }, { children: [(0, jsx_runtime_1.jsx)(\"div\", { children: \"Right click below + Copy Image\" }), (0, jsx_runtime_1.jsx)(\"img\", { src: this.state.imageData, style: { width: '100%', height: 32, display: 'block' } })] })), (0, jsx_runtime_1.jsx)(ScreenshotParams, { plugin: this.plugin, isDisabled: this.state.isDisabled })] });\n    };\n    return DownloadScreenshotControls;\n}(base_1.PluginUIComponent));\nexports.DownloadScreenshotControls = DownloadScreenshotControls;\nfunction ScreenshotParams(_a) {\n    var plugin = _a.plugin, isDisabled = _a.isDisabled;\n    var helper = plugin.helpers.viewportScreenshot;\n    var values = (0, use_behavior_1.useBehavior)(helper.behaviors.values);\n    return (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: helper.params, values: values, onChangeValues: function (v) { return helper.behaviors.values.next(v); }, isDisabled: isDisabled });\n}\nfunction CropControls(_a) {\n    var plugin = _a.plugin;\n    var helper = plugin.helpers.viewportScreenshot;\n    var cropParams = (0, use_behavior_1.useBehavior)(helper === null || helper === void 0 ? void 0 : helper.behaviors.cropParams);\n    (0, use_behavior_1.useBehavior)(helper === null || helper === void 0 ? void 0 : helper.behaviors.relativeCrop);\n    if (!helper)\n        return null;\n    return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ style: { width: '100%', height: '24px', marginTop: '8px' } }, { children: [(0, jsx_runtime_1.jsx)(common_1.ToggleButton, { icon: icons_1.CropOrginalSvg, title: 'Auto-crop', inline: true, isSelected: cropParams.auto, style: { background: 'transparent', float: 'left', width: 'auto', height: '24px', lineHeight: '24px' }, toggle: function () { return helper.toggleAutocrop(); }, label: 'Auto-crop ' + (cropParams.auto ? 'On' : 'Off') }), !cropParams.auto && (0, jsx_runtime_1.jsx)(common_1.Button, { icon: icons_1.CropSvg, title: 'Crop', style: { background: 'transparent', float: 'right', height: '24px', lineHeight: '24px', width: '24px', padding: '0' }, onClick: function () { return helper.autocrop(); } }), !cropParams.auto && !helper.isFullFrame && (0, jsx_runtime_1.jsx)(common_1.Button, { icon: icons_1.CropFreeSvg, title: 'Reset Crop', style: { background: 'transparent', float: 'right', height: '24px', lineHeight: '24px', width: '24px', padding: '0' }, onClick: function () { return helper.resetCrop(); } })] }));\n}\n//# sourceMappingURL=pdbe-screenshot-controls.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvcGRiZS1zY3JlZW5zaG90LWNvbnRyb2xzLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGtDQUFrQztBQUNsQyxjQUFjLG1CQUFPLENBQUMsZ0RBQU87QUFDN0Isb0JBQW9CLG1CQUFPLENBQUMsOERBQW1CO0FBQy9DLG1CQUFtQixtQkFBTyxDQUFDLGtIQUEyQztBQUN0RSxhQUFhLG1CQUFPLENBQUMsb0ZBQTRCO0FBQ2pELG1CQUFtQixtQkFBTyxDQUFDLGtIQUEyQztBQUN0RSxlQUFlLG1CQUFPLENBQUMsMEdBQXVDO0FBQzlELGlCQUFpQixtQkFBTyxDQUFDLHNGQUE2QjtBQUN0RCxxQkFBcUIsbUJBQU8sQ0FBQyxnSEFBMEM7QUFDdkUsY0FBYyxtQkFBTyxDQUFDLHdHQUFzQztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNULHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxnQkFBZ0I7QUFDeEQ7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsK0VBQStFLHlCQUF5QjtBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsZUFBZTtBQUM1QyxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHdCQUF3QixtQkFBbUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCx1RkFBdUYsZ0NBQWdDLElBQUksb0VBQW9FLHFCQUFxQiwwQ0FBMEMscUJBQXFCLElBQUksc0RBQXNELDJCQUEyQixJQUFJLCtGQUErRiw2R0FBNkcsSUFBSSxrQkFBa0IsdUZBQXVGLHVCQUF1Qix3QkFBd0IsbUJBQW1CLElBQUksbUNBQW1DLElBQUksbUJBQW1CLCtEQUErRCxrRkFBa0YsSUFBSSxzQkFBc0IsS0FBSyw4RUFBOEUsNkNBQTZDLElBQUksMkNBQTJDLDRDQUE0QyxtQ0FBbUMsb0NBQW9DLCtDQUErQyxJQUFJLCtDQUErQyx3REFBd0QsSUFBSTtBQUNoOEM7QUFDQTtBQUNBLENBQUM7QUFDRCxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0Usc0VBQXNFLHlDQUF5QywwQkFBMEI7QUFDN007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxTQUFTLG1EQUFtRCxJQUFJLDJEQUEyRCxzR0FBc0csNkZBQTZGLHdCQUF3QixpQ0FBaUMsMERBQTBELGlFQUFpRSwrQ0FBK0MsNEdBQTRHLHlCQUF5Qiw2QkFBNkIsd0ZBQXdGLHlEQUF5RCw0R0FBNEcseUJBQXlCLDhCQUE4QixJQUFJO0FBQ3hqQztBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3VpL3BkYmUtc2NyZWVuc2hvdC1jb250cm9scy5qcz9iZGMxIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5Eb3dubG9hZFNjcmVlbnNob3RDb250cm9scyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGpzeF9ydW50aW1lXzEgPSByZXF1aXJlKFwicmVhY3QvanN4LXJ1bnRpbWVcIik7XG52YXIgcGFyYW1ldGVyc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9jb250cm9scy9wYXJhbWV0ZXJzXCIpO1xudmFyIGJhc2VfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvYmFzZVwiKTtcbnZhciBzY3JlZW5zaG90XzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL3NjcmVlbnNob3RcIik7XG52YXIgY29tbW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2NvbW1vblwiKTtcbnZhciBjb21tYW5kc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9jb21tYW5kc1wiKTtcbnZhciB1c2VfYmVoYXZpb3JfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvaG9va3MvdXNlLWJlaGF2aW9yXCIpO1xudmFyIGljb25zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2ljb25zXCIpO1xudmFyIERvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKERvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBzaG93UHJldmlldzogdHJ1ZSxcbiAgICAgICAgICAgIGlzRGlzYWJsZWQ6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmRvd25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgKF9hID0gX3RoaXMucGx1Z2luLmhlbHBlcnMudmlld3BvcnRTY3JlZW5zaG90KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZG93bmxvYWQoKTtcbiAgICAgICAgICAgIF90aGlzLnByb3BzLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNvcHkgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHZhciBfYjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudHJ5cy5wdXNoKFswLCAyLCAsIDNdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sICgoX2IgPSB0aGlzLnBsdWdpbi5oZWxwZXJzLnZpZXdwb3J0U2NyZWVuc2hvdCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNvcHlUb0NsaXBib2FyZCgpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuVG9hc3QuU2hvdyh0aGlzLnBsdWdpbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdDb3BpZWQgdG8gY2xpcGJvYXJkLicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdTY3JlZW5zaG90JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0TXM6IDE1MDBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMuY29weUltZygpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgICAgICBfdGhpcy5jb3B5SW1nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3JjO1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sICgoX2EgPSB0aGlzLnBsdWdpbi5oZWxwZXJzLnZpZXdwb3J0U2NyZWVuc2hvdCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdldEltYWdlRGF0YVVyaSgpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYyA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBpbWFnZURhdGE6IHNyYyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH07XG4gICAgICAgIF90aGlzLm9wZW4gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKCFlLnRhcmdldC5maWxlcyB8fCAhZS50YXJnZXQuZmlsZXNbMF0pXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5TdGF0ZS5TbmFwc2hvdHMuT3BlbkZpbGUoX3RoaXMucGx1Z2luLCB7IGZpbGU6IGUudGFyZ2V0LmZpbGVzWzBdIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIERvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5iZWhhdmlvcnMuaXNVcGRhdGluZywgZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgaXNEaXNhYmxlZDogdiB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBEb3dubG9hZFNjcmVlbnNob3RDb250cm9scy5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBpbWFnZURhdGE6IHZvaWQgMCB9KTtcbiAgICB9O1xuICAgIERvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGhhc0NsaXBib2FyZEFwaSA9ICEhKChfYSA9IG5hdmlnYXRvci5jbGlwYm9hcmQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS53cml0ZSk7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB7IGNoaWxkcmVuOiBbdGhpcy5zdGF0ZS5zaG93UHJldmlldyAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWltYWdlLXByZXZpZXcnIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKHNjcmVlbnNob3RfMS5TY3JlZW5zaG90UHJldmlldywgeyBwbHVnaW46IHRoaXMucGx1Z2luIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKENyb3BDb250cm9scywgeyBwbHVnaW46IHRoaXMucGx1Z2luIH0pXSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtZmxleC1yb3cnIH0sIHsgY2hpbGRyZW46IFshdGhpcy5zdGF0ZS5pbWFnZURhdGEgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBpY29uOiBpY29uc18xLkNvcHlTdmcsIG9uQ2xpY2s6IGhhc0NsaXBib2FyZEFwaSA/IHRoaXMuY29weSA6IHRoaXMuY29weUltZywgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNEaXNhYmxlZCB9LCB7IGNoaWxkcmVuOiBcIkNvcHlcIiB9KSksIHRoaXMuc3RhdGUuaW1hZ2VEYXRhICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQnV0dG9uLCB0c2xpYl8xLl9fYXNzaWduKHsgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc2V0U3RhdGUoeyBpbWFnZURhdGE6IHZvaWQgMCB9KTsgfSwgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNEaXNhYmxlZCB9LCB7IGNoaWxkcmVuOiBcIkNsZWFyXCIgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgdHNsaWJfMS5fX2Fzc2lnbih7IGljb246IGljb25zXzEuR2V0QXBwU3ZnLCBvbkNsaWNrOiB0aGlzLmRvd25sb2FkLCBkaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0Rpc2FibGVkIH0sIHsgY2hpbGRyZW46IFwiRG93bmxvYWRcIiB9KSldIH0pKSwgdGhpcy5zdGF0ZS5pbWFnZURhdGEgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1yb3cgbXNwLWNvcHktaW1hZ2Utd3JhcHBlcicgfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgeyBjaGlsZHJlbjogXCJSaWdodCBjbGljayBiZWxvdyArIENvcHkgSW1hZ2VcIiB9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImltZ1wiLCB7IHNyYzogdGhpcy5zdGF0ZS5pbWFnZURhdGEsIHN0eWxlOiB7IHdpZHRoOiAnMTAwJScsIGhlaWdodDogMzIsIGRpc3BsYXk6ICdibG9jaycgfSB9KV0gfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFNjcmVlbnNob3RQYXJhbXMsIHsgcGx1Z2luOiB0aGlzLnBsdWdpbiwgaXNEaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0Rpc2FibGVkIH0pXSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBEb3dubG9hZFNjcmVlbnNob3RDb250cm9scztcbn0oYmFzZV8xLlBsdWdpblVJQ29tcG9uZW50KSk7XG5leHBvcnRzLkRvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzID0gRG93bmxvYWRTY3JlZW5zaG90Q29udHJvbHM7XG5mdW5jdGlvbiBTY3JlZW5zaG90UGFyYW1zKF9hKSB7XG4gICAgdmFyIHBsdWdpbiA9IF9hLnBsdWdpbiwgaXNEaXNhYmxlZCA9IF9hLmlzRGlzYWJsZWQ7XG4gICAgdmFyIGhlbHBlciA9IHBsdWdpbi5oZWxwZXJzLnZpZXdwb3J0U2NyZWVuc2hvdDtcbiAgICB2YXIgdmFsdWVzID0gKDAsIHVzZV9iZWhhdmlvcl8xLnVzZUJlaGF2aW9yKShoZWxwZXIuYmVoYXZpb3JzLnZhbHVlcyk7XG4gICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkocGFyYW1ldGVyc18xLlBhcmFtZXRlckNvbnRyb2xzLCB7IHBhcmFtczogaGVscGVyLnBhcmFtcywgdmFsdWVzOiB2YWx1ZXMsIG9uQ2hhbmdlVmFsdWVzOiBmdW5jdGlvbiAodikgeyByZXR1cm4gaGVscGVyLmJlaGF2aW9ycy52YWx1ZXMubmV4dCh2KTsgfSwgaXNEaXNhYmxlZDogaXNEaXNhYmxlZCB9KTtcbn1cbmZ1bmN0aW9uIENyb3BDb250cm9scyhfYSkge1xuICAgIHZhciBwbHVnaW4gPSBfYS5wbHVnaW47XG4gICAgdmFyIGhlbHBlciA9IHBsdWdpbi5oZWxwZXJzLnZpZXdwb3J0U2NyZWVuc2hvdDtcbiAgICB2YXIgY3JvcFBhcmFtcyA9ICgwLCB1c2VfYmVoYXZpb3JfMS51c2VCZWhhdmlvcikoaGVscGVyID09PSBudWxsIHx8IGhlbHBlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogaGVscGVyLmJlaGF2aW9ycy5jcm9wUGFyYW1zKTtcbiAgICAoMCwgdXNlX2JlaGF2aW9yXzEudXNlQmVoYXZpb3IpKGhlbHBlciA9PT0gbnVsbCB8fCBoZWxwZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGhlbHBlci5iZWhhdmlvcnMucmVsYXRpdmVDcm9wKTtcbiAgICBpZiAoIWhlbHBlcilcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyB3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICcyNHB4JywgbWFyZ2luVG9wOiAnOHB4JyB9IH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLlRvZ2dsZUJ1dHRvbiwgeyBpY29uOiBpY29uc18xLkNyb3BPcmdpbmFsU3ZnLCB0aXRsZTogJ0F1dG8tY3JvcCcsIGlubGluZTogdHJ1ZSwgaXNTZWxlY3RlZDogY3JvcFBhcmFtcy5hdXRvLCBzdHlsZTogeyBiYWNrZ3JvdW5kOiAndHJhbnNwYXJlbnQnLCBmbG9hdDogJ2xlZnQnLCB3aWR0aDogJ2F1dG8nLCBoZWlnaHQ6ICcyNHB4JywgbGluZUhlaWdodDogJzI0cHgnIH0sIHRvZ2dsZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gaGVscGVyLnRvZ2dsZUF1dG9jcm9wKCk7IH0sIGxhYmVsOiAnQXV0by1jcm9wICcgKyAoY3JvcFBhcmFtcy5hdXRvID8gJ09uJyA6ICdPZmYnKSB9KSwgIWNyb3BQYXJhbXMuYXV0byAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgeyBpY29uOiBpY29uc18xLkNyb3BTdmcsIHRpdGxlOiAnQ3JvcCcsIHN0eWxlOiB7IGJhY2tncm91bmQ6ICd0cmFuc3BhcmVudCcsIGZsb2F0OiAncmlnaHQnLCBoZWlnaHQ6ICcyNHB4JywgbGluZUhlaWdodDogJzI0cHgnLCB3aWR0aDogJzI0cHgnLCBwYWRkaW5nOiAnMCcgfSwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gaGVscGVyLmF1dG9jcm9wKCk7IH0gfSksICFjcm9wUGFyYW1zLmF1dG8gJiYgIWhlbHBlci5pc0Z1bGxGcmFtZSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgeyBpY29uOiBpY29uc18xLkNyb3BGcmVlU3ZnLCB0aXRsZTogJ1Jlc2V0IENyb3AnLCBzdHlsZTogeyBiYWNrZ3JvdW5kOiAndHJhbnNwYXJlbnQnLCBmbG9hdDogJ3JpZ2h0JywgaGVpZ2h0OiAnMjRweCcsIGxpbmVIZWlnaHQ6ICcyNHB4Jywgd2lkdGg6ICcyNHB4JywgcGFkZGluZzogJzAnIH0sIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGhlbHBlci5yZXNldENyb3AoKTsgfSB9KV0gfSkpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGRiZS1zY3JlZW5zaG90LWNvbnRyb2xzLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/ui/pdbe-screenshot-controls.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/pdbe-structure-controls.js":
  /*!*******************************************!*\
    !*** ./lib/ui/pdbe-structure-controls.js ***!
    \*******************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.PDBeSuperpositionStructureTools = exports.PDBeLigandViewStructureTools = exports.CustomStructureControls = exports.PDBeStructureTools = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar components_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/structure/components */ \"./node_modules/molstar/lib/mol-plugin-ui/structure/components.js\");\nvar measurements_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/structure/measurements */ \"./node_modules/molstar/lib/mol-plugin-ui/structure/measurements.js\");\nvar source_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/structure/source */ \"./node_modules/molstar/lib/mol-plugin-ui/structure/source.js\");\nvar volume_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/structure/volume */ \"./node_modules/molstar/lib/mol-plugin-ui/structure/volume.js\");\nvar annotation_controls_1 = __webpack_require__(/*! ./annotation-controls */ \"./lib/ui/annotation-controls.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar superposition_components_1 = __webpack_require__(/*! ./superposition-components */ \"./lib/ui/superposition-components.js\");\nvar quick_styles_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/structure/quick-styles */ \"./node_modules/molstar/lib/mol-plugin-ui/structure/quick-styles.js\");\nvar alphafold_superposition_1 = __webpack_require__(/*! ./alphafold-superposition */ \"./lib/ui/alphafold-superposition.js\");\nvar export_superposition_1 = __webpack_require__(/*! ./export-superposition */ \"./lib/ui/export-superposition.js\");\nvar alphafold_tranparency_1 = __webpack_require__(/*! ./alphafold-tranparency */ \"./lib/ui/alphafold-tranparency.js\");\nvar PDBeStructureTools = /** @class */ (function (_super) {\n    tslib_1.__extends(PDBeStructureTools, _super);\n    function PDBeStructureTools() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PDBeStructureTools.prototype.render = function () {\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-section-header' }, { children: [(0, jsx_runtime_1.jsx)(icons_1.Icon, { svg: icons_1.BuildSvg }), \"Structure Tools\"] })), (0, jsx_runtime_1.jsx)(source_1.StructureSourceControls, {}), (0, jsx_runtime_1.jsx)(annotation_controls_1.AnnotationsComponentControls, {}), (0, jsx_runtime_1.jsx)(quick_styles_1.StructureQuickStylesControls, {}), (0, jsx_runtime_1.jsx)(components_1.StructureComponentControls, {}), (0, jsx_runtime_1.jsx)(volume_1.VolumeStreamingControls, {}), (0, jsx_runtime_1.jsx)(volume_1.VolumeSourceControls, {}), (0, jsx_runtime_1.jsx)(measurements_1.StructureMeasurementsControls, {}), (0, jsx_runtime_1.jsx)(CustomStructureControls, {})] });\n    };\n    return PDBeStructureTools;\n}(base_1.PluginUIComponent));\nexports.PDBeStructureTools = PDBeStructureTools;\nvar CustomStructureControls = /** @class */ (function (_super) {\n    tslib_1.__extends(CustomStructureControls, _super);\n    function CustomStructureControls() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    CustomStructureControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.state.behaviors.events.changed, function () { return _this.forceUpdate(); });\n    };\n    CustomStructureControls.prototype.render = function () {\n        var _this = this;\n        var controls = [];\n        this.plugin.customStructureControls.forEach(function (Controls, key) {\n            controls.push((0, jsx_runtime_1.jsx)(Controls, { initiallyCollapsed: _this.props.initiallyCollapsed }, key));\n        });\n        return controls.length > 0 ? (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: controls }) : null;\n    };\n    return CustomStructureControls;\n}(base_1.PluginUIComponent));\nexports.CustomStructureControls = CustomStructureControls;\nvar PDBeLigandViewStructureTools = /** @class */ (function (_super) {\n    tslib_1.__extends(PDBeLigandViewStructureTools, _super);\n    function PDBeLigandViewStructureTools() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PDBeLigandViewStructureTools.prototype.render = function () {\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-section-header' }, { children: [(0, jsx_runtime_1.jsx)(icons_1.Icon, { svg: icons_1.BuildSvg }), \"Structure Tools\"] })), (0, jsx_runtime_1.jsx)(components_1.StructureComponentControls, {}), (0, jsx_runtime_1.jsx)(volume_1.VolumeStreamingControls, {}), (0, jsx_runtime_1.jsx)(measurements_1.StructureMeasurementsControls, {}), (0, jsx_runtime_1.jsx)(CustomStructureControls, {})] });\n    };\n    return PDBeLigandViewStructureTools;\n}(base_1.PluginUIComponent));\nexports.PDBeLigandViewStructureTools = PDBeLigandViewStructureTools;\nvar PDBeSuperpositionStructureTools = /** @class */ (function (_super) {\n    tslib_1.__extends(PDBeSuperpositionStructureTools, _super);\n    function PDBeSuperpositionStructureTools() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PDBeSuperpositionStructureTools.prototype.render = function () {\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-section-header' }, { children: [(0, jsx_runtime_1.jsx)(icons_1.Icon, { svg: icons_1.BuildSvg }), \"Structure Tools\"] })), (0, jsx_runtime_1.jsx)(superposition_components_1.SuperpositionComponentControls, {}), (0, jsx_runtime_1.jsx)(alphafold_tranparency_1.AlphafoldTransparencyControls, {}), (0, jsx_runtime_1.jsx)(alphafold_superposition_1.AlphafoldPaeControls, {}), (0, jsx_runtime_1.jsx)(alphafold_superposition_1.AlphafoldSuperpositionControls, {}), (0, jsx_runtime_1.jsx)(measurements_1.StructureMeasurementsControls, {}), (0, jsx_runtime_1.jsx)(export_superposition_1.SuperpositionModelExportUI, {}), (0, jsx_runtime_1.jsx)(CustomStructureControls, {})] });\n    };\n    return PDBeSuperpositionStructureTools;\n}(base_1.PluginUIComponent));\nexports.PDBeSuperpositionStructureTools = PDBeSuperpositionStructureTools;\n//# sourceMappingURL=pdbe-structure-controls.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvcGRiZS1zdHJ1Y3R1cmUtY29udHJvbHMuanMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsdUNBQXVDLEdBQUcsb0NBQW9DLEdBQUcsK0JBQStCLEdBQUcsMEJBQTBCO0FBQzdJLGNBQWMsbUJBQU8sQ0FBQyxnREFBTztBQUM3QixvQkFBb0IsbUJBQU8sQ0FBQyw4REFBbUI7QUFDL0MsYUFBYSxtQkFBTyxDQUFDLG9GQUE0QjtBQUNqRCxtQkFBbUIsbUJBQU8sQ0FBQyxvSEFBNEM7QUFDdkUscUJBQXFCLG1CQUFPLENBQUMsd0hBQThDO0FBQzNFLGVBQWUsbUJBQU8sQ0FBQyw0R0FBd0M7QUFDL0QsZUFBZSxtQkFBTyxDQUFDLDRHQUF3QztBQUMvRCw0QkFBNEIsbUJBQU8sQ0FBQyw4REFBdUI7QUFDM0QsY0FBYyxtQkFBTyxDQUFDLHdHQUFzQztBQUM1RCxpQ0FBaUMsbUJBQU8sQ0FBQyx3RUFBNEI7QUFDckUscUJBQXFCLG1CQUFPLENBQUMsd0hBQThDO0FBQzNFLGdDQUFnQyxtQkFBTyxDQUFDLHNFQUEyQjtBQUNuRSw2QkFBNkIsbUJBQU8sQ0FBQyxnRUFBd0I7QUFDN0QsOEJBQThCLG1CQUFPLENBQUMsa0VBQXlCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSw2REFBNkQsaUNBQWlDLElBQUksa0RBQWtELHVCQUF1Qix1QkFBdUIsK0RBQStELGdGQUFnRix5RUFBeUUscUVBQXFFLDhEQUE4RCwyREFBMkQsMEVBQTBFLHFEQUFxRCxJQUFJO0FBQzV4QjtBQUNBO0FBQ0EsQ0FBQztBQUNELDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRiw2QkFBNkI7QUFDOUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxvREFBb0Q7QUFDakgsU0FBUztBQUNULHNGQUFzRixvQkFBb0I7QUFDMUc7QUFDQTtBQUNBLENBQUM7QUFDRCwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDZEQUE2RCxpQ0FBaUMsSUFBSSxrREFBa0QsdUJBQXVCLHVCQUF1QixzRUFBc0UsOERBQThELDBFQUEwRSxxREFBcUQsSUFBSTtBQUMxZ0I7QUFDQTtBQUNBLENBQUM7QUFDRCxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDZEQUE2RCxpQ0FBaUMsSUFBSSxrREFBa0QsdUJBQXVCLHVCQUF1Qix3RkFBd0YsbUZBQW1GLDRFQUE0RSxzRkFBc0YsMEVBQTBFLCtFQUErRSxxREFBcUQsSUFBSTtBQUNseUI7QUFDQTtBQUNBLENBQUM7QUFDRCx1Q0FBdUM7QUFDdkMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvdWkvcGRiZS1zdHJ1Y3R1cmUtY29udHJvbHMuanM/ZTE1MCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuUERCZVN1cGVycG9zaXRpb25TdHJ1Y3R1cmVUb29scyA9IGV4cG9ydHMuUERCZUxpZ2FuZFZpZXdTdHJ1Y3R1cmVUb29scyA9IGV4cG9ydHMuQ3VzdG9tU3RydWN0dXJlQ29udHJvbHMgPSBleHBvcnRzLlBEQmVTdHJ1Y3R1cmVUb29scyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGpzeF9ydW50aW1lXzEgPSByZXF1aXJlKFwicmVhY3QvanN4LXJ1bnRpbWVcIik7XG52YXIgYmFzZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9iYXNlXCIpO1xudmFyIGNvbXBvbmVudHNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvc3RydWN0dXJlL2NvbXBvbmVudHNcIik7XG52YXIgbWVhc3VyZW1lbnRzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3N0cnVjdHVyZS9tZWFzdXJlbWVudHNcIik7XG52YXIgc291cmNlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3N0cnVjdHVyZS9zb3VyY2VcIik7XG52YXIgdm9sdW1lXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3N0cnVjdHVyZS92b2x1bWVcIik7XG52YXIgYW5ub3RhdGlvbl9jb250cm9sc18xID0gcmVxdWlyZShcIi4vYW5ub3RhdGlvbi1jb250cm9sc1wiKTtcbnZhciBpY29uc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9jb250cm9scy9pY29uc1wiKTtcbnZhciBzdXBlcnBvc2l0aW9uX2NvbXBvbmVudHNfMSA9IHJlcXVpcmUoXCIuL3N1cGVycG9zaXRpb24tY29tcG9uZW50c1wiKTtcbnZhciBxdWlja19zdHlsZXNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvc3RydWN0dXJlL3F1aWNrLXN0eWxlc1wiKTtcbnZhciBhbHBoYWZvbGRfc3VwZXJwb3NpdGlvbl8xID0gcmVxdWlyZShcIi4vYWxwaGFmb2xkLXN1cGVycG9zaXRpb25cIik7XG52YXIgZXhwb3J0X3N1cGVycG9zaXRpb25fMSA9IHJlcXVpcmUoXCIuL2V4cG9ydC1zdXBlcnBvc2l0aW9uXCIpO1xudmFyIGFscGhhZm9sZF90cmFucGFyZW5jeV8xID0gcmVxdWlyZShcIi4vYWxwaGFmb2xkLXRyYW5wYXJlbmN5XCIpO1xudmFyIFBEQmVTdHJ1Y3R1cmVUb29scyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhQREJlU3RydWN0dXJlVG9vbHMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUERCZVN0cnVjdHVyZVRvb2xzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFBEQmVTdHJ1Y3R1cmVUb29scy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3Atc2VjdGlvbi1oZWFkZXInIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGljb25zXzEuSWNvbiwgeyBzdmc6IGljb25zXzEuQnVpbGRTdmcgfSksIFwiU3RydWN0dXJlIFRvb2xzXCJdIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShzb3VyY2VfMS5TdHJ1Y3R1cmVTb3VyY2VDb250cm9scywge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGFubm90YXRpb25fY29udHJvbHNfMS5Bbm5vdGF0aW9uc0NvbXBvbmVudENvbnRyb2xzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkocXVpY2tfc3R5bGVzXzEuU3RydWN0dXJlUXVpY2tTdHlsZXNDb250cm9scywge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbXBvbmVudHNfMS5TdHJ1Y3R1cmVDb21wb25lbnRDb250cm9scywge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHZvbHVtZV8xLlZvbHVtZVN0cmVhbWluZ0NvbnRyb2xzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkodm9sdW1lXzEuVm9sdW1lU291cmNlQ29udHJvbHMsIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShtZWFzdXJlbWVudHNfMS5TdHJ1Y3R1cmVNZWFzdXJlbWVudHNDb250cm9scywge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKEN1c3RvbVN0cnVjdHVyZUNvbnRyb2xzLCB7fSldIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFBEQmVTdHJ1Y3R1cmVUb29scztcbn0oYmFzZV8xLlBsdWdpblVJQ29tcG9uZW50KSk7XG5leHBvcnRzLlBEQmVTdHJ1Y3R1cmVUb29scyA9IFBEQmVTdHJ1Y3R1cmVUb29scztcbnZhciBDdXN0b21TdHJ1Y3R1cmVDb250cm9scyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhDdXN0b21TdHJ1Y3R1cmVDb250cm9scywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDdXN0b21TdHJ1Y3R1cmVDb250cm9scygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDdXN0b21TdHJ1Y3R1cmVDb250cm9scy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLnN0YXRlLmJlaGF2aW9ycy5ldmVudHMuY2hhbmdlZCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuZm9yY2VVcGRhdGUoKTsgfSk7XG4gICAgfTtcbiAgICBDdXN0b21TdHJ1Y3R1cmVDb250cm9scy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY29udHJvbHMgPSBbXTtcbiAgICAgICAgdGhpcy5wbHVnaW4uY3VzdG9tU3RydWN0dXJlQ29udHJvbHMuZm9yRWFjaChmdW5jdGlvbiAoQ29udHJvbHMsIGtleSkge1xuICAgICAgICAgICAgY29udHJvbHMucHVzaCgoMCwganN4X3J1bnRpbWVfMS5qc3gpKENvbnRyb2xzLCB7IGluaXRpYWxseUNvbGxhcHNlZDogX3RoaXMucHJvcHMuaW5pdGlhbGx5Q29sbGFwc2VkIH0sIGtleSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbnRyb2xzLmxlbmd0aCA+IDAgPyAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IGNvbnRyb2xzIH0pIDogbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBDdXN0b21TdHJ1Y3R1cmVDb250cm9scztcbn0oYmFzZV8xLlBsdWdpblVJQ29tcG9uZW50KSk7XG5leHBvcnRzLkN1c3RvbVN0cnVjdHVyZUNvbnRyb2xzID0gQ3VzdG9tU3RydWN0dXJlQ29udHJvbHM7XG52YXIgUERCZUxpZ2FuZFZpZXdTdHJ1Y3R1cmVUb29scyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhQREJlTGlnYW5kVmlld1N0cnVjdHVyZVRvb2xzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBEQmVMaWdhbmRWaWV3U3RydWN0dXJlVG9vbHMoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUERCZUxpZ2FuZFZpZXdTdHJ1Y3R1cmVUb29scy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3Atc2VjdGlvbi1oZWFkZXInIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGljb25zXzEuSWNvbiwgeyBzdmc6IGljb25zXzEuQnVpbGRTdmcgfSksIFwiU3RydWN0dXJlIFRvb2xzXCJdIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21wb25lbnRzXzEuU3RydWN0dXJlQ29tcG9uZW50Q29udHJvbHMsIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KSh2b2x1bWVfMS5Wb2x1bWVTdHJlYW1pbmdDb250cm9scywge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKG1lYXN1cmVtZW50c18xLlN0cnVjdHVyZU1lYXN1cmVtZW50c0NvbnRyb2xzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoQ3VzdG9tU3RydWN0dXJlQ29udHJvbHMsIHt9KV0gfSk7XG4gICAgfTtcbiAgICByZXR1cm4gUERCZUxpZ2FuZFZpZXdTdHJ1Y3R1cmVUb29scztcbn0oYmFzZV8xLlBsdWdpblVJQ29tcG9uZW50KSk7XG5leHBvcnRzLlBEQmVMaWdhbmRWaWV3U3RydWN0dXJlVG9vbHMgPSBQREJlTGlnYW5kVmlld1N0cnVjdHVyZVRvb2xzO1xudmFyIFBEQmVTdXBlcnBvc2l0aW9uU3RydWN0dXJlVG9vbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUERCZVN1cGVycG9zaXRpb25TdHJ1Y3R1cmVUb29scywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQREJlU3VwZXJwb3NpdGlvblN0cnVjdHVyZVRvb2xzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFBEQmVTdXBlcnBvc2l0aW9uU3RydWN0dXJlVG9vbHMucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLXNlY3Rpb24taGVhZGVyJyB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShpY29uc18xLkljb24sIHsgc3ZnOiBpY29uc18xLkJ1aWxkU3ZnIH0pLCBcIlN0cnVjdHVyZSBUb29sc1wiXSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoc3VwZXJwb3NpdGlvbl9jb21wb25lbnRzXzEuU3VwZXJwb3NpdGlvbkNvbXBvbmVudENvbnRyb2xzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoYWxwaGFmb2xkX3RyYW5wYXJlbmN5XzEuQWxwaGFmb2xkVHJhbnNwYXJlbmN5Q29udHJvbHMsIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShhbHBoYWZvbGRfc3VwZXJwb3NpdGlvbl8xLkFscGhhZm9sZFBhZUNvbnRyb2xzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoYWxwaGFmb2xkX3N1cGVycG9zaXRpb25fMS5BbHBoYWZvbGRTdXBlcnBvc2l0aW9uQ29udHJvbHMsIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShtZWFzdXJlbWVudHNfMS5TdHJ1Y3R1cmVNZWFzdXJlbWVudHNDb250cm9scywge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGV4cG9ydF9zdXBlcnBvc2l0aW9uXzEuU3VwZXJwb3NpdGlvbk1vZGVsRXhwb3J0VUksIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShDdXN0b21TdHJ1Y3R1cmVDb250cm9scywge30pXSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBQREJlU3VwZXJwb3NpdGlvblN0cnVjdHVyZVRvb2xzO1xufShiYXNlXzEuUGx1Z2luVUlDb21wb25lbnQpKTtcbmV4cG9ydHMuUERCZVN1cGVycG9zaXRpb25TdHJ1Y3R1cmVUb29scyA9IFBEQmVTdXBlcnBvc2l0aW9uU3RydWN0dXJlVG9vbHM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wZGJlLXN0cnVjdHVyZS1jb250cm9scy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/ui/pdbe-structure-controls.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/pdbe-viewport-controls.js":
  /*!******************************************!*\
    !*** ./lib/ui/pdbe-viewport-controls.js ***!
    \******************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.PDBeViewportControls = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar config_1 = __webpack_require__(/*! Molstar/mol-plugin/config */ \"./node_modules/molstar/lib/mol-plugin/config.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar selection_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/structure/selection */ \"./node_modules/molstar/lib/mol-plugin-ui/structure/selection.js\");\nvar pdbe_screenshot_controls_1 = __webpack_require__(/*! ./pdbe-screenshot-controls */ \"./lib/ui/pdbe-screenshot-controls.js\");\nvar simple_settings_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/viewport/simple-settings */ \"./node_modules/molstar/lib/mol-plugin-ui/viewport/simple-settings.js\");\nvar viewport_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/viewport */ \"./node_modules/molstar/lib/mol-plugin-ui/viewport.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar PDBeViewportControls = /** @class */ (function (_super) {\n    tslib_1.__extends(PDBeViewportControls, _super);\n    function PDBeViewportControls() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PDBeViewportControls.prototype.isBlack = function (customeState) {\n        if (customeState && customeState.initParams && customeState.initParams.bgColor) {\n            var color = customeState.initParams.bgColor;\n            if (color.r === 0 && color.g === 0 && color.b === 0)\n                return true;\n        }\n        return false;\n    };\n    PDBeViewportControls.prototype.render = function () {\n        var customeState = this.plugin.customState;\n        var showPDBeLink = false;\n        var showControlToggle = true;\n        var showControlInfo = true;\n        if (customeState && customeState.initParams && customeState.initParams.moleculeId && customeState.initParams.pdbeLink)\n            showPDBeLink = true;\n        if (customeState && customeState.initParams && customeState.initParams.superposition)\n            showPDBeLink = false;\n        if (customeState && customeState.initParams && customeState.initParams.hideCanvasControls && customeState.initParams.hideCanvasControls.indexOf('controlToggle') > -1)\n            showControlToggle = false;\n        if (customeState && customeState.initParams && customeState.initParams.hideCanvasControls && customeState.initParams.hideCanvasControls.indexOf('controlInfo') > -1)\n            showControlInfo = false;\n        var bgColor = this.isBlack(customeState) ? '#fff' : '#555';\n        var pdbeLink = {\n            parentStyle: { width: 'auto' },\n            bgStyle: { position: 'absolute', height: '27px', width: '54px', marginLeft: '-33px' },\n            containerStyle: { position: 'absolute', right: '10px', top: '10px', padding: '3px 3px 3px 18px' },\n            style: { display: 'inline-block', fontSize: '14px', color: bgColor, borderBottom: 'none', cursor: 'pointer', textDecoration: 'none', position: 'absolute', right: '5px' },\n            pdbeImg: {\n                src: 'https://www.ebi.ac.uk/pdbe/entry/static/images/logos/PDBe/logo_T_64.png',\n                alt: 'PDBe logo',\n                style: { height: '12px', width: '12px', border: 0, position: 'absolute', margin: '4px 0 0 -13px' }\n            }\n        };\n        var vwpBtnsTopMargin = { marginTop: '30px' };\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [showPDBeLink && (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-viewport-controls-buttons', style: pdbeLink.containerStyle }, { children: [(0, jsx_runtime_1.jsx)(\"div\", { className: 'msp-semi-transparent-background', style: pdbeLink.bgStyle }), (0, jsx_runtime_1.jsxs)(\"a\", tslib_1.__assign({ className: 'msp-pdbe-link', style: pdbeLink.style, target: \"_blank\", href: \"https://pdbe.org/\".concat(customeState.initParams.moleculeId) }, { children: [(0, jsx_runtime_1.jsx)(\"img\", { src: pdbeLink.pdbeImg.src, alt: pdbeLink.pdbeImg.alt, style: pdbeLink.pdbeImg.style }), customeState.initParams.moleculeId] }))] })), (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-viewport-controls', onMouseMove: this.onMouseMove, style: showPDBeLink ? vwpBtnsTopMargin : void 0 }, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-viewport-controls-buttons' }, { children: [(0, jsx_runtime_1.jsxs)(\"div\", { children: [(0, jsx_runtime_1.jsx)(\"div\", { className: 'msp-semi-transparent-background' }), this.icon(icons_1.AutorenewSvg, this.resetCamera, 'Reset Camera')] }), (0, jsx_runtime_1.jsxs)(\"div\", { children: [(0, jsx_runtime_1.jsx)(\"div\", { className: 'msp-semi-transparent-background' }), this.icon(icons_1.CameraOutlinedSvg, this.toggleScreenshotExpanded, 'Screenshot / State Snapshot', this.state.isScreenshotExpanded)] }), (0, jsx_runtime_1.jsxs)(\"div\", { children: [(0, jsx_runtime_1.jsx)(\"div\", { className: 'msp-semi-transparent-background' }), showControlToggle && this.icon(icons_1.BuildOutlinedSvg, this.toggleControls, 'Toggle Controls Panel', this.plugin.layout.state.showControls), this.plugin.config.get(config_1.PluginConfig.Viewport.ShowExpand) && this.icon(icons_1.FullscreenSvg, this.toggleExpanded, 'Toggle Expanded Viewport', this.plugin.layout.state.isExpanded), showControlInfo && this.icon(icons_1.TuneSvg, this.toggleSettingsExpanded, 'Settings / Controls Info', this.state.isSettingsExpanded)] }), this.plugin.config.get(config_1.PluginConfig.Viewport.ShowSelectionMode) && (0, jsx_runtime_1.jsxs)(\"div\", { children: [(0, jsx_runtime_1.jsx)(\"div\", { className: 'msp-semi-transparent-background' }), (0, jsx_runtime_1.jsx)(selection_1.ToggleSelectionModeButton, {})] })] })), this.state.isScreenshotExpanded && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-viewport-controls-panel' }, { children: (0, jsx_runtime_1.jsx)(common_1.ControlGroup, tslib_1.__assign({ header: 'Screenshot / State', title: 'Click to close.', initialExpanded: true, hideExpander: true, hideOffset: true, onHeaderClick: this.toggleScreenshotExpanded, topRightIcon: icons_1.CloseSvg, noTopMargin: true, childrenClassName: 'msp-viewport-controls-panel-controls' }, { children: (0, jsx_runtime_1.jsx)(pdbe_screenshot_controls_1.DownloadScreenshotControls, { close: this.toggleScreenshotExpanded }) })) })), this.state.isSettingsExpanded && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-viewport-controls-panel' }, { children: (0, jsx_runtime_1.jsx)(common_1.ControlGroup, tslib_1.__assign({ header: 'Settings / Controls Info', title: 'Click to close.', initialExpanded: true, hideExpander: true, hideOffset: true, onHeaderClick: this.toggleSettingsExpanded, topRightIcon: icons_1.CloseSvg, noTopMargin: true, childrenClassName: 'msp-viewport-controls-panel-controls' }, { children: (0, jsx_runtime_1.jsx)(simple_settings_1.SimpleSettingsControl, {}) })) }))] }))] });\n    };\n    return PDBeViewportControls;\n}(viewport_1.ViewportControls));\nexports.PDBeViewportControls = PDBeViewportControls;\n//# sourceMappingURL=pdbe-viewport-controls.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvcGRiZS12aWV3cG9ydC1jb250cm9scy5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCw0QkFBNEI7QUFDNUIsY0FBYyxtQkFBTyxDQUFDLGdEQUFPO0FBQzdCLG9CQUFvQixtQkFBTyxDQUFDLDhEQUFtQjtBQUMvQyxlQUFlLG1CQUFPLENBQUMsa0ZBQTJCO0FBQ2xELGVBQWUsbUJBQU8sQ0FBQywwR0FBdUM7QUFDOUQsa0JBQWtCLG1CQUFPLENBQUMsa0hBQTJDO0FBQ3JFLGlDQUFpQyxtQkFBTyxDQUFDLHdFQUE0QjtBQUNyRSx3QkFBd0IsbUJBQU8sQ0FBQyw0SEFBZ0Q7QUFDaEYsaUJBQWlCLG1CQUFPLENBQUMsNEZBQWdDO0FBQ3pELGNBQWMsbUJBQU8sQ0FBQyx3R0FBc0M7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsZUFBZTtBQUMxQyx1QkFBdUIsMEVBQTBFO0FBQ2pHLDhCQUE4QiwrRUFBK0U7QUFDN0cscUJBQXFCLGdLQUFnSztBQUNyTDtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLGlDQUFpQztBQUNqQyxpRUFBaUUsNkVBQTZFLDRFQUE0RSxJQUFJLDJDQUEyQyx1RUFBdUUsbURBQW1ELDJJQUEySSxJQUFJLDJDQUEyQyxxRkFBcUYsd0NBQXdDLEtBQUssc0RBQXNELG9IQUFvSCxJQUFJLDZEQUE2RCw0Q0FBNEMsSUFBSSw0Q0FBNEMsMkNBQTJDLDhDQUE4Qyx1RUFBdUUsb0NBQW9DLDJDQUEyQyw4Q0FBOEMseUlBQXlJLG9DQUFvQywyQ0FBMkMsOENBQThDLHVkQUF1ZCxnSEFBZ0gsMkNBQTJDLDhDQUE4QyxtRUFBbUUsSUFBSSxJQUFJLHdGQUF3RiwwQ0FBMEMsSUFBSSwyRUFBMkUsaVJBQWlSLElBQUksMEZBQTBGLHNDQUFzQyxHQUFHLElBQUksc0ZBQXNGLDBDQUEwQyxJQUFJLDJFQUEyRSxxUkFBcVIsSUFBSSw0RUFBNEUsR0FBRyxJQUFJLEtBQUssS0FBSztBQUN0OEc7QUFDQTtBQUNBLENBQUM7QUFDRCw0QkFBNEI7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZGJlLW1vbHN0YXIvLi9saWIvdWkvcGRiZS12aWV3cG9ydC1jb250cm9scy5qcz9hYmY2Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5QREJlVmlld3BvcnRDb250cm9scyA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGpzeF9ydW50aW1lXzEgPSByZXF1aXJlKFwicmVhY3QvanN4LXJ1bnRpbWVcIik7XG52YXIgY29uZmlnXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luL2NvbmZpZ1wiKTtcbnZhciBjb21tb25fMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvY29tbW9uXCIpO1xudmFyIHNlbGVjdGlvbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9zdHJ1Y3R1cmUvc2VsZWN0aW9uXCIpO1xudmFyIHBkYmVfc2NyZWVuc2hvdF9jb250cm9sc18xID0gcmVxdWlyZShcIi4vcGRiZS1zY3JlZW5zaG90LWNvbnRyb2xzXCIpO1xudmFyIHNpbXBsZV9zZXR0aW5nc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS92aWV3cG9ydC9zaW1wbGUtc2V0dGluZ3NcIik7XG52YXIgdmlld3BvcnRfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvdmlld3BvcnRcIik7XG52YXIgaWNvbnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvaWNvbnNcIik7XG52YXIgUERCZVZpZXdwb3J0Q29udHJvbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUERCZVZpZXdwb3J0Q29udHJvbHMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUERCZVZpZXdwb3J0Q29udHJvbHMoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUERCZVZpZXdwb3J0Q29udHJvbHMucHJvdG90eXBlLmlzQmxhY2sgPSBmdW5jdGlvbiAoY3VzdG9tZVN0YXRlKSB7XG4gICAgICAgIGlmIChjdXN0b21lU3RhdGUgJiYgY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMgJiYgY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMuYmdDb2xvcikge1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMuYmdDb2xvcjtcbiAgICAgICAgICAgIGlmIChjb2xvci5yID09PSAwICYmIGNvbG9yLmcgPT09IDAgJiYgY29sb3IuYiA9PT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBQREJlVmlld3BvcnRDb250cm9scy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VzdG9tZVN0YXRlID0gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIHZhciBzaG93UERCZUxpbmsgPSBmYWxzZTtcbiAgICAgICAgdmFyIHNob3dDb250cm9sVG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHNob3dDb250cm9sSW5mbyA9IHRydWU7XG4gICAgICAgIGlmIChjdXN0b21lU3RhdGUgJiYgY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMgJiYgY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMubW9sZWN1bGVJZCAmJiBjdXN0b21lU3RhdGUuaW5pdFBhcmFtcy5wZGJlTGluaylcbiAgICAgICAgICAgIHNob3dQREJlTGluayA9IHRydWU7XG4gICAgICAgIGlmIChjdXN0b21lU3RhdGUgJiYgY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMgJiYgY3VzdG9tZVN0YXRlLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvbilcbiAgICAgICAgICAgIHNob3dQREJlTGluayA9IGZhbHNlO1xuICAgICAgICBpZiAoY3VzdG9tZVN0YXRlICYmIGN1c3RvbWVTdGF0ZS5pbml0UGFyYW1zICYmIGN1c3RvbWVTdGF0ZS5pbml0UGFyYW1zLmhpZGVDYW52YXNDb250cm9scyAmJiBjdXN0b21lU3RhdGUuaW5pdFBhcmFtcy5oaWRlQ2FudmFzQ29udHJvbHMuaW5kZXhPZignY29udHJvbFRvZ2dsZScpID4gLTEpXG4gICAgICAgICAgICBzaG93Q29udHJvbFRvZ2dsZSA9IGZhbHNlO1xuICAgICAgICBpZiAoY3VzdG9tZVN0YXRlICYmIGN1c3RvbWVTdGF0ZS5pbml0UGFyYW1zICYmIGN1c3RvbWVTdGF0ZS5pbml0UGFyYW1zLmhpZGVDYW52YXNDb250cm9scyAmJiBjdXN0b21lU3RhdGUuaW5pdFBhcmFtcy5oaWRlQ2FudmFzQ29udHJvbHMuaW5kZXhPZignY29udHJvbEluZm8nKSA+IC0xKVxuICAgICAgICAgICAgc2hvd0NvbnRyb2xJbmZvID0gZmFsc2U7XG4gICAgICAgIHZhciBiZ0NvbG9yID0gdGhpcy5pc0JsYWNrKGN1c3RvbWVTdGF0ZSkgPyAnI2ZmZicgOiAnIzU1NSc7XG4gICAgICAgIHZhciBwZGJlTGluayA9IHtcbiAgICAgICAgICAgIHBhcmVudFN0eWxlOiB7IHdpZHRoOiAnYXV0bycgfSxcbiAgICAgICAgICAgIGJnU3R5bGU6IHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIGhlaWdodDogJzI3cHgnLCB3aWR0aDogJzU0cHgnLCBtYXJnaW5MZWZ0OiAnLTMzcHgnIH0sXG4gICAgICAgICAgICBjb250YWluZXJTdHlsZTogeyBwb3NpdGlvbjogJ2Fic29sdXRlJywgcmlnaHQ6ICcxMHB4JywgdG9wOiAnMTBweCcsIHBhZGRpbmc6ICczcHggM3B4IDNweCAxOHB4JyB9LFxuICAgICAgICAgICAgc3R5bGU6IHsgZGlzcGxheTogJ2lubGluZS1ibG9jaycsIGZvbnRTaXplOiAnMTRweCcsIGNvbG9yOiBiZ0NvbG9yLCBib3JkZXJCb3R0b206ICdub25lJywgY3Vyc29yOiAncG9pbnRlcicsIHRleHREZWNvcmF0aW9uOiAnbm9uZScsIHBvc2l0aW9uOiAnYWJzb2x1dGUnLCByaWdodDogJzVweCcgfSxcbiAgICAgICAgICAgIHBkYmVJbWc6IHtcbiAgICAgICAgICAgICAgICBzcmM6ICdodHRwczovL3d3dy5lYmkuYWMudWsvcGRiZS9lbnRyeS9zdGF0aWMvaW1hZ2VzL2xvZ29zL1BEQmUvbG9nb19UXzY0LnBuZycsXG4gICAgICAgICAgICAgICAgYWx0OiAnUERCZSBsb2dvJyxcbiAgICAgICAgICAgICAgICBzdHlsZTogeyBoZWlnaHQ6ICcxMnB4Jywgd2lkdGg6ICcxMnB4JywgYm9yZGVyOiAwLCBwb3NpdGlvbjogJ2Fic29sdXRlJywgbWFyZ2luOiAnNHB4IDAgMCAtMTNweCcgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgdndwQnRuc1RvcE1hcmdpbiA9IHsgbWFyZ2luVG9wOiAnMzBweCcgfTtcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtzaG93UERCZUxpbmsgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC12aWV3cG9ydC1jb250cm9scy1idXR0b25zJywgc3R5bGU6IHBkYmVMaW5rLmNvbnRhaW5lclN0eWxlIH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnbXNwLXNlbWktdHJhbnNwYXJlbnQtYmFja2dyb3VuZCcsIHN0eWxlOiBwZGJlTGluay5iZ1N0eWxlIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImFcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1wZGJlLWxpbmsnLCBzdHlsZTogcGRiZUxpbmsuc3R5bGUsIHRhcmdldDogXCJfYmxhbmtcIiwgaHJlZjogXCJodHRwczovL3BkYmUub3JnL1wiLmNvbmNhdChjdXN0b21lU3RhdGUuaW5pdFBhcmFtcy5tb2xlY3VsZUlkKSB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImltZ1wiLCB7IHNyYzogcGRiZUxpbmsucGRiZUltZy5zcmMsIGFsdDogcGRiZUxpbmsucGRiZUltZy5hbHQsIHN0eWxlOiBwZGJlTGluay5wZGJlSW1nLnN0eWxlIH0pLCBjdXN0b21lU3RhdGUuaW5pdFBhcmFtcy5tb2xlY3VsZUlkXSB9KSldIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC12aWV3cG9ydC1jb250cm9scycsIG9uTW91c2VNb3ZlOiB0aGlzLm9uTW91c2VNb3ZlLCBzdHlsZTogc2hvd1BEQmVMaW5rID8gdndwQnRuc1RvcE1hcmdpbiA6IHZvaWQgMCB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC12aWV3cG9ydC1jb250cm9scy1idXR0b25zJyB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgeyBjbGFzc05hbWU6ICdtc3Atc2VtaS10cmFuc3BhcmVudC1iYWNrZ3JvdW5kJyB9KSwgdGhpcy5pY29uKGljb25zXzEuQXV0b3JlbmV3U3ZnLCB0aGlzLnJlc2V0Q2FtZXJhLCAnUmVzZXQgQ2FtZXJhJyldIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB7IGNsYXNzTmFtZTogJ21zcC1zZW1pLXRyYW5zcGFyZW50LWJhY2tncm91bmQnIH0pLCB0aGlzLmljb24oaWNvbnNfMS5DYW1lcmFPdXRsaW5lZFN2ZywgdGhpcy50b2dnbGVTY3JlZW5zaG90RXhwYW5kZWQsICdTY3JlZW5zaG90IC8gU3RhdGUgU25hcHNob3QnLCB0aGlzLnN0YXRlLmlzU2NyZWVuc2hvdEV4cGFuZGVkKV0gfSksICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiAnbXNwLXNlbWktdHJhbnNwYXJlbnQtYmFja2dyb3VuZCcgfSksIHNob3dDb250cm9sVG9nZ2xlICYmIHRoaXMuaWNvbihpY29uc18xLkJ1aWxkT3V0bGluZWRTdmcsIHRoaXMudG9nZ2xlQ29udHJvbHMsICdUb2dnbGUgQ29udHJvbHMgUGFuZWwnLCB0aGlzLnBsdWdpbi5sYXlvdXQuc3RhdGUuc2hvd0NvbnRyb2xzKSwgdGhpcy5wbHVnaW4uY29uZmlnLmdldChjb25maWdfMS5QbHVnaW5Db25maWcuVmlld3BvcnQuU2hvd0V4cGFuZCkgJiYgdGhpcy5pY29uKGljb25zXzEuRnVsbHNjcmVlblN2ZywgdGhpcy50b2dnbGVFeHBhbmRlZCwgJ1RvZ2dsZSBFeHBhbmRlZCBWaWV3cG9ydCcsIHRoaXMucGx1Z2luLmxheW91dC5zdGF0ZS5pc0V4cGFuZGVkKSwgc2hvd0NvbnRyb2xJbmZvICYmIHRoaXMuaWNvbihpY29uc18xLlR1bmVTdmcsIHRoaXMudG9nZ2xlU2V0dGluZ3NFeHBhbmRlZCwgJ1NldHRpbmdzIC8gQ29udHJvbHMgSW5mbycsIHRoaXMuc3RhdGUuaXNTZXR0aW5nc0V4cGFuZGVkKV0gfSksIHRoaXMucGx1Z2luLmNvbmZpZy5nZXQoY29uZmlnXzEuUGx1Z2luQ29uZmlnLlZpZXdwb3J0LlNob3dTZWxlY3Rpb25Nb2RlKSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB7IGNsYXNzTmFtZTogJ21zcC1zZW1pLXRyYW5zcGFyZW50LWJhY2tncm91bmQnIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHNlbGVjdGlvbl8xLlRvZ2dsZVNlbGVjdGlvbk1vZGVCdXR0b24sIHt9KV0gfSldIH0pKSwgdGhpcy5zdGF0ZS5pc1NjcmVlbnNob3RFeHBhbmRlZCAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3Atdmlld3BvcnQtY29udHJvbHMtcGFuZWwnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQ29udHJvbEdyb3VwLCB0c2xpYl8xLl9fYXNzaWduKHsgaGVhZGVyOiAnU2NyZWVuc2hvdCAvIFN0YXRlJywgdGl0bGU6ICdDbGljayB0byBjbG9zZS4nLCBpbml0aWFsRXhwYW5kZWQ6IHRydWUsIGhpZGVFeHBhbmRlcjogdHJ1ZSwgaGlkZU9mZnNldDogdHJ1ZSwgb25IZWFkZXJDbGljazogdGhpcy50b2dnbGVTY3JlZW5zaG90RXhwYW5kZWQsIHRvcFJpZ2h0SWNvbjogaWNvbnNfMS5DbG9zZVN2Zywgbm9Ub3BNYXJnaW46IHRydWUsIGNoaWxkcmVuQ2xhc3NOYW1lOiAnbXNwLXZpZXdwb3J0LWNvbnRyb2xzLXBhbmVsLWNvbnRyb2xzJyB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHBkYmVfc2NyZWVuc2hvdF9jb250cm9sc18xLkRvd25sb2FkU2NyZWVuc2hvdENvbnRyb2xzLCB7IGNsb3NlOiB0aGlzLnRvZ2dsZVNjcmVlbnNob3RFeHBhbmRlZCB9KSB9KSkgfSkpLCB0aGlzLnN0YXRlLmlzU2V0dGluZ3NFeHBhbmRlZCAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3Atdmlld3BvcnQtY29udHJvbHMtcGFuZWwnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQ29udHJvbEdyb3VwLCB0c2xpYl8xLl9fYXNzaWduKHsgaGVhZGVyOiAnU2V0dGluZ3MgLyBDb250cm9scyBJbmZvJywgdGl0bGU6ICdDbGljayB0byBjbG9zZS4nLCBpbml0aWFsRXhwYW5kZWQ6IHRydWUsIGhpZGVFeHBhbmRlcjogdHJ1ZSwgaGlkZU9mZnNldDogdHJ1ZSwgb25IZWFkZXJDbGljazogdGhpcy50b2dnbGVTZXR0aW5nc0V4cGFuZGVkLCB0b3BSaWdodEljb246IGljb25zXzEuQ2xvc2VTdmcsIG5vVG9wTWFyZ2luOiB0cnVlLCBjaGlsZHJlbkNsYXNzTmFtZTogJ21zcC12aWV3cG9ydC1jb250cm9scy1wYW5lbC1jb250cm9scycgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShzaW1wbGVfc2V0dGluZ3NfMS5TaW1wbGVTZXR0aW5nc0NvbnRyb2wsIHt9KSB9KSkgfSkpXSB9KSldIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFBEQmVWaWV3cG9ydENvbnRyb2xzO1xufSh2aWV3cG9ydF8xLlZpZXdwb3J0Q29udHJvbHMpKTtcbmV4cG9ydHMuUERCZVZpZXdwb3J0Q29udHJvbHMgPSBQREJlVmlld3BvcnRDb250cm9scztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBkYmUtdmlld3BvcnQtY29udHJvbHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/ui/pdbe-viewport-controls.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/segment-tree.js":
  /*!********************************!*\
    !*** ./lib/ui/segment-tree.js ***!
    \********************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.SegmentTree = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar operators_1 = __webpack_require__(/*! rxjs/operators */ \"./node_modules/rxjs/dist/cjs/operators/index.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar mol_state_2 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar superposition_1 = __webpack_require__(/*! ../superposition */ \"./lib/superposition.js\");\nvar update_transform_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/state/update-transform */ \"./node_modules/molstar/lib/mol-plugin-ui/state/update-transform.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar lists_1 = __webpack_require__(/*! Molstar/mol-util/color/lists */ \"./node_modules/molstar/lib/mol-util/color/lists.js\");\nvar color_1 = __webpack_require__(/*! Molstar/mol-util/color */ \"./node_modules/molstar/lib/mol-util/color/index.js\");\nvar builder_1 = __webpack_require__(/*! Molstar/mol-script/language/builder */ \"./node_modules/molstar/lib/mol-script/language/builder.js\");\nvar rxjs_1 = __webpack_require__(/*! rxjs */ \"./node_modules/rxjs/dist/cjs/index.js\");\nvar transforms_1 = __webpack_require__(/*! Molstar/mol-plugin-state/transforms */ \"./node_modules/molstar/lib/mol-plugin-state/transforms.js\");\nvar superposition_2 = __webpack_require__(/*! ../superposition */ \"./lib/superposition.js\");\nvar SuperpositionTag = 'SuperpositionTransform';\nvar SegmentTree = /** @class */ (function (_super) {\n    tslib_1.__extends(SegmentTree, _super);\n    function SegmentTree() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.getSegmentParams = function () {\n            var customState = _this.customState;\n            if (!customState.superpositionState || !customState.superpositionState.segmentData)\n                return;\n            var segmentData = customState.superpositionState.segmentData;\n            var segmentArr = segmentData.map(function (segment, i) {\n                var segmentLabel = \"\".concat(i + 1, \" ( \").concat(segment.segment_start, \" - \").concat(segment.segment_end, \" )\");\n                return [segmentLabel, segmentLabel];\n            });\n            var segmentOptions = {\n                segment: param_definition_1.ParamDefinition.Select('', segmentArr, { label: 'Select Segment', description: 'Select segment to view its clusters below' })\n            };\n            var segmentIndex = customState.superpositionState.activeSegment - 1;\n            _this.setState({ segment: {\n                    params: segmentOptions,\n                    value: { segment: segmentArr[segmentIndex][0] }\n                } });\n            _this.setState({ isBusy: false });\n        };\n        _this.updateSegment = function (val) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var customState, updatedParams;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                if (!this.state.segment)\n                    return [2 /*return*/];\n                customState = this.customState;\n                customState.events.isBusy.next(true);\n                // Hide pervious segement structures\n                this.hideStructures(customState.superpositionState.activeSegment - 1);\n                updatedParams = tslib_1.__assign({}, this.state.segment);\n                updatedParams.value = val;\n                this.setState({ segment: updatedParams });\n                setTimeout(function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                    var updatedSegmentIndex;\n                    return tslib_1.__generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                updatedSegmentIndex = parseInt(val.segment.split(' ')[0]);\n                                customState.superpositionState.activeSegment = updatedSegmentIndex;\n                                // Display current segment visible structures\n                                return [4 /*yield*/, this.displayStructures(customState.superpositionState.activeSegment - 1)];\n                            case 1:\n                                // Display current segment visible structures\n                                _a.sent();\n                                customState.events.isBusy.next(false);\n                                this.plugin.customState.events.segmentUpdate.next(true);\n                                return [2 /*return*/];\n                        }\n                    });\n                }); }, 100);\n                return [2 /*return*/, false];\n            });\n        }); };\n        _this.hideStructures = function (segmentIndex) {\n            // clear selections\n            _this.plugin.managers.interactivity.lociSelects.deselectAll();\n            // clear Focus\n            _this.plugin.managers.structure.focus.clear();\n            // remove measurements\n            var measurements = _this.plugin.managers.structure.measurement.state;\n            var measureTypes = ['labels', 'distances', 'angles', 'dihedrals'];\n            var measurementCell = void 0;\n            measureTypes.forEach(function (type) {\n                if (measurementCell)\n                    return;\n                if (measurements[type][0]) {\n                    measurementCell = _this.plugin.state.data.cells.get(measurements[type][0].transform.parent);\n                }\n            });\n            if (measurementCell) {\n                commands_1.PluginCommands.State.RemoveObject(_this.plugin, { state: measurementCell.parent, ref: measurementCell.transform.parent, removeParentGhosts: true });\n            }\n            // hide structures\n            var customState = _this.customState;\n            customState.superpositionState.visibleRefs[segmentIndex] = [];\n            for (var _i = 0, _a = customState.superpositionState.loadedStructs[segmentIndex]; _i < _a.length; _i++) {\n                var struct = _a[_i];\n                var structRef = _this.customState.superpositionState.models[struct];\n                if (structRef) {\n                    var structHierarchy = _this.plugin.managers.structure.hierarchy.current.refs.get(structRef);\n                    if (structHierarchy && structHierarchy.components) {\n                        for (var _b = 0, _c = structHierarchy.components; _b < _c.length; _b++) {\n                            var c = _c[_b];\n                            if (c && c.cell && !c.cell.state.isHidden) {\n                                customState.superpositionState.visibleRefs[segmentIndex].push(c.cell.transform.ref);\n                                commands_1.PluginCommands.State.ToggleVisibility(_this.plugin, { state: c.cell.parent, ref: c.cell.transform.ref });\n                            }\n                        }\n                    }\n                }\n            }\n            if (customState.superpositionState.alphafold.ref) {\n                var afStr = _this.plugin.managers.structure.hierarchy.current.refs.get(customState.superpositionState.alphafold.ref);\n                if (afStr && afStr.components) {\n                    for (var _d = 0, _e = afStr.components; _d < _e.length; _d++) {\n                        var c = _e[_d];\n                        if (c && c.cell && !c.cell.state.isHidden) {\n                            commands_1.PluginCommands.State.ToggleVisibility(_this.plugin, { state: c.cell.parent, ref: c.cell.transform.ref });\n                        }\n                    }\n                }\n            }\n        };\n        _this.displayStructures = function (segmentIndex) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var customState, spState, loadStrs_1, _i, _a, ref, cell, afStr, _b, _c, c;\n            var _this = this;\n            return tslib_1.__generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        customState = this.customState;\n                        spState = customState.superpositionState;\n                        if (!(customState.superpositionState.visibleRefs[segmentIndex].length === 0)) return [3 /*break*/, 3];\n                        loadStrs_1 = [];\n                        customState.superpositionState.segmentData[segmentIndex].clusters.forEach(function (cluster) {\n                            var entryList = [cluster[0]];\n                            if (customState.initParams.superpositionParams && customState.initParams.superpositionParams.superposeAll) {\n                                entryList = cluster;\n                            }\n                            entryList.forEach(function (str) {\n                                var structStateId = \"\".concat(str.pdb_id, \"_\").concat(str.struct_asym_id);\n                                var structRef = customState.superpositionState.models[structStateId];\n                                if (structRef) {\n                                    var cell = _this.plugin.state.data.cells.get(structRef);\n                                    var isHidden = cell.state.isHidden ? true : false;\n                                    if (isHidden) {\n                                        commands_1.PluginCommands.State.ToggleVisibility(_this.plugin, { state: cell.parent, ref: structRef });\n                                        // PluginCommands.State.ToggleVisibility(this.plugin, { state: cell.parent!, ref: cell.transform.parent });\n                                    }\n                                }\n                                else {\n                                    loadStrs_1.push(str);\n                                }\n                            });\n                        });\n                        commands_1.PluginCommands.Camera.Reset(this.plugin);\n                        if (!(loadStrs_1.length > 0)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, (0, superposition_1.renderSuperposition)(this.plugin, segmentIndex, loadStrs_1)];\n                    case 1:\n                        _d.sent();\n                        commands_1.PluginCommands.Camera.Reset(this.plugin);\n                        _d.label = 2;\n                    case 2: return [3 /*break*/, 4];\n                    case 3:\n                        for (_i = 0, _a = customState.superpositionState.visibleRefs[segmentIndex]; _i < _a.length; _i++) {\n                            ref = _a[_i];\n                            cell = this.plugin.state.data.cells.get(ref);\n                            if (cell && cell.state.isHidden) {\n                                commands_1.PluginCommands.State.ToggleVisibility(this.plugin, { state: cell.parent, ref: ref });\n                            }\n                        }\n                        commands_1.PluginCommands.Camera.Reset(this.plugin);\n                        _d.label = 4;\n                    case 4:\n                        if (spState.alphafold.ref) {\n                            (0, superposition_2.superposeAf)(this.plugin, spState.alphafold.traceOnly);\n                            commands_1.PluginCommands.Camera.Reset(this.plugin);\n                        }\n                        if (spState.alphafold.ref && spState.alphafold.visibility[segmentIndex]) {\n                            afStr = this.plugin.managers.structure.hierarchy.current.refs.get(customState.superpositionState.alphafold.ref);\n                            if (afStr && afStr.components) {\n                                for (_b = 0, _c = afStr.components; _b < _c.length; _b++) {\n                                    c = _c[_b];\n                                    if (c && c.cell && c.cell.state.isHidden) {\n                                        commands_1.PluginCommands.State.ToggleVisibility(this.plugin, { state: c.cell.parent, ref: c.cell.transform.ref });\n                                    }\n                                }\n                            }\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        return _this;\n    }\n    SegmentTree.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.customState.events.superpositionInit, function () {\n            var customState = _this.customState;\n            if (customState && !customState.superpositionError) {\n                _this.getSegmentParams();\n            }\n            _this.forceUpdate();\n        });\n        this.subscribe(this.plugin.customState.events.isBusy, function (e) {\n            _this.setState({ isBusy: e });\n            if (e) {\n                commands_1.PluginCommands.Toast.Show(_this.plugin, {\n                    title: 'Process',\n                    message: 'Loading / computing large dataset!',\n                    key: 'is-busy-toast'\n                });\n            }\n            else {\n                commands_1.PluginCommands.Toast.Hide(_this.plugin, { key: 'is-busy-toast' });\n            }\n        });\n        this.subscribe(this.plugin.behaviors.layout.leftPanelTabName, function (e) {\n            if (e !== 'segments')\n                return;\n            _this.getSegmentParams();\n            _this.forceUpdate();\n        });\n    };\n    Object.defineProperty(SegmentTree.prototype, \"customState\", {\n        get: function () {\n            return this.plugin.customState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SegmentTree.prototype.transform = function (s, matrix) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var r, o, params, b;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        r = mol_state_2.StateObjectRef.resolveAndCheck(this.plugin.state.data, s);\n                        if (!r)\n                            return [2 /*return*/];\n                        o = mol_state_2.StateSelection.findTagInSubtree(this.plugin.state.data.tree, r.transform.ref, SuperpositionTag);\n                        params = {\n                            transform: {\n                                name: 'matrix',\n                                params: { data: matrix, transpose: false }\n                            }\n                        };\n                        b = o\n                            ? this.plugin.state.data.build().to(o).update(params)\n                            : this.plugin.state.data.build().to(s)\n                                .insert(transforms_1.StateTransforms.Model.TransformStructureConformation, params, { tags: SuperpositionTag });\n                        return [4 /*yield*/, this.plugin.runTask(this.plugin.state.data.updateTree(b))];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    SegmentTree.prototype.render = function () {\n        var sectionHeader = (0, jsx_runtime_1.jsx)(common_1.SectionHeader, { title: \"Structure clusters\" });\n        var customState = this.customState;\n        if (customState && customState.initParams && !customState.initParams.superposition) {\n            return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [sectionHeader, (0, jsx_runtime_1.jsx)(\"div\", { children: \"Functionality unavailable!\" })] });\n        }\n        else {\n            if (customState && customState.initParams && customState.initParams.superposition) {\n                sectionHeader = (0, jsx_runtime_1.jsx)(common_1.SectionHeader, { title: \"Structure clusters - \".concat(customState.initParams.moleculeId) });\n                if (customState.superpositionError) {\n                    return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [sectionHeader, (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { textAlign: 'center' } }, { children: customState.superpositionError }))] });\n                }\n                else if (!customState.superpositionState || !customState.superpositionState.segmentData) {\n                    return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [sectionHeader, (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { textAlign: 'center' } }, { children: \"Loading Segment Data!\" }))] });\n                }\n            }\n        }\n        if (this.state) {\n            var segmentIndex_1 = parseInt(this.state.segment.value.segment.split(' ')[0]) - 1;\n            var segmentData_1 = customState.superpositionState.segmentData;\n            var fullSegmentRange = \"( \".concat(segmentData_1[0].segment_start, \" - \").concat(segmentData_1[segmentData_1.length - 1].segment_end, \" )\");\n            sectionHeader = (0, jsx_runtime_1.jsx)(common_1.SectionHeader, { title: \"Structure clusters \".concat(customState.initParams.moleculeId), desc: fullSegmentRange });\n            return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [sectionHeader, (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: this.state.segment.params, values: this.state.segment.value, onChangeValues: this.updateSegment, isDisabled: this.state.isBusy }), segmentData_1[segmentIndex_1].clusters.map(function (c, i) { return (0, jsx_runtime_1.jsx)(ClusterNode, { cluster: c, totalClusters: segmentData_1[segmentIndex_1].clusters.length, segmentIndex: segmentIndex_1, clusterIndex: i }, \"cluster-\".concat(segmentIndex_1, \"-\").concat(i)); })] });\n        }\n        return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, {});\n    };\n    return SegmentTree;\n}(base_1.PurePluginUIComponent));\nexports.SegmentTree = SegmentTree;\nvar ClusterNode = /** @class */ (function (_super) {\n    tslib_1.__extends(ClusterNode, _super);\n    function ClusterNode() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            isCollapsed: false,\n            showAll: false,\n            showNone: false,\n            showSearch: false,\n            isBusy: false,\n            cluster: _this.props.cluster,\n            searchText: ''\n        };\n        _this.inputStream = new rxjs_1.Subject();\n        _this.handleInputStream = function (inputStr) {\n            _this.setState({ searchText: inputStr });\n            var filteredRes = _this.props.cluster.filter(function (item) {\n                return item.pdb_id.toLowerCase().indexOf(inputStr.toLowerCase()) >= 0;\n            });\n            _this.setState({ cluster: filteredRes });\n        };\n        _this.toggleExpanded = function (e) {\n            e.preventDefault();\n            _this.setState({ isCollapsed: !_this.state.isCollapsed });\n            e.currentTarget.blur();\n        };\n        _this.selectAll = function (e) {\n            e.preventDefault();\n            _this.setState({ showAll: !_this.state.showAll, showNone: false });\n            e.currentTarget.blur();\n        };\n        _this.selectNone = function (e) {\n            e.preventDefault();\n            _this.setState({ showAll: false, showNone: !_this.state.showNone });\n            e.currentTarget.blur();\n        };\n        _this.applyAction = function (e) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var customState, currentState;\n            var _this = this;\n            return tslib_1.__generator(this, function (_a) {\n                e.preventDefault();\n                e.currentTarget.blur();\n                customState = this.customState;\n                customState.events.isBusy.next(true);\n                currentState = tslib_1.__assign({}, this.state);\n                this.setState({ showAll: false, showNone: false });\n                setTimeout(function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                    var loadStrs, _a, _b, _c, str, structStateId, structRef, cell, isHidden, e_1_1;\n                    var _d, e_1, _e, _f;\n                    return tslib_1.__generator(this, function (_g) {\n                        switch (_g.label) {\n                            case 0:\n                                loadStrs = [];\n                                _g.label = 1;\n                            case 1:\n                                _g.trys.push([1, 12, 13, 18]);\n                                _a = true, _b = tslib_1.__asyncValues(this.state.cluster);\n                                _g.label = 2;\n                            case 2: return [4 /*yield*/, _b.next()];\n                            case 3:\n                                if (!(_c = _g.sent(), _d = _c.done, !_d)) return [3 /*break*/, 11];\n                                _f = _c.value;\n                                _a = false;\n                                _g.label = 4;\n                            case 4:\n                                _g.trys.push([4, , 9, 10]);\n                                str = _f;\n                                structStateId = \"\".concat(str.pdb_id, \"_\").concat(str.struct_asym_id);\n                                structRef = undefined;\n                                if (customState && customState.superpositionState && customState.superpositionState.models[structStateId]) {\n                                    structRef = this.customState.superpositionState.models[structStateId];\n                                }\n                                if (!structRef) return [3 /*break*/, 7];\n                                cell = this.plugin.state.data.cells.get(structRef);\n                                if (!cell) return [3 /*break*/, 6];\n                                isHidden = cell.state.isHidden ? true : false;\n                                if (!((isHidden && currentState.showAll) || (!isHidden && currentState.showNone))) return [3 /*break*/, 6];\n                                return [4 /*yield*/, commands_1.PluginCommands.State.ToggleVisibility(this.plugin, { state: cell.parent, ref: structRef })];\n                            case 5:\n                                _g.sent();\n                                _g.label = 6;\n                            case 6: return [3 /*break*/, 8];\n                            case 7:\n                                if (currentState.showAll)\n                                    loadStrs.push(str);\n                                _g.label = 8;\n                            case 8: return [3 /*break*/, 10];\n                            case 9:\n                                _a = true;\n                                return [7 /*endfinally*/];\n                            case 10: return [3 /*break*/, 2];\n                            case 11: return [3 /*break*/, 18];\n                            case 12:\n                                e_1_1 = _g.sent();\n                                e_1 = { error: e_1_1 };\n                                return [3 /*break*/, 18];\n                            case 13:\n                                _g.trys.push([13, , 16, 17]);\n                                if (!(!_a && !_d && (_e = _b.return))) return [3 /*break*/, 15];\n                                return [4 /*yield*/, _e.call(_b)];\n                            case 14:\n                                _g.sent();\n                                _g.label = 15;\n                            case 15: return [3 /*break*/, 17];\n                            case 16:\n                                if (e_1) throw e_1.error;\n                                return [7 /*endfinally*/];\n                            case 17: return [7 /*endfinally*/];\n                            case 18:\n                                ;\n                                commands_1.PluginCommands.Camera.Reset(this.plugin);\n                                if (!(loadStrs.length > 0)) return [3 /*break*/, 20];\n                                return [4 /*yield*/, (0, superposition_1.renderSuperposition)(this.plugin, this.props.segmentIndex, loadStrs)];\n                            case 19:\n                                _g.sent();\n                                _g.label = 20;\n                            case 20:\n                                customState.events.isBusy.next(false);\n                                return [2 /*return*/];\n                        }\n                    });\n                }); });\n                return [2 /*return*/];\n            });\n        }); };\n        _this.cancelAction = function (e) {\n            e.preventDefault();\n            _this.setState({ showAll: false, showNone: false });\n            e.currentTarget.blur();\n        };\n        _this.clearSearch = function (e) {\n            e.preventDefault();\n            _this.setState({ searchText: '' });\n            _this.inputStream.next('');\n            e.currentTarget.blur();\n        };\n        return _this;\n    }\n    ClusterNode.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.customState.events.isBusy, function (e) {\n            _this.setState({ isBusy: e, showAll: false, showNone: false });\n        });\n        this.subscribe(this.inputStream.pipe((0, operators_1.debounceTime)(1000 / 24)), function (e) { return _this.handleInputStream(e); });\n    };\n    Object.defineProperty(ClusterNode.prototype, \"customState\", {\n        get: function () {\n            return this.plugin.customState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ClusterNode.prototype.render = function () {\n        var _this = this;\n        var customState = this.customState;\n        if (!customState.superpositionState || !customState.superpositionState.segmentData)\n            return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, {});\n        var expand = (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: this.state.isCollapsed ? icons_1.ArrowRightSvg : icons_1.ArrowDropDownSvg, flex: '20px', onClick: this.toggleExpanded, transparent: true, disabled: this.state.isBusy, className: 'msp-no-hover-outline' });\n        var title = \"Segment \".concat(customState.superpositionState.activeSegment, \" Cluster \").concat(this.props.clusterIndex + 1);\n        var label = (0, jsx_runtime_1.jsxs)(common_1.Button, tslib_1.__assign({ className: \"msp-btn-tree-label\", noOverflow: true, title: title, disabled: this.state.isBusy }, { children: [(0, jsx_runtime_1.jsxs)(\"span\", { children: [\"Cluster \", this.props.clusterIndex + 1] }), \" \", (0, jsx_runtime_1.jsxs)(\"small\", { children: [this.state.cluster.length < this.props.cluster.length ? \"\".concat(this.state.cluster.length, \" / \") : '', this.props.cluster.length, \" chain\", this.props.cluster.length > 1 ? 's' : ''] })] }));\n        var selectionControls = (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CheckSvg, flex: true, onClick: this.selectAll, style: { flex: '0 0 50px', textAlign: 'center', fontSize: '80%', color: '#9cacc3', padding: 0 }, disabled: this.state.isBusy, title: \"Show all chains\" }, { children: \"All\" })), (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CloseSvg, flex: true, onClick: this.selectNone, style: { flex: '0 0 50px', textAlign: 'center', fontSize: '80%', color: '#9cacc3', padding: 0 }, disabled: this.state.isBusy, title: \"Hide all chains\" }, { children: \"None\" }))] });\n        var mainRow = (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: \"msp-flex-row msp-tree-row\", style: { marginTop: '10px' } }, { children: [expand, label, this.props.cluster.length > 1 && selectionControls] }));\n        var searchControls = (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-mapped-parameter-group', style: { fontSize: '90%' } }, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-control-row msp-transform-header-brand-gray', style: { height: '33px', marginLeft: '30px' } }, { children: [(0, jsx_runtime_1.jsx)(\"span\", tslib_1.__assign({ className: 'msp-control-row-label' }, { children: \"Search PDB ID\" })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-row-ctrl' }, { children: (0, jsx_runtime_1.jsx)(\"input\", { type: 'text', placeholder: 'Enter PDB ID..', disabled: this.state.isBusy, onChange: function (e) { return _this.inputStream.next(e.target.value); }, value: this.state.searchText, maxLength: 4 }) }))] })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: icons_1.CloseSvg, flex: true, onClick: this.clearSearch, style: { flex: '0 0 24px', padding: 0 }, disabled: this.state.isBusy || this.state.searchText === '', toggleState: this.state.searchText !== '', title: 'Clear search input' })] }));\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [mainRow, (this.state.showAll || this.state.showNone) && (0, jsx_runtime_1.jsx)(\"div\", { children: (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: \"msp-control-row msp-transform-header-brand-\".concat(this.state.showAll ? 'green' : 'red'), style: { display: 'flex', marginLeft: '20px', height: '35px' } }, { children: [(0, jsx_runtime_1.jsxs)(\"span\", tslib_1.__assign({ className: 'msp-control-row-label', style: { flex: '1 1 auto', textAlign: 'left', fontSize: '85%' } }, { children: [this.state.showAll ? 'Display' : 'Hide', \" \", this.state.cluster.length < this.props.cluster.length ? \"\".concat(this.state.cluster.length, \" / \") : 'all ', this.props.cluster.length, \" chains\"] })), (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CheckSvg, flex: true, onClick: this.applyAction, style: { flex: '0 0 60px', textAlign: 'center', fontSize: '78%', color: '#9cacc3', padding: 0, margin: '0 1px' }, title: \"Apply action\" }, { children: \"Apply\" })), (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CloseSvg, flex: true, onClick: this.cancelAction, style: { flex: '0 0 60px', textAlign: 'center', fontSize: '78%', color: '#9cacc3', padding: 0, margin: '0 1px' }, title: \"Cancel action\" }, { children: \"Cancel\" }))] })) }), (!this.state.isCollapsed && this.props.cluster.length > 5) && searchControls, !this.state.isCollapsed && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-tree-updates-wrapper', style: { maxHeight: (this.props.totalClusters > 1) ? '330px' : '87%', overflowY: 'auto' } }, { children: this.state.cluster.map(function (s, i) { return (0, jsx_runtime_1.jsx)(StructureNode, { segmentIndex: _this.props.segmentIndex, structure: s, isRep: i === 0 ? true : false }, \"str-\".concat(s.pdb_id).concat(s.struct_asym_id).concat(i)); }) }))] });\n    };\n    return ClusterNode;\n}(base_1.PluginUIComponent));\nvar StructureNode = /** @class */ (function (_super) {\n    tslib_1.__extends(StructureNode, _super);\n    function StructureNode() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            showControls: false,\n            isBusy: false,\n            isProcessing: false,\n            isHidden: true,\n        };\n        _this.toggleVisible = function (e) { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var structHierarchy, _i, _a, c, currentHiddenState;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        e.preventDefault();\n                        e.currentTarget.blur();\n                        this.setState({ isProcessing: true, showControls: false });\n                        if (!this.ref) return [3 /*break*/, 1];\n                        structHierarchy = this.plugin.managers.structure.hierarchy.current.refs.get(this.ref);\n                        if (structHierarchy && structHierarchy.components) {\n                            for (_i = 0, _a = structHierarchy.components; _i < _a.length; _i++) {\n                                c = _a[_i];\n                                currentHiddenState = c.cell.state.isHidden ? true : false;\n                                if (currentHiddenState === this.state.isHidden) {\n                                    commands_1.PluginCommands.State.ToggleVisibility(this.plugin, { state: c.cell.parent, ref: c.cell.transform.ref });\n                                }\n                            }\n                            this.setState({ isHidden: !this.state.isHidden });\n                        }\n                        return [3 /*break*/, 3];\n                    case 1: return [4 /*yield*/, (0, superposition_1.renderSuperposition)(this.plugin, this.props.segmentIndex, [this.props.structure])];\n                    case 2:\n                        _b.sent();\n                        _b.label = 3;\n                    case 3:\n                        this.setState({ isProcessing: false });\n                        commands_1.PluginCommands.Camera.Reset(this.plugin);\n                        return [2 /*return*/];\n                }\n            });\n        }); };\n        _this.selectAction = function (item) {\n            if (!item)\n                return;\n            _this.setState({ showControls: false });\n            (item === null || item === void 0 ? void 0 : item.value)();\n        };\n        _this.highlight = function (e) {\n            e.preventDefault();\n            if (_this.ref) {\n                var cell = _this.plugin.state.data.cells.get(_this.ref);\n                commands_1.PluginCommands.Interactivity.Object.Highlight(_this.plugin, { state: cell.parent, ref: _this.ref });\n            }\n            e.currentTarget.blur();\n        };\n        _this.clearHighlight = function (e) {\n            e.preventDefault();\n            commands_1.PluginCommands.Interactivity.ClearHighlights(_this.plugin);\n            e.currentTarget.blur();\n        };\n        _this.toggleControls = function (e) {\n            e.preventDefault();\n            _this.setState({ showControls: !_this.state.showControls });\n            e.currentTarget.blur();\n        };\n        return _this;\n    }\n    Object.defineProperty(StructureNode.prototype, \"customState\", {\n        get: function () {\n            return this.plugin.customState;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StructureNode.prototype, \"ref\", {\n        get: function () {\n            if (this.customState && this.customState.superpositionState && this.customState.superpositionState.models[\"\".concat(this.props.structure.pdb_id, \"_\").concat(this.props.structure.struct_asym_id)]) {\n                return this.customState.superpositionState.models[\"\".concat(this.props.structure.pdb_id, \"_\").concat(this.props.structure.struct_asym_id)];\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StructureNode.prototype, \"modelCell\", {\n        get: function () {\n            if (this.ref) {\n                return this.plugin.state.data.cells.get(this.ref);\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(StructureNode.prototype, \"isAllHidden\", {\n        get: function () {\n            var isHidden = true;\n            if (this.ref) {\n                var structHierarchy = this.plugin.managers.structure.hierarchy.current.refs.get(this.ref);\n                if (structHierarchy && structHierarchy.components) {\n                    for (var _i = 0, _a = structHierarchy.components; _i < _a.length; _i++) {\n                        var c = _a[_i];\n                        if (c && c.cell && !c.cell.state.isHidden) {\n                            isHidden = false;\n                            break;\n                        }\n                    }\n                }\n                else {\n                    isHidden = false;\n                }\n            }\n            return isHidden;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    StructureNode.prototype.checkRelation = function (ref) {\n        var isRelated = false;\n        var cell = this.plugin.state.data.cells.get(ref);\n        if (cell && cell.transform.parent) {\n            if (cell && cell.transform.parent === this.ref) {\n                isRelated = true;\n            }\n            else {\n                var pcell = this.plugin.state.data.cells.get(cell.transform.parent);\n                if (pcell && pcell.transform.parent === this.ref)\n                    isRelated = true;\n            }\n        }\n        else {\n            var currentNodeCell = this.plugin.state.data.cells.get(this.ref);\n            if (currentNodeCell && currentNodeCell.transform.parent === cell.transform.parent) {\n                isRelated = true;\n            }\n        }\n        return isRelated;\n    };\n    StructureNode.prototype.is = function (e) {\n        if (!this.ref)\n            return false;\n        var isRelated = false;\n        if (this.ref && e.ref !== this.ref) {\n            isRelated = this.checkRelation(e.ref);\n        }\n        if (e.ref === this.ref || isRelated) {\n            return true;\n        }\n        else {\n            var invalidStruct = (this.customState.superpositionState.invalidStruct.indexOf(\"\".concat(this.props.structure.pdb_id, \"_\").concat(this.props.structure.struct_asym_id)) > -1) ? true : false;\n            return invalidStruct ? true : false;\n        }\n    };\n    StructureNode.prototype.componentDidMount = function () {\n        var _this = this;\n        this.setState({ isHidden: this.isAllHidden });\n        this.subscribe(this.plugin.customState.events.isBusy, function (e) {\n            _this.setState({ isBusy: e, showControls: false });\n        });\n        this.subscribe(this.plugin.state.events.cell.stateUpdated.pipe((0, operators_1.filter)(function (e) { return _this.is(e); }), (0, operators_1.debounceTime)(33)), function (e) {\n            _this.setState({ isHidden: _this.isAllHidden });\n            // this.forceUpdate();\n        });\n    };\n    StructureNode.prototype.getTagRefs = function (tags) {\n        var TagSet = new Set(tags);\n        var tree = this.plugin.state.data.tree;\n        return mol_state_2.StateSelection.findUniqueTagsInSubtree(tree, this.modelCell.transform.ref, TagSet);\n    };\n    StructureNode.prototype.getRandomColor = function () {\n        var clList = lists_1.ColorLists;\n        var spState = this.plugin.customState.superpositionState;\n        var palleteIndex = spState.colorState[this.props.segmentIndex].palleteIndex;\n        var colorIndex = spState.colorState[this.props.segmentIndex].colorIndex;\n        if (clList[spState.colorPalette[palleteIndex]].list[colorIndex + 1]) {\n            colorIndex += 1;\n        }\n        else {\n            colorIndex = 0;\n            palleteIndex = spState.colorPalette[palleteIndex + 1] ? palleteIndex + 1 : 0;\n        }\n        var palleteName = spState.colorPalette[palleteIndex];\n        this.plugin.customState.superpositionState.colorState[this.props.segmentIndex].palleteIndex = palleteIndex;\n        this.plugin.customState.superpositionState.colorState[this.props.segmentIndex].colorIndex = colorIndex;\n        return clList[palleteName].list[colorIndex];\n    };\n    StructureNode.prototype.addChainRepr = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var uniformColor1, strInstance, query, chainSel;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        uniformColor1 = this.getRandomColor();\n                        strInstance = this.plugin.state.data.select(this.ref)[0];\n                        query = builder_1.MolScriptBuilder.struct.generator.atomGroups({\n                            'chain-test': builder_1.MolScriptBuilder.core.rel.eq([builder_1.MolScriptBuilder.struct.atomProperty.macromolecular.label_asym_id(), this.props.structure.struct_asym_id])\n                        });\n                        return [4 /*yield*/, this.plugin.builders.structure.tryCreateComponentFromExpression(strInstance, query, \"Chain-\".concat(this.props.segmentIndex), { label: \"Chain\", tags: [\"superposition-sel\"] })];\n                    case 1:\n                        chainSel = _a.sent();\n                        if (!chainSel) return [3 /*break*/, 3];\n                        return [4 /*yield*/, this.plugin.builders.structure.representation.addRepresentation(chainSel, { type: 'cartoon', color: 'uniform', colorParams: { value: uniformColor1 } }, { tag: \"superposition-visual\" })];\n                    case 2:\n                        _a.sent();\n                        _a.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    StructureNode.prototype.updates = function () {\n        var _this = this;\n        var structHierarchy = this.plugin.managers.structure.hierarchy.current.refs.get(this.ref);\n        if (structHierarchy && structHierarchy.components) {\n            var representations_1 = [];\n            var showAddChainBtn_1 = true;\n            structHierarchy.components.forEach(function (comps) {\n                var gKeys = comps.key.split(',');\n                var cId1Arr = gKeys[0].split('-');\n                if (cId1Arr[2] === 'Chain')\n                    showAddChainBtn_1 = false;\n                if (comps.representations) {\n                    comps.representations.forEach(function (repr) {\n                        representations_1.push(repr);\n                    });\n                }\n            });\n            var customState = this.plugin.customState;\n            if (customState.initParams && customState.initParams.superpositionParams && !customState.initParams.superpositionParams.ligandView) {\n                showAddChainBtn_1 = false;\n            }\n            if (representations_1.length > 0) {\n                return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-accent-offset', style: { marginLeft: '40px' } }, { children: [representations_1.length > 0 && representations_1.map(function (r, i) { return (0, jsx_runtime_1.jsx)(StructureRepresentationEntry, { group: [structHierarchy], representation: r }, \"\".concat(r.cell.transform.ref, \"-\").concat(i)); }), showAddChainBtn_1 && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-group-header', style: { marginTop: '1px' } }, { children: (0, jsx_runtime_1.jsxs)(common_1.Button, tslib_1.__assign({ noOverflow: true, className: 'msp-control-button-label', title: \"Click to add chain representaion\", onClick: function () { return _this.addChainRepr(); } }, { children: [\"\\u00A0\\u00A0Add Chain \", this.props.structure.struct_asym_id, \" Representation\"] })) }))] }));\n            }\n        }\n        return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, {});\n    };\n    StructureNode.prototype.getSubtitle = function () {\n        var customState = this.plugin.customState;\n        var hetList = customState.superpositionState.hets[\"\".concat(this.props.structure.pdb_id, \"_\").concat(this.props.structure.struct_asym_id)];\n        var subtitle;\n        if (hetList) {\n            var hetLimit = this.props.structure.is_representative ? 1 : 4;\n            var totalHets = hetList.length;\n            var hetStr = hetList.join(', ');\n            if (totalHets > hetLimit) {\n                hetStr = hetList.slice(0, hetLimit).join(', ');\n                hetStr += \" + \".concat(totalHets - hetLimit);\n            }\n            subtitle = \" ( \".concat(hetStr, \" )\");\n            if (this.props.structure.is_representative)\n                subtitle = \" \".concat(subtitle, \" ( Representative )\");\n        }\n        else if (this.props.structure.is_representative) {\n            subtitle = ' ( Representative )';\n        }\n        return subtitle;\n    };\n    Object.defineProperty(StructureNode.prototype, \"panelColor\", {\n        get: function () {\n            var panelColor = '#808080';\n            if (!this.state.isHidden) {\n                if (this.modelCell) {\n                    var refs = this.getTagRefs([\"superposition-visual\", \"superposition-ligand-visual\"]);\n                    var visualRef = refs[\"superposition-ligand-visual\"] ? refs[\"superposition-ligand-visual\"] : refs[\"superposition-visual\"] ? refs[\"superposition-visual\"] : undefined;\n                    if (visualRef) {\n                        var visualCell = this.plugin.state.data.cells.get(visualRef);\n                        if (visualCell.params && visualCell.params.values && visualCell.params.values.colorTheme) {\n                            var colorTheme = visualCell.params.values.colorTheme;\n                            if (colorTheme.params && colorTheme.params.value) {\n                                panelColor = \"\".concat(color_1.Color.toStyle(colorTheme.params.value));\n                            }\n                            else if (colorTheme.params && colorTheme.params.palette) {\n                                var colorList1 = colorTheme.params.palette.params.list.colors;\n                                panelColor = \"\".concat(color_1.Color.toStyle(colorList1[0]));\n                            }\n                            else if (colorTheme.params && colorTheme.params.list) {\n                                var colorList2 = colorTheme.params.list.colors;\n                                panelColor = \"\".concat(color_1.Color.toStyle(colorList2[0]));\n                            }\n                        }\n                    }\n                }\n            }\n            return panelColor;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    StructureNode.prototype.render = function () {\n        var superpositionParams = this.customState.initParams.superpositionParams;\n        var strutStateId = \"\".concat(this.props.structure.pdb_id, \"_\").concat(this.props.structure.struct_asym_id);\n        var invalidStruct = (this.customState.superpositionState.invalidStruct.indexOf(strutStateId) > -1) ? true : false;\n        var noMatrixStruct = (this.customState.superpositionState.noMatrixStruct.indexOf(strutStateId) > -1) ? true : false;\n        var subTitle = invalidStruct ? noMatrixStruct ? \" Matrix not available!\" : \" No Ligand found!\" : this.getSubtitle();\n        var strTitle = \"\".concat(this.props.structure.pdb_id, \" chain \").concat(this.props.structure.auth_asym_id);\n        if (superpositionParams && superpositionParams.ligandView) {\n            strTitle = \"\".concat(this.props.structure.pdb_id, \" \").concat(this.props.structure.struct_asym_id);\n        }\n        var label = (0, jsx_runtime_1.jsxs)(common_1.Button, tslib_1.__assign({ className: \"msp-btn-tree-label\", style: { borderLeftColor: this.panelColor }, noOverflow: true, title: strTitle, disabled: (invalidStruct || this.state.isBusy || this.state.isProcessing) ? true : false, onMouseEnter: this.highlight, onMouseLeave: this.clearHighlight }, { children: [(0, jsx_runtime_1.jsx)(\"span\", { children: strTitle }), subTitle && (0, jsx_runtime_1.jsx)(\"small\", { children: subTitle })] }));\n        var expand = (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: !this.state.showControls ? icons_1.ArrowRightSvg : icons_1.ArrowDropDownSvg, flex: '20px', onClick: this.toggleControls, transparent: true, className: 'msp-no-hover-outline', disabled: (invalidStruct || this.state.isBusy || this.state.isProcessing) ? true : false });\n        var visibility = (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: this.state.isHidden ? icons_1.VisibilityOffOutlinedSvg : icons_1.VisibilityOutlinedSvg, toggleState: false, small: true, onClick: this.toggleVisible, disabled: (invalidStruct || this.state.isBusy || this.state.isProcessing) ? true : false, title: this.state.isHidden ? \"Show chain\" : \"Hide chain\" });\n        var row = (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: \"msp-flex-row msp-tree-row\", style: { marginLeft: !this.state.isHidden ? '10px' : '31px' } }, { children: [!this.state.isHidden && expand, label, visibility] }));\n        return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ style: { marginBottom: '1px' } }, { children: [row, this.state.showControls && this.updates()] }));\n    };\n    return StructureNode;\n}(base_1.PluginUIComponent));\nvar StructureRepresentationEntry = /** @class */ (function (_super) {\n    tslib_1.__extends(StructureRepresentationEntry, _super);\n    function StructureRepresentationEntry() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.toggleVisible = function (e) {\n            e.preventDefault();\n            e.currentTarget.blur();\n            var cell = _this.props.representation.cell;\n            commands_1.PluginCommands.State.ToggleVisibility(_this.plugin, { state: cell.parent, ref: cell.transform.parent });\n        };\n        return _this;\n    }\n    StructureRepresentationEntry.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.state.events.cell.stateUpdated, function (e) {\n            if (mol_state_1.State.ObjectEvent.isCell(e, _this.props.representation.cell))\n                _this.forceUpdate();\n        });\n    };\n    StructureRepresentationEntry.prototype.render = function () {\n        var _a, _b, _c, _d, _e, _f, _g;\n        var repr = this.props.representation.cell;\n        var label = (_a = repr.obj) === null || _a === void 0 ? void 0 : _a.label;\n        if (((_b = repr.obj) === null || _b === void 0 ? void 0 : _b.data.repr) && ((_c = repr.obj) === null || _c === void 0 ? void 0 : _c.data.repr.label)) {\n            var sourceLabel = (((_d = repr.obj) === null || _d === void 0 ? void 0 : _d.data.repr.label.indexOf('[Focus]')) >= 0) ? '[Focus]' : (_e = repr.obj) === null || _e === void 0 ? void 0 : _e.data.repr.label;\n            var isLargeLabel = sourceLabel.length > 10 ? true : false;\n            sourceLabel = \"\".concat(isLargeLabel ? \"\".concat(sourceLabel.substring(0, 28), \"...\") : sourceLabel);\n            if (isLargeLabel) {\n                label = sourceLabel;\n            }\n            else {\n                label = \"\".concat(sourceLabel, \" \").concat((label && label.length < 21) ? ' - ' + label : '');\n            }\n        }\n        if (((_f = repr.obj) === null || _f === void 0 ? void 0 : _f.data.repr) && ((_g = repr.obj) === null || _g === void 0 ? void 0 : _g.data.repr.label) === 'Custom Selection')\n            label = 'Custom Selection';\n        return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: [repr.parent && (0, jsx_runtime_1.jsx)(common_1.ExpandGroup, tslib_1.__assign({ header: \"\".concat(label || 'Representation'), noOffset: true, headerStyle: { overflow: 'hidden' } }, { children: (0, jsx_runtime_1.jsx)(update_transform_1.UpdateTransformControl, { state: repr.parent, transform: repr.transform, customHeader: 'none', noMargin: true }) })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: this.props.representation.cell.state.isHidden ? icons_1.VisibilityOffOutlinedSvg : icons_1.VisibilityOutlinedSvg, toggleState: false, onClick: this.toggleVisible, title: this.props.representation.cell.state.isHidden ? \"Show representation\" : \"Hide representation\", small: true, className: 'msp-default-bg', style: { position: 'absolute', top: 0, right: 0, lineHeight: '24px', height: '24px', textAlign: 'right', width: '32px', paddingRight: '6px', background: 'none' } })] }));\n    };\n    return StructureRepresentationEntry;\n}(base_1.PurePluginUIComponent));\n//# sourceMappingURL=segment-tree.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdGQUFnRiwwQ0FBMEMsa0NBQWtDLGdNQUFnTSxJQUFJLDRDQUE0QyxvQkFBb0IsaURBQWlELG9CQUFvQixJQUFJO0FBQ3plLG1FQUFtRSw4UUFBOFE7QUFDalYsdUVBQXVFLCtTQUErUztBQUN0WCxvRUFBb0UsaURBQWlELHNEQUFzRCxJQUFJLCtEQUErRDtBQUM5TyxpRUFBaUUsU0FBUyx1QkFBdUIsSUFBSSw0REFBNEQ7QUFDaks7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLGdEQUFnRDtBQUM3SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSx1Q0FBdUMsSUFBSSwwRkFBMEYsNkVBQTZFLHNCQUFzQixJQUFJLDhFQUE4RSxxRkFBcUYsR0FBRyxrREFBa0QsaVVBQWlVLDBKQUEwSixJQUFJO0FBQ3ArQjtBQUNBO0FBQ0EsQ0FBQztBQUNEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3VpL3NlZ21lbnQtdHJlZS5qcz81MWZjIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5TZWdtZW50VHJlZSA9IHZvaWQgMDtcbnZhciB0c2xpYl8xID0gcmVxdWlyZShcInRzbGliXCIpO1xudmFyIGpzeF9ydW50aW1lXzEgPSByZXF1aXJlKFwicmVhY3QvanN4LXJ1bnRpbWVcIik7XG52YXIgb3BlcmF0b3JzXzEgPSByZXF1aXJlKFwicnhqcy9vcGVyYXRvcnNcIik7XG52YXIgY29tbWFuZHNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4vY29tbWFuZHNcIik7XG52YXIgbW9sX3N0YXRlXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtc3RhdGVcIik7XG52YXIgYmFzZV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9iYXNlXCIpO1xudmFyIGNvbW1vbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9jb250cm9scy9jb21tb25cIik7XG52YXIgcGFyYW1fZGVmaW5pdGlvbl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvcGFyYW0tZGVmaW5pdGlvblwiKTtcbnZhciBwYXJhbWV0ZXJzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL3BhcmFtZXRlcnNcIik7XG52YXIgbW9sX3N0YXRlXzIgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtc3RhdGVcIik7XG52YXIgc3VwZXJwb3NpdGlvbl8xID0gcmVxdWlyZShcIi4uL3N1cGVycG9zaXRpb25cIik7XG52YXIgdXBkYXRlX3RyYW5zZm9ybV8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9zdGF0ZS91cGRhdGUtdHJhbnNmb3JtXCIpO1xudmFyIGljb25zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2ljb25zXCIpO1xudmFyIGxpc3RzXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9jb2xvci9saXN0c1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXV0aWwvY29sb3JcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXNjcmlwdC9sYW5ndWFnZS9idWlsZGVyXCIpO1xudmFyIHJ4anNfMSA9IHJlcXVpcmUoXCJyeGpzXCIpO1xudmFyIHRyYW5zZm9ybXNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tc3RhdGUvdHJhbnNmb3Jtc1wiKTtcbnZhciBzdXBlcnBvc2l0aW9uXzIgPSByZXF1aXJlKFwiLi4vc3VwZXJwb3NpdGlvblwiKTtcbnZhciBTdXBlcnBvc2l0aW9uVGFnID0gJ1N1cGVycG9zaXRpb25UcmFuc2Zvcm0nO1xudmFyIFNlZ21lbnRUcmVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFNlZ21lbnRUcmVlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlZ21lbnRUcmVlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZ2V0U2VnbWVudFBhcmFtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXN0b21TdGF0ZSA9IF90aGlzLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgaWYgKCFjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUgfHwgIWN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB2YXIgc2VnbWVudERhdGEgPSBjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuc2VnbWVudERhdGE7XG4gICAgICAgICAgICB2YXIgc2VnbWVudEFyciA9IHNlZ21lbnREYXRhLm1hcChmdW5jdGlvbiAoc2VnbWVudCwgaSkge1xuICAgICAgICAgICAgICAgIHZhciBzZWdtZW50TGFiZWwgPSBcIlwiLmNvbmNhdChpICsgMSwgXCIgKCBcIikuY29uY2F0KHNlZ21lbnQuc2VnbWVudF9zdGFydCwgXCIgLSBcIikuY29uY2F0KHNlZ21lbnQuc2VnbWVudF9lbmQsIFwiIClcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtzZWdtZW50TGFiZWwsIHNlZ21lbnRMYWJlbF07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBzZWdtZW50T3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBzZWdtZW50OiBwYXJhbV9kZWZpbml0aW9uXzEuUGFyYW1EZWZpbml0aW9uLlNlbGVjdCgnJywgc2VnbWVudEFyciwgeyBsYWJlbDogJ1NlbGVjdCBTZWdtZW50JywgZGVzY3JpcHRpb246ICdTZWxlY3Qgc2VnbWVudCB0byB2aWV3IGl0cyBjbHVzdGVycyBiZWxvdycgfSlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2VnbWVudEluZGV4ID0gY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmFjdGl2ZVNlZ21lbnQgLSAxO1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWdtZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtczogc2VnbWVudE9wdGlvbnMsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7IHNlZ21lbnQ6IHNlZ21lbnRBcnJbc2VnbWVudEluZGV4XVswXSB9XG4gICAgICAgICAgICAgICAgfSB9KTtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgaXNCdXN5OiBmYWxzZSB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMudXBkYXRlU2VnbWVudCA9IGZ1bmN0aW9uICh2YWwpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1c3RvbVN0YXRlLCB1cGRhdGVkUGFyYW1zO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5zZWdtZW50KVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUgPSB0aGlzLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3kubmV4dCh0cnVlKTtcbiAgICAgICAgICAgICAgICAvLyBIaWRlIHBlcnZpb3VzIHNlZ2VtZW50IHN0cnVjdHVyZXNcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVTdHJ1Y3R1cmVzKGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5hY3RpdmVTZWdtZW50IC0gMSk7XG4gICAgICAgICAgICAgICAgdXBkYXRlZFBhcmFtcyA9IHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuc3RhdGUuc2VnbWVudCk7XG4gICAgICAgICAgICAgICAgdXBkYXRlZFBhcmFtcy52YWx1ZSA9IHZhbDtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2VnbWVudDogdXBkYXRlZFBhcmFtcyB9KTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZFNlZ21lbnRJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkU2VnbWVudEluZGV4ID0gcGFyc2VJbnQodmFsLnNlZ21lbnQuc3BsaXQoJyAnKVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5hY3RpdmVTZWdtZW50ID0gdXBkYXRlZFNlZ21lbnRJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSBjdXJyZW50IHNlZ21lbnQgdmlzaWJsZSBzdHJ1Y3R1cmVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZGlzcGxheVN0cnVjdHVyZXMoY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmFjdGl2ZVNlZ21lbnQgLSAxKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEaXNwbGF5IGN1cnJlbnQgc2VnbWVudCB2aXNpYmxlIHN0cnVjdHVyZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZS5ldmVudHMuaXNCdXN5Lm5leHQoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5ldmVudHMuc2VnbWVudFVwZGF0ZS5uZXh0KHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pOyB9LCAxMDApO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBmYWxzZV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IH07XG4gICAgICAgIF90aGlzLmhpZGVTdHJ1Y3R1cmVzID0gZnVuY3Rpb24gKHNlZ21lbnRJbmRleCkge1xuICAgICAgICAgICAgLy8gY2xlYXIgc2VsZWN0aW9uc1xuICAgICAgICAgICAgX3RoaXMucGx1Z2luLm1hbmFnZXJzLmludGVyYWN0aXZpdHkubG9jaVNlbGVjdHMuZGVzZWxlY3RBbGwoKTtcbiAgICAgICAgICAgIC8vIGNsZWFyIEZvY3VzXG4gICAgICAgICAgICBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmZvY3VzLmNsZWFyKCk7XG4gICAgICAgICAgICAvLyByZW1vdmUgbWVhc3VyZW1lbnRzXG4gICAgICAgICAgICB2YXIgbWVhc3VyZW1lbnRzID0gX3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5tZWFzdXJlbWVudC5zdGF0ZTtcbiAgICAgICAgICAgIHZhciBtZWFzdXJlVHlwZXMgPSBbJ2xhYmVscycsICdkaXN0YW5jZXMnLCAnYW5nbGVzJywgJ2RpaGVkcmFscyddO1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVtZW50Q2VsbCA9IHZvaWQgMDtcbiAgICAgICAgICAgIG1lYXN1cmVUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1lYXN1cmVtZW50Q2VsbClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChtZWFzdXJlbWVudHNbdHlwZV1bMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgbWVhc3VyZW1lbnRDZWxsID0gX3RoaXMucGx1Z2luLnN0YXRlLmRhdGEuY2VsbHMuZ2V0KG1lYXN1cmVtZW50c1t0eXBlXVswXS50cmFuc2Zvcm0ucGFyZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChtZWFzdXJlbWVudENlbGwpIHtcbiAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlJlbW92ZU9iamVjdChfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IG1lYXN1cmVtZW50Q2VsbC5wYXJlbnQsIHJlZjogbWVhc3VyZW1lbnRDZWxsLnRyYW5zZm9ybS5wYXJlbnQsIHJlbW92ZVBhcmVudEdob3N0czogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGhpZGUgc3RydWN0dXJlc1xuICAgICAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gX3RoaXMuY3VzdG9tU3RhdGU7XG4gICAgICAgICAgICBjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUudmlzaWJsZVJlZnNbc2VnbWVudEluZGV4XSA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5sb2FkZWRTdHJ1Y3RzW3NlZ21lbnRJbmRleF07IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0cnVjdCA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICB2YXIgc3RydWN0UmVmID0gX3RoaXMuY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLm1vZGVsc1tzdHJ1Y3RdO1xuICAgICAgICAgICAgICAgIGlmIChzdHJ1Y3RSZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cnVjdEhpZXJhcmNoeSA9IF90aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQucmVmcy5nZXQoc3RydWN0UmVmKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cnVjdEhpZXJhcmNoeSAmJiBzdHJ1Y3RIaWVyYXJjaHkuY29tcG9uZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBfYyA9IHN0cnVjdEhpZXJhcmNoeS5jb21wb25lbnRzOyBfYiA8IF9jLmxlbmd0aDsgX2IrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gX2NbX2JdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjICYmIGMuY2VsbCAmJiAhYy5jZWxsLnN0YXRlLmlzSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS52aXNpYmxlUmVmc1tzZWdtZW50SW5kZXhdLnB1c2goYy5jZWxsLnRyYW5zZm9ybS5yZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlRvZ2dsZVZpc2liaWxpdHkoX3RoaXMucGx1Z2luLCB7IHN0YXRlOiBjLmNlbGwucGFyZW50LCByZWY6IGMuY2VsbC50cmFuc2Zvcm0ucmVmIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuYWxwaGFmb2xkLnJlZikge1xuICAgICAgICAgICAgICAgIHZhciBhZlN0ciA9IF90aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQucmVmcy5nZXQoY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmFscGhhZm9sZC5yZWYpO1xuICAgICAgICAgICAgICAgIGlmIChhZlN0ciAmJiBhZlN0ci5jb21wb25lbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9kID0gMCwgX2UgPSBhZlN0ci5jb21wb25lbnRzOyBfZCA8IF9lLmxlbmd0aDsgX2QrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBfZVtfZF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyAmJiBjLmNlbGwgJiYgIWMuY2VsbC5zdGF0ZS5pc0hpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuVG9nZ2xlVmlzaWJpbGl0eShfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IGMuY2VsbC5wYXJlbnQsIHJlZjogYy5jZWxsLnRyYW5zZm9ybS5yZWYgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmRpc3BsYXlTdHJ1Y3R1cmVzID0gZnVuY3Rpb24gKHNlZ21lbnRJbmRleCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VzdG9tU3RhdGUsIHNwU3RhdGUsIGxvYWRTdHJzXzEsIF9pLCBfYSwgcmVmLCBjZWxsLCBhZlN0ciwgX2IsIF9jLCBjO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZCkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2QubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUgPSB0aGlzLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BTdGF0ZSA9IGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS52aXNpYmxlUmVmc1tzZWdtZW50SW5kZXhdLmxlbmd0aCA9PT0gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFN0cnNfMSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLnNlZ21lbnREYXRhW3NlZ21lbnRJbmRleF0uY2x1c3RlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2x1c3Rlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRyeUxpc3QgPSBbY2x1c3RlclswXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1c3RvbVN0YXRlLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvblBhcmFtcyAmJiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnN1cGVycG9zaXRpb25QYXJhbXMuc3VwZXJwb3NlQWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5TGlzdCA9IGNsdXN0ZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cnVjdFN0YXRlSWQgPSBcIlwiLmNvbmNhdChzdHIucGRiX2lkLCBcIl9cIikuY29uY2F0KHN0ci5zdHJ1Y3RfYXN5bV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHJ1Y3RSZWYgPSBjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUubW9kZWxzW3N0cnVjdFN0YXRlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RydWN0UmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IF90aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLmNlbGxzLmdldChzdHJ1Y3RSZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzSGlkZGVuID0gY2VsbC5zdGF0ZS5pc0hpZGRlbiA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0hpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuVG9nZ2xlVmlzaWJpbGl0eShfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IGNlbGwucGFyZW50LCByZWY6IHN0cnVjdFJlZiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQbHVnaW5Db21tYW5kcy5TdGF0ZS5Ub2dnbGVWaXNpYmlsaXR5KHRoaXMucGx1Z2luLCB7IHN0YXRlOiBjZWxsLnBhcmVudCEsIHJlZjogY2VsbC50cmFuc2Zvcm0ucGFyZW50IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFN0cnNfMS5wdXNoKHN0cik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5DYW1lcmEuUmVzZXQodGhpcy5wbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobG9hZFN0cnNfMS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCAoMCwgc3VwZXJwb3NpdGlvbl8xLnJlbmRlclN1cGVycG9zaXRpb24pKHRoaXMucGx1Z2luLCBzZWdtZW50SW5kZXgsIGxvYWRTdHJzXzEpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Quc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5DYW1lcmEuUmVzZXQodGhpcy5wbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2QubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgX2EgPSBjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUudmlzaWJsZVJlZnNbc2VnbWVudEluZGV4XTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCA9IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEuY2VsbHMuZ2V0KHJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGwgJiYgY2VsbC5zdGF0ZS5pc0hpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlRvZ2dsZVZpc2liaWxpdHkodGhpcy5wbHVnaW4sIHsgc3RhdGU6IGNlbGwucGFyZW50LCByZWY6IHJlZiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkNhbWVyYS5SZXNldCh0aGlzLnBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZC5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcFN0YXRlLmFscGhhZm9sZC5yZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoMCwgc3VwZXJwb3NpdGlvbl8yLnN1cGVycG9zZUFmKSh0aGlzLnBsdWdpbiwgc3BTdGF0ZS5hbHBoYWZvbGQudHJhY2VPbmx5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkNhbWVyYS5SZXNldCh0aGlzLnBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3BTdGF0ZS5hbHBoYWZvbGQucmVmICYmIHNwU3RhdGUuYWxwaGFmb2xkLnZpc2liaWxpdHlbc2VnbWVudEluZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmU3RyID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnJlZnMuZ2V0KGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5hbHBoYWZvbGQucmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWZTdHIgJiYgYWZTdHIuY29tcG9uZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9iID0gMCwgX2MgPSBhZlN0ci5jb21wb25lbnRzOyBfYiA8IF9jLmxlbmd0aDsgX2IrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IF9jW19iXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjICYmIGMuY2VsbCAmJiBjLmNlbGwuc3RhdGUuaXNIaWRkZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlRvZ2dsZVZpc2liaWxpdHkodGhpcy5wbHVnaW4sIHsgc3RhdGU6IGMuY2VsbC5wYXJlbnQsIHJlZjogYy5jZWxsLnRyYW5zZm9ybS5yZWYgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNlZ21lbnRUcmVlLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uY3VzdG9tU3RhdGUuZXZlbnRzLnN1cGVycG9zaXRpb25Jbml0LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VzdG9tU3RhdGUgPSBfdGhpcy5jdXN0b21TdGF0ZTtcbiAgICAgICAgICAgIGlmIChjdXN0b21TdGF0ZSAmJiAhY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuZ2V0U2VnbWVudFBhcmFtcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3ksIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzQnVzeTogZSB9KTtcbiAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgY29tbWFuZHNfMS5QbHVnaW5Db21tYW5kcy5Ub2FzdC5TaG93KF90aGlzLnBsdWdpbiwge1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1Byb2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnTG9hZGluZyAvIGNvbXB1dGluZyBsYXJnZSBkYXRhc2V0IScsXG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2lzLWJ1c3ktdG9hc3QnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlRvYXN0LkhpZGUoX3RoaXMucGx1Z2luLCB7IGtleTogJ2lzLWJ1c3ktdG9hc3QnIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uYmVoYXZpb3JzLmxheW91dC5sZWZ0UGFuZWxUYWJOYW1lLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKGUgIT09ICdzZWdtZW50cycpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgX3RoaXMuZ2V0U2VnbWVudFBhcmFtcygpO1xuICAgICAgICAgICAgX3RoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VnbWVudFRyZWUucHJvdG90eXBlLCBcImN1c3RvbVN0YXRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTZWdtZW50VHJlZS5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24gKHMsIG1hdHJpeCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByLCBvLCBwYXJhbXMsIGI7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBtb2xfc3RhdGVfMi5TdGF0ZU9iamVjdFJlZi5yZXNvbHZlQW5kQ2hlY2sodGhpcy5wbHVnaW4uc3RhdGUuZGF0YSwgcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG1vbF9zdGF0ZV8yLlN0YXRlU2VsZWN0aW9uLmZpbmRUYWdJblN1YnRyZWUodGhpcy5wbHVnaW4uc3RhdGUuZGF0YS50cmVlLCByLnRyYW5zZm9ybS5yZWYsIFN1cGVycG9zaXRpb25UYWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnbWF0cml4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7IGRhdGE6IG1hdHJpeCwgdHJhbnNwb3NlOiBmYWxzZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLmJ1aWxkKCkudG8obykudXBkYXRlKHBhcmFtcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEuYnVpbGQoKS50byhzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaW5zZXJ0KHRyYW5zZm9ybXNfMS5TdGF0ZVRyYW5zZm9ybXMuTW9kZWwuVHJhbnNmb3JtU3RydWN0dXJlQ29uZm9ybWF0aW9uLCBwYXJhbXMsIHsgdGFnczogU3VwZXJwb3NpdGlvblRhZyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLnJ1blRhc2sodGhpcy5wbHVnaW4uc3RhdGUuZGF0YS51cGRhdGVUcmVlKGIpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTZWdtZW50VHJlZS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VjdGlvbkhlYWRlciA9ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuU2VjdGlvbkhlYWRlciwgeyB0aXRsZTogXCJTdHJ1Y3R1cmUgY2x1c3RlcnNcIiB9KTtcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gdGhpcy5jdXN0b21TdGF0ZTtcbiAgICAgICAgaWYgKGN1c3RvbVN0YXRlICYmIGN1c3RvbVN0YXRlLmluaXRQYXJhbXMgJiYgIWN1c3RvbVN0YXRlLmluaXRQYXJhbXMuc3VwZXJwb3NpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtzZWN0aW9uSGVhZGVyLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHsgY2hpbGRyZW46IFwiRnVuY3Rpb25hbGl0eSB1bmF2YWlsYWJsZSFcIiB9KV0gfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY3VzdG9tU3RhdGUgJiYgY3VzdG9tU3RhdGUuaW5pdFBhcmFtcyAmJiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnN1cGVycG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9uSGVhZGVyID0gKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5TZWN0aW9uSGVhZGVyLCB7IHRpdGxlOiBcIlN0cnVjdHVyZSBjbHVzdGVycyAtIFwiLmNvbmNhdChjdXN0b21TdGF0ZS5pbml0UGFyYW1zLm1vbGVjdWxlSWQpIH0pO1xuICAgICAgICAgICAgICAgIGlmIChjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtzZWN0aW9uSGVhZGVyLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyB0ZXh0QWxpZ246ICdjZW50ZXInIH0gfSwgeyBjaGlsZHJlbjogY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvbkVycm9yIH0pKV0gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUgfHwgIWN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwgeyBjaGlsZHJlbjogW3NlY3Rpb25IZWFkZXIsICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IHN0eWxlOiB7IHRleHRBbGlnbjogJ2NlbnRlcicgfSB9LCB7IGNoaWxkcmVuOiBcIkxvYWRpbmcgU2VnbWVudCBEYXRhIVwiIH0pKV0gfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnN0YXRlKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudEluZGV4XzEgPSBwYXJzZUludCh0aGlzLnN0YXRlLnNlZ21lbnQudmFsdWUuc2VnbWVudC5zcGxpdCgnICcpWzBdKSAtIDE7XG4gICAgICAgICAgICB2YXIgc2VnbWVudERhdGFfMSA9IGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YTtcbiAgICAgICAgICAgIHZhciBmdWxsU2VnbWVudFJhbmdlID0gXCIoIFwiLmNvbmNhdChzZWdtZW50RGF0YV8xWzBdLnNlZ21lbnRfc3RhcnQsIFwiIC0gXCIpLmNvbmNhdChzZWdtZW50RGF0YV8xW3NlZ21lbnREYXRhXzEubGVuZ3RoIC0gMV0uc2VnbWVudF9lbmQsIFwiIClcIik7XG4gICAgICAgICAgICBzZWN0aW9uSGVhZGVyID0gKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5TZWN0aW9uSGVhZGVyLCB7IHRpdGxlOiBcIlN0cnVjdHVyZSBjbHVzdGVycyBcIi5jb25jYXQoY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5tb2xlY3VsZUlkKSwgZGVzYzogZnVsbFNlZ21lbnRSYW5nZSB9KTtcbiAgICAgICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbc2VjdGlvbkhlYWRlciwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShwYXJhbWV0ZXJzXzEuUGFyYW1ldGVyQ29udHJvbHMsIHsgcGFyYW1zOiB0aGlzLnN0YXRlLnNlZ21lbnQucGFyYW1zLCB2YWx1ZXM6IHRoaXMuc3RhdGUuc2VnbWVudC52YWx1ZSwgb25DaGFuZ2VWYWx1ZXM6IHRoaXMudXBkYXRlU2VnbWVudCwgaXNEaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0J1c3kgfSksIHNlZ21lbnREYXRhXzFbc2VnbWVudEluZGV4XzFdLmNsdXN0ZXJzLm1hcChmdW5jdGlvbiAoYywgaSkgeyByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShDbHVzdGVyTm9kZSwgeyBjbHVzdGVyOiBjLCB0b3RhbENsdXN0ZXJzOiBzZWdtZW50RGF0YV8xW3NlZ21lbnRJbmRleF8xXS5jbHVzdGVycy5sZW5ndGgsIHNlZ21lbnRJbmRleDogc2VnbWVudEluZGV4XzEsIGNsdXN0ZXJJbmRleDogaSB9LCBcImNsdXN0ZXItXCIuY29uY2F0KHNlZ21lbnRJbmRleF8xLCBcIi1cIikuY29uY2F0KGkpKTsgfSldIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHt9KTtcbiAgICB9O1xuICAgIHJldHVybiBTZWdtZW50VHJlZTtcbn0oYmFzZV8xLlB1cmVQbHVnaW5VSUNvbXBvbmVudCkpO1xuZXhwb3J0cy5TZWdtZW50VHJlZSA9IFNlZ21lbnRUcmVlO1xudmFyIENsdXN0ZXJOb2RlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKENsdXN0ZXJOb2RlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENsdXN0ZXJOb2RlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBpc0NvbGxhcHNlZDogZmFsc2UsXG4gICAgICAgICAgICBzaG93QWxsOiBmYWxzZSxcbiAgICAgICAgICAgIHNob3dOb25lOiBmYWxzZSxcbiAgICAgICAgICAgIHNob3dTZWFyY2g6IGZhbHNlLFxuICAgICAgICAgICAgaXNCdXN5OiBmYWxzZSxcbiAgICAgICAgICAgIGNsdXN0ZXI6IF90aGlzLnByb3BzLmNsdXN0ZXIsXG4gICAgICAgICAgICBzZWFyY2hUZXh0OiAnJ1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5pbnB1dFN0cmVhbSA9IG5ldyByeGpzXzEuU3ViamVjdCgpO1xuICAgICAgICBfdGhpcy5oYW5kbGVJbnB1dFN0cmVhbSA9IGZ1bmN0aW9uIChpbnB1dFN0cikge1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzZWFyY2hUZXh0OiBpbnB1dFN0ciB9KTtcbiAgICAgICAgICAgIHZhciBmaWx0ZXJlZFJlcyA9IF90aGlzLnByb3BzLmNsdXN0ZXIuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucGRiX2lkLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihpbnB1dFN0ci50b0xvd2VyQ2FzZSgpKSA+PSAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGNsdXN0ZXI6IGZpbHRlcmVkUmVzIH0pO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy50b2dnbGVFeHBhbmRlZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzQ29sbGFwc2VkOiAhX3RoaXMuc3RhdGUuaXNDb2xsYXBzZWQgfSk7XG4gICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5zZWxlY3RBbGwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBzaG93QWxsOiAhX3RoaXMuc3RhdGUuc2hvd0FsbCwgc2hvd05vbmU6IGZhbHNlIH0pO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc2VsZWN0Tm9uZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IHNob3dBbGw6IGZhbHNlLCBzaG93Tm9uZTogIV90aGlzLnN0YXRlLnNob3dOb25lIH0pO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuYXBwbHlBY3Rpb24gPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VzdG9tU3RhdGUsIGN1cnJlbnRTdGF0ZTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgICAgICAgICBjdXN0b21TdGF0ZSA9IHRoaXMuY3VzdG9tU3RhdGU7XG4gICAgICAgICAgICAgICAgY3VzdG9tU3RhdGUuZXZlbnRzLmlzQnVzeS5uZXh0KHRydWUpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9IHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuc3RhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzaG93QWxsOiBmYWxzZSwgc2hvd05vbmU6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkU3RycywgX2EsIF9iLCBfYywgc3RyLCBzdHJ1Y3RTdGF0ZUlkLCBzdHJ1Y3RSZWYsIGNlbGwsIGlzSGlkZGVuLCBlXzFfMTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9kLCBlXzEsIF9lLCBfZjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9nLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkU3RycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy50cnlzLnB1c2goWzEsIDEyLCAxMywgMThdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0cnVlLCBfYiA9IHRzbGliXzEuX19hc3luY1ZhbHVlcyh0aGlzLnN0YXRlLmNsdXN0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzQgLyp5aWVsZCovLCBfYi5uZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2MgPSBfZy5zZW50KCksIF9kID0gX2MuZG9uZSwgIV9kKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZiA9IF9jLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy50cnlzLnB1c2goWzQsICwgOSwgMTBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyID0gX2Y7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdFN0YXRlSWQgPSBcIlwiLmNvbmNhdChzdHIucGRiX2lkLCBcIl9cIikuY29uY2F0KHN0ci5zdHJ1Y3RfYXN5bV9pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdFJlZiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1c3RvbVN0YXRlICYmIGN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZSAmJiBjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUubW9kZWxzW3N0cnVjdFN0YXRlSWRdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3RSZWYgPSB0aGlzLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5tb2RlbHNbc3RydWN0U3RhdGVJZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdHJ1Y3RSZWYpIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZWxsID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5jZWxscy5nZXQoc3RydWN0UmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjZWxsKSByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIaWRkZW4gPSBjZWxsLnN0YXRlLmlzSGlkZGVuID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISgoaXNIaWRkZW4gJiYgY3VycmVudFN0YXRlLnNob3dBbGwpIHx8ICghaXNIaWRkZW4gJiYgY3VycmVudFN0YXRlLnNob3dOb25lKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlRvZ2dsZVZpc2liaWxpdHkodGhpcy5wbHVnaW4sIHsgc3RhdGU6IGNlbGwucGFyZW50LCByZWY6IHN0cnVjdFJlZiB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9nLmxhYmVsID0gNjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZS5zaG93QWxsKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFN0cnMucHVzaChzdHIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5sYWJlbCA9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCAxMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTogcmV0dXJuIFszIC8qYnJlYWsqLywgMThdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVfMV8xID0gX2cuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSB7IGVycm9yOiBlXzFfMSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxOF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2cudHJ5cy5wdXNoKFsxMywgLCAxNiwgMTddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIV9hICYmICFfZCAmJiAoX2UgPSBfYi5yZXR1cm4pKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMTVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBfZS5jYWxsKF9iKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2cuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5sYWJlbCA9IDE1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6IHJldHVybiBbMyAvKmJyZWFrKi8sIDE3XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNyAvKmVuZGZpbmFsbHkqL107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzogcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuQ2FtZXJhLlJlc2V0KHRoaXMucGx1Z2luKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobG9hZFN0cnMubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDIwXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIHN1cGVycG9zaXRpb25fMS5yZW5kZXJTdXBlcnBvc2l0aW9uKSh0aGlzLnBsdWdpbiwgdGhpcy5wcm9wcy5zZWdtZW50SW5kZXgsIGxvYWRTdHJzKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2cuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZy5sYWJlbCA9IDIwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3kubmV4dChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7IH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfTtcbiAgICAgICAgX3RoaXMuY2FuY2VsQWN0aW9uID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgc2hvd0FsbDogZmFsc2UsIHNob3dOb25lOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNsZWFyU2VhcmNoID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgc2VhcmNoVGV4dDogJycgfSk7XG4gICAgICAgICAgICBfdGhpcy5pbnB1dFN0cmVhbS5uZXh0KCcnKTtcbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQ2x1c3Rlck5vZGUucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5ldmVudHMuaXNCdXN5LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc0J1c3k6IGUsIHNob3dBbGw6IGZhbHNlLCBzaG93Tm9uZTogZmFsc2UgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLmlucHV0U3RyZWFtLnBpcGUoKDAsIG9wZXJhdG9yc18xLmRlYm91bmNlVGltZSkoMTAwMCAvIDI0KSksIGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5oYW5kbGVJbnB1dFN0cmVhbShlKTsgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2x1c3Rlck5vZGUucHJvdG90eXBlLCBcImN1c3RvbVN0YXRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBDbHVzdGVyTm9kZS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY3VzdG9tU3RhdGUgPSB0aGlzLmN1c3RvbVN0YXRlO1xuICAgICAgICBpZiAoIWN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZSB8fCAhY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLnNlZ21lbnREYXRhKVxuICAgICAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwge30pO1xuICAgICAgICB2YXIgZXhwYW5kID0gKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5JY29uQnV0dG9uLCB7IHN2ZzogdGhpcy5zdGF0ZS5pc0NvbGxhcHNlZCA/IGljb25zXzEuQXJyb3dSaWdodFN2ZyA6IGljb25zXzEuQXJyb3dEcm9wRG93blN2ZywgZmxleDogJzIwcHgnLCBvbkNsaWNrOiB0aGlzLnRvZ2dsZUV4cGFuZGVkLCB0cmFuc3BhcmVudDogdHJ1ZSwgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5LCBjbGFzc05hbWU6ICdtc3Atbm8taG92ZXItb3V0bGluZScgfSk7XG4gICAgICAgIHZhciB0aXRsZSA9IFwiU2VnbWVudCBcIi5jb25jYXQoY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmFjdGl2ZVNlZ21lbnQsIFwiIENsdXN0ZXIgXCIpLmNvbmNhdCh0aGlzLnByb3BzLmNsdXN0ZXJJbmRleCArIDEpO1xuICAgICAgICB2YXIgbGFiZWwgPSAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6IFwibXNwLWJ0bi10cmVlLWxhYmVsXCIsIG5vT3ZlcmZsb3c6IHRydWUsIHRpdGxlOiB0aXRsZSwgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5IH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcInNwYW5cIiwgeyBjaGlsZHJlbjogW1wiQ2x1c3RlciBcIiwgdGhpcy5wcm9wcy5jbHVzdGVySW5kZXggKyAxXSB9KSwgXCIgXCIsICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwic21hbGxcIiwgeyBjaGlsZHJlbjogW3RoaXMuc3RhdGUuY2x1c3Rlci5sZW5ndGggPCB0aGlzLnByb3BzLmNsdXN0ZXIubGVuZ3RoID8gXCJcIi5jb25jYXQodGhpcy5zdGF0ZS5jbHVzdGVyLmxlbmd0aCwgXCIgLyBcIikgOiAnJywgdGhpcy5wcm9wcy5jbHVzdGVyLmxlbmd0aCwgXCIgY2hhaW5cIiwgdGhpcy5wcm9wcy5jbHVzdGVyLmxlbmd0aCA+IDEgPyAncycgOiAnJ10gfSldIH0pKTtcbiAgICAgICAgdmFyIHNlbGVjdGlvbkNvbnRyb2xzID0gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuQnV0dG9uLCB0c2xpYl8xLl9fYXNzaWduKHsgaWNvbjogaWNvbnNfMS5DaGVja1N2ZywgZmxleDogdHJ1ZSwgb25DbGljazogdGhpcy5zZWxlY3RBbGwsIHN0eWxlOiB7IGZsZXg6ICcwIDAgNTBweCcsIHRleHRBbGlnbjogJ2NlbnRlcicsIGZvbnRTaXplOiAnODAlJywgY29sb3I6ICcjOWNhY2MzJywgcGFkZGluZzogMCB9LCBkaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0J1c3ksIHRpdGxlOiBcIlNob3cgYWxsIGNoYWluc1wiIH0sIHsgY2hpbGRyZW46IFwiQWxsXCIgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgdHNsaWJfMS5fX2Fzc2lnbih7IGljb246IGljb25zXzEuQ2xvc2VTdmcsIGZsZXg6IHRydWUsIG9uQ2xpY2s6IHRoaXMuc2VsZWN0Tm9uZSwgc3R5bGU6IHsgZmxleDogJzAgMCA1MHB4JywgdGV4dEFsaWduOiAnY2VudGVyJywgZm9udFNpemU6ICc4MCUnLCBjb2xvcjogJyM5Y2FjYzMnLCBwYWRkaW5nOiAwIH0sIGRpc2FibGVkOiB0aGlzLnN0YXRlLmlzQnVzeSwgdGl0bGU6IFwiSGlkZSBhbGwgY2hhaW5zXCIgfSwgeyBjaGlsZHJlbjogXCJOb25lXCIgfSkpXSB9KTtcbiAgICAgICAgdmFyIG1haW5Sb3cgPSAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiBcIm1zcC1mbGV4LXJvdyBtc3AtdHJlZS1yb3dcIiwgc3R5bGU6IHsgbWFyZ2luVG9wOiAnMTBweCcgfSB9LCB7IGNoaWxkcmVuOiBbZXhwYW5kLCBsYWJlbCwgdGhpcy5wcm9wcy5jbHVzdGVyLmxlbmd0aCA+IDEgJiYgc2VsZWN0aW9uQ29udHJvbHNdIH0pKTtcbiAgICAgICAgdmFyIHNlYXJjaENvbnRyb2xzID0gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1tYXBwZWQtcGFyYW1ldGVyLWdyb3VwJywgc3R5bGU6IHsgZm9udFNpemU6ICc5MCUnIH0gfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1yb3cgbXNwLXRyYW5zZm9ybS1oZWFkZXItYnJhbmQtZ3JheScsIHN0eWxlOiB7IGhlaWdodDogJzMzcHgnLCBtYXJnaW5MZWZ0OiAnMzBweCcgfSB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcInNwYW5cIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1jb250cm9sLXJvdy1sYWJlbCcgfSwgeyBjaGlsZHJlbjogXCJTZWFyY2ggUERCIElEXCIgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1yb3ctY3RybCcgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImlucHV0XCIsIHsgdHlwZTogJ3RleHQnLCBwbGFjZWhvbGRlcjogJ0VudGVyIFBEQiBJRC4uJywgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5LCBvbkNoYW5nZTogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLmlucHV0U3RyZWFtLm5leHQoZS50YXJnZXQudmFsdWUpOyB9LCB2YWx1ZTogdGhpcy5zdGF0ZS5zZWFyY2hUZXh0LCBtYXhMZW5ndGg6IDQgfSkgfSkpXSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBzdmc6IGljb25zXzEuQ2xvc2VTdmcsIGZsZXg6IHRydWUsIG9uQ2xpY2s6IHRoaXMuY2xlYXJTZWFyY2gsIHN0eWxlOiB7IGZsZXg6ICcwIDAgMjRweCcsIHBhZGRpbmc6IDAgfSwgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5IHx8IHRoaXMuc3RhdGUuc2VhcmNoVGV4dCA9PT0gJycsIHRvZ2dsZVN0YXRlOiB0aGlzLnN0YXRlLnNlYXJjaFRleHQgIT09ICcnLCB0aXRsZTogJ0NsZWFyIHNlYXJjaCBpbnB1dCcgfSldIH0pKTtcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFttYWluUm93LCAodGhpcy5zdGF0ZS5zaG93QWxsIHx8IHRoaXMuc3RhdGUuc2hvd05vbmUpICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogXCJtc3AtY29udHJvbC1yb3cgbXNwLXRyYW5zZm9ybS1oZWFkZXItYnJhbmQtXCIuY29uY2F0KHRoaXMuc3RhdGUuc2hvd0FsbCA/ICdncmVlbicgOiAncmVkJyksIHN0eWxlOiB7IGRpc3BsYXk6ICdmbGV4JywgbWFyZ2luTGVmdDogJzIwcHgnLCBoZWlnaHQ6ICczNXB4JyB9IH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcInNwYW5cIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1jb250cm9sLXJvdy1sYWJlbCcsIHN0eWxlOiB7IGZsZXg6ICcxIDEgYXV0bycsIHRleHRBbGlnbjogJ2xlZnQnLCBmb250U2l6ZTogJzg1JScgfSB9LCB7IGNoaWxkcmVuOiBbdGhpcy5zdGF0ZS5zaG93QWxsID8gJ0Rpc3BsYXknIDogJ0hpZGUnLCBcIiBcIiwgdGhpcy5zdGF0ZS5jbHVzdGVyLmxlbmd0aCA8IHRoaXMucHJvcHMuY2x1c3Rlci5sZW5ndGggPyBcIlwiLmNvbmNhdCh0aGlzLnN0YXRlLmNsdXN0ZXIubGVuZ3RoLCBcIiAvIFwiKSA6ICdhbGwgJywgdGhpcy5wcm9wcy5jbHVzdGVyLmxlbmd0aCwgXCIgY2hhaW5zXCJdIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBpY29uOiBpY29uc18xLkNoZWNrU3ZnLCBmbGV4OiB0cnVlLCBvbkNsaWNrOiB0aGlzLmFwcGx5QWN0aW9uLCBzdHlsZTogeyBmbGV4OiAnMCAwIDYwcHgnLCB0ZXh0QWxpZ246ICdjZW50ZXInLCBmb250U2l6ZTogJzc4JScsIGNvbG9yOiAnIzljYWNjMycsIHBhZGRpbmc6IDAsIG1hcmdpbjogJzAgMXB4JyB9LCB0aXRsZTogXCJBcHBseSBhY3Rpb25cIiB9LCB7IGNoaWxkcmVuOiBcIkFwcGx5XCIgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgdHNsaWJfMS5fX2Fzc2lnbih7IGljb246IGljb25zXzEuQ2xvc2VTdmcsIGZsZXg6IHRydWUsIG9uQ2xpY2s6IHRoaXMuY2FuY2VsQWN0aW9uLCBzdHlsZTogeyBmbGV4OiAnMCAwIDYwcHgnLCB0ZXh0QWxpZ246ICdjZW50ZXInLCBmb250U2l6ZTogJzc4JScsIGNvbG9yOiAnIzljYWNjMycsIHBhZGRpbmc6IDAsIG1hcmdpbjogJzAgMXB4JyB9LCB0aXRsZTogXCJDYW5jZWwgYWN0aW9uXCIgfSwgeyBjaGlsZHJlbjogXCJDYW5jZWxcIiB9KSldIH0pKSB9KSwgKCF0aGlzLnN0YXRlLmlzQ29sbGFwc2VkICYmIHRoaXMucHJvcHMuY2x1c3Rlci5sZW5ndGggPiA1KSAmJiBzZWFyY2hDb250cm9scywgIXRoaXMuc3RhdGUuaXNDb2xsYXBzZWQgJiYgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLXRyZWUtdXBkYXRlcy13cmFwcGVyJywgc3R5bGU6IHsgbWF4SGVpZ2h0OiAodGhpcy5wcm9wcy50b3RhbENsdXN0ZXJzID4gMSkgPyAnMzMwcHgnIDogJzg3JScsIG92ZXJmbG93WTogJ2F1dG8nIH0gfSwgeyBjaGlsZHJlbjogdGhpcy5zdGF0ZS5jbHVzdGVyLm1hcChmdW5jdGlvbiAocywgaSkgeyByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShTdHJ1Y3R1cmVOb2RlLCB7IHNlZ21lbnRJbmRleDogX3RoaXMucHJvcHMuc2VnbWVudEluZGV4LCBzdHJ1Y3R1cmU6IHMsIGlzUmVwOiBpID09PSAwID8gdHJ1ZSA6IGZhbHNlIH0sIFwic3RyLVwiLmNvbmNhdChzLnBkYl9pZCkuY29uY2F0KHMuc3RydWN0X2FzeW1faWQpLmNvbmNhdChpKSk7IH0pIH0pKV0gfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ2x1c3Rlck5vZGU7XG59KGJhc2VfMS5QbHVnaW5VSUNvbXBvbmVudCkpO1xudmFyIFN0cnVjdHVyZU5vZGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU3RydWN0dXJlTm9kZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdHJ1Y3R1cmVOb2RlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBzaG93Q29udHJvbHM6IGZhbHNlLFxuICAgICAgICAgICAgaXNCdXN5OiBmYWxzZSxcbiAgICAgICAgICAgIGlzUHJvY2Vzc2luZzogZmFsc2UsXG4gICAgICAgICAgICBpc0hpZGRlbjogdHJ1ZSxcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMudG9nZ2xlVmlzaWJsZSA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzdHJ1Y3RIaWVyYXJjaHksIF9pLCBfYSwgYywgY3VycmVudEhpZGRlblN0YXRlO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzUHJvY2Vzc2luZzogdHJ1ZSwgc2hvd0NvbnRyb2xzOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZWYpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0SGllcmFyY2h5ID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnJlZnMuZ2V0KHRoaXMucmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJ1Y3RIaWVyYXJjaHkgJiYgc3RydWN0SGllcmFyY2h5LmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgX2EgPSBzdHJ1Y3RIaWVyYXJjaHkuY29tcG9uZW50czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEhpZGRlblN0YXRlID0gYy5jZWxsLnN0YXRlLmlzSGlkZGVuID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEhpZGRlblN0YXRlID09PSB0aGlzLnN0YXRlLmlzSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLlN0YXRlLlRvZ2dsZVZpc2liaWxpdHkodGhpcy5wbHVnaW4sIHsgc3RhdGU6IGMuY2VsbC5wYXJlbnQsIHJlZjogYy5jZWxsLnRyYW5zZm9ybS5yZWYgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiAhdGhpcy5zdGF0ZS5pc0hpZGRlbiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sICgwLCBzdXBlcnBvc2l0aW9uXzEucmVuZGVyU3VwZXJwb3NpdGlvbikodGhpcy5wbHVnaW4sIHRoaXMucHJvcHMuc2VnbWVudEluZGV4LCBbdGhpcy5wcm9wcy5zdHJ1Y3R1cmVdKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzUHJvY2Vzc2luZzogZmFsc2UgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkNhbWVyYS5SZXNldCh0aGlzLnBsdWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pOyB9O1xuICAgICAgICBfdGhpcy5zZWxlY3RBY3Rpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgaWYgKCFpdGVtKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgc2hvd0NvbnRyb2xzOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIChpdGVtID09PSBudWxsIHx8IGl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGl0ZW0udmFsdWUpKCk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmhpZ2hsaWdodCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAoX3RoaXMucmVmKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGwgPSBfdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5jZWxscy5nZXQoX3RoaXMucmVmKTtcbiAgICAgICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkludGVyYWN0aXZpdHkuT2JqZWN0LkhpZ2hsaWdodChfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IGNlbGwucGFyZW50LCByZWY6IF90aGlzLnJlZiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNsZWFySGlnaGxpZ2h0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuSW50ZXJhY3Rpdml0eS5DbGVhckhpZ2hsaWdodHMoX3RoaXMucGx1Z2luKTtcbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnRvZ2dsZUNvbnRyb2xzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgc2hvd0NvbnRyb2xzOiAhX3RoaXMuc3RhdGUuc2hvd0NvbnRyb2xzIH0pO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RydWN0dXJlTm9kZS5wcm90b3R5cGUsIFwiY3VzdG9tU3RhdGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJ1Y3R1cmVOb2RlLnByb3RvdHlwZSwgXCJyZWZcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1c3RvbVN0YXRlICYmIHRoaXMuY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlICYmIHRoaXMuY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLm1vZGVsc1tcIlwiLmNvbmNhdCh0aGlzLnByb3BzLnN0cnVjdHVyZS5wZGJfaWQsIFwiX1wiKS5jb25jYXQodGhpcy5wcm9wcy5zdHJ1Y3R1cmUuc3RydWN0X2FzeW1faWQpXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5tb2RlbHNbXCJcIi5jb25jYXQodGhpcy5wcm9wcy5zdHJ1Y3R1cmUucGRiX2lkLCBcIl9cIikuY29uY2F0KHRoaXMucHJvcHMuc3RydWN0dXJlLnN0cnVjdF9hc3ltX2lkKV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLCBcIm1vZGVsQ2VsbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVmKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2luLnN0YXRlLmRhdGEuY2VsbHMuZ2V0KHRoaXMucmVmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3RydWN0dXJlTm9kZS5wcm90b3R5cGUsIFwiaXNBbGxIaWRkZW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpc0hpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWYpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RydWN0SGllcmFyY2h5ID0gdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5jdXJyZW50LnJlZnMuZ2V0KHRoaXMucmVmKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RydWN0SGllcmFyY2h5ICYmIHN0cnVjdEhpZXJhcmNoeS5jb21wb25lbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBzdHJ1Y3RIaWVyYXJjaHkuY29tcG9uZW50czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMgJiYgYy5jZWxsICYmICFjLmNlbGwuc3RhdGUuaXNIaWRkZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpc0hpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpc0hpZGRlbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLmNoZWNrUmVsYXRpb24gPSBmdW5jdGlvbiAocmVmKSB7XG4gICAgICAgIHZhciBpc1JlbGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIGNlbGwgPSB0aGlzLnBsdWdpbi5zdGF0ZS5kYXRhLmNlbGxzLmdldChyZWYpO1xuICAgICAgICBpZiAoY2VsbCAmJiBjZWxsLnRyYW5zZm9ybS5wYXJlbnQpIHtcbiAgICAgICAgICAgIGlmIChjZWxsICYmIGNlbGwudHJhbnNmb3JtLnBhcmVudCA9PT0gdGhpcy5yZWYpIHtcbiAgICAgICAgICAgICAgICBpc1JlbGF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHBjZWxsID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5jZWxscy5nZXQoY2VsbC50cmFuc2Zvcm0ucGFyZW50KTtcbiAgICAgICAgICAgICAgICBpZiAocGNlbGwgJiYgcGNlbGwudHJhbnNmb3JtLnBhcmVudCA9PT0gdGhpcy5yZWYpXG4gICAgICAgICAgICAgICAgICAgIGlzUmVsYXRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudE5vZGVDZWxsID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5jZWxscy5nZXQodGhpcy5yZWYpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlQ2VsbCAmJiBjdXJyZW50Tm9kZUNlbGwudHJhbnNmb3JtLnBhcmVudCA9PT0gY2VsbC50cmFuc2Zvcm0ucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgaXNSZWxhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNSZWxhdGVkO1xuICAgIH07XG4gICAgU3RydWN0dXJlTm9kZS5wcm90b3R5cGUuaXMgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMucmVmKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgaXNSZWxhdGVkID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLnJlZiAmJiBlLnJlZiAhPT0gdGhpcy5yZWYpIHtcbiAgICAgICAgICAgIGlzUmVsYXRlZCA9IHRoaXMuY2hlY2tSZWxhdGlvbihlLnJlZik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUucmVmID09PSB0aGlzLnJlZiB8fCBpc1JlbGF0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGludmFsaWRTdHJ1Y3QgPSAodGhpcy5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuaW52YWxpZFN0cnVjdC5pbmRleE9mKFwiXCIuY29uY2F0KHRoaXMucHJvcHMuc3RydWN0dXJlLnBkYl9pZCwgXCJfXCIpLmNvbmNhdCh0aGlzLnByb3BzLnN0cnVjdHVyZS5zdHJ1Y3RfYXN5bV9pZCkpID4gLTEpID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGludmFsaWRTdHJ1Y3QgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgaXNIaWRkZW46IHRoaXMuaXNBbGxIaWRkZW4gfSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3ksIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzQnVzeTogZSwgc2hvd0NvbnRyb2xzOiBmYWxzZSB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlKHRoaXMucGx1Z2luLnN0YXRlLmV2ZW50cy5jZWxsLnN0YXRlVXBkYXRlZC5waXBlKCgwLCBvcGVyYXRvcnNfMS5maWx0ZXIpKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5pcyhlKTsgfSksICgwLCBvcGVyYXRvcnNfMS5kZWJvdW5jZVRpbWUpKDMzKSksIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiBfdGhpcy5pc0FsbEhpZGRlbiB9KTtcbiAgICAgICAgICAgIC8vIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTdHJ1Y3R1cmVOb2RlLnByb3RvdHlwZS5nZXRUYWdSZWZzID0gZnVuY3Rpb24gKHRhZ3MpIHtcbiAgICAgICAgdmFyIFRhZ1NldCA9IG5ldyBTZXQodGFncyk7XG4gICAgICAgIHZhciB0cmVlID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS50cmVlO1xuICAgICAgICByZXR1cm4gbW9sX3N0YXRlXzIuU3RhdGVTZWxlY3Rpb24uZmluZFVuaXF1ZVRhZ3NJblN1YnRyZWUodHJlZSwgdGhpcy5tb2RlbENlbGwudHJhbnNmb3JtLnJlZiwgVGFnU2V0KTtcbiAgICB9O1xuICAgIFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLmdldFJhbmRvbUNvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2xMaXN0ID0gbGlzdHNfMS5Db2xvckxpc3RzO1xuICAgICAgICB2YXIgc3BTdGF0ZSA9IHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZTtcbiAgICAgICAgdmFyIHBhbGxldGVJbmRleCA9IHNwU3RhdGUuY29sb3JTdGF0ZVt0aGlzLnByb3BzLnNlZ21lbnRJbmRleF0ucGFsbGV0ZUluZGV4O1xuICAgICAgICB2YXIgY29sb3JJbmRleCA9IHNwU3RhdGUuY29sb3JTdGF0ZVt0aGlzLnByb3BzLnNlZ21lbnRJbmRleF0uY29sb3JJbmRleDtcbiAgICAgICAgaWYgKGNsTGlzdFtzcFN0YXRlLmNvbG9yUGFsZXR0ZVtwYWxsZXRlSW5kZXhdXS5saXN0W2NvbG9ySW5kZXggKyAxXSkge1xuICAgICAgICAgICAgY29sb3JJbmRleCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29sb3JJbmRleCA9IDA7XG4gICAgICAgICAgICBwYWxsZXRlSW5kZXggPSBzcFN0YXRlLmNvbG9yUGFsZXR0ZVtwYWxsZXRlSW5kZXggKyAxXSA/IHBhbGxldGVJbmRleCArIDEgOiAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYWxsZXRlTmFtZSA9IHNwU3RhdGUuY29sb3JQYWxldHRlW3BhbGxldGVJbmRleF07XG4gICAgICAgIHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5jb2xvclN0YXRlW3RoaXMucHJvcHMuc2VnbWVudEluZGV4XS5wYWxsZXRlSW5kZXggPSBwYWxsZXRlSW5kZXg7XG4gICAgICAgIHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5jb2xvclN0YXRlW3RoaXMucHJvcHMuc2VnbWVudEluZGV4XS5jb2xvckluZGV4ID0gY29sb3JJbmRleDtcbiAgICAgICAgcmV0dXJuIGNsTGlzdFtwYWxsZXRlTmFtZV0ubGlzdFtjb2xvckluZGV4XTtcbiAgICB9O1xuICAgIFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLmFkZENoYWluUmVwciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdW5pZm9ybUNvbG9yMSwgc3RySW5zdGFuY2UsIHF1ZXJ5LCBjaGFpblNlbDtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pZm9ybUNvbG9yMSA9IHRoaXMuZ2V0UmFuZG9tQ29sb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ckluc3RhbmNlID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5zZWxlY3QodGhpcy5yZWYpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSBidWlsZGVyXzEuTW9sU2NyaXB0QnVpbGRlci5zdHJ1Y3QuZ2VuZXJhdG9yLmF0b21Hcm91cHMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFpbi10ZXN0JzogYnVpbGRlcl8xLk1vbFNjcmlwdEJ1aWxkZXIuY29yZS5yZWwuZXEoW2J1aWxkZXJfMS5Nb2xTY3JpcHRCdWlsZGVyLnN0cnVjdC5hdG9tUHJvcGVydHkubWFjcm9tb2xlY3VsYXIubGFiZWxfYXN5bV9pZCgpLCB0aGlzLnByb3BzLnN0cnVjdHVyZS5zdHJ1Y3RfYXN5bV9pZF0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGx1Z2luLmJ1aWxkZXJzLnN0cnVjdHVyZS50cnlDcmVhdGVDb21wb25lbnRGcm9tRXhwcmVzc2lvbihzdHJJbnN0YW5jZSwgcXVlcnksIFwiQ2hhaW4tXCIuY29uY2F0KHRoaXMucHJvcHMuc2VnbWVudEluZGV4KSwgeyBsYWJlbDogXCJDaGFpblwiLCB0YWdzOiBbXCJzdXBlcnBvc2l0aW9uLXNlbFwiXSB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYWluU2VsID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGFpblNlbCkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBsdWdpbi5idWlsZGVycy5zdHJ1Y3R1cmUucmVwcmVzZW50YXRpb24uYWRkUmVwcmVzZW50YXRpb24oY2hhaW5TZWwsIHsgdHlwZTogJ2NhcnRvb24nLCBjb2xvcjogJ3VuaWZvcm0nLCBjb2xvclBhcmFtczogeyB2YWx1ZTogdW5pZm9ybUNvbG9yMSB9IH0sIHsgdGFnOiBcInN1cGVycG9zaXRpb24tdmlzdWFsXCIgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLnVwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBzdHJ1Y3RIaWVyYXJjaHkgPSB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LmN1cnJlbnQucmVmcy5nZXQodGhpcy5yZWYpO1xuICAgICAgICBpZiAoc3RydWN0SGllcmFyY2h5ICYmIHN0cnVjdEhpZXJhcmNoeS5jb21wb25lbnRzKSB7XG4gICAgICAgICAgICB2YXIgcmVwcmVzZW50YXRpb25zXzEgPSBbXTtcbiAgICAgICAgICAgIHZhciBzaG93QWRkQ2hhaW5CdG5fMSA9IHRydWU7XG4gICAgICAgICAgICBzdHJ1Y3RIaWVyYXJjaHkuY29tcG9uZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChjb21wcykge1xuICAgICAgICAgICAgICAgIHZhciBnS2V5cyA9IGNvbXBzLmtleS5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgICAgIHZhciBjSWQxQXJyID0gZ0tleXNbMF0uc3BsaXQoJy0nKTtcbiAgICAgICAgICAgICAgICBpZiAoY0lkMUFyclsyXSA9PT0gJ0NoYWluJylcbiAgICAgICAgICAgICAgICAgICAgc2hvd0FkZENoYWluQnRuXzEgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoY29tcHMucmVwcmVzZW50YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBzLnJlcHJlc2VudGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChyZXByKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXByZXNlbnRhdGlvbnNfMS5wdXNoKHJlcHIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBjdXN0b21TdGF0ZSA9IHRoaXMucGx1Z2luLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgaWYgKGN1c3RvbVN0YXRlLmluaXRQYXJhbXMgJiYgY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5zdXBlcnBvc2l0aW9uUGFyYW1zICYmICFjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnN1cGVycG9zaXRpb25QYXJhbXMubGlnYW5kVmlldykge1xuICAgICAgICAgICAgICAgIHNob3dBZGRDaGFpbkJ0bl8xID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVwcmVzZW50YXRpb25zXzEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWFjY2VudC1vZmZzZXQnLCBzdHlsZTogeyBtYXJnaW5MZWZ0OiAnNDBweCcgfSB9LCB7IGNoaWxkcmVuOiBbcmVwcmVzZW50YXRpb25zXzEubGVuZ3RoID4gMCAmJiByZXByZXNlbnRhdGlvbnNfMS5tYXAoZnVuY3Rpb24gKHIsIGkpIHsgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkoU3RydWN0dXJlUmVwcmVzZW50YXRpb25FbnRyeSwgeyBncm91cDogW3N0cnVjdEhpZXJhcmNoeV0sIHJlcHJlc2VudGF0aW9uOiByIH0sIFwiXCIuY29uY2F0KHIuY2VsbC50cmFuc2Zvcm0ucmVmLCBcIi1cIikuY29uY2F0KGkpKTsgfSksIHNob3dBZGRDaGFpbkJ0bl8xICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1jb250cm9sLWdyb3VwLWhlYWRlcicsIHN0eWxlOiB7IG1hcmdpblRvcDogJzFweCcgfSB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBub092ZXJmbG93OiB0cnVlLCBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1idXR0b24tbGFiZWwnLCB0aXRsZTogXCJDbGljayB0byBhZGQgY2hhaW4gcmVwcmVzZW50YWlvblwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5hZGRDaGFpblJlcHIoKTsgfSB9LCB7IGNoaWxkcmVuOiBbXCJcXHUwMEEwXFx1MDBBMEFkZCBDaGFpbiBcIiwgdGhpcy5wcm9wcy5zdHJ1Y3R1cmUuc3RydWN0X2FzeW1faWQsIFwiIFJlcHJlc2VudGF0aW9uXCJdIH0pKSB9KSldIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7fSk7XG4gICAgfTtcbiAgICBTdHJ1Y3R1cmVOb2RlLnByb3RvdHlwZS5nZXRTdWJ0aXRsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIHZhciBoZXRMaXN0ID0gY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlLmhldHNbXCJcIi5jb25jYXQodGhpcy5wcm9wcy5zdHJ1Y3R1cmUucGRiX2lkLCBcIl9cIikuY29uY2F0KHRoaXMucHJvcHMuc3RydWN0dXJlLnN0cnVjdF9hc3ltX2lkKV07XG4gICAgICAgIHZhciBzdWJ0aXRsZTtcbiAgICAgICAgaWYgKGhldExpc3QpIHtcbiAgICAgICAgICAgIHZhciBoZXRMaW1pdCA9IHRoaXMucHJvcHMuc3RydWN0dXJlLmlzX3JlcHJlc2VudGF0aXZlID8gMSA6IDQ7XG4gICAgICAgICAgICB2YXIgdG90YWxIZXRzID0gaGV0TGlzdC5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgaGV0U3RyID0gaGV0TGlzdC5qb2luKCcsICcpO1xuICAgICAgICAgICAgaWYgKHRvdGFsSGV0cyA+IGhldExpbWl0KSB7XG4gICAgICAgICAgICAgICAgaGV0U3RyID0gaGV0TGlzdC5zbGljZSgwLCBoZXRMaW1pdCkuam9pbignLCAnKTtcbiAgICAgICAgICAgICAgICBoZXRTdHIgKz0gXCIgKyBcIi5jb25jYXQodG90YWxIZXRzIC0gaGV0TGltaXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3VidGl0bGUgPSBcIiAoIFwiLmNvbmNhdChoZXRTdHIsIFwiIClcIik7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5zdHJ1Y3R1cmUuaXNfcmVwcmVzZW50YXRpdmUpXG4gICAgICAgICAgICAgICAgc3VidGl0bGUgPSBcIiBcIi5jb25jYXQoc3VidGl0bGUsIFwiICggUmVwcmVzZW50YXRpdmUgKVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnByb3BzLnN0cnVjdHVyZS5pc19yZXByZXNlbnRhdGl2ZSkge1xuICAgICAgICAgICAgc3VidGl0bGUgPSAnICggUmVwcmVzZW50YXRpdmUgKSc7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1YnRpdGxlO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cnVjdHVyZU5vZGUucHJvdG90eXBlLCBcInBhbmVsQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwYW5lbENvbG9yID0gJyM4MDgwODAnO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmlzSGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZWxDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWZzID0gdGhpcy5nZXRUYWdSZWZzKFtcInN1cGVycG9zaXRpb24tdmlzdWFsXCIsIFwic3VwZXJwb3NpdGlvbi1saWdhbmQtdmlzdWFsXCJdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpc3VhbFJlZiA9IHJlZnNbXCJzdXBlcnBvc2l0aW9uLWxpZ2FuZC12aXN1YWxcIl0gPyByZWZzW1wic3VwZXJwb3NpdGlvbi1saWdhbmQtdmlzdWFsXCJdIDogcmVmc1tcInN1cGVycG9zaXRpb24tdmlzdWFsXCJdID8gcmVmc1tcInN1cGVycG9zaXRpb24tdmlzdWFsXCJdIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlzdWFsUmVmKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmlzdWFsQ2VsbCA9IHRoaXMucGx1Z2luLnN0YXRlLmRhdGEuY2VsbHMuZ2V0KHZpc3VhbFJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlzdWFsQ2VsbC5wYXJhbXMgJiYgdmlzdWFsQ2VsbC5wYXJhbXMudmFsdWVzICYmIHZpc3VhbENlbGwucGFyYW1zLnZhbHVlcy5jb2xvclRoZW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yVGhlbWUgPSB2aXN1YWxDZWxsLnBhcmFtcy52YWx1ZXMuY29sb3JUaGVtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29sb3JUaGVtZS5wYXJhbXMgJiYgY29sb3JUaGVtZS5wYXJhbXMudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuZWxDb2xvciA9IFwiXCIuY29uY2F0KGNvbG9yXzEuQ29sb3IudG9TdHlsZShjb2xvclRoZW1lLnBhcmFtcy52YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjb2xvclRoZW1lLnBhcmFtcyAmJiBjb2xvclRoZW1lLnBhcmFtcy5wYWxldHRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xvckxpc3QxID0gY29sb3JUaGVtZS5wYXJhbXMucGFsZXR0ZS5wYXJhbXMubGlzdC5jb2xvcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsQ29sb3IgPSBcIlwiLmNvbmNhdChjb2xvcl8xLkNvbG9yLnRvU3R5bGUoY29sb3JMaXN0MVswXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjb2xvclRoZW1lLnBhcmFtcyAmJiBjb2xvclRoZW1lLnBhcmFtcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2xvckxpc3QyID0gY29sb3JUaGVtZS5wYXJhbXMubGlzdC5jb2xvcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhbmVsQ29sb3IgPSBcIlwiLmNvbmNhdChjb2xvcl8xLkNvbG9yLnRvU3R5bGUoY29sb3JMaXN0MlswXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYW5lbENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3RydWN0dXJlTm9kZS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3VwZXJwb3NpdGlvblBhcmFtcyA9IHRoaXMuY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5zdXBlcnBvc2l0aW9uUGFyYW1zO1xuICAgICAgICB2YXIgc3RydXRTdGF0ZUlkID0gXCJcIi5jb25jYXQodGhpcy5wcm9wcy5zdHJ1Y3R1cmUucGRiX2lkLCBcIl9cIikuY29uY2F0KHRoaXMucHJvcHMuc3RydWN0dXJlLnN0cnVjdF9hc3ltX2lkKTtcbiAgICAgICAgdmFyIGludmFsaWRTdHJ1Y3QgPSAodGhpcy5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuaW52YWxpZFN0cnVjdC5pbmRleE9mKHN0cnV0U3RhdGVJZCkgPiAtMSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBub01hdHJpeFN0cnVjdCA9ICh0aGlzLmN1c3RvbVN0YXRlLnN1cGVycG9zaXRpb25TdGF0ZS5ub01hdHJpeFN0cnVjdC5pbmRleE9mKHN0cnV0U3RhdGVJZCkgPiAtMSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIHZhciBzdWJUaXRsZSA9IGludmFsaWRTdHJ1Y3QgPyBub01hdHJpeFN0cnVjdCA/IFwiIE1hdHJpeCBub3QgYXZhaWxhYmxlIVwiIDogXCIgTm8gTGlnYW5kIGZvdW5kIVwiIDogdGhpcy5nZXRTdWJ0aXRsZSgpO1xuICAgICAgICB2YXIgc3RyVGl0bGUgPSBcIlwiLmNvbmNhdCh0aGlzLnByb3BzLnN0cnVjdHVyZS5wZGJfaWQsIFwiIGNoYWluIFwiKS5jb25jYXQodGhpcy5wcm9wcy5zdHJ1Y3R1cmUuYXV0aF9hc3ltX2lkKTtcbiAgICAgICAgaWYgKHN1cGVycG9zaXRpb25QYXJhbXMgJiYgc3VwZXJwb3NpdGlvblBhcmFtcy5saWdhbmRWaWV3KSB7XG4gICAgICAgICAgICBzdHJUaXRsZSA9IFwiXCIuY29uY2F0KHRoaXMucHJvcHMuc3RydWN0dXJlLnBkYl9pZCwgXCIgXCIpLmNvbmNhdCh0aGlzLnByb3BzLnN0cnVjdHVyZS5zdHJ1Y3RfYXN5bV9pZCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxhYmVsID0gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoY29tbW9uXzEuQnV0dG9uLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiBcIm1zcC1idG4tdHJlZS1sYWJlbFwiLCBzdHlsZTogeyBib3JkZXJMZWZ0Q29sb3I6IHRoaXMucGFuZWxDb2xvciB9LCBub092ZXJmbG93OiB0cnVlLCB0aXRsZTogc3RyVGl0bGUsIGRpc2FibGVkOiAoaW52YWxpZFN0cnVjdCB8fCB0aGlzLnN0YXRlLmlzQnVzeSB8fCB0aGlzLnN0YXRlLmlzUHJvY2Vzc2luZykgPyB0cnVlIDogZmFsc2UsIG9uTW91c2VFbnRlcjogdGhpcy5oaWdobGlnaHQsIG9uTW91c2VMZWF2ZTogdGhpcy5jbGVhckhpZ2hsaWdodCB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcInNwYW5cIiwgeyBjaGlsZHJlbjogc3RyVGl0bGUgfSksIHN1YlRpdGxlICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJzbWFsbFwiLCB7IGNoaWxkcmVuOiBzdWJUaXRsZSB9KV0gfSkpO1xuICAgICAgICB2YXIgZXhwYW5kID0gKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5JY29uQnV0dG9uLCB7IHN2ZzogIXRoaXMuc3RhdGUuc2hvd0NvbnRyb2xzID8gaWNvbnNfMS5BcnJvd1JpZ2h0U3ZnIDogaWNvbnNfMS5BcnJvd0Ryb3BEb3duU3ZnLCBmbGV4OiAnMjBweCcsIG9uQ2xpY2s6IHRoaXMudG9nZ2xlQ29udHJvbHMsIHRyYW5zcGFyZW50OiB0cnVlLCBjbGFzc05hbWU6ICdtc3Atbm8taG92ZXItb3V0bGluZScsIGRpc2FibGVkOiAoaW52YWxpZFN0cnVjdCB8fCB0aGlzLnN0YXRlLmlzQnVzeSB8fCB0aGlzLnN0YXRlLmlzUHJvY2Vzc2luZykgPyB0cnVlIDogZmFsc2UgfSk7XG4gICAgICAgIHZhciB2aXNpYmlsaXR5ID0gKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5JY29uQnV0dG9uLCB7IHN2ZzogdGhpcy5zdGF0ZS5pc0hpZGRlbiA/IGljb25zXzEuVmlzaWJpbGl0eU9mZk91dGxpbmVkU3ZnIDogaWNvbnNfMS5WaXNpYmlsaXR5T3V0bGluZWRTdmcsIHRvZ2dsZVN0YXRlOiBmYWxzZSwgc21hbGw6IHRydWUsIG9uQ2xpY2s6IHRoaXMudG9nZ2xlVmlzaWJsZSwgZGlzYWJsZWQ6IChpbnZhbGlkU3RydWN0IHx8IHRoaXMuc3RhdGUuaXNCdXN5IHx8IHRoaXMuc3RhdGUuaXNQcm9jZXNzaW5nKSA/IHRydWUgOiBmYWxzZSwgdGl0bGU6IHRoaXMuc3RhdGUuaXNIaWRkZW4gPyBcIlNob3cgY2hhaW5cIiA6IFwiSGlkZSBjaGFpblwiIH0pO1xuICAgICAgICB2YXIgcm93ID0gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogXCJtc3AtZmxleC1yb3cgbXNwLXRyZWUtcm93XCIsIHN0eWxlOiB7IG1hcmdpbkxlZnQ6ICF0aGlzLnN0YXRlLmlzSGlkZGVuID8gJzEwcHgnIDogJzMxcHgnIH0gfSwgeyBjaGlsZHJlbjogWyF0aGlzLnN0YXRlLmlzSGlkZGVuICYmIGV4cGFuZCwgbGFiZWwsIHZpc2liaWxpdHldIH0pKTtcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyBtYXJnaW5Cb3R0b206ICcxcHgnIH0gfSwgeyBjaGlsZHJlbjogW3JvdywgdGhpcy5zdGF0ZS5zaG93Q29udHJvbHMgJiYgdGhpcy51cGRhdGVzKCldIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBTdHJ1Y3R1cmVOb2RlO1xufShiYXNlXzEuUGx1Z2luVUlDb21wb25lbnQpKTtcbnZhciBTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbkVudHJ5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN0cnVjdHVyZVJlcHJlc2VudGF0aW9uRW50cnksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RydWN0dXJlUmVwcmVzZW50YXRpb25FbnRyeSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnRvZ2dsZVZpc2libGUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgICAgIHZhciBjZWxsID0gX3RoaXMucHJvcHMucmVwcmVzZW50YXRpb24uY2VsbDtcbiAgICAgICAgICAgIGNvbW1hbmRzXzEuUGx1Z2luQ29tbWFuZHMuU3RhdGUuVG9nZ2xlVmlzaWJpbGl0eShfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IGNlbGwucGFyZW50LCByZWY6IGNlbGwudHJhbnNmb3JtLnBhcmVudCB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbkVudHJ5LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uc3RhdGUuZXZlbnRzLmNlbGwuc3RhdGVVcGRhdGVkLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKG1vbF9zdGF0ZV8xLlN0YXRlLk9iamVjdEV2ZW50LmlzQ2VsbChlLCBfdGhpcy5wcm9wcy5yZXByZXNlbnRhdGlvbi5jZWxsKSlcbiAgICAgICAgICAgICAgICBfdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN0cnVjdHVyZVJlcHJlc2VudGF0aW9uRW50cnkucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nO1xuICAgICAgICB2YXIgcmVwciA9IHRoaXMucHJvcHMucmVwcmVzZW50YXRpb24uY2VsbDtcbiAgICAgICAgdmFyIGxhYmVsID0gKF9hID0gcmVwci5vYmopID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sYWJlbDtcbiAgICAgICAgaWYgKCgoX2IgPSByZXByLm9iaikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmRhdGEucmVwcikgJiYgKChfYyA9IHJlcHIub2JqKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZGF0YS5yZXByLmxhYmVsKSkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZUxhYmVsID0gKCgoX2QgPSByZXByLm9iaikgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLmRhdGEucmVwci5sYWJlbC5pbmRleE9mKCdbRm9jdXNdJykpID49IDApID8gJ1tGb2N1c10nIDogKF9lID0gcmVwci5vYmopID09PSBudWxsIHx8IF9lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZS5kYXRhLnJlcHIubGFiZWw7XG4gICAgICAgICAgICB2YXIgaXNMYXJnZUxhYmVsID0gc291cmNlTGFiZWwubGVuZ3RoID4gMTAgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBzb3VyY2VMYWJlbCA9IFwiXCIuY29uY2F0KGlzTGFyZ2VMYWJlbCA/IFwiXCIuY29uY2F0KHNvdXJjZUxhYmVsLnN1YnN0cmluZygwLCAyOCksIFwiLi4uXCIpIDogc291cmNlTGFiZWwpO1xuICAgICAgICAgICAgaWYgKGlzTGFyZ2VMYWJlbCkge1xuICAgICAgICAgICAgICAgIGxhYmVsID0gc291cmNlTGFiZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsYWJlbCA9IFwiXCIuY29uY2F0KHNvdXJjZUxhYmVsLCBcIiBcIikuY29uY2F0KChsYWJlbCAmJiBsYWJlbC5sZW5ndGggPCAyMSkgPyAnIC0gJyArIGxhYmVsIDogJycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICgoKF9mID0gcmVwci5vYmopID09PSBudWxsIHx8IF9mID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZi5kYXRhLnJlcHIpICYmICgoX2cgPSByZXByLm9iaikgPT09IG51bGwgfHwgX2cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nLmRhdGEucmVwci5sYWJlbCkgPT09ICdDdXN0b20gU2VsZWN0aW9uJylcbiAgICAgICAgICAgIGxhYmVsID0gJ0N1c3RvbSBTZWxlY3Rpb24nO1xuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1yZXByZXNlbnRhdGlvbi1lbnRyeScgfSwgeyBjaGlsZHJlbjogW3JlcHIucGFyZW50ICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuRXhwYW5kR3JvdXAsIHRzbGliXzEuX19hc3NpZ24oeyBoZWFkZXI6IFwiXCIuY29uY2F0KGxhYmVsIHx8ICdSZXByZXNlbnRhdGlvbicpLCBub09mZnNldDogdHJ1ZSwgaGVhZGVyU3R5bGU6IHsgb3ZlcmZsb3c6ICdoaWRkZW4nIH0gfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KSh1cGRhdGVfdHJhbnNmb3JtXzEuVXBkYXRlVHJhbnNmb3JtQ29udHJvbCwgeyBzdGF0ZTogcmVwci5wYXJlbnQsIHRyYW5zZm9ybTogcmVwci50cmFuc2Zvcm0sIGN1c3RvbUhlYWRlcjogJ25vbmUnLCBub01hcmdpbjogdHJ1ZSB9KSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBzdmc6IHRoaXMucHJvcHMucmVwcmVzZW50YXRpb24uY2VsbC5zdGF0ZS5pc0hpZGRlbiA/IGljb25zXzEuVmlzaWJpbGl0eU9mZk91dGxpbmVkU3ZnIDogaWNvbnNfMS5WaXNpYmlsaXR5T3V0bGluZWRTdmcsIHRvZ2dsZVN0YXRlOiBmYWxzZSwgb25DbGljazogdGhpcy50b2dnbGVWaXNpYmxlLCB0aXRsZTogdGhpcy5wcm9wcy5yZXByZXNlbnRhdGlvbi5jZWxsLnN0YXRlLmlzSGlkZGVuID8gXCJTaG93IHJlcHJlc2VudGF0aW9uXCIgOiBcIkhpZGUgcmVwcmVzZW50YXRpb25cIiwgc21hbGw6IHRydWUsIGNsYXNzTmFtZTogJ21zcC1kZWZhdWx0LWJnJywgc3R5bGU6IHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIHRvcDogMCwgcmlnaHQ6IDAsIGxpbmVIZWlnaHQ6ICcyNHB4JywgaGVpZ2h0OiAnMjRweCcsIHRleHRBbGlnbjogJ3JpZ2h0Jywgd2lkdGg6ICczMnB4JywgcGFkZGluZ1JpZ2h0OiAnNnB4JywgYmFja2dyb3VuZDogJ25vbmUnIH0gfSldIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbkVudHJ5O1xufShiYXNlXzEuUHVyZVBsdWdpblVJQ29tcG9uZW50KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZWdtZW50LXRyZWUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/ui/segment-tree.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/superposition-components.js":
  /*!********************************************!*\
    !*** ./lib/ui/superposition-components.js ***!
    \********************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.SuperpositionComponentControls = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar commands_1 = __webpack_require__(/*! Molstar/mol-plugin/commands */ \"./node_modules/molstar/lib/mol-plugin/commands.js\");\nvar mol_state_1 = __webpack_require__(/*! Molstar/mol-state */ \"./node_modules/molstar/lib/mol-state/index.js\");\nvar param_definition_1 = __webpack_require__(/*! Molstar/mol-util/param-definition */ \"./node_modules/molstar/lib/mol-util/param-definition.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar common_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/common */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/common.js\");\nvar icons_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/icons */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/icons.js\");\nvar parameters_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls/parameters */ \"./node_modules/molstar/lib/mol-plugin-ui/controls/parameters.js\");\nvar operators_1 = __webpack_require__(/*! rxjs/operators */ \"./node_modules/rxjs/dist/cjs/operators/index.js\");\nvar rxjs_1 = __webpack_require__(/*! rxjs */ \"./node_modules/rxjs/dist/cjs/index.js\");\nvar SuperpositionComponentControls = /** @class */ (function (_super) {\n    tslib_1.__extends(SuperpositionComponentControls, _super);\n    function SuperpositionComponentControls() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SuperpositionComponentControls.prototype.defaultState = function () {\n        return {\n            header: 'Components',\n            isCollapsed: false,\n            isDisabled: false,\n            brand: { accent: 'blue', svg: icons_1.CubeOutlineSvg }\n        };\n    };\n    SuperpositionComponentControls.prototype.renderControls = function () {\n        return (0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: (0, jsx_runtime_1.jsx)(ComponentListControls, {}) });\n    };\n    return SuperpositionComponentControls;\n}(base_1.CollapsableControls));\nexports.SuperpositionComponentControls = SuperpositionComponentControls;\n;\nvar ComponentListControls = /** @class */ (function (_super) {\n    tslib_1.__extends(ComponentListControls, _super);\n    function ComponentListControls() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            segmentWatch: false,\n            ligSearchText: '',\n            carbSearchText: '',\n            componentGroups: { nonLigGroups: [], ligGroups: [], carbGroups: [], alphafold: [] },\n            ligGroups: [],\n            isLigCollapsed: false,\n            carbGroups: [],\n            isCarbCollapsed: false,\n            isBusy: false\n        };\n        _this.ligInputStream = new rxjs_1.Subject();\n        _this.handleLigInputStream = function (inputStr) {\n            _this.setState({ ligSearchText: inputStr });\n            var filteredRes = _this.state.componentGroups.ligGroups.filter(function (g) {\n                var gKeys = g[0].key.split(',');\n                var cId1Arr = gKeys[0].split('-');\n                return cId1Arr[2].toLowerCase().indexOf(inputStr.toLowerCase()) >= 0;\n            });\n            _this.setState({ ligGroups: filteredRes });\n        };\n        _this.carbInputStream = new rxjs_1.Subject();\n        _this.handleCarbInputStream = function (inputStr) {\n            _this.setState({ carbSearchText: inputStr });\n            var filteredRes = _this.state.componentGroups.carbGroups.filter(function (g) {\n                var gKeys = g[0].key.split(',');\n                var cId1Arr = gKeys[0].split('-');\n                cId1Arr.splice(0, 2);\n                cId1Arr.pop();\n                return cId1Arr.join('-').toLowerCase().indexOf(inputStr.toLowerCase()) >= 0;\n            });\n            _this.setState({ carbGroups: filteredRes });\n        };\n        _this.toggleVisible = function (e, action, type) {\n            e.preventDefault();\n            e.currentTarget.blur();\n            var customState = _this.plugin.customState;\n            customState.events.isBusy.next(true);\n            var visualEntites = (type === 'ligands') ? _this.state.ligGroups : _this.state.carbGroups;\n            setTimeout(function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n                var _a, visualEntites_1, visualEntites_1_1, visualEntity, e_1_1;\n                var _b, e_1, _c, _d;\n                return tslib_1.__generator(this, function (_e) {\n                    switch (_e.label) {\n                        case 0:\n                            _e.trys.push([0, 5, 6, 11]);\n                            _a = true, visualEntites_1 = tslib_1.__asyncValues(visualEntites);\n                            _e.label = 1;\n                        case 1: return [4 /*yield*/, visualEntites_1.next()];\n                        case 2:\n                            if (!(visualEntites_1_1 = _e.sent(), _b = visualEntites_1_1.done, !_b)) return [3 /*break*/, 4];\n                            _d = visualEntites_1_1.value;\n                            _a = false;\n                            try {\n                                visualEntity = _d;\n                                this.plugin.managers.structure.hierarchy.toggleVisibility(visualEntity, action);\n                            }\n                            finally {\n                                _a = true;\n                            }\n                            _e.label = 3;\n                        case 3: return [3 /*break*/, 1];\n                        case 4: return [3 /*break*/, 11];\n                        case 5:\n                            e_1_1 = _e.sent();\n                            e_1 = { error: e_1_1 };\n                            return [3 /*break*/, 11];\n                        case 6:\n                            _e.trys.push([6, , 9, 10]);\n                            if (!(!_a && !_b && (_c = visualEntites_1.return))) return [3 /*break*/, 8];\n                            return [4 /*yield*/, _c.call(visualEntites_1)];\n                        case 7:\n                            _e.sent();\n                            _e.label = 8;\n                        case 8: return [3 /*break*/, 10];\n                        case 9:\n                            if (e_1) throw e_1.error;\n                            return [7 /*endfinally*/];\n                        case 10: return [7 /*endfinally*/];\n                        case 11:\n                            ;\n                            customState.events.isBusy.next(false);\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        };\n        _this.showHideAllControls = function (type) {\n            return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CheckSvg, flex: true, onClick: function (e) { return _this.toggleVisible(e, 'show', type); }, style: { flex: '0 0 50px', textAlign: 'center', fontSize: '80%', color: '#9cacc3', padding: 0 }, title: \"Show all \".concat(type), disabled: false }, { children: \"All\" })), (0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ icon: icons_1.CloseSvg, flex: true, onClick: function (e) { return _this.toggleVisible(e, 'hide', type); }, style: { flex: '0 0 50px', textAlign: 'center', fontSize: '80%', color: '#9cacc3', padding: 0 }, title: \"Hide all \".concat(type), disabled: false }, { children: \"None\" }))] });\n        };\n        _this.clearLigSearch = function (e) {\n            e.preventDefault();\n            _this.setState({ ligSearchText: '' });\n            _this.ligInputStream.next('');\n            e.currentTarget.blur();\n        };\n        _this.clearCarbSearch = function (e) {\n            e.preventDefault();\n            _this.setState({ carbSearchText: '' });\n            _this.carbInputStream.next('');\n            e.currentTarget.blur();\n        };\n        _this.collapseSection = function (e, type) {\n            e.preventDefault();\n            e.currentTarget.blur();\n            if (type === 'ligands') {\n                _this.setState({ isLigCollapsed: !_this.state.isLigCollapsed });\n            }\n            else {\n                _this.setState({ isCarbCollapsed: !_this.state.isCarbCollapsed });\n            }\n        };\n        _this.sectionHeader = function (type) {\n            var showHideAllControls = (type === 'ligands') ? _this.showHideAllControls('ligands') : _this.showHideAllControls('carbohydrates');\n            var title = (type === 'ligands') ? 'Ligand' : 'Carbohydrates';\n            var visibleVisuals = (type === 'ligands') ? _this.state.ligGroups.length : _this.state.carbGroups.length;\n            var totalVisuals = (type === 'ligands') ? _this.state.componentGroups.ligGroups.length : _this.state.componentGroups.carbGroups.length;\n            return (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row', style: { marginTop: '6px' } }, { children: [(0, jsx_runtime_1.jsxs)(\"button\", tslib_1.__assign({ className: 'msp-form-control msp-control-button-label msp-transform-header-brand-gray', style: { textAlign: 'left' }, onClick: function (e) { return _this.collapseSection(e, type); } }, { children: [(0, jsx_runtime_1.jsx)(\"span\", { children: (0, jsx_runtime_1.jsx)(\"strong\", { children: title }) }), (0, jsx_runtime_1.jsxs)(\"small\", tslib_1.__assign({ style: { color: '#7d91b0' } }, { children: [\" ( \", visibleVisuals, visibleVisuals < totalVisuals ? \" / \".concat(totalVisuals) : '', \" )\"] }))] })), visibleVisuals > 1 && showHideAllControls] }));\n        };\n        return _this;\n    }\n    ComponentListControls.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.managers.structure.hierarchy.behaviors.selection, function () {\n            _this.categoriseGroups();\n            _this.forceUpdate();\n        });\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\n            _this.setState({ isBusy: v });\n        });\n    };\n    ComponentListControls.prototype.componentDidUpdate = function () {\n        var _this = this;\n        var customState = this.plugin.customState;\n        if (customState.events && !this.state.segmentWatch) {\n            this.setState({ segmentWatch: true });\n            this.subscribe(customState.events.segmentUpdate, function () {\n                _this.categoriseGroups();\n                _this.forceUpdate();\n            });\n        }\n        this.subscribe(this.ligInputStream.pipe((0, operators_1.debounceTime)(1000 / 24)), function (e) { return _this.handleLigInputStream(e); });\n        this.subscribe(this.carbInputStream.pipe((0, operators_1.debounceTime)(1000 / 24)), function (e) { return _this.handleCarbInputStream(e); });\n    };\n    ComponentListControls.prototype.categoriseGroups = function () {\n        var componentGroupsVal = { nonLigGroups: [], ligGroups: [], carbGroups: [], alphafold: [] };\n        var componentGroups = this.plugin.managers.structure.hierarchy.currentComponentGroups;\n        var customState = this.plugin.customState;\n        componentGroups.forEach(function (g) {\n            var isLigandView = false;\n            if (customState.initParams && customState.initParams.superpositionParams && customState.initParams.superpositionParams.ligandView) {\n                isLigandView = true;\n            }\n            if (isLigandView) {\n                var gKeys = g[0].key.split(',');\n                var cId1Arr = gKeys[0].split('-');\n                if (gKeys.indexOf('superposition-focus-surr-sel') === -1) {\n                    if (cId1Arr[cId1Arr.length - 1] !== (customState.superpositionState.activeSegment - 1) + '')\n                        return;\n                    if (gKeys.indexOf('superposition-ligand-sel') >= 0) {\n                        componentGroupsVal.ligGroups.push(g);\n                    }\n                    else if (gKeys.indexOf('superposition-carb-sel') >= 0) {\n                        componentGroupsVal.carbGroups.push(g);\n                    }\n                    else if (gKeys.indexOf('alphafold-chain') >= 0) {\n                        componentGroupsVal.alphafold.push(g);\n                    }\n                    else {\n                        componentGroupsVal.nonLigGroups.push(g);\n                    }\n                }\n                else {\n                    componentGroupsVal.nonLigGroups.push(g);\n                }\n            }\n            else {\n                var gKeys = g[0].key.split(',');\n                if (gKeys.indexOf('superposition-focus-surr-sel') >= 0 || gKeys.indexOf(\"Chain-\".concat(customState.superpositionState.activeSegment - 1)) >= 0) {\n                    componentGroupsVal.nonLigGroups.push(g);\n                }\n                else if (gKeys.indexOf('alphafold-chain') >= 0) {\n                    componentGroupsVal.alphafold.push(g);\n                }\n            }\n        });\n        this.setState({ componentGroups: componentGroupsVal, ligGroups: componentGroupsVal.ligGroups, carbGroups: componentGroupsVal.carbGroups, ligSearchText: '', carbSearchText: '' });\n    };\n    ComponentListControls.prototype.render = function () {\n        var _this = this;\n        var ligSearchControls = (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-mapped-parameter-group', style: { fontSize: '90%' } }, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-control-row msp-transform-header-brand-gray', style: { height: '33px' } }, { children: [(0, jsx_runtime_1.jsx)(\"span\", tslib_1.__assign({ className: 'msp-control-row-label' }, { children: \"Search Ligand\" })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-row-ctrl' }, { children: (0, jsx_runtime_1.jsx)(\"input\", { type: 'text', placeholder: 'Enter HET code', disabled: this.state.isBusy, onChange: function (e) { return _this.ligInputStream.next(e.target.value); }, value: this.state.ligSearchText, maxLength: 3 }) }))] })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: icons_1.CloseSvg, flex: true, onClick: this.clearLigSearch, style: { flex: '0 0 24px', padding: 0 }, disabled: this.state.ligSearchText === '' || this.state.isBusy, toggleState: this.state.ligSearchText !== '', title: 'Clear search input' })] }));\n        var carbSearchControls = (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-mapped-parameter-group', style: { fontSize: '90%' } }, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-control-row msp-transform-header-brand-gray', style: { height: '33px' } }, { children: [(0, jsx_runtime_1.jsx)(\"span\", tslib_1.__assign({ className: 'msp-control-row-label' }, { children: \"Search Carbohydrate\" })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-row-ctrl' }, { children: (0, jsx_runtime_1.jsx)(\"input\", { type: 'text', placeholder: 'Enter HET code', disabled: this.state.isBusy, onChange: function (e) { return _this.carbInputStream.next(e.target.value); }, value: this.state.carbSearchText, maxLength: 3 }) }))] })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { svg: icons_1.CloseSvg, flex: true, onClick: this.clearCarbSearch, style: { flex: '0 0 24px', padding: 0 }, disabled: this.state.carbSearchText === '' || this.state.isBusy, toggleState: this.state.carbSearchText !== '', title: 'Clear search input' })] }));\n        var ligSectionHeader = this.sectionHeader('ligands');\n        var carbSectionHeader = this.sectionHeader('carbohydrates');\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(this.state.componentGroups.nonLigGroups.length > 0) && (0, jsx_runtime_1.jsx)(\"div\", { children: this.state.componentGroups.nonLigGroups.map(function (g) { return (0, jsx_runtime_1.jsx)(StructureComponentGroup, { group: g, boldHeader: true }, g[0].cell.transform.ref); }) }), (this.state.componentGroups.alphafold.length > 0) && (0, jsx_runtime_1.jsx)(\"div\", { children: this.state.componentGroups.alphafold.map(function (g) { return (0, jsx_runtime_1.jsx)(StructureComponentGroup, { group: g, boldHeader: true, type: 'alphafold' }, g[0].cell.transform.ref); }) }), (this.state.componentGroups.ligGroups.length > 0) && ligSectionHeader, (!this.state.isLigCollapsed && this.state.componentGroups.ligGroups.length > 5) && ligSearchControls, (this.state.componentGroups.ligGroups.length > 0) && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-offset', style: { maxHeight: '800px', overflowY: 'auto' } }, { children: !this.state.isLigCollapsed && this.state.ligGroups.map(function (g) { return (0, jsx_runtime_1.jsx)(StructureComponentGroup, { group: g, boldHeader: false }, g[0].cell.transform.ref); }) })), (this.state.componentGroups.carbGroups.length > 0) && carbSectionHeader, (!this.state.isCarbCollapsed && this.state.componentGroups.carbGroups.length > 5) && carbSearchControls, (this.state.componentGroups.carbGroups.length > 0) && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-control-offset', style: { maxHeight: '800px', overflowY: 'auto' } }, { children: !this.state.isCarbCollapsed && this.state.carbGroups.map(function (g) { return (0, jsx_runtime_1.jsx)(StructureComponentGroup, { group: g, boldHeader: false }, g[0].cell.transform.ref); }) }))] });\n    };\n    return ComponentListControls;\n}(base_1.PurePluginUIComponent));\nvar StructureComponentGroup = /** @class */ (function (_super) {\n    tslib_1.__extends(StructureComponentGroup, _super);\n    function StructureComponentGroup() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            action: void 0,\n            isHidden: false,\n            isBusy: false\n        };\n        _this.checkAllHidden = function () { return tslib_1.__awaiter(_this, void 0, void 0, function () {\n            var allHidden, _i, _a, c;\n            return tslib_1.__generator(this, function (_b) {\n                allHidden = true;\n                for (_i = 0, _a = this.props.group; _i < _a.length; _i++) {\n                    c = _a[_i];\n                    if (!c.cell.state.isHidden) {\n                        allHidden = false;\n                        break;\n                    }\n                }\n                if (allHidden)\n                    this.setState({ isHidden: true });\n                return [2 /*return*/];\n            });\n        }); };\n        _this.toggleVisible = function (e) {\n            e.preventDefault();\n            e.currentTarget.blur();\n            _this.plugin.managers.structure.component.toggleVisibility(_this.props.group);\n            _this.setState({ isHidden: !_this.state.isHidden });\n            if (_this.props.type === 'alphafold') {\n                var spState = _this.plugin.customState.superpositionState;\n                spState.alphafold.visibility[spState.activeSegment - 1] = _this.state.isHidden;\n            }\n        };\n        _this.toggleAction = function () { return _this.setState({ action: _this.state.action === 'action' ? void 0 : 'action' }); };\n        _this.highlight = function (e) {\n            e.preventDefault();\n            if (!_this.props.group[0].cell.parent)\n                return;\n            commands_1.PluginCommands.Interactivity.Object.Highlight(_this.plugin, { state: _this.props.group[0].cell.parent, ref: _this.props.group.map(function (c) { return c.cell.transform.ref; }) });\n        };\n        _this.clearHighlight = function (e) {\n            e.preventDefault();\n            commands_1.PluginCommands.Interactivity.ClearHighlights(_this.plugin);\n        };\n        _this.focus = function () {\n            var allHidden = true;\n            for (var _i = 0, _a = _this.props.group; _i < _a.length; _i++) {\n                var c = _a[_i];\n                if (!c.cell.state.isHidden) {\n                    allHidden = false;\n                    break;\n                }\n            }\n            if (allHidden) {\n                _this.plugin.managers.structure.hierarchy.toggleVisibility(_this.props.group, 'show');\n            }\n            _this.plugin.managers.camera.focusSpheres(_this.props.group, function (e) {\n                var _a;\n                if (e.cell.state.isHidden)\n                    return;\n                return (_a = e.cell.obj) === null || _a === void 0 ? void 0 : _a.data.boundary.sphere;\n            });\n        };\n        return _this;\n    }\n    Object.defineProperty(StructureComponentGroup.prototype, \"pivot\", {\n        get: function () {\n            return this.props.group[0];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    StructureComponentGroup.prototype.componentDidMount = function () {\n        var _this = this;\n        this.checkAllHidden();\n        this.subscribe(this.plugin.state.events.cell.stateUpdated, function (e) {\n            var _a, _b;\n            // if (State.ObjectEvent.isCell(e, this.pivot.cell)) this.forceUpdate();\n            if (((_a = _this.pivot.cell.obj) === null || _a === void 0 ? void 0 : _a.label) === ((_b = e.cell.obj) === null || _b === void 0 ? void 0 : _b.label)) {\n                if (!e.cell.state.isHidden) {\n                    _this.setState({ isHidden: false });\n                }\n                else {\n                    _this.checkAllHidden();\n                }\n            }\n        });\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\n            _this.setState({ isBusy: v });\n        });\n        this.subscribe(this.plugin.customState.events.isBusy, function (e) {\n            _this.setState({ isBusy: e });\n        });\n    };\n    StructureComponentGroup.prototype.render = function () {\n        var _this = this;\n        var _a;\n        var component = this.pivot;\n        var cell = component.cell;\n        var label = (_a = cell.obj) === null || _a === void 0 ? void 0 : _a.label;\n        var labelEle = this.props.boldHeader ? (0, jsx_runtime_1.jsx)(\"strong\", { children: label }) : label;\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-flex-row' }, { children: [(0, jsx_runtime_1.jsx)(common_1.Button, tslib_1.__assign({ noOverflow: true, className: 'msp-control-button-label', title: \"\".concat(label, \" - Click to focus.\"), onClick: this.focus, style: { textAlign: 'left' }, disabled: this.state.isBusy }, { children: labelEle })), (0, jsx_runtime_1.jsx)(common_1.IconButton, { disabled: this.state.isBusy, svg: this.state.isHidden ? icons_1.VisibilityOffOutlinedSvg : icons_1.VisibilityOutlinedSvg, toggleState: false, onClick: this.toggleVisible, title: \"\".concat(this.state.isHidden ? 'Show' : 'Hide', \" component\"), small: true, className: 'msp-form-control', flex: true }), (0, jsx_runtime_1.jsx)(common_1.IconButton, { disabled: this.state.isBusy, svg: icons_1.MoreHorizSvg, onClick: this.toggleAction, title: 'Actions', toggleState: this.state.action === 'action', className: 'msp-form-control', flex: true })] })), this.state.action === 'action' && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-accent-offset' }, { children: (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ style: { marginBottom: '6px' } }, { children: component.representations.map(function (r) { return (0, jsx_runtime_1.jsx)(StructureRepresentationEntry, { group: _this.props.group, representation: r }, r.cell.transform.ref); }) })) }))] });\n    };\n    return StructureComponentGroup;\n}(base_1.PurePluginUIComponent));\nvar StructureRepresentationEntry = /** @class */ (function (_super) {\n    tslib_1.__extends(StructureRepresentationEntry, _super);\n    function StructureRepresentationEntry() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            isBusy: false,\n            clusterVal: { cluster: 'All' }\n        };\n        _this.remove = function () { return _this.plugin.managers.structure.component.removeRepresentations(_this.props.group, _this.props.representation); };\n        _this.toggleVisible = function (e) {\n            e.preventDefault();\n            e.currentTarget.blur();\n            _this.plugin.managers.structure.component.toggleVisibility(_this.props.group, _this.props.representation);\n        };\n        _this.update = function (params) {\n            return _this.updateRepresentations(_this.props.group, _this.props.representation, params);\n        };\n        _this.selectCluster = function (params) {\n            _this.setState({ clusterVal: { cluster: params.cluster } });\n        };\n        return _this;\n    }\n    StructureRepresentationEntry.prototype.componentDidMount = function () {\n        var _this = this;\n        this.subscribe(this.plugin.state.events.cell.stateUpdated, function (e) {\n            if (mol_state_1.State.ObjectEvent.isCell(e, _this.props.representation.cell))\n                _this.forceUpdate();\n        });\n        this.subscribe(this.plugin.behaviors.state.isBusy, function (v) {\n            _this.setState({ isBusy: v });\n        });\n        this.subscribe(this.plugin.customState.events.isBusy, function (e) {\n            _this.setState({ isBusy: e });\n        });\n    };\n    StructureRepresentationEntry.prototype.updateRepresentations = function (components, pivot, params) {\n        var _a, _b, _c;\n        if (components.length === 0)\n            return Promise.resolve();\n        var index = components[0].representations.indexOf(pivot);\n        if (index < 0)\n            return Promise.resolve();\n        var superpositionState = this.plugin.customState.superpositionState;\n        var filteredComps = [];\n        if (this.state.clusterVal.cluster !== 'All') {\n            var clusterData = superpositionState.segmentData[superpositionState.activeSegment - 1].clusters[parseInt(this.state.clusterVal.cluster) - 1];\n            filteredComps = clusterData.map(function (s) {\n                return \"\".concat(s.pdb_id, \"_\").concat(s.struct_asym_id);\n            });\n            if (filteredComps.length === 0)\n                return;\n        }\n        var update = this.plugin.state.data.build();\n        for (var _i = 0, components_1 = components; _i < components_1.length; _i++) {\n            var c = components_1[_i];\n            // TODO: is it ok to use just the index here? Could possible lead to ugly edge cases, but perhaps not worth the trouble to \"fix\".\n            var repr = c.representations[index];\n            if (!repr)\n                continue;\n            if (repr.cell.transform.transformer !== pivot.cell.transform.transformer)\n                continue;\n            if (this.state.clusterVal.cluster !== 'All') {\n                var rmIndex = filteredComps.indexOf(superpositionState.refMaps[repr.cell.transform.parent]);\n                if (rmIndex === -1)\n                    continue;\n            }\n            var updatedParams = {\n                type: params.type ? params.type : (_a = repr.cell.params) === null || _a === void 0 ? void 0 : _a.values.type,\n                colorTheme: params.colorTheme ? params.colorTheme : (_b = repr.cell.params) === null || _b === void 0 ? void 0 : _b.values.colorTheme,\n                sizeTheme: params.sizeTheme ? params.sizeTheme : (_c = repr.cell.params) === null || _c === void 0 ? void 0 : _c.values.sizeTheme\n            };\n            update.to(repr.cell).update(updatedParams);\n        }\n        return update.commit({ canUndo: 'Update Representation' });\n    };\n    StructureRepresentationEntry.prototype.render = function () {\n        var _a, _b, _c, _d, _e, _f;\n        var repr = this.props.representation.cell;\n        var superpositionState = this.plugin.customState.superpositionState;\n        var clusterSelectArr = [['All', 'All']];\n        superpositionState.segmentData[superpositionState.activeSegment - 1].clusters.forEach(function (c, i) {\n            clusterSelectArr.push([(i + 1) + '', (i + 1) + '']);\n        });\n        var clusterOptions = {\n            cluster: param_definition_1.ParamDefinition.Select('All', clusterSelectArr, { label: 'Select Cluster' })\n        };\n        var isSurrVisual = false;\n        var isAlphafold = false;\n        if (repr && repr.obj) {\n            var reprObj = repr.obj;\n            if (reprObj.tags && reprObj.tags.indexOf('superposition-focus-surr-repr') >= 0)\n                isSurrVisual = true;\n            if (reprObj.tags && reprObj.tags.indexOf('af-superposition-visual') >= 0)\n                isAlphafold = true;\n        }\n        return (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: repr.parent && (0, jsx_runtime_1.jsxs)(\"div\", { children: [(clusterSelectArr.length > 2 && !isSurrVisual && !isAlphafold) && (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: clusterOptions, values: this.state.clusterVal, onChangeValues: this.selectCluster, isDisabled: this.state.isBusy }) })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: { type: (_a = repr.params) === null || _a === void 0 ? void 0 : _a.definition.type }, values: { type: (_b = repr.params) === null || _b === void 0 ? void 0 : _b.values.type }, onChangeValues: this.update, isDisabled: this.state.isBusy }) })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: { colorTheme: (_c = repr.params) === null || _c === void 0 ? void 0 : _c.definition.colorTheme }, values: { colorTheme: (_d = repr.params) === null || _d === void 0 ? void 0 : _d.values.colorTheme }, onChangeValues: this.update, isDisabled: this.state.isBusy }) })), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-representation-entry' }, { children: (0, jsx_runtime_1.jsx)(parameters_1.ParameterControls, { params: { sizeTheme: (_e = repr.params) === null || _e === void 0 ? void 0 : _e.definition.sizeTheme }, values: { sizeTheme: (_f = repr.params) === null || _f === void 0 ? void 0 : _f.values.sizeTheme }, onChangeValues: this.update, isDisabled: this.state.isBusy }) }))] }) }));\n    };\n    return StructureRepresentationEntry;\n}(base_1.PurePluginUIComponent));\n//# sourceMappingURL=superposition-components.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvc3VwZXJwb3NpdGlvbi1jb21wb25lbnRzLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHNDQUFzQztBQUN0QyxjQUFjLG1CQUFPLENBQUMsZ0RBQU87QUFDN0Isb0JBQW9CLG1CQUFPLENBQUMsOERBQW1CO0FBQy9DLGlCQUFpQixtQkFBTyxDQUFDLHNGQUE2QjtBQUN0RCxrQkFBa0IsbUJBQU8sQ0FBQyx3RUFBbUI7QUFDN0MseUJBQXlCLG1CQUFPLENBQUMsa0dBQW1DO0FBQ3BFLGFBQWEsbUJBQU8sQ0FBQyxvRkFBNEI7QUFDakQsZUFBZSxtQkFBTyxDQUFDLDBHQUF1QztBQUM5RCxjQUFjLG1CQUFPLENBQUMsd0dBQXNDO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLGtIQUEyQztBQUN0RSxrQkFBa0IsbUJBQU8sQ0FBQyx1RUFBZ0I7QUFDMUMsYUFBYSxtQkFBTyxDQUFDLG1EQUFNO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSwwREFBMEQsR0FBRztBQUM3SDtBQUNBO0FBQ0EsQ0FBQztBQUNELHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsZ0VBQWdFO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIseUJBQXlCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLDZCQUE2Qix3QkFBd0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDBCQUEwQjtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsNkJBQTZCLHlCQUF5QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFx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R0FBRztBQUNoeEQ7QUFDQTtBQUNBLENBQUM7QUFDRCIsInNvdXJjZXMiOlsid2VicGFjazovL3BkYmUtbW9sc3Rhci8uL2xpYi91aS9zdXBlcnBvc2l0aW9uLWNvbXBvbmVudHMuanM/M2Y3NiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuU3VwZXJwb3NpdGlvbkNvbXBvbmVudENvbnRyb2xzID0gdm9pZCAwO1xudmFyIHRzbGliXzEgPSByZXF1aXJlKFwidHNsaWJcIik7XG52YXIganN4X3J1bnRpbWVfMSA9IHJlcXVpcmUoXCJyZWFjdC9qc3gtcnVudGltZVwiKTtcbnZhciBjb21tYW5kc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi9jb21tYW5kc1wiKTtcbnZhciBtb2xfc3RhdGVfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1zdGF0ZVwiKTtcbnZhciBwYXJhbV9kZWZpbml0aW9uXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtdXRpbC9wYXJhbS1kZWZpbml0aW9uXCIpO1xudmFyIGJhc2VfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvYmFzZVwiKTtcbnZhciBjb21tb25fMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvY29tbW9uXCIpO1xudmFyIGljb25zXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL2NvbnRyb2xzL2ljb25zXCIpO1xudmFyIHBhcmFtZXRlcnNfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvY29udHJvbHMvcGFyYW1ldGVyc1wiKTtcbnZhciBvcGVyYXRvcnNfMSA9IHJlcXVpcmUoXCJyeGpzL29wZXJhdG9yc1wiKTtcbnZhciByeGpzXzEgPSByZXF1aXJlKFwicnhqc1wiKTtcbnZhciBTdXBlcnBvc2l0aW9uQ29tcG9uZW50Q29udHJvbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU3VwZXJwb3NpdGlvbkNvbXBvbmVudENvbnRyb2xzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cGVycG9zaXRpb25Db21wb25lbnRDb250cm9scygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXBlcnBvc2l0aW9uQ29tcG9uZW50Q29udHJvbHMucHJvdG90eXBlLmRlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhlYWRlcjogJ0NvbXBvbmVudHMnLFxuICAgICAgICAgICAgaXNDb2xsYXBzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgaXNEaXNhYmxlZDogZmFsc2UsXG4gICAgICAgICAgICBicmFuZDogeyBhY2NlbnQ6ICdibHVlJywgc3ZnOiBpY29uc18xLkN1YmVPdXRsaW5lU3ZnIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFN1cGVycG9zaXRpb25Db21wb25lbnRDb250cm9scy5wcm90b3R5cGUucmVuZGVyQ29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoQ29tcG9uZW50TGlzdENvbnRyb2xzLCB7fSkgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VwZXJwb3NpdGlvbkNvbXBvbmVudENvbnRyb2xzO1xufShiYXNlXzEuQ29sbGFwc2FibGVDb250cm9scykpO1xuZXhwb3J0cy5TdXBlcnBvc2l0aW9uQ29tcG9uZW50Q29udHJvbHMgPSBTdXBlcnBvc2l0aW9uQ29tcG9uZW50Q29udHJvbHM7XG47XG52YXIgQ29tcG9uZW50TGlzdENvbnRyb2xzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKENvbXBvbmVudExpc3RDb250cm9scywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb21wb25lbnRMaXN0Q29udHJvbHMoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHNlZ21lbnRXYXRjaDogZmFsc2UsXG4gICAgICAgICAgICBsaWdTZWFyY2hUZXh0OiAnJyxcbiAgICAgICAgICAgIGNhcmJTZWFyY2hUZXh0OiAnJyxcbiAgICAgICAgICAgIGNvbXBvbmVudEdyb3VwczogeyBub25MaWdHcm91cHM6IFtdLCBsaWdHcm91cHM6IFtdLCBjYXJiR3JvdXBzOiBbXSwgYWxwaGFmb2xkOiBbXSB9LFxuICAgICAgICAgICAgbGlnR3JvdXBzOiBbXSxcbiAgICAgICAgICAgIGlzTGlnQ29sbGFwc2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGNhcmJHcm91cHM6IFtdLFxuICAgICAgICAgICAgaXNDYXJiQ29sbGFwc2VkOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQnVzeTogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMubGlnSW5wdXRTdHJlYW0gPSBuZXcgcnhqc18xLlN1YmplY3QoKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlTGlnSW5wdXRTdHJlYW0gPSBmdW5jdGlvbiAoaW5wdXRTdHIpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgbGlnU2VhcmNoVGV4dDogaW5wdXRTdHIgfSk7XG4gICAgICAgICAgICB2YXIgZmlsdGVyZWRSZXMgPSBfdGhpcy5zdGF0ZS5jb21wb25lbnRHcm91cHMubGlnR3JvdXBzLmZpbHRlcihmdW5jdGlvbiAoZykge1xuICAgICAgICAgICAgICAgIHZhciBnS2V5cyA9IGdbMF0ua2V5LnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgdmFyIGNJZDFBcnIgPSBnS2V5c1swXS5zcGxpdCgnLScpO1xuICAgICAgICAgICAgICAgIHJldHVybiBjSWQxQXJyWzJdLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihpbnB1dFN0ci50b0xvd2VyQ2FzZSgpKSA+PSAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGxpZ0dyb3VwczogZmlsdGVyZWRSZXMgfSk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNhcmJJbnB1dFN0cmVhbSA9IG5ldyByeGpzXzEuU3ViamVjdCgpO1xuICAgICAgICBfdGhpcy5oYW5kbGVDYXJiSW5wdXRTdHJlYW0gPSBmdW5jdGlvbiAoaW5wdXRTdHIpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY2FyYlNlYXJjaFRleHQ6IGlucHV0U3RyIH0pO1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkUmVzID0gX3RoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmNhcmJHcm91cHMuZmlsdGVyKGZ1bmN0aW9uIChnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdLZXlzID0gZ1swXS5rZXkuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICB2YXIgY0lkMUFyciA9IGdLZXlzWzBdLnNwbGl0KCctJyk7XG4gICAgICAgICAgICAgICAgY0lkMUFyci5zcGxpY2UoMCwgMik7XG4gICAgICAgICAgICAgICAgY0lkMUFyci5wb3AoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY0lkMUFyci5qb2luKCctJykudG9Mb3dlckNhc2UoKS5pbmRleE9mKGlucHV0U3RyLnRvTG93ZXJDYXNlKCkpID49IDA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY2FyYkdyb3VwczogZmlsdGVyZWRSZXMgfSk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnRvZ2dsZVZpc2libGUgPSBmdW5jdGlvbiAoZSwgYWN0aW9uLCB0eXBlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gX3RoaXMucGx1Z2luLmN1c3RvbVN0YXRlO1xuICAgICAgICAgICAgY3VzdG9tU3RhdGUuZXZlbnRzLmlzQnVzeS5uZXh0KHRydWUpO1xuICAgICAgICAgICAgdmFyIHZpc3VhbEVudGl0ZXMgPSAodHlwZSA9PT0gJ2xpZ2FuZHMnKSA/IF90aGlzLnN0YXRlLmxpZ0dyb3VwcyA6IF90aGlzLnN0YXRlLmNhcmJHcm91cHM7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfYSwgdmlzdWFsRW50aXRlc18xLCB2aXN1YWxFbnRpdGVzXzFfMSwgdmlzdWFsRW50aXR5LCBlXzFfMTtcbiAgICAgICAgICAgICAgICB2YXIgX2IsIGVfMSwgX2MsIF9kO1xuICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2UudHJ5cy5wdXNoKFswLCA1LCA2LCAxMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdHJ1ZSwgdmlzdWFsRW50aXRlc18xID0gdHNsaWJfMS5fX2FzeW5jVmFsdWVzKHZpc3VhbEVudGl0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFs0IC8qeWllbGQqLywgdmlzdWFsRW50aXRlc18xLm5leHQoKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodmlzdWFsRW50aXRlc18xXzEgPSBfZS5zZW50KCksIF9iID0gdmlzdWFsRW50aXRlc18xXzEuZG9uZSwgIV9iKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSB2aXN1YWxFbnRpdGVzXzFfMS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbEVudGl0eSA9IF9kO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5tYW5hZ2Vycy5zdHJ1Y3R1cmUuaGllcmFyY2h5LnRvZ2dsZVZpc2liaWxpdHkodmlzdWFsRW50aXR5LCBhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzMgLypicmVhayovLCAxMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZV8xXzEgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0geyBlcnJvcjogZV8xXzEgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2UudHJ5cy5wdXNoKFs2LCAsIDksIDEwXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIV9hICYmICFfYiAmJiAoX2MgPSB2aXN1YWxFbnRpdGVzXzEucmV0dXJuKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIF9jLmNhbGwodmlzdWFsRW50aXRlc18xKV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gODtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVN0YXRlLmV2ZW50cy5pc0J1c3kubmV4dChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnNob3dIaWRlQWxsQ29udHJvbHMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkJ1dHRvbiwgdHNsaWJfMS5fX2Fzc2lnbih7IGljb246IGljb25zXzEuQ2hlY2tTdmcsIGZsZXg6IHRydWUsIG9uQ2xpY2s6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy50b2dnbGVWaXNpYmxlKGUsICdzaG93JywgdHlwZSk7IH0sIHN0eWxlOiB7IGZsZXg6ICcwIDAgNTBweCcsIHRleHRBbGlnbjogJ2NlbnRlcicsIGZvbnRTaXplOiAnODAlJywgY29sb3I6ICcjOWNhY2MzJywgcGFkZGluZzogMCB9LCB0aXRsZTogXCJTaG93IGFsbCBcIi5jb25jYXQodHlwZSksIGRpc2FibGVkOiBmYWxzZSB9LCB7IGNoaWxkcmVuOiBcIkFsbFwiIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBpY29uOiBpY29uc18xLkNsb3NlU3ZnLCBmbGV4OiB0cnVlLCBvbkNsaWNrOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMudG9nZ2xlVmlzaWJsZShlLCAnaGlkZScsIHR5cGUpOyB9LCBzdHlsZTogeyBmbGV4OiAnMCAwIDUwcHgnLCB0ZXh0QWxpZ246ICdjZW50ZXInLCBmb250U2l6ZTogJzgwJScsIGNvbG9yOiAnIzljYWNjMycsIHBhZGRpbmc6IDAgfSwgdGl0bGU6IFwiSGlkZSBhbGwgXCIuY29uY2F0KHR5cGUpLCBkaXNhYmxlZDogZmFsc2UgfSwgeyBjaGlsZHJlbjogXCJOb25lXCIgfSkpXSB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuY2xlYXJMaWdTZWFyY2ggPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBsaWdTZWFyY2hUZXh0OiAnJyB9KTtcbiAgICAgICAgICAgIF90aGlzLmxpZ0lucHV0U3RyZWFtLm5leHQoJycpO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuY2xlYXJDYXJiU2VhcmNoID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY2FyYlNlYXJjaFRleHQ6ICcnIH0pO1xuICAgICAgICAgICAgX3RoaXMuY2FyYklucHV0U3RyZWFtLm5leHQoJycpO1xuICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuY29sbGFwc2VTZWN0aW9uID0gZnVuY3Rpb24gKGUsIHR5cGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuY3VycmVudFRhcmdldC5ibHVyKCk7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2xpZ2FuZHMnKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc0xpZ0NvbGxhcHNlZDogIV90aGlzLnN0YXRlLmlzTGlnQ29sbGFwc2VkIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc0NhcmJDb2xsYXBzZWQ6ICFfdGhpcy5zdGF0ZS5pc0NhcmJDb2xsYXBzZWQgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLnNlY3Rpb25IZWFkZXIgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgdmFyIHNob3dIaWRlQWxsQ29udHJvbHMgPSAodHlwZSA9PT0gJ2xpZ2FuZHMnKSA/IF90aGlzLnNob3dIaWRlQWxsQ29udHJvbHMoJ2xpZ2FuZHMnKSA6IF90aGlzLnNob3dIaWRlQWxsQ29udHJvbHMoJ2NhcmJvaHlkcmF0ZXMnKTtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9ICh0eXBlID09PSAnbGlnYW5kcycpID8gJ0xpZ2FuZCcgOiAnQ2FyYm9oeWRyYXRlcyc7XG4gICAgICAgICAgICB2YXIgdmlzaWJsZVZpc3VhbHMgPSAodHlwZSA9PT0gJ2xpZ2FuZHMnKSA/IF90aGlzLnN0YXRlLmxpZ0dyb3Vwcy5sZW5ndGggOiBfdGhpcy5zdGF0ZS5jYXJiR3JvdXBzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciB0b3RhbFZpc3VhbHMgPSAodHlwZSA9PT0gJ2xpZ2FuZHMnKSA/IF90aGlzLnN0YXRlLmNvbXBvbmVudEdyb3Vwcy5saWdHcm91cHMubGVuZ3RoIDogX3RoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmNhcmJHcm91cHMubGVuZ3RoO1xuICAgICAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtZmxleC1yb3cnLCBzdHlsZTogeyBtYXJnaW5Ub3A6ICc2cHgnIH0gfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiYnV0dG9uXCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtZm9ybS1jb250cm9sIG1zcC1jb250cm9sLWJ1dHRvbi1sYWJlbCBtc3AtdHJhbnNmb3JtLWhlYWRlci1icmFuZC1ncmF5Jywgc3R5bGU6IHsgdGV4dEFsaWduOiAnbGVmdCcgfSwgb25DbGljazogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLmNvbGxhcHNlU2VjdGlvbihlLCB0eXBlKTsgfSB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShcInNwYW5cIiwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShcInN0cm9uZ1wiLCB7IGNoaWxkcmVuOiB0aXRsZSB9KSB9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJzbWFsbFwiLCB0c2xpYl8xLl9fYXNzaWduKHsgc3R5bGU6IHsgY29sb3I6ICcjN2Q5MWIwJyB9IH0sIHsgY2hpbGRyZW46IFtcIiAoIFwiLCB2aXNpYmxlVmlzdWFscywgdmlzaWJsZVZpc3VhbHMgPCB0b3RhbFZpc3VhbHMgPyBcIiAvIFwiLmNvbmNhdCh0b3RhbFZpc3VhbHMpIDogJycsIFwiIClcIl0gfSkpXSB9KSksIHZpc2libGVWaXN1YWxzID4gMSAmJiBzaG93SGlkZUFsbENvbnRyb2xzXSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQ29tcG9uZW50TGlzdENvbnRyb2xzLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS5iZWhhdmlvcnMuc2VsZWN0aW9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5jYXRlZ29yaXNlR3JvdXBzKCk7XG4gICAgICAgICAgICBfdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uYmVoYXZpb3JzLnN0YXRlLmlzQnVzeSwgZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgaXNCdXN5OiB2IH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbXBvbmVudExpc3RDb250cm9scy5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY3VzdG9tU3RhdGUgPSB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZTtcbiAgICAgICAgaWYgKGN1c3RvbVN0YXRlLmV2ZW50cyAmJiAhdGhpcy5zdGF0ZS5zZWdtZW50V2F0Y2gpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzZWdtZW50V2F0Y2g6IHRydWUgfSk7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZShjdXN0b21TdGF0ZS5ldmVudHMuc2VnbWVudFVwZGF0ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmNhdGVnb3Jpc2VHcm91cHMoKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5saWdJbnB1dFN0cmVhbS5waXBlKCgwLCBvcGVyYXRvcnNfMS5kZWJvdW5jZVRpbWUpKDEwMDAgLyAyNCkpLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuaGFuZGxlTGlnSW5wdXRTdHJlYW0oZSk7IH0pO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLmNhcmJJbnB1dFN0cmVhbS5waXBlKCgwLCBvcGVyYXRvcnNfMS5kZWJvdW5jZVRpbWUpKDEwMDAgLyAyNCkpLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQ2FyYklucHV0U3RyZWFtKGUpOyB9KTtcbiAgICB9O1xuICAgIENvbXBvbmVudExpc3RDb250cm9scy5wcm90b3R5cGUuY2F0ZWdvcmlzZUdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudEdyb3Vwc1ZhbCA9IHsgbm9uTGlnR3JvdXBzOiBbXSwgbGlnR3JvdXBzOiBbXSwgY2FyYkdyb3VwczogW10sIGFscGhhZm9sZDogW10gfTtcbiAgICAgICAgdmFyIGNvbXBvbmVudEdyb3VwcyA9IHRoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5oaWVyYXJjaHkuY3VycmVudENvbXBvbmVudEdyb3VwcztcbiAgICAgICAgdmFyIGN1c3RvbVN0YXRlID0gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGU7XG4gICAgICAgIGNvbXBvbmVudEdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChnKSB7XG4gICAgICAgICAgICB2YXIgaXNMaWdhbmRWaWV3ID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoY3VzdG9tU3RhdGUuaW5pdFBhcmFtcyAmJiBjdXN0b21TdGF0ZS5pbml0UGFyYW1zLnN1cGVycG9zaXRpb25QYXJhbXMgJiYgY3VzdG9tU3RhdGUuaW5pdFBhcmFtcy5zdXBlcnBvc2l0aW9uUGFyYW1zLmxpZ2FuZFZpZXcpIHtcbiAgICAgICAgICAgICAgICBpc0xpZ2FuZFZpZXcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzTGlnYW5kVmlldykge1xuICAgICAgICAgICAgICAgIHZhciBnS2V5cyA9IGdbMF0ua2V5LnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgdmFyIGNJZDFBcnIgPSBnS2V5c1swXS5zcGxpdCgnLScpO1xuICAgICAgICAgICAgICAgIGlmIChnS2V5cy5pbmRleE9mKCdzdXBlcnBvc2l0aW9uLWZvY3VzLXN1cnItc2VsJykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjSWQxQXJyW2NJZDFBcnIubGVuZ3RoIC0gMV0gIT09IChjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuYWN0aXZlU2VnbWVudCAtIDEpICsgJycpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGlmIChnS2V5cy5pbmRleE9mKCdzdXBlcnBvc2l0aW9uLWxpZ2FuZC1zZWwnKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRHcm91cHNWYWwubGlnR3JvdXBzLnB1c2goZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZ0tleXMuaW5kZXhPZignc3VwZXJwb3NpdGlvbi1jYXJiLXNlbCcpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudEdyb3Vwc1ZhbC5jYXJiR3JvdXBzLnB1c2goZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZ0tleXMuaW5kZXhPZignYWxwaGFmb2xkLWNoYWluJykgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50R3JvdXBzVmFsLmFscGhhZm9sZC5wdXNoKGcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50R3JvdXBzVmFsLm5vbkxpZ0dyb3Vwcy5wdXNoKGcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRHcm91cHNWYWwubm9uTGlnR3JvdXBzLnB1c2goZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGdLZXlzID0gZ1swXS5rZXkuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICBpZiAoZ0tleXMuaW5kZXhPZignc3VwZXJwb3NpdGlvbi1mb2N1cy1zdXJyLXNlbCcpID49IDAgfHwgZ0tleXMuaW5kZXhPZihcIkNoYWluLVwiLmNvbmNhdChjdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGUuYWN0aXZlU2VnbWVudCAtIDEpKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudEdyb3Vwc1ZhbC5ub25MaWdHcm91cHMucHVzaChnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZ0tleXMuaW5kZXhPZignYWxwaGFmb2xkLWNoYWluJykgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRHcm91cHNWYWwuYWxwaGFmb2xkLnB1c2goZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNvbXBvbmVudEdyb3VwczogY29tcG9uZW50R3JvdXBzVmFsLCBsaWdHcm91cHM6IGNvbXBvbmVudEdyb3Vwc1ZhbC5saWdHcm91cHMsIGNhcmJHcm91cHM6IGNvbXBvbmVudEdyb3Vwc1ZhbC5jYXJiR3JvdXBzLCBsaWdTZWFyY2hUZXh0OiAnJywgY2FyYlNlYXJjaFRleHQ6ICcnIH0pO1xuICAgIH07XG4gICAgQ29tcG9uZW50TGlzdENvbnRyb2xzLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBsaWdTZWFyY2hDb250cm9scyA9ICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtbWFwcGVkLXBhcmFtZXRlci1ncm91cCcsIHN0eWxlOiB7IGZvbnRTaXplOiAnOTAlJyB9IH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWNvbnRyb2wtcm93IG1zcC10cmFuc2Zvcm0taGVhZGVyLWJyYW5kLWdyYXknLCBzdHlsZTogeyBoZWlnaHQ6ICczM3B4JyB9IH0sIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwic3BhblwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWNvbnRyb2wtcm93LWxhYmVsJyB9LCB7IGNoaWxkcmVuOiBcIlNlYXJjaCBMaWdhbmRcIiB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1jb250cm9sLXJvdy1jdHJsJyB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiaW5wdXRcIiwgeyB0eXBlOiAndGV4dCcsIHBsYWNlaG9sZGVyOiAnRW50ZXIgSEVUIGNvZGUnLCBkaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0J1c3ksIG9uQ2hhbmdlOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMubGlnSW5wdXRTdHJlYW0ubmV4dChlLnRhcmdldC52YWx1ZSk7IH0sIHZhbHVlOiB0aGlzLnN0YXRlLmxpZ1NlYXJjaFRleHQsIG1heExlbmd0aDogMyB9KSB9KSldIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5JY29uQnV0dG9uLCB7IHN2ZzogaWNvbnNfMS5DbG9zZVN2ZywgZmxleDogdHJ1ZSwgb25DbGljazogdGhpcy5jbGVhckxpZ1NlYXJjaCwgc3R5bGU6IHsgZmxleDogJzAgMCAyNHB4JywgcGFkZGluZzogMCB9LCBkaXNhYmxlZDogdGhpcy5zdGF0ZS5saWdTZWFyY2hUZXh0ID09PSAnJyB8fCB0aGlzLnN0YXRlLmlzQnVzeSwgdG9nZ2xlU3RhdGU6IHRoaXMuc3RhdGUubGlnU2VhcmNoVGV4dCAhPT0gJycsIHRpdGxlOiAnQ2xlYXIgc2VhcmNoIGlucHV0JyB9KV0gfSkpO1xuICAgICAgICB2YXIgY2FyYlNlYXJjaENvbnRyb2xzID0gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1tYXBwZWQtcGFyYW1ldGVyLWdyb3VwJywgc3R5bGU6IHsgZm9udFNpemU6ICc5MCUnIH0gfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1yb3cgbXNwLXRyYW5zZm9ybS1oZWFkZXItYnJhbmQtZ3JheScsIHN0eWxlOiB7IGhlaWdodDogJzMzcHgnIH0gfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJzcGFuXCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1yb3ctbGFiZWwnIH0sIHsgY2hpbGRyZW46IFwiU2VhcmNoIENhcmJvaHlkcmF0ZVwiIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWNvbnRyb2wtcm93LWN0cmwnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJpbnB1dFwiLCB7IHR5cGU6ICd0ZXh0JywgcGxhY2Vob2xkZXI6ICdFbnRlciBIRVQgY29kZScsIGRpc2FibGVkOiB0aGlzLnN0YXRlLmlzQnVzeSwgb25DaGFuZ2U6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5jYXJiSW5wdXRTdHJlYW0ubmV4dChlLnRhcmdldC52YWx1ZSk7IH0sIHZhbHVlOiB0aGlzLnN0YXRlLmNhcmJTZWFyY2hUZXh0LCBtYXhMZW5ndGg6IDMgfSkgfSkpXSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29tbW9uXzEuSWNvbkJ1dHRvbiwgeyBzdmc6IGljb25zXzEuQ2xvc2VTdmcsIGZsZXg6IHRydWUsIG9uQ2xpY2s6IHRoaXMuY2xlYXJDYXJiU2VhcmNoLCBzdHlsZTogeyBmbGV4OiAnMCAwIDI0cHgnLCBwYWRkaW5nOiAwIH0sIGRpc2FibGVkOiB0aGlzLnN0YXRlLmNhcmJTZWFyY2hUZXh0ID09PSAnJyB8fCB0aGlzLnN0YXRlLmlzQnVzeSwgdG9nZ2xlU3RhdGU6IHRoaXMuc3RhdGUuY2FyYlNlYXJjaFRleHQgIT09ICcnLCB0aXRsZTogJ0NsZWFyIHNlYXJjaCBpbnB1dCcgfSldIH0pKTtcbiAgICAgICAgdmFyIGxpZ1NlY3Rpb25IZWFkZXIgPSB0aGlzLnNlY3Rpb25IZWFkZXIoJ2xpZ2FuZHMnKTtcbiAgICAgICAgdmFyIGNhcmJTZWN0aW9uSGVhZGVyID0gdGhpcy5zZWN0aW9uSGVhZGVyKCdjYXJib2h5ZHJhdGVzJyk7XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3hzKShqc3hfcnVudGltZV8xLkZyYWdtZW50LCB7IGNoaWxkcmVuOiBbKHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLm5vbkxpZ0dyb3Vwcy5sZW5ndGggPiAwKSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHsgY2hpbGRyZW46IHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLm5vbkxpZ0dyb3Vwcy5tYXAoZnVuY3Rpb24gKGcpIHsgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkoU3RydWN0dXJlQ29tcG9uZW50R3JvdXAsIHsgZ3JvdXA6IGcsIGJvbGRIZWFkZXI6IHRydWUgfSwgZ1swXS5jZWxsLnRyYW5zZm9ybS5yZWYpOyB9KSB9KSwgKHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmFscGhhZm9sZC5sZW5ndGggPiAwKSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHsgY2hpbGRyZW46IHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmFscGhhZm9sZC5tYXAoZnVuY3Rpb24gKGcpIHsgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkoU3RydWN0dXJlQ29tcG9uZW50R3JvdXAsIHsgZ3JvdXA6IGcsIGJvbGRIZWFkZXI6IHRydWUsIHR5cGU6ICdhbHBoYWZvbGQnIH0sIGdbMF0uY2VsbC50cmFuc2Zvcm0ucmVmKTsgfSkgfSksICh0aGlzLnN0YXRlLmNvbXBvbmVudEdyb3Vwcy5saWdHcm91cHMubGVuZ3RoID4gMCkgJiYgbGlnU2VjdGlvbkhlYWRlciwgKCF0aGlzLnN0YXRlLmlzTGlnQ29sbGFwc2VkICYmIHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmxpZ0dyb3Vwcy5sZW5ndGggPiA1KSAmJiBsaWdTZWFyY2hDb250cm9scywgKHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmxpZ0dyb3Vwcy5sZW5ndGggPiAwKSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1vZmZzZXQnLCBzdHlsZTogeyBtYXhIZWlnaHQ6ICc4MDBweCcsIG92ZXJmbG93WTogJ2F1dG8nIH0gfSwgeyBjaGlsZHJlbjogIXRoaXMuc3RhdGUuaXNMaWdDb2xsYXBzZWQgJiYgdGhpcy5zdGF0ZS5saWdHcm91cHMubWFwKGZ1bmN0aW9uIChnKSB7IHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFN0cnVjdHVyZUNvbXBvbmVudEdyb3VwLCB7IGdyb3VwOiBnLCBib2xkSGVhZGVyOiBmYWxzZSB9LCBnWzBdLmNlbGwudHJhbnNmb3JtLnJlZik7IH0pIH0pKSwgKHRoaXMuc3RhdGUuY29tcG9uZW50R3JvdXBzLmNhcmJHcm91cHMubGVuZ3RoID4gMCkgJiYgY2FyYlNlY3Rpb25IZWFkZXIsICghdGhpcy5zdGF0ZS5pc0NhcmJDb2xsYXBzZWQgJiYgdGhpcy5zdGF0ZS5jb21wb25lbnRHcm91cHMuY2FyYkdyb3Vwcy5sZW5ndGggPiA1KSAmJiBjYXJiU2VhcmNoQ29udHJvbHMsICh0aGlzLnN0YXRlLmNvbXBvbmVudEdyb3Vwcy5jYXJiR3JvdXBzLmxlbmd0aCA+IDApICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1jb250cm9sLW9mZnNldCcsIHN0eWxlOiB7IG1heEhlaWdodDogJzgwMHB4Jywgb3ZlcmZsb3dZOiAnYXV0bycgfSB9LCB7IGNoaWxkcmVuOiAhdGhpcy5zdGF0ZS5pc0NhcmJDb2xsYXBzZWQgJiYgdGhpcy5zdGF0ZS5jYXJiR3JvdXBzLm1hcChmdW5jdGlvbiAoZykgeyByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4KShTdHJ1Y3R1cmVDb21wb25lbnRHcm91cCwgeyBncm91cDogZywgYm9sZEhlYWRlcjogZmFsc2UgfSwgZ1swXS5jZWxsLnRyYW5zZm9ybS5yZWYpOyB9KSB9KSldIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIENvbXBvbmVudExpc3RDb250cm9scztcbn0oYmFzZV8xLlB1cmVQbHVnaW5VSUNvbXBvbmVudCkpO1xudmFyIFN0cnVjdHVyZUNvbXBvbmVudEdyb3VwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN0cnVjdHVyZUNvbXBvbmVudEdyb3VwLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN0cnVjdHVyZUNvbXBvbmVudEdyb3VwKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBhY3Rpb246IHZvaWQgMCxcbiAgICAgICAgICAgIGlzSGlkZGVuOiBmYWxzZSxcbiAgICAgICAgICAgIGlzQnVzeTogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuY2hlY2tBbGxIaWRkZW4gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhbGxIaWRkZW4sIF9pLCBfYSwgYztcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIGFsbEhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9yIChfaSA9IDAsIF9hID0gdGhpcy5wcm9wcy5ncm91cDsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYyA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjLmNlbGwuc3RhdGUuaXNIaWRkZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbEhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFsbEhpZGRlbilcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgfTtcbiAgICAgICAgX3RoaXMudG9nZ2xlVmlzaWJsZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICAgICAgX3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5jb21wb25lbnQudG9nZ2xlVmlzaWJpbGl0eShfdGhpcy5wcm9wcy5ncm91cCk7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiAhX3RoaXMuc3RhdGUuaXNIaWRkZW4gfSk7XG4gICAgICAgICAgICBpZiAoX3RoaXMucHJvcHMudHlwZSA9PT0gJ2FscGhhZm9sZCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BTdGF0ZSA9IF90aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgICAgICAgICAgc3BTdGF0ZS5hbHBoYWZvbGQudmlzaWJpbGl0eVtzcFN0YXRlLmFjdGl2ZVNlZ21lbnQgLSAxXSA9IF90aGlzLnN0YXRlLmlzSGlkZGVuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy50b2dnbGVBY3Rpb24gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zZXRTdGF0ZSh7IGFjdGlvbjogX3RoaXMuc3RhdGUuYWN0aW9uID09PSAnYWN0aW9uJyA/IHZvaWQgMCA6ICdhY3Rpb24nIH0pOyB9O1xuICAgICAgICBfdGhpcy5oaWdobGlnaHQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaWYgKCFfdGhpcy5wcm9wcy5ncm91cFswXS5jZWxsLnBhcmVudClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkludGVyYWN0aXZpdHkuT2JqZWN0LkhpZ2hsaWdodChfdGhpcy5wbHVnaW4sIHsgc3RhdGU6IF90aGlzLnByb3BzLmdyb3VwWzBdLmNlbGwucGFyZW50LCByZWY6IF90aGlzLnByb3BzLmdyb3VwLm1hcChmdW5jdGlvbiAoYykgeyByZXR1cm4gYy5jZWxsLnRyYW5zZm9ybS5yZWY7IH0pIH0pO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5jbGVhckhpZ2hsaWdodCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb21tYW5kc18xLlBsdWdpbkNvbW1hbmRzLkludGVyYWN0aXZpdHkuQ2xlYXJIaWdobGlnaHRzKF90aGlzLnBsdWdpbik7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFsbEhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gX3RoaXMucHJvcHMuZ3JvdXA7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgaWYgKCFjLmNlbGwuc3RhdGUuaXNIaWRkZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgYWxsSGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhbGxIaWRkZW4pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmhpZXJhcmNoeS50b2dnbGVWaXNpYmlsaXR5KF90aGlzLnByb3BzLmdyb3VwLCAnc2hvdycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMucGx1Z2luLm1hbmFnZXJzLmNhbWVyYS5mb2N1c1NwaGVyZXMoX3RoaXMucHJvcHMuZ3JvdXAsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgIGlmIChlLmNlbGwuc3RhdGUuaXNIaWRkZW4pXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICByZXR1cm4gKF9hID0gZS5jZWxsLm9iaikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRhdGEuYm91bmRhcnkuc3BoZXJlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cnVjdHVyZUNvbXBvbmVudEdyb3VwLnByb3RvdHlwZSwgXCJwaXZvdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZ3JvdXBbMF07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdHJ1Y3R1cmVDb21wb25lbnRHcm91cC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY2hlY2tBbGxIaWRkZW4oKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uc3RhdGUuZXZlbnRzLmNlbGwuc3RhdGVVcGRhdGVkLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIC8vIGlmIChTdGF0ZS5PYmplY3RFdmVudC5pc0NlbGwoZSwgdGhpcy5waXZvdC5jZWxsKSkgdGhpcy5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICAgICAgaWYgKCgoX2EgPSBfdGhpcy5waXZvdC5jZWxsLm9iaikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxhYmVsKSA9PT0gKChfYiA9IGUuY2VsbC5vYmopID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5sYWJlbCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWUuY2VsbC5zdGF0ZS5pc0hpZGRlbikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGlzSGlkZGVuOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmNoZWNrQWxsSGlkZGVuKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uYmVoYXZpb3JzLnN0YXRlLmlzQnVzeSwgZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgaXNCdXN5OiB2IH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmUodGhpcy5wbHVnaW4uY3VzdG9tU3RhdGUuZXZlbnRzLmlzQnVzeSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgaXNCdXN5OiBlIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN0cnVjdHVyZUNvbXBvbmVudEdyb3VwLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGNvbXBvbmVudCA9IHRoaXMucGl2b3Q7XG4gICAgICAgIHZhciBjZWxsID0gY29tcG9uZW50LmNlbGw7XG4gICAgICAgIHZhciBsYWJlbCA9IChfYSA9IGNlbGwub2JqKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubGFiZWw7XG4gICAgICAgIHZhciBsYWJlbEVsZSA9IHRoaXMucHJvcHMuYm9sZEhlYWRlciA/ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJzdHJvbmdcIiwgeyBjaGlsZHJlbjogbGFiZWwgfSkgOiBsYWJlbDtcbiAgICAgICAgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKGpzeF9ydW50aW1lXzEuRnJhZ21lbnQsIHsgY2hpbGRyZW46IFsoMCwganN4X3J1bnRpbWVfMS5qc3hzKShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLWZsZXgtcm93JyB9LCB7IGNoaWxkcmVuOiBbKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb21tb25fMS5CdXR0b24sIHRzbGliXzEuX19hc3NpZ24oeyBub092ZXJmbG93OiB0cnVlLCBjbGFzc05hbWU6ICdtc3AtY29udHJvbC1idXR0b24tbGFiZWwnLCB0aXRsZTogXCJcIi5jb25jYXQobGFiZWwsIFwiIC0gQ2xpY2sgdG8gZm9jdXMuXCIpLCBvbkNsaWNrOiB0aGlzLmZvY3VzLCBzdHlsZTogeyB0ZXh0QWxpZ246ICdsZWZ0JyB9LCBkaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0J1c3kgfSwgeyBjaGlsZHJlbjogbGFiZWxFbGUgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkljb25CdXR0b24sIHsgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5LCBzdmc6IHRoaXMuc3RhdGUuaXNIaWRkZW4gPyBpY29uc18xLlZpc2liaWxpdHlPZmZPdXRsaW5lZFN2ZyA6IGljb25zXzEuVmlzaWJpbGl0eU91dGxpbmVkU3ZnLCB0b2dnbGVTdGF0ZTogZmFsc2UsIG9uQ2xpY2s6IHRoaXMudG9nZ2xlVmlzaWJsZSwgdGl0bGU6IFwiXCIuY29uY2F0KHRoaXMuc3RhdGUuaXNIaWRkZW4gPyAnU2hvdycgOiAnSGlkZScsIFwiIGNvbXBvbmVudFwiKSwgc21hbGw6IHRydWUsIGNsYXNzTmFtZTogJ21zcC1mb3JtLWNvbnRyb2wnLCBmbGV4OiB0cnVlIH0pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKGNvbW1vbl8xLkljb25CdXR0b24sIHsgZGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5LCBzdmc6IGljb25zXzEuTW9yZUhvcml6U3ZnLCBvbkNsaWNrOiB0aGlzLnRvZ2dsZUFjdGlvbiwgdGl0bGU6ICdBY3Rpb25zJywgdG9nZ2xlU3RhdGU6IHRoaXMuc3RhdGUuYWN0aW9uID09PSAnYWN0aW9uJywgY2xhc3NOYW1lOiAnbXNwLWZvcm0tY29udHJvbCcsIGZsZXg6IHRydWUgfSldIH0pKSwgdGhpcy5zdGF0ZS5hY3Rpb24gPT09ICdhY3Rpb24nICYmICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1hY2NlbnQtb2Zmc2V0JyB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBzdHlsZTogeyBtYXJnaW5Cb3R0b206ICc2cHgnIH0gfSwgeyBjaGlsZHJlbjogY29tcG9uZW50LnJlcHJlc2VudGF0aW9ucy5tYXAoZnVuY3Rpb24gKHIpIHsgcmV0dXJuICgwLCBqc3hfcnVudGltZV8xLmpzeCkoU3RydWN0dXJlUmVwcmVzZW50YXRpb25FbnRyeSwgeyBncm91cDogX3RoaXMucHJvcHMuZ3JvdXAsIHJlcHJlc2VudGF0aW9uOiByIH0sIHIuY2VsbC50cmFuc2Zvcm0ucmVmKTsgfSkgfSkpIH0pKV0gfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3RydWN0dXJlQ29tcG9uZW50R3JvdXA7XG59KGJhc2VfMS5QdXJlUGx1Z2luVUlDb21wb25lbnQpKTtcbnZhciBTdHJ1Y3R1cmVSZXByZXNlbnRhdGlvbkVudHJ5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN0cnVjdHVyZVJlcHJlc2VudGF0aW9uRW50cnksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RydWN0dXJlUmVwcmVzZW50YXRpb25FbnRyeSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgaXNCdXN5OiBmYWxzZSxcbiAgICAgICAgICAgIGNsdXN0ZXJWYWw6IHsgY2x1c3RlcjogJ0FsbCcgfVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5yZW1vdmUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5wbHVnaW4ubWFuYWdlcnMuc3RydWN0dXJlLmNvbXBvbmVudC5yZW1vdmVSZXByZXNlbnRhdGlvbnMoX3RoaXMucHJvcHMuZ3JvdXAsIF90aGlzLnByb3BzLnJlcHJlc2VudGF0aW9uKTsgfTtcbiAgICAgICAgX3RoaXMudG9nZ2xlVmlzaWJsZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBlLmN1cnJlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICAgICAgX3RoaXMucGx1Z2luLm1hbmFnZXJzLnN0cnVjdHVyZS5jb21wb25lbnQudG9nZ2xlVmlzaWJpbGl0eShfdGhpcy5wcm9wcy5ncm91cCwgX3RoaXMucHJvcHMucmVwcmVzZW50YXRpb24pO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy51cGRhdGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlUmVwcmVzZW50YXRpb25zKF90aGlzLnByb3BzLmdyb3VwLCBfdGhpcy5wcm9wcy5yZXByZXNlbnRhdGlvbiwgcGFyYW1zKTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc2VsZWN0Q2x1c3RlciA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY2x1c3RlclZhbDogeyBjbHVzdGVyOiBwYXJhbXMuY2x1c3RlciB9IH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN0cnVjdHVyZVJlcHJlc2VudGF0aW9uRW50cnkucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5zdGF0ZS5ldmVudHMuY2VsbC5zdGF0ZVVwZGF0ZWQsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAobW9sX3N0YXRlXzEuU3RhdGUuT2JqZWN0RXZlbnQuaXNDZWxsKGUsIF90aGlzLnByb3BzLnJlcHJlc2VudGF0aW9uLmNlbGwpKVxuICAgICAgICAgICAgICAgIF90aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5iZWhhdmlvcnMuc3RhdGUuaXNCdXN5LCBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc0J1c3k6IHYgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN1YnNjcmliZSh0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5ldmVudHMuaXNCdXN5LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBpc0J1c3k6IGUgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3RydWN0dXJlUmVwcmVzZW50YXRpb25FbnRyeS5wcm90b3R5cGUudXBkYXRlUmVwcmVzZW50YXRpb25zID0gZnVuY3Rpb24gKGNvbXBvbmVudHMsIHBpdm90LCBwYXJhbXMpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGlmIChjb21wb25lbnRzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdmFyIGluZGV4ID0gY29tcG9uZW50c1swXS5yZXByZXNlbnRhdGlvbnMuaW5kZXhPZihwaXZvdCk7XG4gICAgICAgIGlmIChpbmRleCA8IDApXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHZhciBzdXBlcnBvc2l0aW9uU3RhdGUgPSB0aGlzLnBsdWdpbi5jdXN0b21TdGF0ZS5zdXBlcnBvc2l0aW9uU3RhdGU7XG4gICAgICAgIHZhciBmaWx0ZXJlZENvbXBzID0gW107XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmNsdXN0ZXJWYWwuY2x1c3RlciAhPT0gJ0FsbCcpIHtcbiAgICAgICAgICAgIHZhciBjbHVzdGVyRGF0YSA9IHN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YVtzdXBlcnBvc2l0aW9uU3RhdGUuYWN0aXZlU2VnbWVudCAtIDFdLmNsdXN0ZXJzW3BhcnNlSW50KHRoaXMuc3RhdGUuY2x1c3RlclZhbC5jbHVzdGVyKSAtIDFdO1xuICAgICAgICAgICAgZmlsdGVyZWRDb21wcyA9IGNsdXN0ZXJEYXRhLm1hcChmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiLmNvbmNhdChzLnBkYl9pZCwgXCJfXCIpLmNvbmNhdChzLnN0cnVjdF9hc3ltX2lkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGZpbHRlcmVkQ29tcHMubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdXBkYXRlID0gdGhpcy5wbHVnaW4uc3RhdGUuZGF0YS5idWlsZCgpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGNvbXBvbmVudHNfMSA9IGNvbXBvbmVudHM7IF9pIDwgY29tcG9uZW50c18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGMgPSBjb21wb25lbnRzXzFbX2ldO1xuICAgICAgICAgICAgLy8gVE9ETzogaXMgaXQgb2sgdG8gdXNlIGp1c3QgdGhlIGluZGV4IGhlcmU/IENvdWxkIHBvc3NpYmxlIGxlYWQgdG8gdWdseSBlZGdlIGNhc2VzLCBidXQgcGVyaGFwcyBub3Qgd29ydGggdGhlIHRyb3VibGUgdG8gXCJmaXhcIi5cbiAgICAgICAgICAgIHZhciByZXByID0gYy5yZXByZXNlbnRhdGlvbnNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKCFyZXByKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKHJlcHIuY2VsbC50cmFuc2Zvcm0udHJhbnNmb3JtZXIgIT09IHBpdm90LmNlbGwudHJhbnNmb3JtLnRyYW5zZm9ybWVyKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuY2x1c3RlclZhbC5jbHVzdGVyICE9PSAnQWxsJykge1xuICAgICAgICAgICAgICAgIHZhciBybUluZGV4ID0gZmlsdGVyZWRDb21wcy5pbmRleE9mKHN1cGVycG9zaXRpb25TdGF0ZS5yZWZNYXBzW3JlcHIuY2VsbC50cmFuc2Zvcm0ucGFyZW50XSk7XG4gICAgICAgICAgICAgICAgaWYgKHJtSW5kZXggPT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGRhdGVkUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6IHBhcmFtcy50eXBlID8gcGFyYW1zLnR5cGUgOiAoX2EgPSByZXByLmNlbGwucGFyYW1zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudmFsdWVzLnR5cGUsXG4gICAgICAgICAgICAgICAgY29sb3JUaGVtZTogcGFyYW1zLmNvbG9yVGhlbWUgPyBwYXJhbXMuY29sb3JUaGVtZSA6IChfYiA9IHJlcHIuY2VsbC5wYXJhbXMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi52YWx1ZXMuY29sb3JUaGVtZSxcbiAgICAgICAgICAgICAgICBzaXplVGhlbWU6IHBhcmFtcy5zaXplVGhlbWUgPyBwYXJhbXMuc2l6ZVRoZW1lIDogKF9jID0gcmVwci5jZWxsLnBhcmFtcykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLnZhbHVlcy5zaXplVGhlbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB1cGRhdGUudG8ocmVwci5jZWxsKS51cGRhdGUodXBkYXRlZFBhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVwZGF0ZS5jb21taXQoeyBjYW5VbmRvOiAnVXBkYXRlIFJlcHJlc2VudGF0aW9uJyB9KTtcbiAgICB9O1xuICAgIFN0cnVjdHVyZVJlcHJlc2VudGF0aW9uRW50cnkucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2Y7XG4gICAgICAgIHZhciByZXByID0gdGhpcy5wcm9wcy5yZXByZXNlbnRhdGlvbi5jZWxsO1xuICAgICAgICB2YXIgc3VwZXJwb3NpdGlvblN0YXRlID0gdGhpcy5wbHVnaW4uY3VzdG9tU3RhdGUuc3VwZXJwb3NpdGlvblN0YXRlO1xuICAgICAgICB2YXIgY2x1c3RlclNlbGVjdEFyciA9IFtbJ0FsbCcsICdBbGwnXV07XG4gICAgICAgIHN1cGVycG9zaXRpb25TdGF0ZS5zZWdtZW50RGF0YVtzdXBlcnBvc2l0aW9uU3RhdGUuYWN0aXZlU2VnbWVudCAtIDFdLmNsdXN0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGMsIGkpIHtcbiAgICAgICAgICAgIGNsdXN0ZXJTZWxlY3RBcnIucHVzaChbKGkgKyAxKSArICcnLCAoaSArIDEpICsgJyddKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBjbHVzdGVyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGNsdXN0ZXI6IHBhcmFtX2RlZmluaXRpb25fMS5QYXJhbURlZmluaXRpb24uU2VsZWN0KCdBbGwnLCBjbHVzdGVyU2VsZWN0QXJyLCB7IGxhYmVsOiAnU2VsZWN0IENsdXN0ZXInIH0pXG4gICAgICAgIH07XG4gICAgICAgIHZhciBpc1N1cnJWaXN1YWwgPSBmYWxzZTtcbiAgICAgICAgdmFyIGlzQWxwaGFmb2xkID0gZmFsc2U7XG4gICAgICAgIGlmIChyZXByICYmIHJlcHIub2JqKSB7XG4gICAgICAgICAgICB2YXIgcmVwck9iaiA9IHJlcHIub2JqO1xuICAgICAgICAgICAgaWYgKHJlcHJPYmoudGFncyAmJiByZXByT2JqLnRhZ3MuaW5kZXhPZignc3VwZXJwb3NpdGlvbi1mb2N1cy1zdXJyLXJlcHInKSA+PSAwKVxuICAgICAgICAgICAgICAgIGlzU3VyclZpc3VhbCA9IHRydWU7XG4gICAgICAgICAgICBpZiAocmVwck9iai50YWdzICYmIHJlcHJPYmoudGFncy5pbmRleE9mKCdhZi1zdXBlcnBvc2l0aW9uLXZpc3VhbCcpID49IDApXG4gICAgICAgICAgICAgICAgaXNBbHBoYWZvbGQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtcmVwcmVzZW50YXRpb24tZW50cnknIH0sIHsgY2hpbGRyZW46IHJlcHIucGFyZW50ICYmICgwLCBqc3hfcnVudGltZV8xLmpzeHMpKFwiZGl2XCIsIHsgY2hpbGRyZW46IFsoY2x1c3RlclNlbGVjdEFyci5sZW5ndGggPiAyICYmICFpc1N1cnJWaXN1YWwgJiYgIWlzQWxwaGFmb2xkKSAmJiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtcmVwcmVzZW50YXRpb24tZW50cnknIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkocGFyYW1ldGVyc18xLlBhcmFtZXRlckNvbnRyb2xzLCB7IHBhcmFtczogY2x1c3Rlck9wdGlvbnMsIHZhbHVlczogdGhpcy5zdGF0ZS5jbHVzdGVyVmFsLCBvbkNoYW5nZVZhbHVlczogdGhpcy5zZWxlY3RDbHVzdGVyLCBpc0Rpc2FibGVkOiB0aGlzLnN0YXRlLmlzQnVzeSB9KSB9KSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1yZXByZXNlbnRhdGlvbi1lbnRyeScgfSwgeyBjaGlsZHJlbjogKDAsIGpzeF9ydW50aW1lXzEuanN4KShwYXJhbWV0ZXJzXzEuUGFyYW1ldGVyQ29udHJvbHMsIHsgcGFyYW1zOiB7IHR5cGU6IChfYSA9IHJlcHIucGFyYW1zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZGVmaW5pdGlvbi50eXBlIH0sIHZhbHVlczogeyB0eXBlOiAoX2IgPSByZXByLnBhcmFtcykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnZhbHVlcy50eXBlIH0sIG9uQ2hhbmdlVmFsdWVzOiB0aGlzLnVwZGF0ZSwgaXNEaXNhYmxlZDogdGhpcy5zdGF0ZS5pc0J1c3kgfSkgfSkpLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3AtcmVwcmVzZW50YXRpb24tZW50cnknIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkocGFyYW1ldGVyc18xLlBhcmFtZXRlckNvbnRyb2xzLCB7IHBhcmFtczogeyBjb2xvclRoZW1lOiAoX2MgPSByZXByLnBhcmFtcykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmRlZmluaXRpb24uY29sb3JUaGVtZSB9LCB2YWx1ZXM6IHsgY29sb3JUaGVtZTogKF9kID0gcmVwci5wYXJhbXMpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC52YWx1ZXMuY29sb3JUaGVtZSB9LCBvbkNoYW5nZVZhbHVlczogdGhpcy51cGRhdGUsIGlzRGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5IH0pIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShcImRpdlwiLCB0c2xpYl8xLl9fYXNzaWduKHsgY2xhc3NOYW1lOiAnbXNwLXJlcHJlc2VudGF0aW9uLWVudHJ5JyB9LCB7IGNoaWxkcmVuOiAoMCwganN4X3J1bnRpbWVfMS5qc3gpKHBhcmFtZXRlcnNfMS5QYXJhbWV0ZXJDb250cm9scywgeyBwYXJhbXM6IHsgc2l6ZVRoZW1lOiAoX2UgPSByZXByLnBhcmFtcykgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lLmRlZmluaXRpb24uc2l6ZVRoZW1lIH0sIHZhbHVlczogeyBzaXplVGhlbWU6IChfZiA9IHJlcHIucGFyYW1zKSA9PT0gbnVsbCB8fCBfZiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2YudmFsdWVzLnNpemVUaGVtZSB9LCBvbkNoYW5nZVZhbHVlczogdGhpcy51cGRhdGUsIGlzRGlzYWJsZWQ6IHRoaXMuc3RhdGUuaXNCdXN5IH0pIH0pKV0gfSkgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN0cnVjdHVyZVJlcHJlc2VudGF0aW9uRW50cnk7XG59KGJhc2VfMS5QdXJlUGx1Z2luVUlDb21wb25lbnQpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN1cGVycG9zaXRpb24tY29tcG9uZW50cy5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/ui/superposition-components.js\n");
  
  /***/ }),
  
  /***/ "./lib/ui/superposition-viewport.js":
  /*!******************************************!*\
    !*** ./lib/ui/superposition-viewport.js ***!
    \******************************************/
  /***/ ((__unused_webpack_module, exports, __webpack_require__) => {
  
  "use strict";
  eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.SuperpostionViewport = void 0;\nvar tslib_1 = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.js\");\nvar jsx_runtime_1 = __webpack_require__(/*! react/jsx-runtime */ \"./node_modules/react/jsx-runtime.js\");\nvar base_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/base */ \"./node_modules/molstar/lib/mol-plugin-ui/base.js\");\nvar controls_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/controls */ \"./node_modules/molstar/lib/mol-plugin-ui/controls.js\");\nvar task_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/task */ \"./node_modules/molstar/lib/mol-plugin-ui/task.js\");\nvar toast_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/toast */ \"./node_modules/molstar/lib/mol-plugin-ui/toast.js\");\nvar viewport_1 = __webpack_require__(/*! Molstar/mol-plugin-ui/viewport */ \"./node_modules/molstar/lib/mol-plugin-ui/viewport.js\");\nvar SuperpostionViewport = /** @class */ (function (_super) {\n    tslib_1.__extends(SuperpostionViewport, _super);\n    function SuperpostionViewport() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SuperpostionViewport.prototype.render = function () {\n        var _a, _b;\n        var VPControls = ((_b = (_a = this.plugin.spec.components) === null || _a === void 0 ? void 0 : _a.viewport) === null || _b === void 0 ? void 0 : _b.controls) || viewport_1.ViewportControls;\n        return (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)(viewport_1.Viewport, {}), (0, jsx_runtime_1.jsx)(\"div\", tslib_1.__assign({ className: 'msp-viewport-top-left-controls' }, { children: (0, jsx_runtime_1.jsx)(controls_1.StateSnapshotViewportControls, {}) })), (0, jsx_runtime_1.jsx)(controls_1.SelectionViewportControls, {}), (0, jsx_runtime_1.jsx)(VPControls, {}), (0, jsx_runtime_1.jsx)(task_1.BackgroundTaskProgress, {}), (0, jsx_runtime_1.jsxs)(\"div\", tslib_1.__assign({ className: 'msp-highlight-toast-wrapper' }, { children: [(0, jsx_runtime_1.jsx)(controls_1.LociLabels, {}), (0, jsx_runtime_1.jsx)(toast_1.Toasts, {})] }))] });\n    };\n    return SuperpostionViewport;\n}(base_1.PluginUIComponent));\nexports.SuperpostionViewport = SuperpostionViewport;\n//# sourceMappingURL=superposition-viewport.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdWkvc3VwZXJwb3NpdGlvbi12aWV3cG9ydC5qcy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCw0QkFBNEI7QUFDNUIsY0FBYyxtQkFBTyxDQUFDLGdEQUFPO0FBQzdCLG9CQUFvQixtQkFBTyxDQUFDLDhEQUFtQjtBQUMvQyxhQUFhLG1CQUFPLENBQUMsb0ZBQTRCO0FBQ2pELGlCQUFpQixtQkFBTyxDQUFDLDRGQUFnQztBQUN6RCxhQUFhLG1CQUFPLENBQUMsb0ZBQTRCO0FBQ2pELGNBQWMsbUJBQU8sQ0FBQyxzRkFBNkI7QUFDbkQsaUJBQWlCLG1CQUFPLENBQUMsNEZBQWdDO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUseURBQXlELG9EQUFvRCw2Q0FBNkMsSUFBSSw2RUFBNkUsR0FBRyxtRUFBbUUsd0NBQXdDLDJEQUEyRCxxREFBcUQsMENBQTBDLElBQUksMkRBQTJELDRDQUE0QyxJQUFJLEtBQUs7QUFDeHFCO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsNEJBQTRCO0FBQzVCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRiZS1tb2xzdGFyLy4vbGliL3VpL3N1cGVycG9zaXRpb24tdmlld3BvcnQuanM/MGExOSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuU3VwZXJwb3N0aW9uVmlld3BvcnQgPSB2b2lkIDA7XG52YXIgdHNsaWJfMSA9IHJlcXVpcmUoXCJ0c2xpYlwiKTtcbnZhciBqc3hfcnVudGltZV8xID0gcmVxdWlyZShcInJlYWN0L2pzeC1ydW50aW1lXCIpO1xudmFyIGJhc2VfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvYmFzZVwiKTtcbnZhciBjb250cm9sc18xID0gcmVxdWlyZShcIk1vbHN0YXIvbW9sLXBsdWdpbi11aS9jb250cm9sc1wiKTtcbnZhciB0YXNrXzEgPSByZXF1aXJlKFwiTW9sc3Rhci9tb2wtcGx1Z2luLXVpL3Rhc2tcIik7XG52YXIgdG9hc3RfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvdG9hc3RcIik7XG52YXIgdmlld3BvcnRfMSA9IHJlcXVpcmUoXCJNb2xzdGFyL21vbC1wbHVnaW4tdWkvdmlld3BvcnRcIik7XG52YXIgU3VwZXJwb3N0aW9uVmlld3BvcnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU3VwZXJwb3N0aW9uVmlld3BvcnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VwZXJwb3N0aW9uVmlld3BvcnQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VwZXJwb3N0aW9uVmlld3BvcnQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgdmFyIFZQQ29udHJvbHMgPSAoKF9iID0gKF9hID0gdGhpcy5wbHVnaW4uc3BlYy5jb21wb25lbnRzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eudmlld3BvcnQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jb250cm9scykgfHwgdmlld3BvcnRfMS5WaWV3cG9ydENvbnRyb2xzO1xuICAgICAgICByZXR1cm4gKDAsIGpzeF9ydW50aW1lXzEuanN4cykoanN4X3J1bnRpbWVfMS5GcmFnbWVudCwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkodmlld3BvcnRfMS5WaWV3cG9ydCwge30pLCAoMCwganN4X3J1bnRpbWVfMS5qc3gpKFwiZGl2XCIsIHRzbGliXzEuX19hc3NpZ24oeyBjbGFzc05hbWU6ICdtc3Atdmlld3BvcnQtdG9wLWxlZnQtY29udHJvbHMnIH0sIHsgY2hpbGRyZW46ICgwLCBqc3hfcnVudGltZV8xLmpzeCkoY29udHJvbHNfMS5TdGF0ZVNuYXBzaG90Vmlld3BvcnRDb250cm9scywge30pIH0pKSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShjb250cm9sc18xLlNlbGVjdGlvblZpZXdwb3J0Q29udHJvbHMsIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4KShWUENvbnRyb2xzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkodGFza18xLkJhY2tncm91bmRUYXNrUHJvZ3Jlc3MsIHt9KSwgKDAsIGpzeF9ydW50aW1lXzEuanN4cykoXCJkaXZcIiwgdHNsaWJfMS5fX2Fzc2lnbih7IGNsYXNzTmFtZTogJ21zcC1oaWdobGlnaHQtdG9hc3Qtd3JhcHBlcicgfSwgeyBjaGlsZHJlbjogWygwLCBqc3hfcnVudGltZV8xLmpzeCkoY29udHJvbHNfMS5Mb2NpTGFiZWxzLCB7fSksICgwLCBqc3hfcnVudGltZV8xLmpzeCkodG9hc3RfMS5Ub2FzdHMsIHt9KV0gfSkpXSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTdXBlcnBvc3Rpb25WaWV3cG9ydDtcbn0oYmFzZV8xLlBsdWdpblVJQ29tcG9uZW50KSk7XG5leHBvcnRzLlN1cGVycG9zdGlvblZpZXdwb3J0ID0gU3VwZXJwb3N0aW9uVmlld3BvcnQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdXBlcnBvc2l0aW9uLXZpZXdwb3J0LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/ui/superposition-viewport.js\n");
  
  /***/ }),
  
  /***/ "./node_modules/h264-mp4-encoder/embuild/dist/h264-mp4-encoder.node.js":
  /*!*****************************************************************************!*\
    !*** ./node_modules/h264-mp4-encoder/embuild/dist/h264-mp4-encoder.node.js ***!
    \*****************************************************************************/
  /***/ ((module, __unused_webpack_exports, __webpack_require__) => {
  
  eval("module.exports=function(A){var B={};function Q(I){if(B[I])return B[I].exports;var g=B[I]={i:I,l:!1,exports:{}};return A[I].call(g.exports,g,g.exports,Q),g.l=!0,g.exports}return Q.m=A,Q.c=B,Q.d=function(A,B,I){Q.o(A,B)||Object.defineProperty(A,B,{enumerable:!0,get:I})},Q.r=function(A){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(A,\"__esModule\",{value:!0})},Q.t=function(A,B){if(1&B&&(A=Q(A)),8&B)return A;if(4&B&&\"object\"==typeof A&&A&&A.__esModule)return A;var I=Object.create(null);if(Q.r(I),Object.defineProperty(I,\"default\",{enumerable:!0,value:A}),2&B&&\"string\"!=typeof A)for(var g in A)Q.d(I,g,function(B){return A[B]}.bind(null,g));return I},Q.n=function(A){var B=A&&A.__esModule?function(){return A.default}:function(){return A};return Q.d(B,\"a\",B),B},Q.o=function(A,B){return Object.prototype.hasOwnProperty.call(A,B)},Q.p=\"\",Q(Q.s=2)}([function(A,B){A.exports=__webpack_require__(/*! path */ \"path\")},function(A,B,Q){(function(B,I){var g,E=(g=(g=\"undefined\"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||B,function(A){var B;A=A||{},B||(B=void 0!==A?A:{});var E,C={};for(E in B)B.hasOwnProperty(E)&&(C[E]=B[E]);var D,i,y,F,U=\"./this.program\";D=\"object\"==typeof window,i=\"function\"==typeof importScripts,y=\"object\"==typeof process&&\"object\"==typeof process.versions&&\"string\"==typeof process.versions.node,F=!D&&!y&&!i;var c,N,H,G,o=\"\";y?(o=i?Q(0).dirname(o)+\"/\":I+\"/\",c=function(A,B){var I=_B(A);return I?B?I:I.toString():(H||(H=Q(3)),G||(G=Q(0)),A=G.normalize(A),H.readFileSync(A,B?null:\"utf8\"))},N=function(A){return(A=c(A,!0)).buffer||(A=new Uint8Array(A)),a(A.buffer),A},1<process.argv.length&&(U=process.argv[1].replace(/\\\\/g,\"/\")),process.argv.slice(2),process.on(\"uncaughtException\",(function(A){throw A})),process.on(\"unhandledRejection\",FA),B.inspect=function(){return\"[Emscripten Module object]\"}):F?(\"undefined\"!=typeof read&&(c=function(A){var B=_B(A);return B?TB(B):read(A)}),N=function(A){var B;return(B=_B(A))?B:\"function\"==typeof readbuffer?new Uint8Array(readbuffer(A)):(a(\"object\"==typeof(B=read(A,\"binary\"))),B)},\"undefined\"!=typeof print&&(\"undefined\"==typeof console&&(console={}),console.log=print,console.warn=console.error=\"undefined\"!=typeof printErr?printErr:print)):(D||i)&&(i?o=self.location.href:document.currentScript&&(o=document.currentScript.src),g&&(o=g),o=0!==o.indexOf(\"blob:\")?o.substr(0,o.lastIndexOf(\"/\")+1):\"\",c=function(A){try{var B=new XMLHttpRequest;return B.open(\"GET\",A,!1),B.send(null),B.responseText}catch(B){if(A=_B(A))return TB(A);throw B}},i&&(N=function(A){try{var B=new XMLHttpRequest;return B.open(\"GET\",A,!1),B.responseType=\"arraybuffer\",B.send(null),new Uint8Array(B.response)}catch(B){if(A=_B(A))return A;throw B}}));var w=B.print||console.log.bind(console),Y=B.printErr||console.warn.bind(console);for(E in C)C.hasOwnProperty(E)&&(B[E]=C[E]);C=null,B.thisProgram&&(U=B.thisProgram);var s,L=0;B.wasmBinary&&(s=B.wasmBinary),B.noExitRuntime&&B.noExitRuntime,\"object\"!=typeof WebAssembly&&Y(\"no native wasm support detected\");var R,h=new WebAssembly.Table({initial:1182,maximum:1182,element:\"anyfunc\"}),k=!1;function a(A,B){A||FA(\"Assertion failed: \"+B)}var S=\"undefined\"!=typeof TextDecoder?new TextDecoder(\"utf8\"):void 0;function M(A,B,Q){var I=B+Q;for(Q=B;A[Q]&&!(Q>=I);)++Q;if(16<Q-B&&A.subarray&&S)return S.decode(A.subarray(B,Q));for(I=\"\";B<Q;){var g=A[B++];if(128&g){var E=63&A[B++];if(192==(224&g))I+=String.fromCharCode((31&g)<<6|E);else{var C=63&A[B++];65536>(g=224==(240&g)?(15&g)<<12|E<<6|C:(7&g)<<18|E<<12|C<<6|63&A[B++])?I+=String.fromCharCode(g):(g-=65536,I+=String.fromCharCode(55296|g>>10,56320|1023&g))}}else I+=String.fromCharCode(g)}return I}function J(A){return A?M(d,A,void 0):\"\"}function V(A,B,Q,I){if(!(0<I))return 0;var g=Q;I=Q+I-1;for(var E=0;E<A.length;++E){var C=A.charCodeAt(E);if(55296<=C&&57343>=C&&(C=65536+((1023&C)<<10)|1023&A.charCodeAt(++E)),127>=C){if(Q>=I)break;B[Q++]=C}else{if(2047>=C){if(Q+1>=I)break;B[Q++]=192|C>>6}else{if(65535>=C){if(Q+2>=I)break;B[Q++]=224|C>>12}else{if(Q+3>=I)break;B[Q++]=240|C>>18,B[Q++]=128|C>>12&63}B[Q++]=128|C>>6&63}B[Q++]=128|63&C}}return B[Q]=0,Q-g}function K(A){for(var B=0,Q=0;Q<A.length;++Q){var I=A.charCodeAt(Q);55296<=I&&57343>=I&&(I=65536+((1023&I)<<10)|1023&A.charCodeAt(++Q)),127>=I?++B:B=2047>=I?B+2:65535>=I?B+3:B+4}return B}var t,n,d,r,e,l,x,Z,f,b=\"undefined\"!=typeof TextDecoder?new TextDecoder(\"utf-16le\"):void 0;function p(A){var B;for(B=A>>1;r[B];)++B;if(32<(B<<=1)-A&&b)return b.decode(d.subarray(A,B));B=0;for(var Q=\"\";;){var I=r[A+2*B>>1];if(0==I)return Q;++B,Q+=String.fromCharCode(I)}}function q(A,B,Q){if(void 0===Q&&(Q=2147483647),2>Q)return 0;var I=B;Q=(Q-=2)<2*A.length?Q/2:A.length;for(var g=0;g<Q;++g)r[B>>1]=A.charCodeAt(g),B+=2;return r[B>>1]=0,B-I}function u(A){return 2*A.length}function O(A){for(var B=0,Q=\"\";;){var I=l[A+4*B>>2];if(0==I)return Q;++B,65536<=I?(I-=65536,Q+=String.fromCharCode(55296|I>>10,56320|1023&I)):Q+=String.fromCharCode(I)}}function m(A,B,Q){if(void 0===Q&&(Q=2147483647),4>Q)return 0;var I=B;Q=I+Q-4;for(var g=0;g<A.length;++g){var E=A.charCodeAt(g);if(55296<=E&&57343>=E&&(E=65536+((1023&E)<<10)|1023&A.charCodeAt(++g)),l[B>>2]=E,(B+=4)+4>Q)break}return l[B>>2]=0,B-I}function W(A){for(var B=0,Q=0;Q<A.length;++Q){var I=A.charCodeAt(Q);55296<=I&&57343>=I&&++Q,B+=4}return B}function X(A){t=A,B.HEAP8=n=new Int8Array(A),B.HEAP16=r=new Int16Array(A),B.HEAP32=l=new Int32Array(A),B.HEAPU8=d=new Uint8Array(A),B.HEAPU16=e=new Uint16Array(A),B.HEAPU32=x=new Uint32Array(A),B.HEAPF32=Z=new Float32Array(A),B.HEAPF64=f=new Float64Array(A)}var j=B.INITIAL_MEMORY||16777216;function z(A){for(;0<A.length;){var Q=A.shift();if(\"function\"==typeof Q)Q(B);else{var I=Q.ob;\"number\"==typeof I?void 0===Q.ua?B.dynCall_v(I):B.dynCall_vi(I,Q.ua):I(void 0===Q.ua?null:Q.ua)}}}(R=B.wasmMemory?B.wasmMemory:new WebAssembly.Memory({initial:j/65536,maximum:32768}))&&(t=R.buffer),j=t.byteLength,X(t),l[22752]=5334064;var v=[],T=[],P=[],_=[],$=[];function AA(){var A=B.preRun.shift();v.unshift(A)}var BA=Math.abs,QA=Math.ceil,IA=Math.floor,gA=Math.min,EA=0,CA=null,DA=null;function iA(){EA++,B.monitorRunDependencies&&B.monitorRunDependencies(EA)}function yA(){if(EA--,B.monitorRunDependencies&&B.monitorRunDependencies(EA),0==EA&&(null!==CA&&(clearInterval(CA),CA=null),DA)){var A=DA;DA=null,A()}}function FA(A){throw B.onAbort&&B.onAbort(A),w(A),Y(A),k=!0,new WebAssembly.RuntimeError(\"abort(\"+A+\"). Build with -s ASSERTIONS=1 for more info.\")}function UA(A,B){return String.prototype.startsWith?A.startsWith(B):0===A.indexOf(B)}B.preloadedImages={},B.preloadedAudios={};var cA,NA,HA=\"data:application/octet-stream;base64,\",GA=\"data:application/octet-stream;base64,AGFzbQEAAAABqwVRYAF/AX9gAX8AYAJ/fwBgAn9/AX9gA39/fwF/YAN/f38AYAAAYAR/f39/AGAFf39/f38Bf2AGf39/f39/AX9gBH9/f38Bf2AFf39/f38AYAZ/f39/f38AYAABf2AIf39/f39/f38Bf2AHf39/f39/fwF/YAV/f35/fgF/YAd/f39/f39/AGAKf39/f39/f39/fwBgAn9+AX9gBX9/fn9/AGAFf39/f34Bf2ACf38BfmAIf39/f39/f38AYAN/fn8AYAV/fn5+fgBgC39/f39/f39/f39/AX9gA39+fwF+YAJ/fgBgDH9/f39/f39/f39/fwF/YAV/f39/fAF/YAR/f39/AX5gAn99AGAKf39/f39/f39/fwF/YAF/AX5gD39/f39/f39/f39/f39/fwBgBH9+fn8AYAd/f39/f35+AX9gBn9/f39+fgF/YAZ/fH9/f38Bf2ABfwF9YAt/f39/f39/f39/fwBgEH9/f39/f39/f39/f39/f38AYAd/f39/fn5/AGADf39+AGAJf39/f39/f39/AX9gBn9/f39/fAF/YAl/f35/f39/f38Bf2ADf399AX9gA39+fwF/YAd/fn9/f39/AX9gAn99AX9gAn5/AX9gAn5+AX9gAAF+YAR/f39+AX5gA39/fwF9YAR/f39/AX1gA39/fwF8YAR/f39/AXxgDX9/f39/f39/f39/f38AYAR/f39+AGAFf39/fn8AYAZ/f39+fn8AYAR/f399AGAEf39+fwBgA39+fgBgA399fwBgAn98AGANf39/f39/f39/f39/fwF/YAV/f35/fwF/YAd/f3x/f39/AX9gA35/fwF/YAR+fn5+AX9gBX9/f39/AX5gAn9/AX1gAn5+AX1gAX8BfGACf38BfGACfn4BfGACfH8BfALhDk4DZW52Fl9lbWJpbmRfcmVnaXN0ZXJfY2xhc3MAPANlbnYiX2VtYmluZF9yZWdpc3Rlcl9jbGFzc19jb25zdHJ1Y3RvcgAMA2Vudh9fZW1iaW5kX3JlZ2lzdGVyX2NsYXNzX3Byb3BlcnR5ABIDZW52H19lbWJpbmRfcmVnaXN0ZXJfY2xhc3NfZnVuY3Rpb24AFwNlbnYFYWJvcnQABgNlbnYKaW52b2tlX3ZpaQAFA2VudhtfX2N4YV9maW5kX21hdGNoaW5nX2NhdGNoXzIADQNlbnYLZ2V0VGVtcFJldDAADQNlbnYRX19yZXN1bWVFeGNlcHRpb24AAQNlbnYNX19hc3NlcnRfZmFpbAAHA2VudghpbnZva2VfdgABA2VudhtfX2N4YV9maW5kX21hdGNoaW5nX2NhdGNoXzMAAANlbnYRX19jeGFfYmVnaW5fY2F0Y2gAAANlbnYJaW52b2tlX2lpAAMDZW52GF9fY3hhX2FsbG9jYXRlX2V4Y2VwdGlvbgAAA2VudglpbnZva2VfdmkAAgNlbnYNaW52b2tlX2lpaWlpaQAJA2VudgtfX2N4YV90aHJvdwAFA2VudgtpbnZva2VfdmlpaQAHA2VudhRfX2N4YV9mcmVlX2V4Y2VwdGlvbgABA2VudgtpbnZva2VfaWlpaQAKA2VudgppbnZva2VfaWlpAAQDZW52Dmludm9rZV9paWlpaWlpAA8DZW52D19fY3hhX2VuZF9jYXRjaAAGA2VudhtfX2N4YV9maW5kX21hdGNoaW5nX2NhdGNoXzQAAwNlbnYSbGx2bV9laF90eXBlaWRfZm9yAAADZW52DGludm9rZV9paWlpaQAIA2VudghpbnZva2VfaQAAA2VudgxpbnZva2VfdmlpaWkACwNlbnYbX19jeGFfZmluZF9tYXRjaGluZ19jYXRjaF81AAQDZW52F19fY3hhX2dldF9leGNlcHRpb25fcHRyAAADZW52Emludm9rZV92aWlpaWlpaWlpaQApA2Vudg9pbnZva2VfaWlpaWlpaWkADgNlbnYPaW52b2tlX3ZpaWlpaWlpABcDZW52DWludm9rZV92aWlpaWkADANlbnYKaW52b2tlX2lpZgAwA2Vudg1fX2N4YV9yZXRocm93AAYDZW52DGdldHRpbWVvZmRheQADA2VudgxfX3N5c19zdGF0NjQAAwNlbnYKX19zeXNfb3BlbgAEA2Vudg1fX3N5c19mY250bDY0AAQDZW52C19fc3lzX2lvY3RsAAQWd2FzaV9zbmFwc2hvdF9wcmV2aWV3MQhmZF9jbG9zZQAAFndhc2lfc25hcHNob3RfcHJldmlldzEHZmRfcmVhZAAKFndhc2lfc25hcHNob3RfcHJldmlldzEIZmRfd3JpdGUACgNlbnYZX19jeGFfdW5jYXVnaHRfZXhjZXB0aW9ucwANA2Vudg1pbnZva2VfaWlpaWlkAC4DZW52C2ludm9rZV9maWlpADkDZW52C2ludm9rZV9kaWlpADsWd2FzaV9zbmFwc2hvdF9wcmV2aWV3MRFlbnZpcm9uX3NpemVzX2dldAADFndhc2lfc25hcHNob3RfcHJldmlldzELZW52aXJvbl9nZXQAAwNlbnYKX19tYXBfZmlsZQADA2VudgxfX3N5c19tdW5tYXAAAwNlbnYKc3RyZnRpbWVfbAAIA2VudhNpbnZva2VfaWlpaWlpaWlpaWlpAB0DZW52F2ludm9rZV92aWlpaWlpaWlpaWlpaWlpACoDZW52FV9lbWJpbmRfcmVnaXN0ZXJfdm9pZAACA2VudhVfZW1iaW5kX3JlZ2lzdGVyX2Jvb2wACwNlbnYbX2VtYmluZF9yZWdpc3Rlcl9zdGRfc3RyaW5nAAIDZW52HF9lbWJpbmRfcmVnaXN0ZXJfc3RkX3dzdHJpbmcABQNlbnYWX2VtYmluZF9yZWdpc3Rlcl9lbXZhbAACA2VudhhfZW1iaW5kX3JlZ2lzdGVyX2ludGVnZXIACwNlbnYWX2VtYmluZF9yZWdpc3Rlcl9mbG9hdAAFA2VudhxfZW1iaW5kX3JlZ2lzdGVyX21lbW9yeV92aWV3AAUDZW52FmVtc2NyaXB0ZW5fcmVzaXplX2hlYXAAAANlbnYVZW1zY3JpcHRlbl9tZW1jcHlfYmlnAAQDZW52C3NldFRlbXBSZXQwAAEDZW52EWludm9rZV9paWlqaWlpaWlpABoDZW52D2ludm9rZV92aWlpaWpqaQASA2VudgtpbnZva2VfdmlqaQALA2VudgppbnZva2VfamlpAAQDZW52Cmludm9rZV9paWoACgNlbnYNaW52b2tlX3ZpaWppaQARFndhc2lfc25hcHNob3RfcHJldmlldzEHZmRfc2VlawAIA2Vudg1pbnZva2VfaWlpaWlqAA8DZW52DGludm9rZV9qaWlpaQAIA2VudgZtZW1vcnkCAYACgIACA2VudgV0YWJsZQFwAJ4JA+4M7AwGBgABAA0AAgMFAAIDBQACAAIAAgACAAIAAgACAwUAAgACAgIFCgkEAgIDFwUBAgwCBAUBAgIBAAEHCwoCBQUOCQwBBwwDAggAAQIEAgAJAgABAQABFAcAAwMJAwMDAwEDBRgFAwMBAQEAAAIFAQUHAgICCwsHEQQCAgQEAgMBAQMBAQMBAwEDAQIBBQMCAQQBBQ0AAQEBADIHBwoBBQMDAgACAwEFBAMBAwEDBAEDAQMBBAEDAQMBAwEEAQEDBAIBAQIEAQMBAwEDAQEDAwEDAQUDAgEBAwEDAQQBAQMBAQMDAQMBAwEDAgEBAwIDAUMBAwEDAwEDAwABAQAABQUDAQMBAQEBAQEDAQQBAwMBAwEDAQEDAQMBAAIDAQMBAQMBAQEDAQMCAQEDAgEDAgEDAQMBAwEEBAEAAwEEBAEDBQIBBQEBAwMKCgEBAQICAQcHBQACAAIFBQUEAAECCgECAgcCBRYYFgcHBQAAAAAiAgICAhwoICggKCAAAgoLFhgAAgYBBgcCAgIBAAADAAUHEgsKAwIHBQUCBQIDBwMAPQIDBUBGLwcDBysYAgoDAwIAAQABAQEBAQEBBgICAQYCAgEGAgIBBgICAQYCAgEGAgIBAQYEChYYBQcHBwcHBQUHBQUHCQABAgIFBQUHCAABAgICBwUCBQUHCgABAgoFBQUFBw8AAwEDBQEKBQUHCgcAAAUCBQoHCgAFBQEAAQAAAgUFAAECAgUFAAEAAgUFAAEABQUBAAICBQUAAAEAAgIAAAAAAgIEAAEAAQEFBz8FHCwFABwCAwIBACIiAwMADTYAAwIDAQMDAwEDAQQFBQQDAwIDBAMEAQQAAQIEAAAEExAQAAMNAAABAAAAAQEBAAECBBQGBwADAwoAAQQTEBAAAwMEExAQAAMDAQENNgAAAwAAAAAEBAMEAwMCBQMAAw0KBAIBAjExAAoAAwMCAAQEBAQEBANQCA8FAAcLNEg0BCcCBQQAHAA3ChkkBwwRFgQDLBsbACIAAAAEAgAAGSRJNRlEIAICJBlCGU9MAgQNAQACAAABAAQUAAcEAwUDAAAAAwQFAAABAQQAAQIAAwADAAQAAwIAAwABAQMAAAMDAgAJAwMFBAIUAxwAAwAEAAMDAAADAAABAQAAAAAICAMDExUzHgMFBAMAAAABAQEABQMEAAEDAwEGAAICAwUAAAMDAgQDBgADAAQEAwoBAA0NDQQICggEDQQANx8fSwdOBQcIBwUECAcFBAkBAAICDwMDBAIDAAMBAAkIAAUAAAIhCgcJCB8JCAoJCAoJCAkIHwkICx04CQg6CQgHCQoNCgEAAAAEAwEJAA8DCQgDBSEJCAkICQgJCAkICQgLHQkICQgJCgQAAAIDCAAAAwEDCAcIBBECABUIFR4EAAoRBAAmCAgAAQgRCQIEFQgVHhEmCAICDgMJCQkMCQwJCwgOBwsLCwsLCwcMCwsLDgMJCQkMCQwJCwgOBwsLCwsLCwcMCwsLDwwCAw8MAwgBAAICAgACDxoSBQMEBQUPAQQCAgIEAAICAgAABAMAAg8aEgUEDwEEBAACAAQDAgIlABIjAgQJJRIjBAkABAQMAAoCDAAKAAoBAAYAAwICAgYCBgIGAgYCBgICAgICAgIGAgYCBgIGAgYCBgIGAgYCAgIGAgYCBgIGAgEAAgIBAAECAAUGBgYGBgYGBgYGBgYGBgYGBgENAwEBDQADAgEAAQIDDQMNAQMBAgEBBA0KCgoDDQQDDQQDCgQIAAEDBAMECgQIDggIAwMBDgkKDgkICAAKAAgKAA4JDgkIBA4JDgkIBAABAAEAAAICAgIDAgICAAYBAAYBAgAGAQAGAQAGAQAGAQABAAEAAQABAAEAAQABAAEDAAIBAQAFAgUEAAMCBAIBAAUCAwECBQAAAgIBAwADCgICAQAEAQcAAgEDAAAFBAQEAgYAAAMCAwMEBAEDBQACBBcFBQILBQQCAQUFBRcLBQQCBQMFBAQCAwUDBQABBgIAAwAAAQEBDQYABgEGAAEAAAEBAAEBAAQEBAMFBwcHBwMEAwMHBQsMCwsLDAwMBAAAAAYGBgYGBgYGBgYGBgYBAQEBAQEGBgYGAAABAwMAAwIAGU01BAQFAAIEBAIAAQIFBwsMFykqAwQKCAkPDhodRS4wOTsNAAEARy0REhELDxoKBAgOCC0hMkEWPkoGEAJ/AUGwyMUCC38AQfTGBQsH3Ac2EV9fd2FzbV9jYWxsX2N0b3JzAEwGbWFsbG9jAPUMBGZyZWUA9gwQX19lcnJub19sb2NhdGlvbgCMBghzZXRUaHJldwDZBhlfWlN0MTh1bmNhdWdodF9leGNlcHRpb252ANsGD19fY3hhX2Nhbl9jYXRjaADZDBVfX2N4YV9pc19wb2ludGVyX3R5cGUA2gwNX19nZXRUeXBlTmFtZQDcDCpfX2VtYmluZF9yZWdpc3Rlcl9uYXRpdmVfYW5kX2J1aWx0aW5fdHlwZXMA3QwKX19kYXRhX2VuZAMBCWR5bkNhbGxfdgCJDQpkeW5DYWxsX3ZpAIoNC2R5bkNhbGxfdmlpAIsNDGR5bkNhbGxfdmlpaQCMDQ1keW5DYWxsX3ZpaWlpAI0NDmR5bkNhbGxfdmlpaWlpAI4NEGR5bkNhbGxfdmlpaWlpaWkAjw0TZHluQ2FsbF92aWlpaWlpaWlpaQCQDRhkeW5DYWxsX3ZpaWlpaWlpaWlpaWlpaWkAkQ0QZHluQ2FsbF92aWlpaWpqaQCnDQ5keW5DYWxsX3ZpaWppaQCoDQxkeW5DYWxsX3ZpamkAqQ0JZHluQ2FsbF9pAFAKZHluQ2FsbF9paQCSDQtkeW5DYWxsX2lpaQCTDQxkeW5DYWxsX2lpaWkAlA0NZHluQ2FsbF9paWlpaQCVDQ5keW5DYWxsX2lpaWlpaQCWDQ9keW5DYWxsX2lpaWlpaWkAlw0QZHluQ2FsbF9paWlpaWlpaQCYDRNkeW5DYWxsX2lpaWlpaWlpaWlpAJkNFGR5bkNhbGxfaWlpaWlpaWlpaWlpAJoNFWR5bkNhbGxfaWlpaWlpaWlpaWlpaQCbDQ5keW5DYWxsX2lpaWlpagCqDQ5keW5DYWxsX2lpaWlpZACcDRJkeW5DYWxsX2lpaWppaWlpaWkAqw0LZHluQ2FsbF9paWoArA0LZHluQ2FsbF9paWYAnQ0LZHluQ2FsbF9qaWkArQ0NZHluQ2FsbF9qaWlpaQCuDQxkeW5DYWxsX2ZpaWkAng0MZHluQ2FsbF9kaWlpAJ8NCXN0YWNrU2F2ZQCgDQpzdGFja0FsbG9jAKENDHN0YWNrUmVzdG9yZQCiDRBfX2dyb3dXYXNtTWVtb3J5AKMNDmR5bkNhbGxfaWlpamlqAK8NDGR5bkNhbGxfamlqaQCwDQ9keW5DYWxsX2lpZGlpaWkApA0RZHluQ2FsbF9paWlpaWlpaWkApQ0PZHluQ2FsbF9paWlpaWpqALENEGR5bkNhbGxfaWlpaWlpamoAsg0PZHluQ2FsbF92aWlpaWlpAKYNCYwSAQBBAQudCU5PUFFSU1RVVldYWVpbXF1eX2BhYmNkZWZnaGlqa2xtf26AAVWBAYIBfgTGB+IGlwGsB/4LmAGGDJoBEZMBqweDB/gG/AemAZMHhgcXkwyNDJQBlQGWAZUBmwGZAZ0BnAGeAaEHoweiB6QHnwGgAd8E4wahAaIB6gTqBOcGowHsBqQB7walAaAEqAHoAYwDqQHFBKoByAS5BIQDsgGrAY0DmAOVA5cDmQOjA8YEtAG1AbYBtwGzAcoEzATOBMkEuAHNBMMBwQHEAVK5AbEBqAOwBNkDugHPBM8B0QHHAdMB2AHGAcAFyQHMAaYD3AGqA6sDrgOvA7MB3AHIAdwBygHLAdwBzQHOAdwB0AHcAdIB3AHUAdUB1gHcAdkB2gHWA8UB3APmA/cD+wOMBvED8gP0A/UDnAOyAYkD7AGzAe4B4QS/BLIB8AGyAbIBsgH0AbIB9gGyAfYBsgH5AbIB+wGyAf0BmwO1BLIB/wGyAYECsgGDArIBhQKaA7IBhwKIAq0FsgGMAo0CsgGQArIBkgKyAZQCsgGWApcCsgGWArIBmgKsAbIBnAKdArIBoAKhArIBowKyAaUCsgGnAqgCsgGqAqsCsgGyAa4CjgOwA7IBsAKyAbIC2gSyAbUCtgK5ArIBugK8ArIBpwK+ArIBsgKyAcECsgHEArIBxQKxBMYCxwLIArMEyQLKArgEoQSyAcwCsgHQAtEC0wKyAdUCsgHXArIB9gGyAdoCsgHcArIB3gLfArIB4QKyAeMCtAHkAuUCywSyAecCsgHpAuoCsgHtAu4CsgHwArIB8wL0ArIB9wKyAfoCsgH8ArIB/gKyAYADsgGFA5EB6wHzAfIB7wH1AfcB+gH8AfgB/gGAAoIChAKnAYYCigKPApECkwKVApgCmQKbAp4CogKkAqYCqQKsAq0CrwKxArMCtwK9Ar8CwALCAsMCywLNAtQC1gLYAtkC2wLdAuAC4gLmAugC6wLvAvEC9QL4AvsC/QL/AoEDrQekA5IMvwGGA6cD+AWvB88DhwzRA9UD2APuBeUFxAWSBecD4QPbA6MEjwfIBfwD/QP+A/8D8QbzBvIG9AbRA9ED0QPRA9ED0QOABIEEggSDBIQEhQSJBI0EkQSVBJkEnQSeBOoBiQKwAeMBwgHRBLQDsgP4A/kDywPjBFLnBLcMsgS2BLcEugS7BIwFjQW8BMIEwwTEBMcE0ATSBI4FjwWQBdUE1wTYBNkE1gTbAbkB3QTcBN8E3gTgBNsEuQHkBNwE3wTlBOYE4gToBOkE6gTrBOwE7QTuBKUE7wTwBNwE6wTxBPME9ASmBPUE9gT3BOsE+AT5BPoEpwT7BPwE/QTrBPgE/gT/BKgEhgWABYEF6wSCBYQFhQWpBIAFqgSrBKwEhwWIBYkF6wSKBa0ErgSvBJMDkwWUBZEDiwyVBZYFowWuBbAFsgWzBbQFtgW4BbsFvAW9BdwBrwXcAbEF3AGvBdwB3AG1BdwBtwXcAdwB3AHcAb4FtAG5BboFwQXcAdwBvgXDBcIFxQXGBccFygXeCvUFyQXbBVLSBdQFywXMBc0FzgXPBdAF1QXYBdYF2QXXBdoFtQe4B7YHuQe3B7oH0wXcBd0F3gXfBeEF4gXjBeQF0QXmBecF6AXpBeoF6wXsBe0FUrkB7wXwBfEF8gXzBfQF9gX3BY4GvwbGBrAGlgaeBq0GrgbqBMAG3gbaBvkGyAKEB4EH9gaNB44H3wYkkgeUB5UHzAelB6YHqQeqB64HsAezB7MBvge/B+AG4QbkBuYG6wbuBu4GUrkBuwefDKAMoQy8B8AH8gvdBsMH+Af5B/oH+wf2DP0L/AaAB/0GgAj/BuoIiwiMCI0IjgjSCNMI4waRCJQIlwiXCJwIoAihCKkI0QikCKcIqgirCNUH5QeXB7QI+Qf6B7UImAecB5kHzAebB7sI0gjTCMkIzwjRCLEH3wjgCOgI6QjqCNYH1wf8BbQH8gjNB/QIswf6CPMI6gjgB4MMvgzjBrMBvwm3CcAJwQnDCcQJxQnqCMgJ2AnZCZoH2gmcDNsJxQneCZsM6QnqCe8J8An3CfgJ2Af4CfsJ/An9CfcJ/gnZB4MKvQeECoUKhgqHCogKiQqKCosKjAqNCo4KjwqQCpEKkgqTCpQKlQqWCpcKmAqZCpoKmwqcCp0KngqfCqAKoQqiCqMKpAqlCqYKpwqoCqkKqgqrCqwKrQquCq8KsAqzCrQK1AvZC98K1AroC9EK6wvsC9oK3AriCtsH3AfdB98HoAbhB7UGiQuKC+IH4wfkB6kLqgusC60LsAuxC7MLtAu2C7cLuQu6C7wLpAu+C8ALwgvEC8YLyAvKC9ML/grhC98E5wu7DNYK1wrhCvIK8wr0CvUK9gr3Cu4K+Ar5CvoKgAqAC4ELhAuHC4gL6gSLC40LmgubC54LnwugC6ILpQucC50L5wjhCKELowumC1K5AbkB4wrlCuYK5wroCuoK6wrtCu4K7wrwCvEKuQH7CvsK/ArcBNwE/QrcBLkBjguQC/wK6gTqBJILgQW5AZQLlgv8CuoE6gSYC4EFuQG5AVK5Ae4H7wfxB1K5AfIH8wf1B7kB9geFCI8IkgiVCJgImgidCKIIpQioCLkBswi3CLwIvgjACMIIxAjGCMoIzAjOCLkB1QjbCOII4wjkCOUI7AjtCLkB7gjxCPYI9wj4CPkI+wj8CFK5AfcEgQmCCYMJhQmHCYoJqAuvC7ULwwvHC7sLvwtSuQH3BJkJmgmbCZ0JnwmiCasLsgu4C8ULyQu9C8EL0AvPC68J0AvPC7MJuQG4CbgJuQm5CbkJugnqBLsJuwm5AbgJuAm5CbkJuQm6CeoEuwm7CbkBvAm8CbkJuQm5Cb0J6gS7CbsJuQG8CbwJuQm5CbkJvQnqBLsJuwm5Ab4Jxgm5AdcJ3Am5AecJ7Qm5Ae4J8gm5AfUJ9gnfBLkB9Qn6Cd8EUucE6gTqBOoEUoAMhQyEDKUMpAyCDKcMqAyzDLIMqgy5AboMuQG4DL0M8gu/DMAMuQHBDFK5AbMBswHCDLkBxAzYDNUMxwy5AdcM1AzIDLkB1gzRDMoMuQHMDPQMCuzuJuwMPwAQ0QcQTRDOAxDQAxCfBEHQqQVBLzsBAEHbqQVBAToAAEHcqQVBOjsBAEHnqQVBAToAAEGAwwVBnQkRAAAaC5EGAQJ/QZgPQbQPQdgPQQBB6A9BAUHrD0EAQesPQQBBgAhB7Q9BAhAAQZgPQQFB8A9B6A9BA0EEEAFBCBD+CyIAQgU3AwBBCBD+CyIBQgY3AwBBmA9BjwhB7BBBhBFBByAAQewQQYgRQQggARACQQgQ/gsiAEIJNwMAQQgQ/gsiAUIKNwMAQZgPQZ4IQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEINNwMAQQgQ/gsiAUIONwMAQZgPQaQIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEIPNwMAQQgQ/gsiAUIQNwMAQZgPQasIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEIRNwMAQQgQ/gsiAUISNwMAQZgPQbUIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEITNwMAQQgQ/gsiAUIUNwMAQZgPQboIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEIVNwMAQQgQ/gsiAUIWNwMAQZgPQcAIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEIXNwMAQQgQ/gsiAUIYNwMAQZgPQdYIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEIZNwMAQQgQ/gsiAUIaNwMAQZgPQeYIQdj8A0GEEUEbIABB2PwDQYgRQRwgARACQQgQ/gsiAEIdNwMAQQgQ/gsiAUIeNwMAQZgPQfYIQaz9A0GEEUELIABBrP0DQYgRQQwgARACQQgQ/gsiAEIfNwMAQQgQ/gsiAUIgNwMAQZgPQYcJQdj8A0GEEUEbIABB2PwDQYgRQRwgARACQQgQ/gsiAEIhNwMAQZgPQY0JQQJBkBFBmBFBIiAAQQAQA0EIEP4LIgBCIzcDAEGYD0GYCUEDQZwRQYgRQSQgAEEAEANBCBD+CyIAQiU3AwBBmA9BpAlBA0GcEUGIEUEkIABBABADQQgQ/gsiAEImNwMAQZgPQbEJQQJBkBFBmBFBIiAAQQAQAwsFAEGYDwsPACAABEAgABCDARD2DAsLBwAgABENAAvAAQEHf0E4EP4LIgBBCGoiAUIANwMAIABCADcDACAAQTBqIgJCADcDACAAQShqIgNCADcDACAAQSBqIgRCADcDACAAQRhqIgVCADcDACAAQRBqIgZCADcDACAAQQo6AAsgAEH0DykAADcAACABQfwPLwAAOwAAIABBADYCNCACQQA6AAAgAEEANgIsIANBADoAACAEQqGAgIDAAjcCACAFQgA3AgAgBkKAgICA4AM3AgAgAEEANgIMIABBADoACiAACwQAIAALVQEBfyMAQSBrIgIkACAAKAI0BEAgAkG1CjYCECACQasKNgIMIAJBhAo2AgggAkEsNgIEIAJB5gk2AgBBugkgAhCHDRAEAAsgACABEIoMIAJBIGokAAuGAQEBfyABIAAoAgQiAkEBdWohASAAKAIAIQACQCABIAJBAXEEfyABKAIAIABqKAIABSAACxEAACIALAALIgFBf0wEQCAAKAIEIgFBBGoQ9QwiAiABNgIAIAAoAgAhAAwBCyABQf8BcSIBQQRqEPUMIgIgATYCAAsgAkEEaiAAIAEQgA0aIAILkgIBBH8jAEEQayIDJAAgASAAKAIEIgVBAXVqIQYgACgCACEEIAVBAXEEQCAGKAIAIARqKAIAIQQLIAIoAgAiAEFwSQRAAkACQCAAQQtPBEAgAEEQakFwcSIFEP4LIQEgAyAFQYCAgIB4cjYCCCADIAE2AgAgAyAANgIEDAELIAMgADoACyADIQEgAEUNAQsgASACQQRqIAAQgA0aCyAAIAFqQQA6AABByLIFQQA2AgAgBCAGIAMQBUHIsgUoAgAhAEHIsgVBADYCACAAQQFHBEAgAywAC0F/TARAIAMoAgAQ9gwLIANBEGokAA8LEAYhABAHGiADLAALQX9MBEAgAygCABD2DAsgABAIAAsgAxCGDAALBwAgAEEMagtYAQF/IwBBIGsiAiQAIAAoAjQEQCACQfIKNgIQIAJBqwo2AgwgAkGECjYCCCACQS42AgQgAkHmCTYCAEG6CSACEIcNEAQACyAAIAEoAgA2AgwgAkEgaiQACzgBAX8gASAAKAIEIgJBAXVqIQEgACgCACEAIAEgAkEBcQR/IAEoAgAgAGooAgAFIAALEQAAKAIAC1IBAn8jAEEQayIDJAAgASAAKAIEIgRBAXVqIQEgACgCACEAIARBAXEEQCABKAIAIABqKAIAIQALIAMgAjYCDCABIANBDGogABECACADQRBqJAALBwAgAEEQagtYAQF/IwBBIGsiAiQAIAAoAjQEQCACQaMLNgIQIAJBqwo2AgwgAkGECjYCCCACQTA2AgQgAkHmCTYCAEG6CSACEIcNEAQACyAAIAEoAgA2AhAgAkEgaiQACwcAIABBFGoLWAEBfyMAQSBrIgIkACAAKAI0BEAgAkHVCzYCECACQasKNgIMIAJBhAo2AgggAkEyNgIEIAJB5gk2AgBBugkgAhCHDRAEAAsgACABKAIANgIUIAJBIGokAAsHACAAQRhqC1gBAX8jAEEgayICJAAgACgCNARAIAJBigw2AhAgAkGrCjYCDCACQYQKNgIIIAJBNTYCBCACQeYJNgIAQboJIAIQhw0QBAALIAAgASgCADYCGCACQSBqJAALBwAgAEEcagtYAQF/IwBBIGsiAiQAIAAoAjQEQCACQboMNgIQIAJBqwo2AgwgAkGECjYCCCACQTg2AgQgAkHmCTYCAEG6CSACEIcNEAQACyAAIAEoAgA2AhwgAkEgaiQACwcAIABBIGoLWAEBfyMAQSBrIgIkACAAKAI0BEAgAkHrDDYCECACQasKNgIMIAJBhAo2AgggAkE7NgIEIAJB5gk2AgBBugkgAhCHDRAEAAsgACABKAIANgIgIAJBIGokAAsHACAAQSRqC1gBAX8jAEEgayICJAAgACgCNARAIAJBrA02AhAgAkGrCjYCDCACQYQKNgIIIAJBPjYCBCACQeYJNgIAQboJIAIQhw0QBAALIAAgASgCADYCJCACQSBqJAALBwAgAEEoagtZAQF/IwBBIGsiAiQAIAAoAjQEQCACQecNNgIQIAJBqwo2AgwgAkGECjYCCCACQcEANgIEIAJB5gk2AgBBugkgAhCHDRAEAAsgACABLQAAOgAoIAJBIGokAAs4AQF/IAEgACgCBCICQQF1aiEBIAAoAgAhACABIAJBAXEEfyABKAIAIABqKAIABSAACxEAAC0AAAtSAQJ/IwBBEGsiAyQAIAEgACgCBCIEQQF1aiEBIAAoAgAhACAEQQFxBEAgASgCACAAaigCACEACyADIAI6AA8gASADQQ9qIAARAgAgA0EQaiQACwcAIABBLGoLWQEBfyMAQSBrIgIkACAAKAI0BEAgAkGeDjYCECACQasKNgIMIAJBhAo2AgggAkHEADYCBCACQeYJNgIAQboJIAIQhw0QBAALIAAgASgCADYCLCACQSBqJAALBwAgAEEwagtZAQF/IwBBIGsiAiQAIAAoAjQEQCACQdoONgIQIAJBqwo2AgwgAkGECjYCCCACQccANgIEIAJB5gk2AgBBugkgAhCHDRAEAAsgACABLQAAOgAwIAJBIGokAAs1AQF/IAEgACgCBCICQQF1aiEBIAAoAgAhACABIAJBAXEEfyABKAIAIABqKAIABSAACxEBAAuPAgIDfwF+IwBBQGoiAiQAIAAgAUEAEHAgASgCMCIBQQJOBEADQCACQTBqIgMgACkCKDcDACACIAApAjA3AzggAiAAKQIgNwMoIAIgACkCGDcDICACIAApAhA3AxggAiAAKQIINwMQIAApAgAhBSADQQA2AgAgAiAFNwMIIAJBADYCBCACQQA2AiQgAkEANgIAIAIgAigCCEEBdSIDQQFxIANqNgIIIAIgAigCDEEBdSIDQQFxIANqNgIMIAIgAigCFEECdDYCFCAAIAJBBGogAkEBEHEaIAAgACACKAIEaiIDNgKoByADIAJBCGpBARBwIAFBAkohBCABQX9qIQEgAyEAIAQNAAsLIAJBQGskAAu0CAEIfyAAQQBBrAcQgQ0iACABKAIAQQ9qIgNBBHUiBDYCWCABKAIEIQYgAEHY/+N+NgJ0IABByP+jfjYCbCAAIANBcHEiAzYCZCAAIAZBD2oiB0FwcSIGNgJoIAAgB0EEdSIHNgJcIAAgBCAHbDYCYCAAIAdBFnQiByAEQQZ0IgRB6P8DakHo/wNxckGAgKB/ajYCeCAAIAcgBEH4/wNqQfj/A3FyQYCAYGo2AnAgACABKAIAIgggASgCBHJBD3FBAEc2AnwgACABKQIwNwIwIAAgAUEoaiIEKQIANwIoIAAgAUEgaiIHKQIANwIgIAAgASkCGDcCGCAAIAEpAhA3AhAgACABKQIINwIIIAAgASkCADcCAAJAAkACQCAABEAgBCgCACEFIAcoAgAhBCABKAIcIQcgASgCBCEJIAAgAEG7B2pBcHEiATYCvAIgAg0BIAEhBQwDC0EAIQQgAg0BDAILIAAgASAEIAdqIAVBAEdqQQFqIAlBD2pBBHVBAmogCEEPakEEdUGAA2xBgAZqbGxqQQ9qQXBxIgQ2AjggASEFCyAAIANBAm0iATYCTCAAQcgAaiIHIAE2AgAgACAEIAMgBmwiAWoiBDYCPCAAIAM2AkQgAEFAayICIAQgAUEEbWo2AgAgACAHKQIANwLkAiAAIAApAjg3AtQCIAAgAikCADcC3AILIAAgA0EgaiIBNgLIAiAAIAFBAXUiBDYCzAIgACAENgLQAiAAIAUgA0EEdEGQBGoiCWo2ArwCIAAgBSAGQSBqIAFsIghqIgIgAUECdEEIciIHajYCwAIgACACIAZBAXVBEGogBGwiA2oiBiAHajYCxAIgAyAGaiEGAkAgACgCKEUEQCAGIQEMAQsgACAENgL8AiAAIAYgCWo2AuwCIAAgATYC+AIgACAENgKAAyAAIAYgCGoiASAHajYC8AIgACABIANqIgEgB2o2AvQCIAEgA2ohASAFIAZPDQAgBkEAIAUgA0EBdCAIaiIDQQFyaiIEIAEgBCABSxsgAyAFamsQgQ0aCyAAKAIcBEAgACAAKAJYIgRBBHRBIGoiAzYC4AIgACADQQF1IgU2AuQCIAAgBEEIdCABakGQBGo2AtQCIAAgBTYC6AIgACABIAAoAlwiBEEEdEEgaiADbGoiASADQQJ0QQhyIgNqNgLYAiAAIAEgBEEDdEEQaiAFbCIFaiIBIANqNgLcAiABIAVqIQELIAAoAiAiCEEBTgRAIAAoAlgiBkEEdEEgaiIDIAAoAlwiBUEEdEEgamwhCSAFQQN0QRBqIANBAXVsIQQgBkEIdEGQBGohCiADQQJ0QQhyIQZBACEDA0AgACADQQxsaiIFIAEgCWoiByAEaiICIAZqNgKMAyAFIAYgB2o2AogDIAUgASAKajYChAMgAiAEaiEBIANBAWoiAyAIRw0ACwsL4gIBBH9BASEEAkAgAEUNAEECIQQgACgCCCAAKAIMckEASA0AIAAoAgAiBUEBSA0AIAAoAgQiBkEBSA0AIAAoAhQgACgCECAAKAIcIgcgACgCGHJyckEBSw0AIAAoAiBBCEsNAEEFIQQgBSAGciIFQQFxDQAgB0VBAnRBACAFQQ9xGyEECyAEQQEgAhtBASABGyIFRQRAIAEgACgCICAAKAIcaiAAKAIoQQBHakEBaiAAKAIAQQ9qQQR1QYADbCIEQYAGaiAAKAIEQQ9qQQR1IgZBAmpsbEEQciIHIAQgBmxqIAcgAxtBrAdqNgIAIAIgACgCACIBQQ9qQQR1IgRBBXQgBCAAKAIEQQ9qQQR1bEGkCWxBAm1BvxdqQXBxIARBA3RqQRdqQXBxIAFBL2pBcHFqIARBAnRqQRNqQXBxIARqQQ9qQXBxIARqQQ9qQXBxIARqQQ9qQXBxakEvajYCAAsgBQvnGgEifyAAIAAgARBzIQggACgCqAciBgRAIAAoAgAiCkEPakEEdSIHIAAoAgRBD2pBBHVsQaQJbEECbSELIApBL2pBcHEhDyAHQQV0QTBqIRIgB0ECdEEEaiEVIAdBA3RBCGohFgNAIAYgASAIaiIKQQ9qQXBxIgk2AtwGIAYgCUGhF2pBcHEiCTYCxAYgBiAJIAtqQQ9qQXBxIgk2ArgGIAYgCSAWakEPakFwcSIJNgK0BiAGIAkgD2pBD2pBcHEiCTYCvAYgBiAJIBVqQQ9qQXBxIgk2ApwGIAYgByAJakEPakFwcSIJNgKgBiAGIAcgCWpBD2pBcHEiCTYCqAYgBiAHIAlqQQ9qQXBxIgk2AsAGIAkgEmogCCAKa2ohCCAGKAKoByIGDQALCyAAIAMpAgA3AjggACADKQIQNwJIIABBQGsgAykCCDcCAAJAAkACQAJAIAAoAigEQCACKAIAQQFKDQFBACEGA0AgACATQQJ0IgdqIgxB7AJqIRcgDEH4AmoiGCgCACESAkAgACgCACAGdSIUQQNIDQAgACgCBCAGdSIGQQNIDQBBACADIAdqIgcoAgwiFWshFkEAIBJrIQ8gFEF+aiEdIAcoAgAhDiAXKAIAIRAgBkF+aiIcIRoDQCAQIA4gFWoiDi0AADoAACAQIBJqIhBBAWohBiAOQQFqIQcgHSEIA0AgByAWai0AACAHLQABIAdBf2otAAAgBkF/ai0AAGtqIAYtAAFraiAGIA9qIgotAABrIAcgFWotAAAgBiASai0AAGtqIgkgCUEfdSIJaiAJc0ECdkGQHWotAABBAnQiCUH/ASAJQf8BSRtB/wFzIActAAAiCSAGLQAAIgFrIgsgC0EfdSILaiALc0GQHWotAABB/wFzbCILQf//A3MgCWwgASALbGoiCUGAgP4HTw0GIAZBAWohBiAHQQFqIQcgCiAJQYCAAmpBEHY6AAAgCEF/aiIIDQALIAYgD2ogBy0AADoAACAaQX9qIhoNAAsgECASaiAOIBVqIBQQgA0aIBwhBgNAIBAgDyAQaiIHIBQQgA0aIAchECAGQX9qIgYNAAsgByAOIBUgHGxrIBQQgA0aIBgoAgAhEgsgFygCACEGIAwgEjYCRCAMIAY2AjhBASEGIBNBAWoiE0EDRw0ACwsgAEEANgLIBiACRQ0DDAILIABBADYCyAYMAQtBkB9Bnx9BgDBBvx8QCQALIAAgAikCADcC4AYgACACKQIgNwKAByAAIAIpAhg3AvgGIAAgAikCEDcC8AYgACACKQIINwLoBgsgACgC+AYiBkEAIAZBNEgbRQRAIABBMzYC+AZBMyEGCyAAKAL0BiIHQQlMBEAgAEEKNgL0BkEKIQcLIAAgACgC4AZBfXFBCEY2AqwGIAAoAhxFBEAgACADKQIANwLUAiAAIAMpAhA3AuQCIAAgAykCCDcC3AILQX8hEQJAIAAoAuQGIhlBBksEQCAZQeMARw0BIAAoAuwGIRtBBkHjAAJ/IAAoAugGIhFFBEAgACgCsAYhEQsgEUEASAsbIRkMAQsCQAJAAkACQAJAAkAgGUEBaw4GBQQDAgYBAAsgACgCVA0DCyAAKAIgQQBKIRtBBiEZDAQLQQEhEUEBIRsMAwtBASERDAILIAAoArAGIRFBAiEZDAELIAAoArAGIRFBASEZQX8hGwsgACgCsAYhCCAbQQBOBEAgACAbNgKwBgsCQAJAIBlBBkYEQEEAIQogAEEANgJUIAAgAC0AiAdBAXM6AIgHIAAgBkEeIAZBHkgbIgYgByAGIAdKGyIHNgJQQcIAIQYgACAAKAIwQQJOBH8gACgCqAciBiAHNgJQIAZBADYCVCAGIAYtAIgHQQFzOgCIByAAKALEBiEHIAZBADYCyAYgBiAHNgLEBiAGQcIAEHQgBkEAEHUgACAAKALIBiAGKALIBmo2AsgGQQEhCkHTAAUgBgsQdCAAIAoQdQwBC0EDIQYgACgCUEUNASARIAAoAiAiB0oNASARQQhKDQEgGyAHSg0BCyAAQeAGaiEeIAggEUcgEUF/SnEhJAJAIAAoAjBBAk4EQCAAKAKoByINIB4pAgA3AuAGIA0gHikCIDcCgAcgDSAeKQIYNwL4BiANQfAGaiIGIB4pAhA3AgAgDSAeKQIINwLoBiAGIAAoAvAGQQJ1NgIAIA1B4AZqISBBACEGA0AgDSgCaCAGdSElIAMgIUECdCIHaiIIKAIAISYgCCgCDCEQIAcgDWoiBygCRCECIAcoAjghCCAAKAIEIAZ1IgdBDHQgDSgCBCAGdSIfEHYhIiAAKAIAIAZ1QQx0IA0oAgAgBnUiFhB2IQwgH0EBTgRAIAIgFmshIyAQQX9qIRMgB0F/aiEXIAxBAnUhGCAiQQJ1ISdBACEcA0AgFkEBTgRAQYAgIBwgImwgJ2oiBkH/H3EiDmshGiAmIAZBDHUiFCAQbGohHUEAIQoDQCAKIAxsIBhqIgdB/x9xIQYgHSAHQQx1IgtqIgctAAAiDyEJIAcgEGogByAUIBdIGyIVLQAAIhIhASALIBNIBEAgBy0AASEJIBUtAAEhAQsgCCAGIAlB/wFxbEGAICAGayIHIA9sakELdiAabCAGIAFB/wFxbCAHIBJsakELdiAObGpBgCBqQQ12OgAAIAhBAWohCCAKQQFqIgogFkcNAAsLIAIgFkoEQCAIIAhBf2otAAAgIxCBDSAjaiEICyAcQQFqIhwgH0cNAAsLICUgH2sgAmwiBkEBTgRAQQAgAmshBwNAIAggByAIai0AADoAACAIQQFqIQggBkF/aiIGDQALC0EBIQYgIUEBaiIhQQNHDQALIA0gACgC3AY2AtwGIAAoAsgGIQYgACgCxAYhByANQQA2AsgGIA0gBiAHajYCxAYgDSAgIBEgJCAbIBkgACgCLEECdEEAEHcgACAAKALIBiANKALIBmo2AsgGAkAgGUF7akEBSw0AIAAoAjRFDQBBACEGQQAhIANAIAAgIEECdCIIaiIHKAK8AiIfIAcoAsgCIhIgACgCaCAGdSILbGpBCGohByAIIA1qIggoAuACIRUgCCgC1AIhIyAAKAJkIAZ1IhdBAXUiCCANKAJkIAZ1IhNBEHRqIBcQdiEcIAtBAXUiCiANKAJoIAZ1Ig9BEHRqIAsQdiEWIAggEyAGQQ9zIgl0aiAXEHYhCCAKIA8gCXRqIAsQdiEKAkAgBgRAIBdBAUgNASAKQYCQf2ohAiAHQX5qIR0gE0F/aiEUIAhBgJB/aiEOIAcgD0EBdGoiDEF+aiEYQQAhGgNAIA9BAU4EQEEAIA5BEHUiBkEBaiAUIAYgFEgbIA5BgIB8SBshCkEAIAYgFCAGIBNIGyAOQQBIGyEJQRAgDkEMdkEPcSIBayEQQQAhCCAjIQYDQCAHIAhBAXRqIBAgBiAJai0AAGwgASAGIApqLQAAbGo7AQAgBiAVaiEGIAhBAWoiCCAPRw0ACwsgHSAHLwEAOwEAIAwgGC8BADsBACALQQFOBEAgGiAfaiEIQQAhCiACIQYDQCAIIAZBDHZBD3EiCSAHIAZBEHVBAXRqIgEvAQJsIAEvAQBBECAJa2xqQYABakEIdjoAACAGIBZqIQYgCCASaiEIIApBAWoiCiALRw0ACwsgDiAcaiEOIBpBAWoiGiAXRw0ACwwBCyAXQQFIDQAgCkGAkH5qISUgB0F8aiEmIAdBfmohJyATQX9qIRggCEGAkH5qIQwgByAPQQF0aiIiQQJqISEgIkF+aiEDQQAhAgNAIA9BAU4EQEEAIAxBEHUiBkEBaiAYIAYgGEgbIAxBgIB8SBshCkEAIAYgGCAGIBNIGyAMQQBIGyEJQQAgGCAGQX9qIAYgE0obIAxBgIAESBshAUEAIAZBAmoiBiAYIAYgE0gbIAxBgIB4SBshECAMQQx2QQ9xQQJ0IgZBkztqLAAAIQ4gBkGSO2osAAAhGiAGQZE7aiwAACEUIAZBkDtqLAAAIR1BACEIICMhBgNAIAcgCEEBdGogBiAJai0AACAUbCABIAZqLQAAIB1saiAGIApqLQAAIBpsaiAGIBBqLQAAIA5sajsBACAGIBVqIQYgCEEBaiIIIA9HDQALCyAnIAcvAQAiBjsBACAmIAY7AQAgIiADLwEAIgY7AQAgISAGOwEAIAtBAU4EQCACIB9qIQlBACEBICUhBgNAIAkgByAGQRB1QQF0aiIIQX5qLgEAIAZBCnZBPHEiCkGQO2osAABsIAguAQAgCkGRO2osAABsaiAILgECIApBkjtqLAAAbGogCC4BBCAKQZM7aiwAAGxqQYAEakEKdSIIQQAgCEEAShsiCEH/ASAIQf8BSBs6AAAgBiAWaiEGIAkgEmohCSABQQFqIgEgC0cNAAsLIAwgHGohDCACQQFqIgIgF0cNAAsLQQEhBiAgQQFqIiBBA0cNAAsLIAAoAqgGQQAgACgCWBCBDRogACAeIBEgJCAbIBkgACgCLEECdEEBckEUEHcMAQsgACAeIBEgJCAbIBkgACgCLEECdEEAEHcLIAUgACgCyAY2AgAgBCAAKALEBjYCAEEAIQYLIAYLyQIBA38gAkEPakFwcSEDIAEoAgRBD2pBBHUhBCABKAIAIgVBD2pBBHUhAQJAIABFBEAgA0GhF2pBcHEhAwwBCyAAIAM2AtwGIAAgA0GhF2pBcHEiAzYCxAYLIAMgASAEbEGkCWxBAm1qQQ9qQXBxIQMgAARAIAAgAzYCuAYLIAFBA3QgA2pBF2pBcHEhAyAABEAgACADNgK0BgsgAUECdCEEIAMgBUEvakFwcWpBD2pBcHEhAwJAIABFBEAgAyAEakETakFwcSABakEPakFwcSABakEPakFwcSABakEPakFwcSEDDAELIAAgAzYCvAYgACADIARqQRNqQXBxIgM2ApwGIAAgASADakEPakFwcSIDNgKgBiAAIAEgA2pBD2pBcHEiAzYCqAYgACABIANqQQ9qQXBxIgM2AsAGCyABQQV0IANqIAJrQTBqC6cUAQd/IAAoAmAhBEHgHyEDAkADQAJAIAQgAyICLwECSg0AIAAoAgwgAi8BBEHxBGxKDQAgACgCIEEBaiAEbCACKAIITQ0CCyACQQxqIQMgAi0ADEEzSQ0AC0GUISECCyAAKALEBiAAKALIBmoiA0GAgIAINgAAIAAgACgCyAYiBEEEajYCyAYCQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAgA0F8IARrQQNxQQRyaiIDQQNxRQRAIABBGDYCzAYgAEHUBmoiByADNgIAIAAgAzYC2AYgAEHQBmoiBUGAgID4BkGAgIC4BiABQdMARhsiAzYCACABQYACTw0BIABBzAZqIQQgAi0AACEGIAItAAEhCEEAIQIgAEEANgLMBiAAIAYgAUEQdCADciAIIAFB0wBHQQJ0cUEIdHJyNgLQBiAAKAIsQQFqIgYhAwNAIAJBAWohAiADQQF2IgMNAAsgBCACQQF0QX9qIAYQeCABQdMARgRAIARBA0ECEHggBEEBQQEQeCAEQQFBARB4IAQgBCgCAEF/aiICNgIAIAUCfyACQQBOBEAgBSgCAAwBCyACQWBMDQQgBSgCACECIAcgBygCACIDQQRqNgIAIAMgAkEIdEGAgPwHcSACQRh0ciACQQh2QYD+A3EgAkEYdnJyNgIAIAQgBCgCAEEgaiICNgIAIAVBADYCAEEACyIDNgIAIAQgAkF/ajYCACAFIAJBAEwEfyACQWFMDQUgByAHKAIAIgJBBGo2AgAgAiADQQh0QYCA/AdxIANBGHRyIANBCHZBgP4DcSADQRh2cnI2AgAgBCAEKAIAQSBqNgIAIAVBADYCAEEABSADCzYCAAsgBEEDQQIQeCAEQQNBAxB4QQAhAiAAKAIgQQJqIgYhAwNAIAJBAWohAiADQQF2IgMNAAsgBCACQQF0QX9qIAYQeCAEIAQoAgBBf2oiAjYCACAAAn8gAkEATgRAIAUoAgAMAQsgAkFgTA0FIAUoAgAhAiAHIAcoAgAiA0EEajYCACADIAJBCHRBgID8B3EgAkEYdHIgAkEIdkGA/gNxIAJBGHZycjYCACAEIAQoAgBBIGo2AgAgBUEANgIAQQALNgLQBkEAIQIgACgCAEEPakEEdSIGIQMDQCACQQFqIQIgA0EBdiIDDQALIAQgAkEBdEF/aiAGEHhBACECIAAoAgRBD2pBBHUiBiEDA0AgAkEBaiECIANBAXYiAw0ACyAEIAJBAXRBf2ogBhB4IAAoAnwiA0EGaiIGQQhPDQUgBCAEKAIAQX1qIgI2AgAgBQJ/IAJBAE4EQCAFKAIADAELIAJBYEwNByAAIAAoAtQGIgNBBGo2AtQGIAMgACgC0AYgBkEAIAJrdnIiAkEYdCACQQh0QYCA/AdxciACQQh2QYD+A3EgAkEYdnJyNgIAIABBADYC0AYgACAAKALMBkEgaiICNgLMBiAAKAJ8IQNBAAsgBiACdHI2AgAgBCADBH8gBEEBQQEQeEEAIQIgACgCZCAAKAIAa0EBdUEBaiIGIQMDQCACQQFqIQIgA0EBdiIDDQALIAQgAkEBdEF/aiAGEHggBEEBQQEQeEEAIQIgACgCaCAAKAIEa0EBdUEBaiIGIQMDQCACQQFqIQIgA0EBdiIDDQALIAQgAkEBdEF/aiAGEHggBCgCAAUgAgtBf2oiAjYCACAFAn8gAkEATgRAIAUoAgAMAQsgAkFgTA0IIAUoAgAhAiAHIAcoAgAiA0EEajYCACADIAJBCHRBgID8B3EgAkEYdHIgAkEIdkGA/gNxIAJBGHZycjYCACAEIAQoAgBBIGoiAjYCACAFQQA2AgBBAAsiBjYCACABQdMARgRAIAQgAkF/aiIDNgIAIAUgAkEASgR/IAYFIAJBYUwNCiAHIAcoAgAiAUEEajYCACABQQFBACADa3YgBnIiA0EYdCADQQh0QYCA/AdxciADQQh2QYD+A3EgA0EYdnJyNgIAIAQgBCgCAEEgaiIDNgIAIAVBADYCAEEAC0EBIAN0ciICNgIAIAQgA0F+aiIBNgIAIANBAUwEQCADQWJMDQsgByAHKAIAIgNBBGo2AgAgAyACQQh0QYCA/AdxIAJBGHRyIAJBCHZBgP4DcSACQRh2cnI2AgAgBCAEKAIAQSBqIgE2AgAgBUEANgIAQQAhAgsgBSACNgIAIAQgAUF/aiIDNgIAIAFBAEwEQCABQWFMDQwgByAHKAIAIgNBBGo2AgAgAyACQQh0QYCA/AdxIAJBGHRyIAJBCHZBgP4DcSACQRh2cnI2AgAgBCAEKAIAQSBqIgM2AgAgBUEANgIAQQAhAgsgBSACNgIAIAQgA0F+aiIBNgIAIANBAUwEQCADQWJMDQ0gByAHKAIAIgNBBGo2AgAgAyACQQh0QYCA/AdxIAJBGHRyIAJBCHZBgP4DcSACQRh2cnI2AgAgBCAEKAIAQSBqIgE2AgAgBUEANgIAQQAhAgsgBSACNgIAIAQgAUF/aiIGNgIAIAFBAEwEQCABQWFMDQ4gByAHKAIAIgNBBGo2AgAgAyACQQh0QYCA/AdxIAJBGHRyIAJBCHZBgP4DcSACQRh2cnI2AgAgBCAEKAIAQSBqIgY2AgAgBUEANgIAQQAhAgsgBSACNgIAIAQgBkF/aiIDNgIAIAUgBkEASgR/IAIFIAZBYUwNDyAHIAcoAgAiBkEEajYCACAGQQFBACADa3YgAnIiAkEYdCACQQh0QYCA/AdxciACQQh2QYD+A3EgAkEYdnJyNgIAIAQgBCgCAEEgaiIDNgIAIAVBADYCAEEAC0EBIAN0ciICNgIAIAQgA0F/aiIBNgIAIANBAEwEQCADQWFMDRAgByAHKAIAIgNBBGo2AgAgAyACQQh0QYCA/AdxIAJBGHRyIAJBCHZBgP4DcSACQRh2cnI2AgAgBCAEKAIAQSBqIgE2AgAgBUEANgIAQQAhAgsgBSACNgIAIAQgAUF/ajYCACAFIAFBAEwEfyABQWFMDREgByAHKAIAIgNBBGo2AgAgAyACQQh0QYCA/AdxIAJBGHRyIAJBCHZBgP4DcSACQRh2cnI2AgAgBCAEKAIAQSBqNgIAIAVBADYCAEEABSACCzYCAAsgABB5DwtBoCFBnx9B1cQAQbEhEAkAC0G7IUGfH0HJOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtBuyFBnx9ByThBxyEQCQALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALQeshQZ8fQc44QcchEAkAC68IAQN/IAAoAsQGIAAoAsgGaiICQYCAgAg2AAAgACAAKALIBiIDQQRqNgLIBgJAAkACQAJAAkAgAkF8IANrQQNxQQRyaiICQQNxRQRAIABCmICAgICAgIDoADcCzAYgACACNgLUBiAAIAI2AtgGIABBzAZqIQNBACECIAEgACgCLEECdGpBAWoiBCEBA0AgAkEBaiECIAFBAXYiAQ0ACyADIAJBAXRBf2ogBBB4QQAhAiAAKAIsQQFqIgQhAQNAIAJBAWohAiABQQF2IgENAAsgAyACQQF0QX9qIAQQeCADIAMoAgBBf2oiAjYCACAAAn8gAkEATgRAIAAoAtAGDAELIAJBYEwNAiAAIAAoAtQGIgFBBGo2AtQGIAEgACgC0AYiAkEYdCACQQh0QYCA/AdxciACQQh2QYD+A3EgAkEYdnJyNgIAIABBADYC0AYgACAAKALMBkEgaiICNgLMBkEACyIBNgLQBiAAIAJBf2o2AswGIAAgAkEATAR/IAJBYUwNAyAAIAAoAtQGIgJBBGo2AtQGIAIgAUEIdEGAgPwHcSABQRh0ciABQQh2QYD+A3EgAUEYdnJyNgIAIABBADYC0AYgACAAKALMBkEgajYCzAZBAAUgAQs2AtAGIANBAUEBEHggA0EBQQEQeCADQQFBARB4IAAgACgCzAZBf2oiATYCzAYgAAJ/IAFBAE4EQCAAKALQBgwBCyABQWBMDQQgACAAKALUBiIBQQRqNgLUBiABIAAoAtAGIgJBGHQgAkEIdEGAgPwHcXIgAkEIdkGA/gNxIAJBGHZycjYCACAAQQA2AtAGIAAgACgCzAZBIGoiATYCzAZBAAsiAjYC0AYgACABQX5qNgLMBiAAIAFBAUwEfyABQWJMDQUgACAAKALUBiIBQQRqNgLUBiABIAJBCHRBgID8B3EgAkEYdHIgAkEIdkGA/gNxIAJBGHZycjYCACAAQQA2AtAGIAAgACgCzAZBIGo2AswGQQAFIAILNgLQBkEAIQIgACgCUEEBdEFLaiIBQR91IAFzQQFqIgQhAQNAIAJBAWohAiABQQF2IgENAAsgAyACQQF0QX9qIAQQeCADIAMoAgBBe2oiAjYCACAAAn8gAkEATgRAIAAoAtAGDAELIAJBYEwNBiAAIAAoAtQGIgNBBGo2AtQGIAMgACgC0AZBHEEAIAJrdnIiAkEYdCACQQh0QYCA/AdxciACQQh2QYD+A3EgAkEYdnJyNgIAIABBADYC0AYgACAAKALMBkEgaiICNgLMBkEAC0EcIAJ0cjYC0AYgABB5DwtBoCFBnx9B1cQAQbEhEAkAC0HrIUGfH0HOOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALyQMBD38gAEEAIAFBD3QgAEEPdiIOIAFJG2siAEEAIAFBDnQgAEEOdiIAIAFJG2siAkEAIAFBDXQgAkENdiICIAFJG2siA0EAIAFBDHQgA0EMdiIDIAFJG2siBEEAIAFBC3QgBEELdiIEIAFJG2siBUEAIAFBCnQgBUEKdiIFIAFJG2siBkEAIAFBCXQgBkEJdiIGIAFJG2siB0EAIAFBCHQgB0EIdiIHIAFJG2siCEEAIAFBB3QgCEEHdiIIIAFJG2siCUEAIAFBBnQgCUEGdiIJIAFJG2siCkEAIAFBBXQgCkEFdiIKIAFJG2siC0EAIAFBBHQgC0EEdiILIAFJG2siDEEAIAFBA3QgDEEDdiIMIAFJG2siDUEAIAFBAnQgDUECdiINIAFJG2siD0EBdiIQIAFPQQF0IAAgAU9BDnQgDiABT0EPdHIgAiABT0ENdHIgAyABT0EMdHIgBCABT0ELdHIgBSABT0EKdHIgBiABT0EJdHIgByABT0EIdGogCCABT0EHdGogCSABT0EGdGogCiABT0EFdGogCyABT0EEdGogDCABT0EDdGogDSABT0ECdGpqIA9BACABQQF0IBAgAUkbayABT2oL7h0BCn8gACACQR52QQJxNgKAAUF/IQggACgCCEF/aiIJQT8gCUE/SRsiDUEBaiIPIAAoAvAGIhFBA3QiEGwhDiAAKAJgIQwDQAJAIAhBAWoiC0EBdCIKQcAiai8BACEJIApBkiNqLwEAIQogCEEmSg0AIAshCCAJIA1sIApqIAxsIA5KDQELCyAKQRB0IQggAkEfdiEOQQEgCUEQdCIKZ3QhCQNAIAlB//8DcSILIAhBEHZsIAlBEHYgCGxqIAsgCEH//wNxbEEQdmohCEGAgAggCSAKbEEQdiIKayEJIApB//8DRw0ACyANBH8gD0EQdCEJQQEgCCANQRB0aiILZ3QhCgNAIApB//8DcSINIAlBEHZsIApBEHYgCWxqIA0gCUH//wNxbEEQdmohCUGAgAggCiALbEEQdiILayEKIAtB//8DRw0ACyAJQf//A3EiCiARQQ12Qf//A3FsIAlBEHYgEGxqIAogEEH4/wNxbEEQdmoFQQALIQogACgCDCIJQQF1IgsgEEghDSALIBAgDRshCwJ/AkACQAJ/IAJBf0wEQCAIQf//A3EiDyAKQRB2bCAKIAhBEHZsaiAKQf//A3EgD2xBEHZqDAELIANFDQEgCEGAgHxqIAAoAvwDIAAoAvgDayIPQQIgD0ECShsiD0EMIA9BDEgbQdQCbEEIdmwiCEEUdiAKbCAKaiAIQQR2Qf//A3EiCCAKQRB2bGogCCAKQf//A3FsQRB2agsgEGsiCCAJRQ0CGiAAKALwAyEPDAELIAogEGsiCCAJRQ0BGiAAKAKQBCAAKALwAyIPa0EEdSAIaiEICyAIIAlBOGxBA3UgD2siCSAIIAlIGwsgEGoiCCARQQd0IgkgCCAJSBsiCCARQQF0IgkgCCAJShshCQJAIAMgDnJFBEAgACgCkAQhCAwBCyAAIAAoAvADIAkgEGtqIgg2ApAECyAAIAk2AoAEIAAgCCAKIBBraiIIIAsgCCALShs2ApAEAkACQCAAKAIYRQ0AIAAoAlRFDQAgACgC9ANBCHUhCAwBC0EAIQgCQCADBEADQCAIQQF0IgpBkiNqLwEAIApBwCJqLwEAakEBdiAMbCAJSARAIAghCgwDC0EpIQogCEEBaiIIQSlHDQAMAgALAAsgDkHSAGwhCwNAIAwgCyAIQQF0akHAImovAQBsIAlIBEAgCCEKDAILQSkhCiAIQQFqIghBKUcNAAsLIApBCmohCAJ/IAMEQCAAKAKEBCIKIAAoAvwDIgsgACgC+AMiCSALIAlKGyILIAlBBmoiCSALIAlIGyAIaiIIIAogCEobDAELIAAoAvgDIAhqCyEIIAAoAoQEIgkgCEEBaiIKTA0AIAkgCmpBAm0hCAsgAEEANgLsAyAAIAgQeiAAQQA2ApABIABCADcCiAEgACAAKALsAyIINgKEBCAAIAhBCHQ2AvQDAkACQAJAAkACQAJAAkAgAkEBTgRAIAAoArwCIQkgACACQQxsIABqIghB+AJqIgooAgA2ArwCIAogCTYCACAAQcACaiIJKAIAIQogCSAIQfwCaiILKAIANgIAIAsgCjYCACAAQcQCaiIJKAIAIQogCSAIQYADaiIIKAIANgIAIAggCjYCAAwBCyAEQQBKDQAgAg0AIAAoAgwiCEUNACAAKALwAyAAKALwBkEDdGsgCEEDdEwNAEEAIQggACAFQQAgBCAGIAcQeyAAIAAoAmAiCTYClAEgCUEBaiIKIQkDQCAIQQFqIQggCUEBdiIJDQALIABBzAZqIAhBAXRBf2ogChB4IAAQeSAAKAJcQQR0IQkgACgCWEEEdCEHIAAoAsgCIQsgACgC4AIhDCAAKAK8AiEIIAAoAtQCIQoDQCAKIAggBxCADSEKIAggC2ohCCAKIAxqIQogCUF/aiIJDQALIAAoAlxBA3QhCSAAKAJYQQN0IQcgACgCzAIhCyAAKALAAiEIIAAoAuQCIQwgACgC2AIhCgNAIAogCCAHEIANIQogCCALaiEIIAogDGohCiAJQX9qIgkNAAsgACgCXEEDdCEJIAAoAlhBA3QhByAAKALQAiELIAAoAsQCIQggACgC6AIhDCAAKALcAiEKA0AgCiAIIAcQgA0hCiAIIAtqIQggCiAMaiEKIAlBf2oiCQ0ACwwBCyAAIAUgAiAEIAYgBxB7A0ACQCAAKAL8BiIIRQ0AIAAoAtQGIAAoAtgGa0EDdCAAKALMBmtBIGoiCUF/TA0DIAkgCEEDdE0NACAAEHkgACAFIAIgBCAGIAcQewsgACAHEHwgACAAKALUAkEQajYC1AIgACAAKALYAkEIajYC2AIgACAAKALcAkEIajYC3AIgACAAKAKQAUEBaiIINgKQASAAKAIYBEAgACgC1AYgACgC2AZrQQN0IAAoAswGa0EgaiIJQX9MDQQgCEUNBSAAKAJgIAkgACgCyAZBA3RqQQFqbCAAKAKABCAIbGsiCSAAKAKIBGshCiAAKALsAyEIIAAgCTYCiAQgAAJ/AkAgCUEBSA0AIApBAUgNACAIIAAoAowEQQNIaiEIQQAMAQsgACgCjAQhCyAJIApxQX9MBEAgCCALQQNIayEIQQAMAQsgC0EBags2AowEIAAgACgC9AMiCSAIaiAJQQh1azYC9AMgACAIIAAoAoQEIglBA2oiCiAIIApIGyIIIAlBfWoiCSAIIAlKGxB6CyAAIAAoAogBQQFqIgk2AogBIAkgACgCWCIISA0AIABBADYCiAEgACAAKALUAiAAKALgAiAIa0EEdGo2AtQCIAAgACgC2AIgACgC5AIgCGtBA3RqNgLYAiAAIAAoAtwCIAAoAugCIAhrQQN0ajYC3AIgACgCuAZCwICBgoSIkKDAADcCACAAKAK8BkF/NgIAIAAgACgCjAFBAWoiCDYCjAEgCCAAKAJcSA0ACyAAKAKUASIJBEBBACEIIAlBAWoiCiEJA0AgCEEBaiEIIAlBAXYiCQ0ACyAAQcwGaiAIQQF0QX9qIAoQeAsgABB5IAAgACgC1AIgACgCXCIIIAAoAuACbEEEdGs2AtQCIAAgACgC2AJBACAIQQN0ayIIIAAoAuQCbGo2AtgCIAAgACgC3AIgCCAAKALoAmxqNgLcAgsgBUEGRgRAIABBADYCnAcgAEIANwLkAwsCQCAEQQFOBEAgACAEakEBOgDjAwwBCyAEDQAgAEEBNgKcBwsgACgCyAYhDAJAIAAoAmAiCSAAKAKUAUYNACAMQQN0QWBqIQpBACEIIAJBf0YiDUHSAGwhBwNAAkAgCSAHIAhBAXRqQcAiai8BAGwgCkwEQCAIIQsMAQtBKSELIAhBAWoiCEEpRw0BCwsCQCADDQAgACgC9ANBCHUgACgC+AMiCGsiCSALQQlqSARAIAAgCEF/ajYC+AMMAQsgCSALQQtqTA0AIAAgCEEBajYC+AMLIAMgDXIEQCAAIAAoAvgDNgL8AwwBCyAAQfwDaiIIIAgoAgAiCCAAKAL0A0EIdSALa0F2aiIJIAggCUobNgIACyAAQfADaiIIIAgoAgAgDCAAKALwBmtBA3RqIgg2AgACQCAAKAIMIgkEQAJAIAhBf0oNACAAKAIUBEAgACgCxAYgDGoiCEGAgIAINgAAIAAgACgCyAYiCUEEajYCyAYgCEF8IAlrQQNxQQRyaiILQQNxDQcgAEKYgICAgICAgAw3AswGIAAgCzYC1AYgACALNgLYBkGAgIDgACEJQRghCANAIAAgCEF4aiIKNgLMBiAAAn8gCEEHSgRAIAohCCAJDAELIAhBaEwNCiAAIAtBBGoiDDYC1AYgC0H/AUEAIAprdiAJciIIQRh0IAhBCHRBgID8B3FyIAhBCHZBgP4DcSAIQRh2cnI2AgAgAEEANgLQBiAAIAAoAswGQSBqIgg2AswGIAwhC0EAC0H/ASAIdHIiCTYC0AYgACAAKALwAyIKQQhqNgLwAyAKQXhIDQALIAAQeSAAKAIMIQkgACgC8AMhCAwBC0EAIQggAEEANgLwAwsgCCAJQQN0IglMDQEgACgCEA0BIAAgCTYC8AMMAQsgAEEANgLwAwsgAkEBTgRAIAAoArwCIQkgACACQQxsIABqIghB+AJqIgooAgA2ArwCIAogCTYCACAAQcACaiIJKAIAIQogCSAIQfwCaiIHKAIANgIAIAcgCjYCACAAQcQCaiIJKAIAIQogCSAIQYADaiIIKAIANgIAIAggCjYCAAsCQCAEQX9GDQAgACgCZCEMIAAoAmghDUEQIQlBACEGA0AgACAGQQJ0aiIKQbwCaiEOAkAgACgCHARAIA4oAgAhCCAOIApB1AJqIgcoAgAiCjYCACAHIAg2AgAgCUEBdCAMaiEIDAELIAlBAXQgDGohCCAKKALUAiEKIA4oAgAhByANIQsDQCAHIAogDBCADSEHIAogDGohCiAHIAhqIQcgC0F/aiILDQALIA4oAgAhCgsgCiAJayEOIA1BAU4EQEEAIAlrIQIgCCAJQX9zaiEFQQAhByAOIQoDQCAKIAkgCmotAAAgCRCBDSIKIAhqIgsgAmogBSAKai0AACAJEIENGiALIQogB0EBaiIHIA1HDQALCyAJQQFOBEAgCCAJIA1qbCELIA4gCCAJbGshCiAOIAggDUF/amxqIQJBACEHA0AgCiAOIAgQgA0iCiALaiACIAgQgA0aIAggCmohCiAHQQFqIgcgCUcNAAsLIAkgBkUiCHUhCSAMIAh1IQwgDSAIdSENIAZBAWoiBkEDRw0ACyAAIAAoAlRBAWoiCDYCVAJAIAggACgCCCIJSA0AIAlFDQAgASgCBA0AIABBADYCVAsgBEEBSA0AIAAoArwCIQkgACAEQQxsIABqIghB+AJqIgooAgA2ArwCIAogCTYCACAAQcACaiIJKAIAIQogCSAIQfwCaiIHKAIANgIAIAcgCjYCACAAQcQCaiIAKAIAIQkgACAIQYADaiIIKAIANgIAIAggCTYCAAsPC0H7IUGfH0HgOEGOIhAJAAtB+yFBnx9B4DhBjiIQCQALQfI6QZ8fQc3VAEH+OhAJAAtBoCFBnx9B1cQAQbEhEAkAC0HrIUGfH0HOOEHHIRAJAAvbAQEBfwJAAkAgAiABdkUEQCAAIAAoAgAgAWsiAzYCACABQSFPDQECfyADQQBOBEAgACgCBAwBCyADQWBMDQMgACAAKAIIIgFBBGo2AgggASAAKAIEIAJBACADa3ZyIgNBGHQgA0EIdEGAgPwHcXIgA0EIdkGA/gNxIANBGHZycjYCACAAQQA2AgQgACAAKAIAQSBqIgM2AgBBAAshASAAIAEgAiADdHI2AgQPC0G7IUGfH0HJOEHHIRAJAAtB2SFBnx9ByzhBxyEQCQALQeshQZ8fQc44QcchEAkAC6IGAQp/IAAgACgCzAZBf2oiAjYCzAYgACgCyAYhCCAAKALEBiEGAkACQAJAAkAgAAJ/IAJBAE4EQCAAKALUBiEEIAAoAtAGDAELIAJBYEwNASAAQdQGaiIDIAMoAgAiBUEEaiIENgIAIAUgAEHQBmoiBygCAEEBQQAgAmt2ciIBQRh0IAFBCHRBgID8B3FyIAFBCHZBgP4DcSABQRh2cnI2AgAgB0EANgIAIAAgACgCzAZBIGoiAjYCzAZBAAtBASACdHIiATYC0AYgBCAAKALYBiIJa0EDdCACa0EgaiIFQX9MDQFBACEDIAAgAkEAIAVrQQdxIgprIgI2AswGAkAgAkF/SgRAIAQhAgwBCyACQWBMDQMgACAEQQRqIgI2AtQGIAQgAUEIdEGAgPwHcSABQRh0ciABQQh2QYD+A3EgAUEYdnJyNgIAQQAhASAAQQA2AtAGIAAgACgCzAZBIGo2AswGCyAGIAhqIQcgACABNgLQBiACIAFBCHRBgID8B3EgAUEYdHIgAUEIdkGA/gNxIAFBGHZycjYCAAJAIAUgCmpBA3YiBkUEQEEAIQQMAQsgCSEBQQAhBEEAIQUDQEEAIAEtAAAiAkEDS0EBdCADIANBAkYiCBtBAWogAhshAyAEIAggAkEESXFqIQQgAUEBaiEBIAVBAWoiBSAGRw0ACwsgCSAEIAdqIgVHBEAgBSAJIAYQgg0LAkAgBEUEQCAGIQMMAQtBACEBAkAgBkUEQEEAIQMMAQtBACEDQQAhBANAIAUtAAAhAgJAIAFBAkcNAEECIQEgAkH/AXFBA0sNACADIAdqQQM6AAAgA0EBaiEDQQAhAQsgBUEBaiEFIAMgB2ogAjoAAEEAIAFBAWogAkH/AXEbIQEgA0EBaiEDIARBAWoiBCAGRw0ACwsgAyAHaiAFSw0ECyAAKAKAByIBBEAgByADIAAoAoQHIAERBQALIAAgACgCyAYgA2o2AsgGDwtB6yFBnx9BzjhBxyEQCQALQfshQZ8fQeA4QY4iEAkAC0HrIUGfH0HOOEHHIRAJAAtBpCJBnx9ByMQAQa8iEAkAC4sTARB/IAEgACgC+AYiByAHIAFKGyIBIAAoAvQGIgcgASAHShsiAUEzIAFBM0gbIgggACgC7ANHBEAgACAINgLsA0GwJUHAJCAAKAKAARshCkECIQkDQCAAQQIgCWtB1ABsaiIHIAhBAXQiAUGQJ2ovAQAiBEGBgH5qOwGmBCAHIAFBoCZqLwEAIgJBgYB+ajsBpAQgByABQbAlai8BADsBogQgByABIApqLwEAOwGgBCAHQZ4EaiILIAhB1gBsQQl1IgFBemwgCGpBDGwiA0H6I2ouAQAgAXQ7AQAgB0GaBGoiDCADQfYjai4BACABdDsBACAHQZYEaiINIANB8iNqLgEAIAF0OwEAIAdBnARqIg4gA0H4I2ouAQBBAXQgAXUiBTsBACAHQZgEaiIPIANB9CNqLgEAQQF0IAF1IgY7AQAgB0GUBGoiECADQfAjai4BAEEBdCABdSIBOwEAIAcgAUH//wNxIgNBD3QiEUH//wUgAmsiAU1BD3QiAiACQYCAAXIiAiACIANsIAFLGyICIAJBgMAAciICIAIgA2wgAUsbIgIgAkGAIHIiAiACIANsIAFKGyICIAJBgBByIgIgAiADbCABShsiAiACQYAIciICIAIgA2wgAUobIgIgAkGABHIiAiACIANsIAFKGyICIAJBgAJyIgIgAiADbCABShsiAiACQYABciICIAIgA2wgAUobIgIgAkHAAHIiAiACIANsIAFKGyICIAJBIHIiAiACIANsIAFKGyICIAJBEHIiAiACIANsIAFKGyICIAJBCHIiAiACIANsIAFKGyICIAJBBHIiAiACIANsIAFKGyICIAJBAnIiAiACIANsIAFKGyICIAJBAXIiAiACIANsIAFKGyICOwGsBCAHIAI7AagEIAcgBkH//wNxIgJBD3QgAU1BD3QiBiAGQYCAAXIiBiACIAZsIAFLGyIGIAZBgMAAciIGIAIgBmwgAUsbIgYgBkGAIHIiBiACIAZsIAFKGyIGIAZBgBByIgYgAiAGbCABShsiBiAGQYAIciIGIAIgBmwgAUobIgYgBkGABHIiBiACIAZsIAFKGyIGIAZBgAJyIgYgAiAGbCABShsiBiAGQYABciIGIAIgBmwgAUobIgYgBkHAAHIiBiACIAZsIAFKGyIGIAZBIHIiBiACIAZsIAFKGyIGIAZBEHIiBiACIAZsIAFKGyIGIAZBCHIiBiACIAZsIAFKGyIGIAZBBHIiBiACIAZsIAFKGyIGIAZBAnIiBiACIAZsIAFKGyIGIAZBAXIiBiACIAZsIAFKGyICOwG0BCAHIAI7AbAEIAcgAjsBrgQgByACOwGqBCAHIAVB//8DcSICQQ90IAFNQQ90IgUgBUGAgAFyIgUgAiAFbCABSxsiBSAFQYDAAHIiBSACIAVsIAFLGyIFIAVBgCByIgUgAiAFbCABShsiBSAFQYAQciIFIAIgBWwgAUobIgUgBUGACHIiBSACIAVsIAFKGyIFIAVBgARyIgUgAiAFbCABShsiBSAFQYACciIFIAIgBWwgAUobIgUgBUGAAXIiBSACIAVsIAFKGyIFIAVBwAByIgUgAiAFbCABShsiBSAFQSByIgUgAiAFbCABShsiBSAFQRByIgUgAiAFbCABShsiBSAFQQhyIgUgAiAFbCABShsiBSAFQQRyIgUgAiAFbCABShsiBSAFQQJyIgUgAiAFbCABShsiBSAFQQFyIgUgAiAFbCABShsiATsBtgQgByABOwGyBCAHIBFB//8FIARrIgFNQQ90IgIgAkGAgAFyIgIgAiADbCABSxsiAiACQYDAAHIiAiACIANsIAFLGyICIAJBgCByIgIgAiADbCABShsiAiACQYAQciICIAIgA2wgAUobIgIgAkGACHIiAiACIANsIAFKGyICIAJBgARyIgIgAiADbCABShsiAiACQYACciICIAIgA2wgAUobIgIgAkGAAXIiAiACIANsIAFKGyICIAJBwAByIgIgAiADbCABShsiAiACQSByIgIgAiADbCABShsiAiACQRByIgIgAiADbCABShsiAiACQQhyIgIgAiADbCABShsiAiACQQRyIgIgAiADbCABShsiAiACQQJyIgIgAiADbCABShsiAiACQQFyIgIgAiADbCABShsiAzsBuAQgByADOwG8BCAHIBAvAQAiAzsBzAQgByADOwHIBCAHIA8vAQAiAzsB1AQgByADOwHQBCAHIAM7Ac4EIAcgAzsBygQgByAOLwEAIgI7AdYEIAcgA0EPdCABTUEPdCIEIARBgIABciIEIAMgBGwgAUsbIgQgBEGAwAByIgQgAyAEbCABSxsiBCAEQYAgciIEIAMgBGwgAUobIgQgBEGAEHIiBCADIARsIAFKGyIEIARBgAhyIgQgAyAEbCABShsiBCAEQYAEciIEIAMgBGwgAUobIgQgBEGAAnIiBCADIARsIAFKGyIEIARBgAFyIgQgAyAEbCABShsiBCAEQcAAciIEIAMgBGwgAUobIgQgBEEgciIEIAMgBGwgAUobIgQgBEEQciIEIAMgBGwgAUobIgQgBEEIciIEIAMgBGwgAUobIgQgBEEEciIEIAMgBGwgAUobIgQgBEECciIEIAMgBGwgAUobIgQgBEEBciIEIAMgBGwgAUobIgM7AcQEIAcgAzsBwAQgByADOwG+BCAHIAM7AboEIAcgAkEPdCABTUEPdCIDIANBgIABciIDIAIgA2wgAUsbIgMgA0GAwAByIgMgAiADbCABSxsiAyADQYAgciIDIAIg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ampqampqaiEFCyADIAVqIANBEEZ2QQR2QYGChAhsQYCBgoR4IAMbIgQhAyAEIQUgBAwCCyACIBEtAABBgYKECGwiAzYCDCACIAM2AgggAiADNgIEIAIgAzYCACACIBEtAAFBgYKECGwiAzYCHCACIAM2AhggAiADNgIUIAIgAzYCECACIBEtAAJBgYKECGwiAzYCLCACIAM2AiggAiADNgIkIAIgAzYCICACIBEtAANBgYKECGwiAzYCPCACIAM2AjggAiADNgI0IAIgAzYCMCACIBEtAARBgYKECGwiAzYCTCACIAM2AkggAiADNgJEIAIgAzYCQCACIBEtAAVBgYKECGwiAzYCXCACIAM2AlggAiADNgJUIAIgAzYCUCACIBEtAAZBgYKECGwiAzYCbCACIAM2AmggAiADNgJkIAIgAzYCYCACIBEtAAdBgYKECGwiAzYCfCACIAM2AnggAiADNgJ0IAIgAzYCcCACIBEtAAhBgYKECGwiAzYCjAEgAiADNgKIASACIAM2AoQBIAIgAzYCgAEgAiARLQAJQYGChAhsIgM2ApwBIAIgAzYCmAEgAiADNgKUASACIAM2ApABIAIgES0ACkGBgoQIbCIDNgKsASACIAM2AqgBIAIgAzYCpAEgAiADNgKgASACIBEtAAtBgYKECGwiAzYCvAEgAiADNgK4ASACIAM2ArQBIAIgAzYCsAEgAiARLQAMQYGChAhsIgM2AswBIAIgAzYCyAEgAiADNgLEASACIAM2AsABIAIgES0ADUGBgoQIbCIDNgLcASACIAM2AtgBIAIgAzYC1AEgAiADNgLQASACIBEtAA5BgYKECGwiAzYC7AEgAiADNgLoASACIAM2AuQBIAIgAzYC4AEgAiARLQAPQYGChAhsIgM2AvABIAMhBSADIQcMAgsgGygCCCEFIBsoAgQhAyAbKAIAIQQgGygCDAshByACIAQ2AvABIAIgBzYC7AEgAiAFNgLoASACIAM2AuQBIAIgBDYC4AEgAiAHNgLcASACIAU2AtgBIAIgAzYC1AEgAiAENgLQASACIAc2AswBIAIgBTYCyAEgAiADNgLEASACIAQ2AsABIAIgBzYCvAEgAiAFNgK4ASACIAM2ArQBIAIgBDYCsAEgAiAHNgKsASACIAU2AqgBIAIgAzYCpAEgAiAENgKgASACIAc2ApwBIAIgBTYCmAEgAiADNgKUASACIAQ2ApABIAIgBzYCjAEgAiAFNgKIASACIAM2AoQBIAIgBDYCgAEgAiAHNgJ8IAIgBTYCeCACIAM2AnQgAiAENgJwIAIgBzYCbCACIAU2AmggAiADNgJkIAIgBDYCYCACIAc2AlwgAiAFNgJYIAIgAzYCVCACIAQ2AlAgAiAHNgJMIAIgBTYCSCACIAM2AkQgAiAENgJAIAIgBzYCPCACIAU2AjggAiADNgI0IAIgBDYCMCACIAc2AiwgAiAFNgIoIAIgAzYCJCACIAQ2AiAgAiAHNgIcIAIgBTYCGCACIAM2AhQgAiAENgIQIAIgBzYCDCACIAU2AgggAiADNgIEIAIgBDYCAAsgAiAHNgL8ASACIAU2AvgBIAIgAzYC9AEgACgC3AZBECAAKAKQByAGQbAIahCHASAAKALsAyIEQQF0IgJBwC5qLwEAaiACQaAqai8BAEE/IAAoApwBQQJqZ0EBdGtsQQR1aiICIAAoArABSARAIABBBjYCmAEgACACNgKwASAAKAKMByECIAAgACgCkAc2AowHIAAgAjYCkAcLAkAgACgC4AZBAk4EQCAAKAKAAUUNAQsgACgCkAEiAiAAKAJYIgcgACgChAEiBWoiA04hISACIANBf2pOBEAgIUEJQQggIRsgACgCiAEgB0F/akYbISELIAIgBUcEQCAhQQJyICEgACgCiAEbISELAkAgAiADTARAIAAoAogBIQMMAQsgIUEEaiAhIAAoAogBIgMbISELIAAoApAHIRogACgC1AIhHyAAKALcBiE1IAYgACgCwAYiAi0AIDoAowUgBiACLQAAOgCiBSAGIAItAAE6AKEFIAYgAi0AAjoAoAUgBiACLQADOgCfBSAGIAItAAQ6AJ4FIAYgAi0ABToAnQUgBiACLQAGOgCcBSAGIAItAAc6AJsFIAYgAi0ACDoAmgUgBiACLQAJOgCZBSAGIAItAAo6AJgFIAYgAi0ACzoAlwUgBiACLQAMOgCWBSAGIAItAA06AJUFIAYgAi0ADjoAlAUgBiACLQAPOgCTBSAGIAIgA0EFdGoiAigCMDYCpAUgBiACKAI0NgKoBSAGIAIoAjg2AqwFIAYgAigCPDYCsAUgBiACKAJQNgK0BSAAQZQEaiEkICFBAnEhLCAhQQFxIS0gBEEBdEGAMGovAQAhDCAGQaQFaiE3QQAhBEEAIRUDQCAhIARB8DBqLQAAIgVxIAVBBHZyIQMgNyAEQQNxIgdBAnQiCWogBEH8////B3FrIQIgACgCvAYiCCAAKAKIAUECdGogB2pBBGohHCAIIARBAnYiB2ohF0EAIQggAkEAAn8gBUEEcUUEQCADIANBBHIiBSAEQQRJGyADICwbIgMgBSAEQQNLGyADIC0bIQMLIAMLIANBCHIgBEECSxsgAyAtGyISQQFxIhYbIQMgB0EGdCAJciIPIAAoAtwGaiITKAIwIQkgEygCICENIBMoAhAhCiATKAIAIQsgFywAACIOIBwsAAAiEEghGCAAKALsA0EBdEGgKmohFEEAIQcgAkF7aiIgQQAgEkECcSIZQQF2GyIFQSBPBEAgBS0AAyAFLQACIAUtAAAgBS0AAWpqaiEIQQIhBwsgDiAQIBgbIQ4gFC8BACEQAkAgA0UNACADQSBJDQAgB0ECaiEHIAMtAAMgAy0AAiADLQABIAggAy0AAGpqamohCAtBAiEFIA8gGmoiAyAHIAhqIAdBBEZ2QQJ2QYGChAhsQYCBgoR4IAcbIgc2AjAgAyAHNgIgIAMgBzYCECADIAc2AgAgCyAKIA0gCSAHIAcgByAHEIsBQQAgEEEDbEEEdiIPQQIgDiAOQQBIGyIIQQJGG2ohEAJAIBZFBEAgECEHDAELIAIoAgQiJiEWIBJBCHFFBEAgAiACLQADQYGChAhsIhY2AgQLAkAgCyAKIA0gCSACKAIAIg4gDiAOIA4QiwEgD0EAIAgbaiIHIBBOBEAgECEHDAELIAMgDjYCMCADIA42AiAgAyAONgIQIAMgDjYCACACLQAAIQ4gAi0ABCEWQQAhBQsgCyAKIA0gCSACLQAGIhhBAmoiECAWQf8BcSIWaiACLQAFIh5BAXRqQQZ0IAItAAciFEEDbCAQakEWdHJBgP6HeHEgHkECaiIdIAItAAMiECAWQQF0ampBAnZyIBhBAXQgFGogHWpBDnRBgID8D3FyIiVBCHQgAi0AAiIYQQJqIicgEEEBdCAWampBAnZyIiNBCHQgECACLQABIh1qIBhBAXRqQQJqQQJ2ciIUQQh0ICcgDkH/AXEiImogHUEBdGpBAnZyIg4gFCAjICUQiwFBACAPIAhBA0YbaiInIAdIBEAgAyAlNgIwIAMgIzYCICADIBQ2AhAgAyAONgIAIAItAAAhIiACLQAEIRYgAi0AASEdIAItAAIhGCACLQADIRAgAi0ABSEeQQMhBSAnIQcLIAsgCiANIAkgECAWQQFqIhZqQQ90QYCA/A9xIBAgGGpBB3RBgAFqQYD+B3EgHUEBaiIdIBhqQQF2cnIiEEEIdCAdICJqQQF2ciIYIA4gECAWIB5qQRd0QYCAgHhxciIQIBQQiwFBACAPIAhBB0YbaiIWIAdIBEAgAyAUNgIwIAMgEDYCICADIA42AhAgAyAYNgIAQQchBSAWIQcLIAIgJjYCBAsCQCAZRQ0AICAtAAAiFCEQIAsgCiANIAkgAkF+aiIeLQAAIhhBgYKECGwiHSACQX1qIiUtAAAiDkGBgoQIbCIjIAJBfGoiIi0AACIWQYGChAhsIiYgFEGBgoQIbCIZEIsBQQAgDyAIQQFGG2oiJyAHSARAIAMgGTYCMCADICY2AiAgAyAjNgIQIAMgHTYCACAeLQAAIRggJS0AACEOICAtAAAhECAiLQAAIRZBASEFICchBwsgCyAKIA0gCSAWQQJqIh4gDkEBdCAYampBBnRBgP4HcSAOIBhqQQFqQQF2ciAOIBBqIBZBAXRqQQZ0QYABakGA/gdxIBZBAWoiFiAOakEBdnIiGEEQdHIiHSAeIBBBA2xqQQZ0QYD+B3EgFEGAgIQIbCAQIBZqQQF2cnIiDkEQdCAYciIQIA4gGRCLAUEAIA8gCEEIRhtqIhYgB04NACADIBk2AjAgAyAONgIgIAMgEDYCECADIB02AgBBCCEFIBYhBwsCQCASQQdxQQdHDQAgCyAKIA0gCSACLQAAIhBBAmoiFiACLQACIhIgAi0AASIOQQF0ampBDnRBgID8D3EgDkECaiIOIAItAAMgEkEBdGpqQRZ0QYCAgHhxciAQQQF0IA5qIAJBf2oiIy0AACIOakEGdEGA/gdxciACQX5qIiYtAAAiEiAOQQF0IBZqakECdnIiFiAWQQh0IhkgAkF9aiInLQAAIhBBAmoiFCASQQF0IA5qakECdnIiHiAeQQh0IAJBfGoiMi0AACIYIBIgEEEBdGpqQQJqQQJ2ciIdICAtAAAiJSAYQQF0IBRqakECdiIiIB1BCHRyIhQQiwFBACAPIAhBBEYbaiIqIAdIBEAgAyAUNgIwIAMgHTYCICADIB42AhAgAyAWNgIAICAtAAAhJSAyLQAAIRggJy0AACEQICYtAAAhEiAjLQAAIQ5BBCEFICohBwsgCyAKIA0gCSASQQFqIiAgDmpBAXYgGXIiEiAQICBqQQF2IBRBEHZB/wFxIiBBCHRyIh4gEkEQdHIiHSAYQQFqIhggEGpBAXYgFEEIdkH/AXEiEEEIdHIiFCAeQRB0ciIeICJBCHRBgP4DcSAYICVqQQF2ciAUQRB0ciIYEIsBQQAgDyAIQQZGG2oiFCAHSARAIAMgGDYCMCADIB42AiAgAyAdNgIQIAMgEjYCACAjLQAAIQ5BBiEFIBQhBwsgCyAKIA0gCSACLQACQQFqIhIgAi0AASIYakEPdEGAgPwPcSASIAItAANqQRd0QYCAgHhxciACLQAAQQFqIhIgDmpBAXZyIBIgGGpBB3RBgP4HcXIiDiAWIA5BCHQgIHIiEiAQIBlyIhAQiwFBACAPIAhBBUYbaiIJIAdODQAgAyAQNgIwIAMgEjYCICADIBY2AhAgAyAONgIAQQUhBSAJIQcLIBwgBToAACAXIAU6AAAgACAEakF/IAUgBSAISmsgBSAIRhs6AKABIBVBAXQhFSA1IARBBnRqQaAKaiEFAkAgB0EEdEEEdSIHIAAoAuwDQQF0QYAxai8BAEoEQCATIANBEEECIAUgJBCMASIIIBVyIRUgCEEBcUUNASADQRAgAyAFQQFBfxCNAQwBCyAFQgA3AQAgBUIANwE4IAVCADcBMCAFQgA3ASggBUIANwEgIAVCADcBGCAFQgA3ARAgBUIANwEICyACIAMtAAM6AAIgAiADLQATOgABIAIgAy0AIzoAACACQXxqIAMoAjA2AgAgByAMaiEMIARBAWoiBEEQRw0ACyAAKALcBiAVOwGQFyAMIAAoArABTg0AIABBBTYCmAEgACAMNgKwASAfQQdxDQUgGkEHcQ0GIAAoAuACIQNBECECA0AgGikCACFZIB8gGikCCDcCCCAfIFk3AgAgAyAfaiEfIBpBEGohGiACQX9qIgINAAsLIAAoApgBQQRKDQELIAAuAZYHIgUgBWwgAC4BlAciByAHbGohDSAAKAL4ASICQRB0QRB1IgMgA2wgAkEQdSIEIARsaiIKIAAuAZoHIgggCGwgAC4BmAciCSAJbGpJBEAgACAEIAVBP2xqQSBqQQZ2OwGWByAAIAMgB0E/bGpBIGpBBnY7AZQHCyAKIA1PBEAgACAEIAhBP2xqQSBqQQZ2OwGaByAAIAMgCUE/bGpBIGpBBnY7AZgHCyAGIAAoAowBQRZ0IAJqQYCAfHEgACgCiAFBBnQgAmpB//8DcXIiAjYCDCAGIAI2AlggACAGQQxqEIgBDAgLIAAoApAHIgVBA3ENBCAbQRBqIgJBA3ENBUEAISIgACgCnAEiA0EATARAIBsoAhAhAiAbKAIUIQMgGygCGCEEIAUgGygCHCIHNgJ8IAUgBDYCeCAFIAM2AnQgBSACNgJwIAUgBzYCbCAFIAQ2AmggBSADNgJkIAUgAjYCYCAFIAc2AlwgBSAENgJYIAUgAzYCVCAFIAI2AlAgBSAHNgJMIAUgBDYCSCAFIAM2AkQgBSACNgJAIAUgBzYCPCAFIAQ2AjggBSADNgI0IAUgAjYCMCAFIAc2AiwgBSAENgIoIAUgAzYCJCAFIAI2AiAgBSAHNgIcIAUgBDYCGCAFIAM2AhQgBSACNgIQIAUgBzYCDCAFIAQ2AgggBSADNgIEIAUgAjYCAAwJCyADQQFGDQYgEUEQaiEDQQIhCQNAIAUhBEEAIQdBACEFIANBIEkiDUUEQEECIQUgAy0AAyADLQACIAMtAAAgAy0AAWpqaiEHCyACQSBJIgpFBEAgBUECaiEFIAItAAMgAi0AAiACLQABIAcgAi0AAGpqamohBwsgBCAFIAdqIAVBBEZ2QQJ2QYGChAhsQYCBgoR4IAUbIgc2AgQgBCAHNgJAIAQgBzYCACACQQRqIQtBACEIQQAhBSADQQRqQSBJIg9FBEAgAy0AByADLQAGIAMtAAQgAy0ABWpqaiEIQQIhBQsgBAJ/IAtBIEkiC0UEQCACLQAHIAItAAYgAi0ABSAIIAItAARqampqIQggBUECaiEFCyAFIAhqIAVBBEZ2QQJ2QYGChAhsC0GAgYKEeCAFGyITNgJEIAchCCAKRQRAQQAhCEEAIQUgBAJ/IAtFBEAgAi0AByACLQAGIAItAAQgAi0ABWpqaiEIQQIhBQsgBSAIaiAFQQRGdkECdkGBgoQIbAtBgIGChHggBRsiCDYCBAsgByEKIA1FBEBBACENQQAhBSAEAn8gD0UEQCADLQAHIAMtAAYgAy0ABCADLQAFampqIQ1BAiEFCyAFIA1qIAVBBEZ2QQJ2QYGChAhsC0GAgYKEeCAFGyIKNgJACyACQQhqIQIgA0EIaiEDIARBCGohBSAJQX9qIgkNAAsgBCAINgI0IAQgBzYCMCAEIAg2AiQgBCAHNgIgIAQgCDYCFCAEIAc2AhAgBCATNgJ0IAQgCjYCcCAEIBM2AmQgBCAKNgJgIAQgEzYCVCAEIAo2AlAgBCAEKAI4IgI2AkggBCAEKAI8IgM2AmwgBCACNgJoIAQgAzYCXCAEIAI2AlggBCADNgJMIAQgBEF4aigCACICNgIIIAQgBEF8aigCACIDNgIsIAQgAjYCKCAEIAM2AhwgBCACNgIYIAQgAzYCDAwHC0GwL0GfH0HQMEHHLxAJAAtB4S9Bnx9B0TBBxy8QCQALQbQoQZ8fQew0QcUoEAkAC0HWKEGfH0HtNEHFKBAJAAtBsC9Bnx9B9zBBzTIQCQALQeEvQZ8fQfgwQc0yEAkACyARLQAQIQIgBSARLQAYQYGChAhsIgM2AgwgBSADNgIIIAUgAkGBgoQIbCICNgIEIAUgAjYCACARLQARIQIgBSARLQAZQYGChAhsIgM2AhwgBSADNgIYIAUgAkGBgoQIbCICNgIUIAUgAjYCECARLQASIQIgBSARLQAaQYGChAhsIgM2AiwgBSADNgIoIAUgAkGBgoQIbCICNgIkIAUgAjYCICARLQATIQIgBSARLQAbQYGChAhsIgM2AjwgBSADNgI4IAUgAkGBgoQIbCICNgI0IAUgAjYCMCARLQAUIQIgBSARLQAcQYGChAhsIgM2AkwgBSADNgJIIAUgAkGBgoQIbCICNgJEIAUgAjYCQCARLQAVIQIgBSARLQAdQYGChAhsIgM2AlwgBSADNgJYIAUgAkGBgoQIbCICNgJUIAUgAjYCUCARLQAWIQIgBSARLQAeQYGChAhsIgM2AmwgBSADNgJoIAUgAkGBgoQIbCICNgJkIAUgAjYCYCARLQAXIQIgBSARLQAfQYGChAhsIgM2AnwgBSADNgJ4IAUgAkGBgoQIbCICNgJ0IAUgAjYCcAtBACEiC0F+IAAoApgBIgMgIhshHSAAKALcBiEMIAAoArgGIhQgACgCiAEiAkEDdGpBCGohGSADQQVHBEAgAkECdCAAKAK8BiICakGChIgQNgIEIAJBgoSIEDYCACAAKAKIASECCyAAQaQGaiIDIAAoAqgGIAJqLQAAIAMoAgBBBHZBkIQhcXI2AgAgBiAZLQAAOgCVBSAZQQA6AAAgBiAULQAAOgCTBSAUQQA6AAAgBiAZLQABOgCWBSAZQQA6AAEgBiAULQABOgCSBSAUQQA6AAEgBiAZLQACOgCXBSAZQQA6AAIgBiAULQACOgCRBSAUQQA6AAIgBiAZLQADOgCYBSAZQQA6AAMgBiAULQADOgCQBSAUQQA6AANBCUEIIB1BBUobIS0gDEGIF2ohHCAMQYAXaiEXIABB6ARqIRYgDEHgFGohECAMQcASaiEgIAxBgApqISMgDEHgFmohISAAQZQEaiElIAxBoApqIR4gACgCmAEhAgJAAkACQAJAAkACQANAAkACQCACQQFqIgJBBksNAAJAIAJBAWsOBgEBAQEBAgALIAAoAoABQQJGDQYgAEGUAWoiAiACKAIAQQFqNgIAIBRBADYCBCAZQQA2AgQgACgC+AEhAiAAKAK0BiIDIAMgACgCiAFBBHRqIgNBLGoiBCgCADYCECAAKAK0BiACNgIUIAAoArQGIAI2AhggACgCtAYgAjYCHCAAKAK0BiACNgIAIAAoArQGIAI2AgQgACgCtAYgAjYCCCAAKAK0BiACNgIMIAQgAjYCACADIAI2AiggAyACNgIkIAMgAjYCICAAIAAoAvgBIgI2ApgGIAAgAjYClAYgACACNgKQBiAAIAI2AowGIAAgAjYChAYgACACNgKABiAAIAI2AvwFIAAgAjYC+AUgACACNgLwBSAAIAI2AuwFIAAgAjYC6AUgACACNgLkBSAAIAI2AtwFIAAgAjYC2AUgACACNgLUBSAAIAI2AtAFIAAoAtQCIgJBB3ENBSAAKAKMByIDQQdxDQQgACgC4AIhBUEQIQQDQCADKQIAIVkgAiADKQIINwIIIAIgWTcCACACIAVqIQIgA0EQaiEDIARBf2oiBA0ACyAAKALYAiAAKALkAiAAKAKQBxCKASAAKALcAiAAKALoAiAAKAKQB0EIahCKAQwICyAMIAAoAowHQRAgLSAeICUQjAEhAiAAKALcBiACOwGQFyAdQQZOBEAgIxCOASAMIAAuAZQEIgIgDC4BgApsQYCACGpBEnUiAzsB4BYgDCADOwGACiAMIAIgDC4BggpsQYCACGpBEnUiAzsBggogDCADOwHiFiAMIAIgDC4BhApsQYCACGpBEnUiAzsBhAogDCADOwHkFiAMIAIgDC4BhgpsQYCACGpBEnUiAzsBhgogDCADOwHmFiAMIAIgDC4BiApsQYCACGpBEnUiAzsBiAogDCADOwHoFiAMIAIgDC4BigpsQYCACGpBEnUiAzsBigogDCADOwHqFiAMIAIgDC4BjApsQYCACGpBEnUiAzsB7BYgDCADOwGMCiAMIAIgDC4BjgpsQYCACGpBEnUiAzsB7hYgDCADOwGOCiAMIAIgDC4BkApsQYCACGpBEnUiAzsB8BYgDCADOwGQCiAMIAIgDC4BkgpsQYCACGpBEnUiAzsB8hYgDCADOwGSCiAMIAIgDC4BlApsQYCACGpBEnUiAzsB9BYgDCADOwGUCiAMIAIgDC4BlgpsQYCACGpBEnUiAzsB9hYgDCADOwGWCiAMIAIgDC4BmApsQYCACGpBEnUiAzsB+BYgDCADOwGYCiAMIAIgDC4BmgpsQYCACGpBEnUiAzsB+hYgDCADOwGaCiAMIAIgDC4BnApsQYCACGpBEnUiAzsB/BYgDCADOwGcCiAMIAIgDC4BngpsQYCACGpBEnUiAjsB/hYgDCACOwGeCiAjEI4BIAAvAZYEIgJBA3ENAyAMIAJBAnYiAiAMLwGACmw7AcAKIAwgDC8BggogAmw7AYALIAwgDC8BhAogAmw7AcALIAwgDC8BhgogAmw7AYAMIAwgDC8BiAogAmw7AcAMIAwgDC8BigogAmw7AYANIAwgDC8BjAogAmw7AcANIAwgDC8BjgogAmw7AYAOIAwgDC8BkAogAmw7AcAOIAwgDC8BkgogAmw7AYAPIAwgDC8BlAogAmw7AcAPIAwgDC8BlgogAmw7AYAQIAwgDC8BmAogAmw7AcAQIAwgDC8BmgogAmw7AYARIAwgDC8BnAogAmw7AcARIAwgDC8BngogAmw7AYASQf//AyECCyAAKALUAiAAKALgAiAAKAKMByAeQQQgAkEQdBCNAQtBACEVIAAoAtwGLwGQFyICQYCYA3FBAEciA0ECciADIAJBgOYAcRsiA0EEciADIAJBzAFxGyIDQQhyIAMgAkEzcRshH0EBIRMDQCAAIBNBAnRqIg4oAjggACgCiAEiBCAOKAJEIgMgACgCjAEiBWxqQQN0aiECICAgECATQQFGIhobIQsgACgCkAcgE0EDdGpBeGohEgJAIAAoAnxFDQACQCAEQQR0QRBqIAAoAgAiB0oEQCAAKAIEIQgMAQsgBUEEdEEQaiAAKAIEIghMDQELQQAgB0ECbSAEQQN0ayIEQQggBEEISBsiDWshD0EIIA1rIQkgAyANayEKIAAoAtwGIQMgCEECbSAFQQN0ayIEQQggBEEISBsiGCEIA0AgDSEEA0AgAyIFIAItAAAiBzoAACADQQFqIQMgAkEBaiECIARBf2oiBA0ACyAJBEAgAyAHIAkQgQ0aIAUgD2pBCWohAwsgAiAKaiECIAhBf2oiCA0AC0EIIBhrIgIEQCADQXhqIQQDQCADIAQpAAA3AAAgA0EIaiEDIAJBf2oiAg0ACwsgACgC3AYhAkEIIQMLIAIgEiADQQUgCyAWEIwBIQcgC0FmaiICIAIvAQAiCSALQWBqIgUvAQAiDSALQWJqIgMvAQAiCmsiDyALQWRqIgQvAQAiCGtqOwEAIAQgCiANaiINIAhrIAlrOwEAIAMgCCAPaiAJazsBACAFIAkgCCANamoiCTsBACAFIAAvAegEQRF0QRB1IgggCUEQdEEQdSIJbEHWqg1BqtUCIAlBAEgbakESdSINOwEAIBcgHCAaGyIJIA07AQAgAyADLgEAIg0gCGxB1qoNQarVAiANQQBIG2pBEnUiDTsBACAJIA07AQIgBCAELgEAIg0gCGxB1qoNQarVAiANQQBIG2pBEnUiDTsBACAJIA07AQQgAiACLgEAIg0gCGxB1qoNQarVAiANQQBIG2pBEnUiCDsBACAJIAg7AQYgAiACLwEAIgkgBS8BACIKIAMvAQAiD2siGiAELwEAIghraiINOwEAIAQgCiAPaiICIAhrIAlrIgo7AQAgAyAIIBpqIAlrIgQ7AQAgBSAJIAIgCGpqIgM7AQACQAJAAkAgAC8B6gQiAkEBcUUEQCALIAJBAXYiAiANbDsB4AEgCyACIApsOwGgASALIAIgBGw7AWAgCyACIANsOwEgQQIgFSAHGyECIAcgAyAEciAKciANckH//wNxIgRBAEciA3JFBEAgDigC1AIgDigC4AIgEhCKAQwECyAERQ0CIAdBf3MiBEEIcQRAIAtCADcBOCALQgA3ATIgC0IANwEqIAtCADcBIgsgBEEEcQRAIAtCADcBeCALQgA3AXIgC0IANwFqIAtCADcBYgsgBEECcQRAIAtCADcBuAEgC0IANwGyASALQgA3AaoBIAtCADcBogELQQ8hByAEQQFxDQEMAgtBszRBnx9BgDZBwjQQCQALIAtCADcB+AEgC0IANwHyASALQgA3AeoBIAtCADcB4gELIA4oAtQCIA4oAuACIBIgC0ECIAdBHHQQjQELIAIgA3IhFSATQQFqIhNBA0cNAAsCQCAAKAKYASIEIBVBAiAVQQJIGyISIB9ycg0AIAAoAvgBIAAoArgCRw0AQX8hAiAAQX82ApgBDAELCyAdQQZIBH8gHwUgACgCnAEgEkECdEEMQQAgHxtqIARqaiEEQQ9BACAfGwshFiAAKAKAAUECRiIFRQRAQQAhAiAAKAKUAUEBaiIHIQMDQCACQQFqIQIgA0EBdiIDDQALIABBzAZqIAJBAXRBf2ogBxB4IABBADYClAELAkACQAJAAkACQAJAIAFBAUgNACAAKAKkB0UNACAAIAAoAswGQX9qIgI2AswGIAACfyACQQBOBEAgACgC0AYMAQsgAkFgTA0CIABB1AZqIgMgAygCACIHQQRqNgIAIAcgAEHQBmoiCCgCACAiQQAgAmt2ciICQRh0IAJBCHRBgID8B3FyIAJBCHZBgP4DcSACQRh2cnI2AgAgCEEANgIAIAAgACgCzAZBIGoiAjYCzAZBAAsgIiACdHI2AtAGCyAiRQRAQQAhAiAEQXtqIAQgBRsgBCAEQQRKG0EBaiIEIQMDQCACQQFqIQIgA0EBdiIDDQALIABBzAZqIAJBAXRBf2ogBBB4CyAAKAKYAUEDRgRAIAAgACgCzAZBf2oiAjYCzAYCfyACQQBOBEAgACgC0AYMAQsgAkFgTA0DIABB1AZqIgMgAygCACIDQQRqNgIAIAMgAEHQBmoiBSgCAEEBQQAgAmt2ciICQRh0IAJBCHRBgID8B3FyIAJBCHZBgP4DcSACQRh2cnI2AgAgBUEANgIAIAAgACgCzAZBIGoiAjYCzAZBAAshBCAAIAJBf2oiAzYCzAYgAEEBIAJ0IARyIgQ2AtAGIAJBAEoEfyAEBSACQWFMDQQgAEHUBmoiAiACKAIAIgdBBGo2AgAgB0EBQQAgA2t2IARyIgJBGHQgAkEIdEGAgPwHcXIgAkEIdkGA/gNxIAJBGHZycjYCACAAQQA2AtAGIAAgACgCzAZBIGoiAzYCzAZBAAshBSAAIANBf2oiAjYCzAYgAEEBIAN0IAVyIgQ2AtAGIANBAEoEfyAEBSADQWFMDQUgAEHUBmoiAyADKAIAIgNBBGo2AgAgA0EBQQAgAmt2IARyIgJBGHQgAkEIdEGAgPwHcXIgAkEIdkGA/gNxIAJBGHZycjYCACAAQQA2AtAGIAAgACgCzAZBIGoiAjYCzAZBAAshBSAAIAJBf2oiAzYCzAYgAEEBIAJ0IAVyIgQ2AtAGIAAgAkEASgR/IAQFIAJBYUwNBiAAQdQGaiICIAIoAgAiBUEEajYCACAFQQFBACADa3YgBHIiA0EYdCADQQh0QYCA/AdxciADQQh2QYD+A3EgA0EYdnJyNgIAIABBADYC0AYgACAAKALMBkEgaiIDNgLMBkEAC0EBIAN0cjYC0AYLICINCSAAKAKYASICQQVOBEAgAkEFRgRAIABBzAZqIQVBACECA0AgBUEBQQQgACACQaAzai0AAGosAKABIgNBAEgiBBtBASADIAQbEHggAkEBaiICQRBHDQALC0EAIQIgACgCnAEiAyADQQJzIANBAXEbQQFqIgQhAwNAIAJBAWohAiADQQF2IgMNAAsgAEHMBmogAkEBdEF/aiAEEHggACgCtAYiAiACIAAoAogBQQR0aiICKAIsNgIQIAAoArQGQYCAAjYCFCAAKAK0BkGAgAI2AhggACgCtAZBgIACNgIcIAAoArQGQYCAAjYCACAAKAK0BkGAgAI2AgQgACgCtAZBgIACNgIIIAAoArQGQYCAAjYCDCACQoCAgoCAgCA3AiggAkKAgIKAgIAgNwIgDAoLQQJBBCACQQFxGyEHQQJBBCACQQJxGyEEIABBzAZqIQ9BACELIABBiAFqIRpBACEIQQAhCQNAQQAhAiAAIAtBAnQiBWpBuAFqIg0uAQBBAXRBf2oiA0EfdSADc0EBaiIKIQMDQCACQQFqIQIgA0EBdiIDDQALIA8gAkEBdEF/aiAKEHhBACECIA0uAQJBAXRBf2oiA0EfdSADc0EBaiINIQMDQCACQQFqIQIgA0EBdiIDDQALQQEhAyAPIAJBAXRBf2ogDRB4IAUgGmpB8ABqIhMoAgAhBSAAKAK0BiICIAlBBGoiDUECdGogAiAAKAKIAUEEdGpBIGoiCiAEIAhqIg5BAnRqQXxqKAIANgIAA0AgACgCtAYgAyANakECdGogBTYCAEEAIQIgA0EBaiIDIAdHDQALQQAhAwNAIAAoArQGIAMgCWpBAnRqIAU2AgAgA0EBaiIDIAdHDQALA0AgCiACIAhqQQJ0aiAFNgIAIAJBAWoiAiAERw0ACyAIIAlBBWxqQQJ0IABqQdAFaiEDIBMoAgAhBSAHIQgDQEEAIQIDQCADIAJBAnRqIAU2AgAgAkEBaiICIARHDQALIANBFGohAyAIQX9qIggNAAsgDkEDcSIIRQRAIAcgCWpBA3EiCUUNCwsgC0EBaiELDAAACwALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtB6yFBnx9BzjhBxyEQCQALQeshQZ8fQc44QcchEAkAC0HrIUGfH0HOOEHHIRAJAAtBkDRBnx9B9TVBnzQQCQALQdYoQZ8fQe00QcUoEAkAC0G0KEGfH0HsNEHFKBAJAAtB6DJBnx9B+scAQYgzEAkACyAWIBJBBHRqIQUgHUEFSiIERQRAQQAhAiAdQQVHQTBsIAVqQbAzai0AAEEBaiIHIQMDQCACQQFqIQIgA0EBdiIDDQALIABBzAZqIAJBAXRBf2ogBxB4C0EAIARFIAUbRQRAQQAhAiAAKALsAyAAKAKEBGtBAXRBf2oiA0EfdSADc0EBaiIEIQMDQCACQQFqIQIgA0EBdiIDDQALIABBzAZqIAJBAXRBf2ogBBB4IAAgACgC7AM2AoQECyAdQQZOBEAgAEHMBmogIUEQIAZBlAVqEI8BCyAWBEBBD0EQIB1BBUobIQggAEHMBmohCSAGQZQFaiENQQAhAgNAIAJBoDNqLQAAIgNBA3EhBAJAIAUgAkECdnZBAXEEQCAJIAwgA0EGdGpBoApqIAggBCANaiADQQJ2IgdrIgMQjwEgAy0AAEUNASAAIAAoAqQGQQEgBCAHQQVsakEFanRyNgKkBgwBCyAGQZAFaiAEQQRyIANBAnZrakEAOgAACyACQQFqIgJBEEcNAAsgGSAGLQCRBToAACAUIAYtAJcFOgAAIBkgBi0AkgU6AAEgFCAGLQCWBToAASAZIAYtAJMFOgACIBQgBi0AlQU6AAIgGSAGLQCUBSICOgADIBQgAjoAAwsCQCASRQ0AIAZBEToAcCAGQRE6AHIgAEHMBmoiAiAXQQQgBkHxAGoiAxCPASACIBxBBCADEI8BIBJBAkgNACAGIBktAAQ6APMCIAYgFC0ABDoA8QIgBiAZLQAFOgD0AiAGIBQtAAU6APACIAIgIEEPIAZB8gJqIgMQjwEgAiAMQYATakEPIAZB8wJqIgQQjwEgAiAMQcATakEPIAZB8QJqIgUQjwEgAiAMQYAUakEPIAMQjwEgGSAGLQDxAjoABCAUIAYtAPMCOgAEIBkgBi0A8gIiBzoABSAUIAc6AAUgBiAZLQAGOgDzAiAGIBQtAAY6APECIAYgGS0ABzoA9AIgBiAULQAHOgDwAiACIBBBDyADEI8BIAIgDEGgFWpBDyAEEI8BIAIgDEHgFWpBDyAFEI8BIAIgDEGgFmpBDyADEI8BIBkgBi0A8QI6AAYgFCAGLQDzAjoABiAZIAYtAPICIgI6AAcgFCACOgAHCyAVQQFKDQAgFEEANgIEIBlBADYCBAsgACgC1AIhAyAAKALABiIEIAQgACgCiAFBBXRqIgItAD86ACAgAkEwaiEFQQAhAgNAIAIgBGogACgC4AIgAmwgA2otAA86AAAgAiAFaiADIAAoAuACQQ9sIAJqai0AADoAACACQQFqIgJBEEcNAAsgACgC2AIhAiAAKALABiIEIAQgACgCiAFBBXRqIgVBxwBqIgctAAA6ACEgBCACLQAHOgAQIAVBQGsgAiAAQeQCaiIDKAIAQQdsai0AADoAACAEIAIgAygCAGotAAc6ABEgBSACIAMoAgBBB2xqLQABOgBBIAQgAiADKAIAQQF0ai0ABzoAEiAFIAIgAygCAEEHbGotAAI6AEIgBCACIAMoAgBBA2xqLQAHOgATIAUgAiADKAIAQQdsai0AAzoAQyAEIAIgAygCAEECdGotAAc6ABQgBSACIAMoAgBBB2xqLQAEOgBEIAQgAiADKAIAQQVsai0ABzoAFSAFIAIgAygCAEEHbGotAAU6AEUgBCACIAMoAgBBBmxqLQAHOgAWIAUgAiADKAIAQQdsai0ABjoARiAEIAIgAygCAEEHbGotAAc6ABcgByACIAMoAgBBB2xqLQAHOgAAIAAoAtwCIQIgACgCwAYiBCAEIAAoAogBQQV0aiIFQc8AaiIHLQAAOgAiIAQgAi0ABzoAGCAFIAIgAEHoAmoiAygCAEEHbGotAAA6AEggBCACIAMoAgBqLQAHOgAZIAUgAiADKAIAQQdsai0AAToASSAEIAIgAygCAEEBdGotAAc6ABogBSACIAMoAgBBB2xqLQACOgBKIAQgAiADKAIAQQNsai0ABzoAGyAFIAIgAygCAEEHbGotAAM6AEsgBCACIAMoAgBBAnRqLQAHOgAcIAUgAiADKAIAQQdsai0ABDoATCAEIAIgAygCAEEFbGotAAc6AB0gBSACIAMoAgBBB2xqLQAFOgBNIAQgAiADKAIAQQZsai0ABzoAHiAFIAIgAygCAEEHbGotAAY6AE4gBCACIAMoAgBBB2xqLQAHOgAfIAcgAiADKAIAQQdsai0ABzoAAAJAIAAoAqwGDQAgACgChAQhJCAAKAKYASETIAAoAowBIQ4gACgCiAEiCiAAKAKoBmogACgCpAYiAkEUdjoAACAGQaAFaiEmAkAgIgRAIAYgAkEhcUEARzoAoAUgBiACQTBxQQBHOgCQBSAGIAJBwgBxQQBHOgChBSAGIAJB4ABxQQBHOgCUBSAGIAJBhAFxQQBHOgCiBSAGIAJBwAFxQQBHOgCYBSAGIAJBiAJxQQBHOgCjBSAGIAJBgANxQQBHOgCcBSAGIAJBoAhxQQBHOgCkBSAGIAJBgAxxQQBHOgCRBSAGIAJBwBBxQQBHOgClBSAGIAJBgBhxQQBHOgCVBSAGIAJBgCFxQQBHOgCmBSAGIAJBgDBxQQBHOgCZBSAGIAJBgMIAcUEARzoApwUgBiACQYDgAHFBAEc6AJ0FIAYgAkGAiAJxQQBHOgCoBSAGIAJBgIADcUEARzoAkgUgBiACQYCQBHFBAEc6AKkFIAYgAkGAgAZxQQBHOgCWBSAGIAJBgKAIcUEARzoAqgUgBiACQYCADHFBAEc6AJoFIAYgAkGAwBBxQQBHOgCrBSAGIAJBgIAYcUEARzoAngUgBiACQYCAwgBxQQBHOgCsBSAGIAJBgIDgAHFBAEc6AJMFIAYgAkGAgIQBcUEARzoArQUgBiACQYCAwAFxQQBHOgCXBSAGIAJBgICIAnFBAEc6AK4FIAYgAkGAgIADcUEARzoAmwUgBiACQYCAkARxQQBHOgCvBSAGIAJBgICABnFBAEc6AJ8FDAELAkAgE0EETARAIABBvAVqIQMgBkGQBWohBCAmIQVBBCEJA0BBAiEHIAQCf0ECIAJBMHENABpBASADKAIQIgtBEHRBEHUgAygCFCIPQRB0QRB1ayINIA1BH3UiDWogDXNBA0oNABogC0EQdSAPQRB1ayIIIAhBH3UiCGogCHNBA0oLOgAAAkAgAkEhcQ0AQQEhByADKAIAIg1BEHRBEHUgAygCFCILQRB0QRB1ayIIIAhBH3UiCGogCHNBA0oNACANQRB1IAtBEHVrIgcgB0EfdSIHaiAHc0EDSiEHCyAFIAc6AABBAiEHIAQCf0ECIAJB4ABxDQAaQQEgAygCFCILQRB0QRB1IAMoAhgiD0EQdEEQdWsiDSANQR91Ig1qIA1zQQNKDQAaIAtBEHUgD0EQdWsiCCAIQR91IghqIAhzQQNKCzoABAJAIAJBwgBxDQBBASEHIAMoAgQiDUEQdEEQdSADKAIYIgtBEHRBEHVrIgggCEEfdSIIaiAIc0EDSg0AIA1BEHUgC0EQdWsiByAHQR91IgdqIAdzQQNKIQcLIAUgBzoAAUECIQcgBAJ/QQIgAkHAAXENABpBASADKAIYIgtBEHRBEHUgAygCHCIPQRB0QRB1ayINIA1BH3UiDWogDXNBA0oNABogC0EQdSAPQRB1ayIIIAhBH3UiCGogCHNBA0oLOgAIAkAgAkGEAXENAEEBIQcgAygCCCINQRB0QRB1IAMoAhwiC0EQdEEQdWsiCCAIQR91IghqIAhzQQNKDQAgDUEQdSALQRB1ayIHIAdBH3UiB2ogB3NBA0ohBwsgBSAHOgACQQIhByAEAn9BAiACQYADcQ0AGkEBIAMoAhwiC0EQdEEQdSADKAIgIg9BEHRBEHVrIg0gDUEfdSINaiANc0EDSg0AGiALQRB1IA9BEHVrIgggCEEfdSIIaiAIc0EDSgs6AAwCQCACQYgCcQ0AQQEhByADKAIMIg1BEHRBEHUgAygCICILQRB0QRB1ayIIIAhBH3UiCGogCHNBA0oNACANQRB1IAtBEHVrIgcgB0EfdSIHaiAHc0EDSiEHCyAFIAc6AAMgA0EUaiEDIARBAWohBCACQQV1IQIgBUEEaiEFIAlBf2oiCQ0ACyATQQVOBEAgBkGEiJAgNgKQBQwCCyAKIAAoAqAGaiICQX9qLAAAQQVOBEAgBkGEiJAgNgKQBQsgAiwAAEEFSA0CDAELIAZBg4aMGDYCrAUgBkKDhoyYsODAgQM3AqQFIAZCg4aMmLDgwIEDNwOYBSAGQoSIkKCw4MCBAzcDkAULIAZBhIiQIDYCoAULIAAoAqAGIApqIBM6AAAgCkUEQCAGQQA2ApAFCyAORQRAIAZBADYCoAULIAZB1AVqIRsgBkHQBWohKSAAKAKcBiAKaiICLQAAIQMgAiAkOgAAIAJBf2otAAAhAiAGQcAFaiEqIAZB1wVqISMgBkHVBWohIiAGQdMFaiEhIAZB0QVqITUgBkHWBWohMSAGQdIFaiErIAZBsAVqISVBACEFA0AgAkH/AXEhLCAGKAKQBSIEBEAgBiAkICxqQQFqQQF1QQVsIgJB8jhqLQAAOgDUBSAGIAJB7jhqIgItAAA6ANAFIAYgAiAEQf8BcWotAAA6ALAFIAYgAiAGLQCRBWotAAA6ALEFIAYgAiAGLQCSBWotAAA6ALIFIAYgAiAGLQCTBWotAAA6ALMFCyADQf8BcSERIAYoAqAFIgMEQCAGIBEgJGpBAWpBAXVBBWwiAkHyOGotAAA6ANYFIAYgAkHuOGoiAi0AADoA0gUgBiACIANB/wFxai0AADoAwAUgBiACIAYtAKEFai0AADoAwQUgBiACIAYtAKIFai0AADoAwgUgBiACIAYtAKMFai0AADoAwwULIAYgJEF2akEFbCICQaQ5ai0AACIDOgDXBSAGIAM6ANUFIAYgAkGgOWoiAy0AACICOgDTBSAGIAI6ANEFQQQhAgNAIAIgJWogAyAGQZAFaiACai0AAGotAAA6AAAgJSACQRBqIgRqIAMgBkGQBWogBGotAABqLQAAOgAAIAJBAWoiAkEQRw0ACyAFBEAgBiAGKAK4BTYCtAUgBiAGKALIBTYCxAVBAiEPA0AgACAPQQJ0aiIDKALgAiECIAMoAtQCIQNBACEEICkhBSAbIQcDQCAEIQgCQCAFLQAAIgRFDQAgBkGQBWogCGoiBSgCACIJRQ0AIAMgCEEBdmoiDUEBIAQgBy0AACIHIAUtACAiCiAJQf8BcSIJEJABIAIgDWoiDUEBIAQgByAKIAkQkAEgAiANaiIJQQEgBCAHIAUtACEiDSAFLQABIgoQkAEgAiAJaiIJQQEgBCAHIA0gChCQASACIAlqIglBASAEIAcgBS0AIiINIAUtAAIiChCQASACIAlqIglBASAEIAcgDSAKEJABIAIgCWoiCUEBIAQgByAFLQAjIg0gBS0AAyIFEJABIAIgCWpBASAEIAcgDSAFEJABC0EIIQQgNSEFICIhByAIRQ0ACyACQQJ0IQpBACEEICshBSAxIQkDQCAEIQcCQCAFLQAAIgRFDQAgByAmaiIIKAIAIg1FDQAgAyACIAQgCS0AACIFIAcgKmoiCS0AACILIA1B/wFxIg0QkAEgA0EBaiACIAQgBSALIA0QkAEgA0ECaiACIAQgBSAJLQABIg0gCC0AASILEJABIANBA2ogAiAEIAUgDSALEJABIANBBGogAiAEIAUgCS0AAiINIAgtAAIiCxCQASADQQVqIAIgBCAFIA0gCxCQASADQQZqIAIgBCAFIAktAAMiCSAILQADIggQkAEgA0EHaiACIAQgBSAJIAgQkAELIAMgCmohA0EIIQQgISEFICMhCSAHRQ0ACyAPQX9qIg8NAAsMAgsgACgC4AIiB0ECdCEZIAAoAtQCIR5BACECICkhAyAbIQQDQCADLQAAIRIgBC0AACEFAkAgAiIWIAZBkAVqaiIQKAIAIgNB/wFxQQRGBEAgFiAeaiECIBJBAnZBAmohGkEQIQMDQAJAIAJBf2oiDS0AACIIIAItAAAiCWsiBCAEQR91IgRqIARzIgQgEk4NACACQX5qIg8tAAAiCyAIayIKIApBH3UiCmogCnMgBU4NACACLQABIgogCWsiEyATQR91IhNqIBNzIAVODQAgAi0AAiETAn8CQCACQX1qIhAtAAAiDiAIayIVIBVBH3UiFWogFXMgBU4NACAEIBpODQAgAkF8ai0AACEXIA0gCiAOaiAIIAlqIAtqIhVBAXRqQQRqQQN2OgAAIA8gDiAVakECakECdjoAACAOQQNsQQRqIQ8gECENQQMMAQsgCCAKaiEPQQIhFSALIRdBAgshHCANIA8gFWogF0EBdGogHHY6AAACQCAEIBpODQAgEyAJayIEIARBH3UiBGogBHMgBU4NACACIAggCWogCmoiBCATakECakECdjoAASACIAQgE0EDbGogAi0AA0EBdGpBBGpBA3Y6AAIgAiALIBNqIARBAXRqQQRqQQN2OgAADAELIAIgCSALaiAKQQF0akECakECdjoAAAsgAiAHaiECIANBf2oiAw0ACwwBCyASRQ0AIANFDQAgFiAeaiECIBBBIGohIEEAIRcDQAJAIANB/wFxBEBBACAXICBqLQAAIgtrIQ9BBCENA0AgAkF/aiITLQAAIgMgAi0AACIEayIIIAhBH3UiCGogCHMgEmsgAkF+aiIOLQAAIgggA2siCSAJQR91IglqIAlzIAVrcSACLQABIgkgBGsiCiAKQR91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AAJrIgcgB0EfdSIHaiAHcyAFLQABIAQtAAFrIgcgB0EfdSIHaiAHcyAFLQAAIAQtAABrIgcgB0EfdSIHaiAHcyAIampqampqamohCCAEQRBqIQQgASAFaiEFIAZBAWoiBkEIRw0ACyADIAg2AgQgAkGAAWohBEEAIQYgACABQQN0aiIKIQVBACEHA0AgBS0AByAELQAHayIAIABBH3UiAGogAHMgBS0ABiAELQAGayIAIABBH3UiAGogAHMgBS0ABSAELQAFayIAIABBH3UiAGogAHMgBS0ABCAELQAEayIAIABBH3UiAGogAHMgBS0AAyAELQADayIAIABBH3UiAGogAHMgBS0AAiAELQACayIAIABBH3UiAGogAHMgBS0AASAELQABayIAIABBH3UiAGogAHMgBS0AACAELQAAayIAIABBH3UiAGogAHMgBmpqampqampqIQYgBEEQaiEEIAEgBWohBSAHQQFqIgdBCEcNAAsgAyAGNgIIIAJBiAFqIQQgCkEIaiEFQQAhB0EAIQADQCAFLQAHIAQtAAdrIgIgAkEfdSICaiACcyAFLQAGIAQtAAZrIgIgAkEfdSICaiACcyAFLQAFIAQtAAVrIgIgAkEfdSICaiACcyAFLQAEIAQtAARrIgIgAkEfdSICaiACcyAFLQADIAQtAANrIgIgAkEfdSICaiACcyAFLQACIAQtAAJrIgIgAkEfdSICaiACcyAFLQABIAQtAAFrIgIgAkEfdSICaiACcyAFLQAAIAQtAABrIgIgAkEfdSICaiACcyAHampqampqamohByAEQRBqIQQgASAFaiEFIABBAWoiAEEIRw0ACyADIAc2AgwgCCAJaiAGaiAHagv3AwEUfyAAQYgBaiERQQEhBgNAQQhBBEEIIAAoApgBIgJBAnEbIAJBf0YiAxshC0EIQQRBCCACQQFxGyADGyEMIAZBA3RBeGohEiAAIAZBAnRqIgJByAJqIRMgAkG8AmohFEEAIQ1BACEHQQAhCANAIBQoAgAhAiATKAIAIQkgASARIA1BAnRqKAJwIgMgACgCjAFBFnRqIgRBgIAccSIOIAAoAogBQQZ0IANqIgNBB3EiD3IiCjYCACACIAkgCCAEQRN1amxqIANBEHRBE3VqIAdqIQMgACgCkAcgEmogCEEEdGogB2ohBQJAIApFBEBBACEEA0BB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
