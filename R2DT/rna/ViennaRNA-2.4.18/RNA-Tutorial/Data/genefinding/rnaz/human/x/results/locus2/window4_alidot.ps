%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA DotPlot
%%Creator: PS_dot.c,v 1.24 2003/08/07 09:01:00 ivo Exp $, ViennaRNA-1.5
%%CreationDate: Fri Nov 24 16:48:53 2006
%%BoundingBox: 66 211 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox
100 dict begin

/logscale false def

%delete next line to get rid of title
270 665 moveto /Helvetica findfont 14 scalefont setfont (alidot.ps) show

/lpmin {
   1e-05 log  % log(pmin) only probs>pmin will be shown
} bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul add            % x += 0.5
   exch 2 index 0.5 mul add exch  % x += 0.5
   newpath
   moveto
   dup neg   0 rlineto
   dup neg   0 exch rlineto
             0 rlineto
   closepath
   fill
} bind def

/sequence { (\
AA_GGUAUGUACACAUUAGAAAAAAAAUUUGU__AUAGGUCAUUUCAAAGAGGGCUUAUGGGGCUAUGAAACCAAGAGCUCUUAACGCUGUGACCAAAGAUUGAA\
) } def
/len { sequence length } bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

72 216 translate
72 6 mul len 1 add div dup scale
/Helvetica findfont 0.95 scalefont setfont

% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [0.7 -0.2 90]
  [-0.3 len sub 0.7 len add -90]
] {
  gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
  grestore
} forall

0.5 dup translate
% draw diagonal
0.04 setlinewidth
0 len moveto len 0 lineto stroke 

%draw grid
0.01 setlinewidth
len log 0.9 sub cvi 10 exch exp  % grid spacing
dup 1 gt {
   dup dup 20 div dup 2 array astore exch 40 div setdash
} { [0.3 0.7] 0.1 setdash } ifelse
0 exch len {
   dup dup
   0 moveto
   len lineto 
   dup
   len exch sub 0 exch moveto
   len exch len exch sub lineto
   stroke
} for
0.5 neg dup translate

/hsb {
dup 0.3 mul 1 exch sub sethsbcolor
} bind def

0.16 1.00 hsb 53 80 0.9883 ubox
0.16 1.00 hsb 53 80 0.9883 lbox
0.00 1.00 hsb 54 79 0.9892 ubox
0.00 1.00 hsb 54 79 0.9892 lbox
0.00 1.00 hsb 55 78 0.9891 ubox
0.00 1.00 hsb 55 78 0.9891 lbox
0.00 1.00 hsb 41 92 0.9890 ubox
0.00 1.00 hsb 41 92 0.9890 lbox
0.00 1.00 hsb 39 94 0.9890 ubox
0.00 1.00 hsb 39 94 0.9890 lbox
0.00 1.00 hsb 40 93 0.9887 ubox
0.00 1.00 hsb 40 93 0.9887 lbox
0.00 1.00 hsb 52 81 0.9885 ubox
0.00 1.00 hsb 52 81 0.9885 lbox
0.00 1.00 hsb 38 95 0.9881 ubox
0.00 1.00 hsb 38 95 0.9881 lbox
0.00 1.00 hsb 42 91 0.9867 ubox
0.00 1.00 hsb 42 91 0.9867 lbox
0.00 1.00 hsb 51 82 0.9808 ubox
0.00 1.00 hsb 51 82 0.9808 lbox
0.00 1.00 hsb 56 77 0.9775 ubox
0.00 1.00 hsb 56 77 0.9775 lbox
0.00 1.00 hsb 43 90 0.9669 ubox
0.00 1.00 hsb 43 90 0.9669 lbox
0.32 0.60 hsb 57 76 0.9205 ubox
0.32 0.60 hsb 57 76 0.9205 lbox
0.00 1.00 hsb 50 83 0.9014 ubox
0.00 1.00 hsb 50 83 0.9014 lbox
0.00 0.20 hsb 61 73 0.6279 ubox
0.00 0.20 hsb 61 73 0.6279 lbox
0.00 0.60 hsb 62 72 0.5741 ubox
0.00 0.60 hsb 62 72 0.5741 lbox
0.32 0.20 hsb 60 74 0.4149 ubox
0.32 0.20 hsb 60 74 0.4149 lbox
0.16 0.60 hsb 59 75 0.3835 ubox
0.16 0.60 hsb 59 75 0.3835 lbox
0.00 1.00 hsb 46 87 0.3293 ubox
0.00 0.60 hsb 60 73 0.1205 ubox
0.00 0.20 hsb 61 72 0.1038 ubox
0.16 1.00 hsb 6 13 0.0567 ubox
0.00 0.60 hsb 5 14 0.0660 ubox
0.16 1.00 hsb 5 12 0.0402 ubox
0.16 1.00 hsb 6 11 0.0316 ubox
0.00 0.60 hsb 9 14 0.0309 ubox
0.16 1.00 hsb 29 104 0.0141 ubox
0.32 1.00 hsb 32 99 0.0017 ubox
0.16 1.00 hsb 12 19 0.0116 ubox
0.32 1.00 hsb 8 21 0.0015 ubox
0.32 1.00 hsb 29 35 0.0011 ubox
0.16 1.00 hsb 5 101 0.0099 ubox
0.16 1.00 hsb 29 103 0.0072 ubox
0.16 1.00 hsb 4 12 0.0042 ubox
0.32 0.60 hsb 28 105 0.0084 ubox
0.00 0.20 hsb 8 15 0.0187 ubox
0.16 1.00 hsb 9 101 0.0018 ubox
0.16 1.00 hsb 10 21 0.0015 ubox
0.16 1.00 hsb 4 101 0.0013 ubox
0.16 1.00 hsb 10 37 0.0010 ubox
0.16 0.60 hsb 65 70 0.0106 ubox
0.00 1.00 hsb 6 100 0.0094 ubox
0.32 0.60 hsb 12 21 0.0043 ubox
0.00 0.60 hsb 60 72 0.0123 ubox
0.16 0.60 hsb 59 66 0.0067 ubox
0.32 0.60 hsb 12 35 0.0011 ubox
0.16 0.60 hsb 60 65 0.0061 ubox
0.00 0.60 hsb 62 73 0.0107 ubox
0.00 0.20 hsb 30 103 0.0109 ubox
0.00 0.20 hsb 7 16 0.0095 ubox
0.16 0.20 hsb 58 67 0.0058 ubox
0.00 0.60 hsb 14 19 0.0074 ubox
0.16 0.20 hsb 28 104 0.0056 ubox
0.00 1.00 hsb 45 87 0.0022 ubox
0.00 1.00 hsb 10 100 0.0017 ubox
0.32 0.20 hsb 57 68 0.0017 ubox
0.00 0.20 hsb 36 97 0.0079 ubox
0.00 1.00 hsb 10 19 0.0010 ubox
0.16 0.60 hsb 24 29 0.0009 ubox
0.00 1.00 hsb 49 83 0.0009 ubox
0.00 1.00 hsb 44 90 0.0008 ubox
0.00 1.00 hsb 51 83 0.0008 ubox
0.16 0.20 hsb 30 102 0.0041 ubox
0.00 0.60 hsb 4 14 0.0053 ubox
0.00 0.20 hsb 4 102 0.0048 ubox
0.16 0.20 hsb 11 36 0.0011 ubox
0.00 0.20 hsb 65 71 0.0028 ubox
0.00 0.20 hsb 65 69 0.0023 ubox
0.00 0.20 hsb 32 100 0.0016 ubox
0.00 0.20 hsb 36 96 0.0010 ubox
showpage
end
%%EOF
