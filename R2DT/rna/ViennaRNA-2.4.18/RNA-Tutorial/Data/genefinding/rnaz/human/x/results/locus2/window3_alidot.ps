%!PS-Adobe-3.0 EPSF-3.0
%%Title: RNA DotPlot
%%Creator: PS_dot.c,v 1.24 2003/08/07 09:01:00 ivo Exp $, ViennaRNA-1.5
%%CreationDate: Fri Nov 24 16:48:52 2006
%%BoundingBox: 66 211 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: -d2 
%This file contains the square roots of the base pair probabilities in the form
% i  j  sqrt(p(i,j)) ubox
100 dict begin

/logscale false def

%delete next line to get rid of title
270 665 moveto /Helvetica findfont 14 scalefont setfont (alidot.ps) show

/lpmin {
   1e-05 log  % log(pmin) only probs>pmin will be shown
} bind def

/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul add            % x += 0.5
   exch 2 index 0.5 mul add exch  % x += 0.5
   newpath
   moveto
   dup neg   0 rlineto
   dup neg   0 exch rlineto
             0 rlineto
   closepath
   fill
} bind def

/sequence { (\
GUAUGUACACAUUUGAAAAAAAAUUUGU__AUAGGUCAUUUCAAAGAGGGCUUGUGGGACUA__AAACCAAGAGCUCUUAACGCUGUGACCAAAGAUUGAAGUUC\
) } def
/len { sequence length } bind def

/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def

/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def

72 216 translate
72 6 mul len 1 add div dup scale
/Helvetica findfont 0.95 scalefont setfont

% print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [0.7 -0.2 90]
  [-0.3 len sub 0.7 len add -90]
] {
  gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
  grestore
} forall

0.5 dup translate
% draw diagonal
0.04 setlinewidth
0 len moveto len 0 lineto stroke 

%draw grid
0.01 setlinewidth
len log 0.9 sub cvi 10 exch exp  % grid spacing
dup 1 gt {
   dup dup 20 div dup 2 array astore exch 40 div setdash
} { [0.3 0.7] 0.1 setdash } ifelse
0 exch len {
   dup dup
   0 moveto
   len lineto 
   dup
   len exch sub 0 exch moveto
   len exch len exch sub lineto
   stroke
} for
0.5 neg dup translate

/hsb {
dup 0.3 mul 1 exch sub sethsbcolor
} bind def

0.16 1.00 hsb 49 76 0.9990 ubox
0.16 1.00 hsb 49 76 0.9990 lbox
0.00 1.00 hsb 35 90 0.9999 ubox
0.00 1.00 hsb 35 90 0.9999 lbox
0.00 1.00 hsb 37 88 0.9999 ubox
0.00 1.00 hsb 37 88 0.9999 lbox
0.00 1.00 hsb 50 75 0.9999 ubox
0.00 1.00 hsb 50 75 0.9999 lbox
0.00 1.00 hsb 51 74 0.9998 ubox
0.00 1.00 hsb 51 74 0.9998 lbox
0.00 1.00 hsb 36 89 0.9997 ubox
0.00 1.00 hsb 36 89 0.9997 lbox
0.00 1.00 hsb 48 77 0.9993 ubox
0.00 1.00 hsb 48 77 0.9993 lbox
0.00 1.00 hsb 34 91 0.9990 ubox
0.00 1.00 hsb 34 91 0.9990 lbox
0.00 1.00 hsb 38 87 0.9976 ubox
0.00 1.00 hsb 38 87 0.9976 lbox
0.00 1.00 hsb 47 78 0.9914 ubox
0.00 1.00 hsb 47 78 0.9914 lbox
0.00 1.00 hsb 52 73 0.9898 ubox
0.00 1.00 hsb 52 73 0.9898 lbox
0.00 1.00 hsb 39 86 0.9776 ubox
0.00 1.00 hsb 39 86 0.9776 lbox
0.00 1.00 hsb 46 79 0.9112 ubox
0.00 1.00 hsb 46 79 0.9112 lbox
0.16 0.60 hsb 53 72 0.8995 ubox
0.16 0.60 hsb 53 72 0.8995 lbox
0.00 0.60 hsb 57 69 0.4723 ubox
0.00 0.60 hsb 57 69 0.4723 lbox
0.00 0.60 hsb 58 68 0.4145 ubox
0.00 0.60 hsb 58 68 0.4145 lbox
0.00 0.60 hsb 56 69 0.3957 ubox
0.00 0.60 hsb 57 68 0.3882 ubox
0.00 1.00 hsb 42 83 0.3329 ubox
0.16 1.00 hsb 25 100 0.0357 ubox
0.48 0.60 hsb 24 101 0.0291 ubox
0.16 0.20 hsb 26 99 0.0287 ubox
0.32 1.00 hsb 25 99 0.0043 ubox
0.32 1.00 hsb 28 95 0.0021 ubox
0.32 1.00 hsb 26 101 0.0016 ubox
0.32 1.00 hsb 25 31 0.0012 ubox
0.16 1.00 hsb 16 104 0.0099 ubox
0.16 1.00 hsb 17 103 0.0091 ubox
0.00 1.00 hsb 96 103 0.0148 ubox
0.16 0.60 hsb 97 102 0.0140 ubox
0.16 0.60 hsb 61 66 0.0131 ubox
0.16 1.00 hsb 20 103 0.0023 ubox
0.16 1.00 hsb 52 72 0.0009 ubox
0.16 0.60 hsb 55 71 0.0106 ubox
0.00 1.00 hsb 15 105 0.0098 ubox
0.16 0.60 hsb 1 8 0.0092 ubox
0.16 0.60 hsb 2 9 0.0078 ubox
0.00 0.60 hsb 95 104 0.0114 ubox
0.16 0.60 hsb 2 7 0.0058 ubox
0.00 1.00 hsb 96 104 0.0057 ubox
0.00 0.60 hsb 56 68 0.0095 ubox
0.16 0.60 hsb 8 15 0.0041 ubox
0.00 0.20 hsb 1 10 0.0102 ubox
0.00 0.20 hsb 32 93 0.0093 ubox
0.00 1.00 hsb 41 83 0.0023 ubox
0.00 1.00 hsb 19 104 0.0018 ubox
0.16 0.60 hsb 53 71 0.0016 ubox
0.00 0.60 hsb 10 15 0.0064 ubox
0.16 0.60 hsb 25 102 0.0013 ubox
0.32 0.20 hsb 8 17 0.0013 ubox
0.16 0.60 hsb 53 70 0.0011 ubox
0.00 0.60 hsb 95 105 0.0060 ubox
0.16 0.60 hsb 20 25 0.0009 ubox
0.32 0.20 hsb 24 31 0.0009 ubox
0.00 1.00 hsb 45 79 0.0009 ubox
0.00 1.00 hsb 40 86 0.0008 ubox
0.00 1.00 hsb 47 79 0.0008 ubox
0.00 0.60 hsb 58 69 0.0052 ubox
0.16 0.20 hsb 24 100 0.0035 ubox
0.16 0.20 hsb 23 32 0.0008 ubox
0.00 0.60 hsb 99 105 0.0016 ubox
0.00 0.20 hsb 5 10 0.0030 ubox
0.00 0.20 hsb 61 67 0.0029 ubox
0.00 0.20 hsb 61 65 0.0018 ubox
0.00 0.20 hsb 54 68 0.0016 ubox
0.00 0.20 hsb 54 69 0.0015 ubox
0.00 0.20 hsb 55 67 0.0012 ubox
0.00 0.20 hsb 32 92 0.0010 ubox
showpage
end
%%EOF
