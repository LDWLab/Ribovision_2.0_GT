<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RNAlib-2.4.18: Random Structure Samples from the Ensemble</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="RNAlib-2.4.18"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RNAlib-2.4.18
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__subopt__stochbt.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Random Structure Samples from the Ensemble<div class="ingroups"><a class="el" href="group__subopt__and__representatives.html">Suboptimals and Representative Structures</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to draw random structure samples from the ensemble according to their equilibrium probability.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions to draw random structure samples from the ensemble according to their equilibrium probability. </p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Random Structure Samples from the Ensemble:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="group__subopt__stochbt.svg" width="100%" height="398"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__kl__neighborhood__stochbt"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__kl__neighborhood__stochbt.html">Stochastic Backtracking of Structures from Distance Based Partitioning</a></td></tr>
<tr class="memdesc:group__kl__neighborhood__stochbt"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains functions related to stochastic backtracking from a specified distance class. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__subopt__stochbt__deprecated"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt__deprecated.html">Deprecated Interface for Stochastic Backtracking</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga760aa2fb2d5e3d7521a11454a21e9b9f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f">VRNA_PBACKTRACK_DEFAULT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga760aa2fb2d5e3d7521a11454a21e9b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boltzmann sampling flag indicating default backtracing mode.  <a href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f">More...</a><br /></td></tr>
<tr class="separator:ga760aa2fb2d5e3d7521a11454a21e9b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d580ce645aa0c38b69afdf56c332200"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200">VRNA_PBACKTRACK_NON_REDUNDANT</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga9d580ce645aa0c38b69afdf56c332200"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boltzmann sampling flag indicating non-redundant backtracing mode.  <a href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200">More...</a><br /></td></tr>
<tr class="separator:ga9d580ce645aa0c38b69afdf56c332200"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gad5bd9c8b195dd9cde15389f0042f0e44"><td class="memItemLeft" align="right" valign="top">typedef void()&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a>(const char *stucture, void *data)</td></tr>
<tr class="memdesc:gad5bd9c8b195dd9cde15389f0042f0e44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for Boltzmann sampling.  <a href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">More...</a><br /></td></tr>
<tr class="separator:gad5bd9c8b195dd9cde15389f0042f0e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa59c30efbed96bf9aaf8005584c72e63"><td class="memItemLeft" align="right" valign="top">typedef struct vrna_pbacktrack_memory_s *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a></td></tr>
<tr class="memdesc:gaa59c30efbed96bf9aaf8005584c72e63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boltzmann sampling memory data structure.  <a href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">More...</a><br /></td></tr>
<tr class="separator:gaa59c30efbed96bf9aaf8005584c72e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga72ebbe45bcbce147a12f27f62b38db78"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga72ebbe45bcbce147a12f27f62b38db78">vrna_pbacktrack5</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int length)</td></tr>
<tr class="memdesc:ga72ebbe45bcbce147a12f27f62b38db78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample a secondary structure of a subsequence from the Boltzmann ensemble according its probability.  <a href="group__subopt__stochbt.html#ga72ebbe45bcbce147a12f27f62b38db78">More...</a><br /></td></tr>
<tr class="separator:ga72ebbe45bcbce147a12f27f62b38db78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga30c3ddff868c44eecfdb07d99a2422ba"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba">vrna_pbacktrack5_num</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, unsigned int length, unsigned int options)</td></tr>
<tr class="memdesc:ga30c3ddff868c44eecfdb07d99a2422ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba">More...</a><br /></td></tr>
<tr class="separator:ga30c3ddff868c44eecfdb07d99a2422ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga626beb5b5b962d7e7c8433cd2cfd4e93"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93">vrna_pbacktrack5_cb</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, unsigned int length, <a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *cb, void *data, unsigned int options)</td></tr>
<tr class="memdesc:ga626beb5b5b962d7e7c8433cd2cfd4e93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93">More...</a><br /></td></tr>
<tr class="separator:ga626beb5b5b962d7e7c8433cd2cfd4e93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5d7065196975b803daeb4e094ba1cb9"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9">vrna_pbacktrack5_resume</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *vc, unsigned int num_samples, unsigned int length, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *nr_mem, unsigned int options)</td></tr>
<tr class="memdesc:gac5d7065196975b803daeb4e094ba1cb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9">More...</a><br /></td></tr>
<tr class="separator:gac5d7065196975b803daeb4e094ba1cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a91dc092580faf7799476e8dd76e0ac"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">vrna_pbacktrack5_resume_cb</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, unsigned int length, <a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *cb, void *data, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *nr_mem, unsigned int options)</td></tr>
<tr class="memdesc:ga4a91dc092580faf7799476e8dd76e0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">More...</a><br /></td></tr>
<tr class="separator:ga4a91dc092580faf7799476e8dd76e0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga594844ac73c4e66e00d6791b31540634"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga594844ac73c4e66e00d6791b31540634">vrna_pbacktrack</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc)</td></tr>
<tr class="memdesc:ga594844ac73c4e66e00d6791b31540634"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample a secondary structure from the Boltzmann ensemble according its probability.  <a href="group__subopt__stochbt.html#ga594844ac73c4e66e00d6791b31540634">More...</a><br /></td></tr>
<tr class="separator:ga594844ac73c4e66e00d6791b31540634"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga596ed9bcd86f629a7c7c59c58b297db5"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5">vrna_pbacktrack_num</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, unsigned int options)</td></tr>
<tr class="memdesc:ga596ed9bcd86f629a7c7c59c58b297db5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5">More...</a><br /></td></tr>
<tr class="separator:ga596ed9bcd86f629a7c7c59c58b297db5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga843fa953a15337b15cc68401adad84d7"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7">vrna_pbacktrack_cb</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, <a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *cb, void *data, unsigned int options)</td></tr>
<tr class="memdesc:ga843fa953a15337b15cc68401adad84d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7">More...</a><br /></td></tr>
<tr class="separator:ga843fa953a15337b15cc68401adad84d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae175129ece546fe7c092f27072e039d1"><td class="memItemLeft" align="right" valign="top">char **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1">vrna_pbacktrack_resume</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *nr_mem, unsigned int options)</td></tr>
<tr class="memdesc:gae175129ece546fe7c092f27072e039d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1">More...</a><br /></td></tr>
<tr class="separator:gae175129ece546fe7c092f27072e039d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fc5ce952995e53baef52cad5581c063"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063">vrna_pbacktrack_resume_cb</a> (<a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *fc, unsigned int num_samples, <a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *cb, void *data, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *nr_mem, unsigned int options)</td></tr>
<tr class="memdesc:ga6fc5ce952995e53baef52cad5581c063"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.  <a href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063">More...</a><br /></td></tr>
<tr class="separator:ga6fc5ce952995e53baef52cad5581c063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae64fbdef59e7f503d7e920aac279212b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">vrna_pbacktrack_mem_free</a> (<a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> s)</td></tr>
<tr class="memdesc:gae64fbdef59e7f503d7e920aac279212b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release memory occupied by a Boltzmann sampling memory data structure.  <a href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">More...</a><br /></td></tr>
<tr class="separator:gae64fbdef59e7f503d7e920aac279212b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga760aa2fb2d5e3d7521a11454a21e9b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga760aa2fb2d5e3d7521a11454a21e9b9f">&#9670;&nbsp;</a></span>VRNA_PBACKTRACK_DEFAULT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VRNA_PBACKTRACK_DEFAULT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Boltzmann sampling flag indicating default backtracing mode. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a> </dd></dl>

</div>
</div>
<a id="ga9d580ce645aa0c38b69afdf56c332200"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d580ce645aa0c38b69afdf56c332200">&#9670;&nbsp;</a></span>VRNA_PBACKTRACK_NON_REDUNDANT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VRNA_PBACKTRACK_NON_REDUNDANT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Boltzmann sampling flag indicating non-redundant backtracing mode. </p>
<p>This flag will turn the Boltzmann sampling into non-redundant backtracing mode along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gad5bd9c8b195dd9cde15389f0042f0e44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5bd9c8b195dd9cde15389f0042f0e44">&#9670;&nbsp;</a></span>vrna_boltzmann_sampling_callback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void() vrna_boltzmann_sampling_callback(const char *stucture, void *data)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Callback for Boltzmann sampling. </p>
<dl class="callbacks"><dt><b><a class="el" href="callbacks.html#_callbacks000001">Notes on Callback Functions:</a></b></dt><dd>This function will be called for each secondary structure that has been successfully backtraced from the partition function DP matrices. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">structure</td><td>The secondary structure in dot-bracket notation </td></tr>
    <tr><td class="paramname">data</td><td>Some arbitrary, auxiliary data address as provided to the calling function </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa59c30efbed96bf9aaf8005584c72e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa59c30efbed96bf9aaf8005584c72e63">&#9670;&nbsp;</a></span>vrna_pbacktrack_mem_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct vrna_pbacktrack_memory_s* <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Boltzmann sampling memory data structure. </p>
<p>This structure is required for properly resuming a previous sampling round in specialized Boltzmann sampling, such as non-redundant backtracking.</p>
<p>Initialize with <code>NULL</code> and pass its address to the corresponding functions <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, etc.</p>
<dl class="section note"><dt>Note</dt><dd>Do not forget to release memory occupied by this data structure before losing its context! Use <a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b" title="Release memory occupied by a Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_free()</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, <a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b" title="Release memory occupied by a Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_free()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga72ebbe45bcbce147a12f27f62b38db78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga72ebbe45bcbce147a12f27f62b38db78">&#9670;&nbsp;</a></span>vrna_pbacktrack5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * vrna_pbacktrack5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Sample a secondary structure of a subsequence from the Boltzmann ensemble according its probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a secondary structure. The parameter <code>length</code> specifies the length of the substructure starting from the 5' end.</p>
<p>The structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga594844ac73c4e66e00d6791b31540634" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">vrna_pbacktrack()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">length</td><td>The length of the subsequence to consider (starting with 5' end) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A sampled secondary structure in dot-bracket notation (or NULL on error)</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000005">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gaf2e614b8beb4ddf3e8751433b76f39db" title="Sample a sub-structure from the Boltzmann ensemble according its probability.">pbacktrack5()</a></b> to objects of type <em>fold_compound</em>. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga30c3ddff868c44eecfdb07d99a2422ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga30c3ddff868c44eecfdb07d99a2422ba">&#9670;&nbsp;</a></span>vrna_pbacktrack5_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char ** vrna_pbacktrack5_num </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures. The parameter <code>length</code> specifies the length of the substructure starting from the 5' end.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga72ebbe45bcbce147a12f27f62b38db78" title="Sample a secondary structure of a subsequence from the Boltzmann ensemble according its probability.">vrna_pbacktrack5()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">length</td><td>The length of the subsequence to consider (starting with 5' end) </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A set of secondary structure samples in dot-bracket notation terminated by NULL (or NULL on error)</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000007">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gaf2e614b8beb4ddf3e8751433b76f39db" title="Sample a sub-structure from the Boltzmann ensemble according its probability.">pbacktrack5()</a></b> to objects of type <em>fold_compound</em> where the last argument <code>options</code> is optional with default value <code>options = VRNA_PBACKTRACK_DEFAULT</code>. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga626beb5b5b962d7e7c8433cd2cfd4e93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga626beb5b5b962d7e7c8433cd2cfd4e93">&#9670;&nbsp;</a></span>vrna_pbacktrack5_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int vrna_pbacktrack5_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures. The parameter <code>length</code> specifies the length of the substructure starting from the 5' end.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<p>In contrast to <a class="el" href="group__subopt__stochbt.html#ga72ebbe45bcbce147a12f27f62b38db78" title="Sample a secondary structure of a subsequence from the Boltzmann ensemble according its probability.">vrna_pbacktrack5()</a> and <a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_num()</a> this function yields the structure samples through a callback mechanism.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga72ebbe45bcbce147a12f27f62b38db78" title="Sample a secondary structure of a subsequence from the Boltzmann ensemble according its probability.">vrna_pbacktrack5()</a>, <a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">length</td><td>The length of the subsequence to consider (starting with 5' end) </td></tr>
    <tr><td class="paramname">cb</td><td>The callback that receives the sampled structure </td></tr>
    <tr><td class="paramname">data</td><td>A data structure passed through to the callback <code>cb</code> </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of structures actually backtraced</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000009">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gaf2e614b8beb4ddf3e8751433b76f39db" title="Sample a sub-structure from the Boltzmann ensemble according its probability.">pbacktrack5()</a></b> to objects of type <em>fold_compound</em> where the last argument <code>options</code> is optional with default value <code>options = VRNA_PBACKTRACK_DEFAULT</code>. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="gac5d7065196975b803daeb4e094ba1cb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac5d7065196975b803daeb4e094ba1cb9">&#9670;&nbsp;</a></span>vrna_pbacktrack5_resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char ** vrna_pbacktrack5_resume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *&#160;</td>
          <td class="paramname"><em>nr_mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures. The parameter <code>length</code> specifies the length of the substructure starting from the 5' end.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<p>In contrast to <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a> this function allows for resuming a previous sampling round in specialized Boltzmann sampling, such as non-redundant backtracking. For that purpose, the user passes the address of a Boltzmann sampling data structure (<a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>) which will be re-used in each round of sampling, i.e. each successive call to <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a> or <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>.</p>
<p>A successive sample call to this function may look like: </p><div class="fragment"><div class="line"><a class="code" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> nonredundant_memory = NULL;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample the first 100 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9">vrna_pbacktrack5_resume</a>(fc,</div>
<div class="line">                        100,</div>
<div class="line">                        fc-&gt;length,</div>
<div class="line">                        &amp;nonredundant_memory,</div>
<div class="line">                        options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample another 500 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9">vrna_pbacktrack5_resume</a>(fc,</div>
<div class="line">                        500,</div>
<div class="line">                        fc-&gt;length,</div>
<div class="line">                        &amp;nonredundant_memory,</div>
<div class="line">                        options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory occupied by the non-redundant memory data structure</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">vrna_pbacktrack_mem_free</a>(nonredundant_memory);</div>
<div class="ttc" id="agroup__subopt__stochbt_html_gaa59c30efbed96bf9aaf8005584c72e63"><div class="ttname"><a href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a></div><div class="ttdeci">struct vrna_pbacktrack_memory_s * vrna_pbacktrack_mem_t</div><div class="ttdoc">Boltzmann sampling memory data structure.</div><div class="ttdef"><b>Definition:</b> boltzmann_sampling.h:75</div></div>
<div class="ttc" id="agroup__subopt__stochbt_html_gac5d7065196975b803daeb4e094ba1cb9"><div class="ttname"><a href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9">vrna_pbacktrack5_resume</a></div><div class="ttdeci">char ** vrna_pbacktrack5_resume(vrna_fold_compound_t *vc, unsigned int num_samples, unsigned int length, vrna_pbacktrack_mem_t *nr_mem, unsigned int options)</div><div class="ttdoc">Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...</div></div>
<div class="ttc" id="agroup__subopt__stochbt_html_gae64fbdef59e7f503d7e920aac279212b"><div class="ttname"><a href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">vrna_pbacktrack_mem_free</a></div><div class="ttdeci">void vrna_pbacktrack_mem_free(vrna_pbacktrack_mem_t s)</div><div class="ttdoc">Release memory occupied by a Boltzmann sampling memory data structure.</div></div>
</div><!-- fragment --><dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>, <a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b" title="Release memory occupied by a Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_free</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">length</td><td>The length of the subsequence to consider (starting with 5' end) </td></tr>
    <tr><td class="paramname">nr_mem</td><td>The address of the Boltzmann sampling memory data structure </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A set of secondary structure samples in dot-bracket notation terminated by NULL (or NULL on error)</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000011">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gaf2e614b8beb4ddf3e8751433b76f39db" title="Sample a sub-structure from the Boltzmann ensemble according its probability.">pbacktrack5()</a></b> to objects of type <em>fold_compound</em>. In addition to the list of structures, this function also returns the <code>nr_mem</code> data structure as first element. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga4a91dc092580faf7799476e8dd76e0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4a91dc092580faf7799476e8dd76e0ac">&#9670;&nbsp;</a></span>vrna_pbacktrack5_resume_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int vrna_pbacktrack5_resume_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *&#160;</td>
          <td class="paramname"><em>nr_mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures. The parameter <code>length</code> specifies the length of the substructure starting from the 5' end.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<p>In contrast to <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a> this function yields the structure samples through a callback mechanism.</p>
<p>A successive sample call to this function may look like: </p><div class="fragment"><div class="line"><a class="code" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> nonredundant_memory = NULL;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample the first 100 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">vrna_pbacktrack5_resume_cb</a>(fc,</div>
<div class="line">                           100,</div>
<div class="line">                           fc-&gt;length,</div>
<div class="line">                           &amp;callback_function,</div>
<div class="line">                           (<span class="keywordtype">void</span> *)&amp;callback_data,</div>
<div class="line">                           &amp;nonredundant_memory,</div>
<div class="line">                           options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample another 500 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">vrna_pbacktrack5_resume_cb</a>(fc,</div>
<div class="line">                           500,</div>
<div class="line">                           fc-&gt;length,</div>
<div class="line">                           &amp;callback_function,</div>
<div class="line">                           (<span class="keywordtype">void</span> *)&amp;callback_data,</div>
<div class="line">                           &amp;nonredundant_memory,</div>
<div class="line">                           options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory occupied by the non-redundant memory data structure</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">vrna_pbacktrack_mem_free</a>(nonredundant_memory);</div>
<div class="ttc" id="agroup__subopt__stochbt_html_ga4a91dc092580faf7799476e8dd76e0ac"><div class="ttname"><a href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">vrna_pbacktrack5_resume_cb</a></div><div class="ttdeci">unsigned int vrna_pbacktrack5_resume_cb(vrna_fold_compound_t *fc, unsigned int num_samples, unsigned int length, vrna_boltzmann_sampling_callback *cb, void *data, vrna_pbacktrack_mem_t *nr_mem, unsigned int options)</div><div class="ttdoc">Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...</div></div>
</div><!-- fragment --><dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>, <a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b" title="Release memory occupied by a Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_free</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">length</td><td>The length of the subsequence to consider (starting with 5' end) </td></tr>
    <tr><td class="paramname">cb</td><td>The callback that receives the sampled structure </td></tr>
    <tr><td class="paramname">data</td><td>A data structure passed through to the callback <code>cb</code> </td></tr>
    <tr><td class="paramname">nr_mem</td><td>The address of the Boltzmann sampling memory data structure </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of structures actually backtraced</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000013">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gaf2e614b8beb4ddf3e8751433b76f39db" title="Sample a sub-structure from the Boltzmann ensemble according its probability.">pbacktrack5()</a></b> to objects of type <em>fold_compound</em>. In addition to the number of structures backtraced, this function also returns the <code>nr_mem</code> data structure as first element. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga594844ac73c4e66e00d6791b31540634"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga594844ac73c4e66e00d6791b31540634">&#9670;&nbsp;</a></span>vrna_pbacktrack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * vrna_pbacktrack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Sample a secondary structure from the Boltzmann ensemble according its probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a secondary structure.</p>
<p>The structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga72ebbe45bcbce147a12f27f62b38db78" title="Sample a secondary structure of a subsequence from the Boltzmann ensemble according its probability.">vrna_pbacktrack5()</a>, <a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_num</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A sampled secondary structure in dot-bracket notation (or NULL on error)</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000006">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gac03ca6db186bb3bf0a2a326d7fb3ba03" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">pbacktrack()</a></b> to objects of type <em>fold_compound</em>. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga596ed9bcd86f629a7c7c59c58b297db5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga596ed9bcd86f629a7c7c59c58b297db5">&#9670;&nbsp;</a></span>vrna_pbacktrack_num()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char ** vrna_pbacktrack_num </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga594844ac73c4e66e00d6791b31540634" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">vrna_pbacktrack()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga30c3ddff868c44eecfdb07d99a2422ba" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A set of secondary structure samples in dot-bracket notation terminated by NULL (or NULL on error)</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000008">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gac03ca6db186bb3bf0a2a326d7fb3ba03" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">pbacktrack()</a></b> to objects of type <em>fold_compound</em> where the last argument <code>options</code> is optional with default value <code>options = VRNA_PBACKTRACK_DEFAULT</code>. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga843fa953a15337b15cc68401adad84d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga843fa953a15337b15cc68401adad84d7">&#9670;&nbsp;</a></span>vrna_pbacktrack_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int vrna_pbacktrack_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<p>In contrast to <a class="el" href="group__subopt__stochbt.html#ga594844ac73c4e66e00d6791b31540634" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">vrna_pbacktrack()</a> and <a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_num()</a> this function yields the structure samples through a callback mechanism.</p>
<dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga594844ac73c4e66e00d6791b31540634" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">vrna_pbacktrack()</a>, <a class="el" href="group__subopt__stochbt.html#ga596ed9bcd86f629a7c7c59c58b297db5" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_num()</a>, <a class="el" href="group__subopt__stochbt.html#ga626beb5b5b962d7e7c8433cd2cfd4e93" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">cb</td><td>The callback that receives the sampled structure </td></tr>
    <tr><td class="paramname">data</td><td>A data structure passed through to the callback <code>cb</code> </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of structures actually backtraced</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000010">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gac03ca6db186bb3bf0a2a326d7fb3ba03" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">pbacktrack()</a></b> to objects of type <em>fold_compound</em> where the last argument <code>options</code> is optional with default value <code>options = VRNA_PBACKTRACK_DEFAULT</code>. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="gae175129ece546fe7c092f27072e039d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae175129ece546fe7c092f27072e039d1">&#9670;&nbsp;</a></span>vrna_pbacktrack_resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char ** vrna_pbacktrack_resume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *&#160;</td>
          <td class="paramname"><em>nr_mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<p>In contrast to <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a> this function allows for resuming a previous sampling round in specialized Boltzmann sampling, such as non-redundant backtracking. For that purpose, the user passes the address of a Boltzmann sampling data structure (<a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>) which will be re-used in each round of sampling, i.e. each successive call to <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a> or <a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>.</p>
<p>A successive sample call to this function may look like: </p><div class="fragment"><div class="line"><a class="code" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> nonredundant_memory = NULL;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample the first 100 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1">vrna_pbacktrack_resume</a>(fc,</div>
<div class="line">                       100,</div>
<div class="line">                       &amp;nonredundant_memory,</div>
<div class="line">                       options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample another 500 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1">vrna_pbacktrack_resume</a>(fc,</div>
<div class="line">                       500,</div>
<div class="line">                       &amp;nonredundant_memory,</div>
<div class="line">                       options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory occupied by the non-redundant memory data structure</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">vrna_pbacktrack_mem_free</a>(nonredundant_memory);</div>
<div class="ttc" id="agroup__subopt__stochbt_html_gae175129ece546fe7c092f27072e039d1"><div class="ttname"><a href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1">vrna_pbacktrack_resume</a></div><div class="ttdeci">char ** vrna_pbacktrack_resume(vrna_fold_compound_t *fc, unsigned int num_samples, vrna_pbacktrack_mem_t *nr_mem, unsigned int options)</div><div class="ttdoc">Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.</div></div>
</div><!-- fragment --><dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>, <a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b" title="Release memory occupied by a Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_free</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">nr_mem</td><td>The address of the Boltzmann sampling memory data structure </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A set of secondary structure samples in dot-bracket notation terminated by NULL (or NULL on error)</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000012">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gac03ca6db186bb3bf0a2a326d7fb3ba03" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">pbacktrack()</a></b> to objects of type <em>fold_compound</em>. In addition to the list of structures, this function also returns the <code>nr_mem</code> data structure as first element. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="ga6fc5ce952995e53baef52cad5581c063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6fc5ce952995e53baef52cad5581c063">&#9670;&nbsp;</a></span>vrna_pbacktrack_resume_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int vrna_pbacktrack_resume_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166">vrna_fold_compound_t</a> *&#160;</td>
          <td class="paramname"><em>fc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gad5bd9c8b195dd9cde15389f0042f0e44">vrna_boltzmann_sampling_callback</a> *&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> *&#160;</td>
          <td class="paramname"><em>nr_mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability. </p>
<p>Perform a probabilistic (stochastic) backtracing in the partition function DP arrays to obtain a set of <code>num_samples</code> secondary structures.</p>
<p>Any structure <img class="formulaInl" alt="$ s $" src="form_35.png" width="6" height="7"/> with free energy <img class="formulaInl" alt="$ E(s) $" src="form_36.png" width="26" height="15"/> is picked from the Boltzmann distributed ensemble according to its probability </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p(s) = \frac{exp(-E(s) / kT)}{Z} \]" src="form_37.png" width="140" height="30"/>
</p>
<p> with partition function <img class="formulaInl" alt="$ Z = \sum_s exp(-E(s) / kT) $" src="form_38.png" width="146" height="15"/>, Boltzmann constant <img class="formulaInl" alt="$ k $" src="form_5.png" width="7" height="11"/> and thermodynamic temperature <img class="formulaInl" alt="$ T $" src="form_39.png" width="11" height="10"/>.</p>
<p>Using the <code>options</code> flag one can switch between regular (<a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>) backtracing mode, and non-redundant sampling (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>) along the lines of Michalik et al. 2017 <a class="el" href="citelist.html#CITEREF_michalik:2017">[19]</a>.</p>
<p>In contrast to <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a> this function yields the structure samples through a callback mechanism.</p>
<p>A successive sample call to this function may look like: </p><div class="fragment"><div class="line"><a class="code" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a> nonredundant_memory = NULL;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample the first 100 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">vrna_pbacktrack5_resume_cb</a>(fc,</div>
<div class="line">                           100,</div>
<div class="line">                           &amp;callback_function,</div>
<div class="line">                           (<span class="keywordtype">void</span> *)&amp;callback_data,</div>
<div class="line">                           &amp;nonredundant_memory,</div>
<div class="line">                           options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// sample another 500 structures</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac">vrna_pbacktrack5_resume_cb</a>(fc,</div>
<div class="line">                           500,</div>
<div class="line">                           &amp;callback_function,</div>
<div class="line">                           (<span class="keywordtype">void</span> *)&amp;callback_data,</div>
<div class="line">                           &amp;nonredundant_memory,</div>
<div class="line">                           options);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory occupied by the non-redundant memory data structure</span></div>
<div class="line"><a class="code" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b">vrna_pbacktrack_mem_free</a>(nonredundant_memory);</div>
</div><!-- fragment --><dl class="section pre"><dt>Precondition</dt><dd>Unique multiloop decomposition has to be active upon creation of <code>fc</code> with <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> or similar. This can be done easily by passing <a class="el" href="group__fold__compound.html#ga283cf113a37614a75c1388c4ec6d7b2f" title="Retrieve a vrna_fold_compound_t data structure for single sequences and hybridizing sequences.">vrna_fold_compound()</a> a model details parameter with <a class="el" href="group__model__details.html#ade065b814a4e2e72ead93ab502613ed2" title="Flag to ensure unique multi-branch loop decomposition during folding.">vrna_md_t.uniq_ML</a> = 1. </dd>
<dd>
<a class="el" href="group__part__func__global.html#ga29e256d688ad221b78d37f427e0e99bc" title="Compute the partition function  for a given RNA sequence, or sequence alignment.">vrna_pf()</a> has to be called first to fill the partition function matrices</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function is polymorphic. It accepts <a class="el" href="group__fold__compound.html#ga1b0cef17fd40466cef5968eaeeff6166" title="Typename for the fold_compound data structure vrna_fc_s.">vrna_fold_compound_t</a> of type <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447da7e264dd3cf2dc9b6448caabcb7763cd6">VRNA_FC_TYPE_SINGLE</a>, and <a class="el" href="group__fold__compound.html#gga01a4ff86fa71deaaa5d1abbd95a1447dab821ce46ea3cf665be97df22a76f5023">VRNA_FC_TYPE_COMPARATIVE</a>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In non-redundant sampling mode (<a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>), this function may not yield the full number of requested samples. This may happen if a) the number of requested structures is larger than the total number of structuresin the ensemble, b) numeric instabilities prevent the backtracking function to enumerate structures with high free energies, or c) any other error occurs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga843fa953a15337b15cc68401adad84d7" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_cb()</a>, <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>, <a class="el" href="group__subopt__stochbt.html#ga760aa2fb2d5e3d7521a11454a21e9b9f" title="Boltzmann sampling flag indicating default backtracing mode.">VRNA_PBACKTRACK_DEFAULT</a>, <a class="el" href="group__subopt__stochbt.html#ga9d580ce645aa0c38b69afdf56c332200" title="Boltzmann sampling flag indicating non-redundant backtracing mode.">VRNA_PBACKTRACK_NON_REDUNDANT</a>, <a class="el" href="group__subopt__stochbt.html#gae64fbdef59e7f503d7e920aac279212b" title="Release memory occupied by a Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_free</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td>The fold compound data structure </td></tr>
    <tr><td class="paramname">num_samples</td><td>The size of the sample set, i.e. number of structures </td></tr>
    <tr><td class="paramname">cb</td><td>The callback that receives the sampled structure </td></tr>
    <tr><td class="paramname">data</td><td>A data structure passed through to the callback <code>cb</code> </td></tr>
    <tr><td class="paramname">nr_mem</td><td>The address of the Boltzmann sampling memory data structure </td></tr>
    <tr><td class="paramname">options</td><td>A bitwise OR-flag indicating the backtracing mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of structures actually backtraced</dd></dl>
<dl class="wrappers"><dt><b><a class="el" href="wrappers.html#_wrappers000014">SWIG Wrapper Notes:</a></b></dt><dd>This function is attached as overloaded method <b><a class="el" href="group__subopt__stochbt__deprecated.html#gac03ca6db186bb3bf0a2a326d7fb3ba03" title="Sample a secondary structure from the Boltzmann ensemble according its probability.">pbacktrack()</a></b> to objects of type <em>fold_compound</em>. In addition to the number of structures backtraced, this function also returns the <code>nr_mem</code> data structure as first element. See also <a class="el" href="examples_python.html#examples_python_pbacktrack">Python Examples - Boltzmann Sampling</a> </dd></dl>

</div>
</div>
<a id="gae64fbdef59e7f503d7e920aac279212b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae64fbdef59e7f503d7e920aac279212b">&#9670;&nbsp;</a></span>vrna_pbacktrack_mem_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vrna_pbacktrack_mem_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63">vrna_pbacktrack_mem_t</a>&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="boltzmann__sampling_8h.html">ViennaRNA/boltzmann_sampling.h</a>&gt;</code></p>

<p>Release memory occupied by a Boltzmann sampling memory data structure. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subopt__stochbt.html#gaa59c30efbed96bf9aaf8005584c72e63" title="Boltzmann sampling memory data structure.">vrna_pbacktrack_mem_t</a>, <a class="el" href="group__subopt__stochbt.html#gac5d7065196975b803daeb4e094ba1cb9" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga4a91dc092580faf7799476e8dd76e0ac" title="Obtain a set of secondary structure samples for a subsequence from the Boltzmann ensemble according t...">vrna_pbacktrack5_resume_cb()</a>, <a class="el" href="group__subopt__stochbt.html#gae175129ece546fe7c092f27072e039d1" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume()</a>, <a class="el" href="group__subopt__stochbt.html#ga6fc5ce952995e53baef52cad5581c063" title="Obtain a set of secondary structure samples from the Boltzmann ensemble according their probability.">vrna_pbacktrack_resume_cb()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The non-redundancy memory data structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Apr 23 2021 00:39:33 for RNAlib-2.4.18 by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
